(()=>{(window.vevr||(window.vevr=[])).push(function(eP,Bs,st){Bs.register("basic",["react","vev","animejs"],function(Ki){"use strict";var gt,qt,Ct,Bn,En,Zt,ln,Fn,Rn,ri,In,Hn,Un,en,Yt,Pn,Nt,Ee,Xe,pt,wt,kt;return{setters:[function(mt){gt=mt.useCallback,qt=mt.useRef,Ct=mt.useEffect,Bn=mt.default,En=mt.Fragment,Zt=mt.useState,ln=mt.useMemo},function(mt){Fn=mt.useGlobalStore,Rn=mt.Tracking,ri=mt.Link,In=mt.Image,Hn=mt.Icon,Un=mt.useHover,en=mt.useVisible,Yt=mt.useEditorState,Pn=mt.View,Nt=mt.useRoute,Ee=mt.useScrollTop,Xe=mt.useViewport,pt=mt.useDevice,wt=mt.useMainDevice},function(mt){kt=mt.default}],execute:function(){Ki({"external-link":It,frame:Tn,image:Ft,shape:di,w74dqar7:Gi,w75y8u1c:Ln});var mt=Ki("circle",()=>!1);function St(Tt){var Ut,ce,At;let _n="";switch(Tt.mode){case 0:Tt.page!==""?_n=((Ut=Tt==null?void 0:Tt.page)==null?void 0:Ut.title)||Tt.page:_n="Unlinked page";break;case 1:if(Tt.widget){const{key:$t,name:wn,page:Gn,pageName:yi}=Tt.widget;_n=wn+", "+yi}else _n="Unlinked page";break;case 2:_n=(Tt==null?void 0:Tt.href)||"empty link";break;case 3:Tt.email!==""?_n=Tt.email+"?subject"+Tt.subject:_n="empty email: ";break;case 4:_n=Tt.phone||"empty phone";break;case 5:((ce=Tt==null?void 0:Tt.file)==null?void 0:ce.url)!==""?_n=(At=Tt==null?void 0:Tt.file)==null?void 0:At.url:_n="empty phone: ";break}return _n}function It({link:Tt,children:_n,className:Ut}){const ce=Fn($t=>$t.pages),At=gt($t=>{Rn.send("vev","link-button","click",St(Tt))},[Tt,ce]);return st.createElement(ri,{onClick:At,className:Ut,to:Tt},_n)}function Tn(){return null}function Ft(Tt){return Tt.section&&(Tt.className="section"),st.createElement(In,Object.assign({},Tt))}var cn=Ki("rectangle",()=>null),nn=Ki("section",()=>st.createElement("div",{className:"children __sc"}));function di({shapeId:Tt,stretch:_n}){return st.createElement(Hn,{d:Tt,stretch:_n})}var Ri=Ki("text",({text:Tt})=>st.createElement("div",{className:"__stagger",id:"",dangerouslySetInnerHTML:{__html:Tt}}));function Ti(Tt){const _n=Tt.split("/");return _n[_n.length-1].split(".")[0]}function Gi({hostRef:Tt,video:_n,loop:Ut,infiniteLoop:ce,loopAmount:At,mute:$t,controls:wn,fill:Gn,playOnHover:yi=!1,startVisible:ir,noContextMenu:Oi,noTracking:Rr,thumbnail:Qi,preload:Bi,section:ni}){const li=qt(),at=qt({current:0,maxProgress:0}),[Ge,ct]=Un(),Cn=en(li),{disabled:jt}=Yt(),pn=qt(1);let ki=1;Ct(()=>{const Si=li.current;if(Rr||!Si||!_n)return;const or=["play","pause","ended","timeupdate"],ns=rr=>{const lr=li.current;if(!lr)return;const xt=(_n==null?void 0:_n.name)||Ti(_n.sources[0].url)||"";switch(rr.type){case"timeupdate":const sn=Math.round(100*lr.currentTime/lr.duration),_i={current:sn,maxProgress:Math.max(sn,at.current.maxProgress)};sn>at.current.maxProgress&&Xn("Video Progress",xt,at.current.maxProgress),lr.currentTime>ki*lr.duration/5&&(Xn(`Video Progress ${ki*20}`,xt),ki++),at.current.current=_i.current,at.current.maxProgress=_i.maxProgress;break;case"play":return Xn("Play",xt);case"pause":return Xn("Pause",xt,at.current.current);case"ended":return Xn("Finished",xt)}};return or.forEach(rr=>Si&&Si.addEventListener(rr,ns,!1)),()=>or.forEach(rr=>Si&&Si.removeEventListener(rr,ns))},[_n,Rr,Cn]),Ct(()=>{const Si=li.current;!Si||(jt?(pn.current=1,Si.load(),Si.pause()):Si.readyState>=3&&(Cn?Cn&&ir&&(Si.muted=!0,Si.play(),setTimeout(()=>Si.play(),100)):(Si.pause(),pn.current=1)))},[Cn,ir,jt,_n]);const Ai={};ce&&Ut&&(Ai.loop=!0),ir&&(Ai.autoPlay=!0),$t&&(Ai.muted=!0),wn&&(Ai.controls=!0),Pn.isIE&&(Ai.className="ie"),Ct(()=>{const Si=li.current;yi&&Si&&(Ge?Si.play():Si.pause())},[yi,Ge]),Ct(()=>{const Si=li.current;!Si||(Si.style.objectFit=Gn?"cover":"contain")},[Gn,li.current]);const jr=()=>{pn.current<At&&(li.current.currentTime=0,li.current.play(),pn.current++)};return Ct(()=>{if(li.current)return li.current.addEventListener("ended",jr),()=>{li.current&&li.current.removeEventListener("ended",jr)}},[li.current,At]),ni&&(Ai.className=(Ai.className||"")+" section"),Bn.createElement(En,null,!_n&&Bn.createElement("div",{className:"fill row v-center h-center",style:{color:"white"}},Bn.createElement("h3",null,"Double-click to select video")),Bn.createElement("video",Object.assign({},ct,{ref:li,onContextMenu:Si=>Oi&&Si.preventDefault(),"aria-label":(_n==null?void 0:_n.name)||"",full:!0,playsInline:!0,disableRemotePlayback:!0,poster:Qi&&Qi.url?Qi.url:_n&&_n.thumbnail,preload:Bi},Ai),_n&&_n.sources&&_n.sources.sort(Si=>Si.format==="video/webm"?-1:1).map(Si=>Bn.createElement("source",{key:Si.url,src:Si.url,type:Si.format||"video/mp4"})),"Your browser does not support this video"),Bn.createElement("div",{className:"overlay"}))}function Xn(Tt,_n,Ut,ce){Rn.send("video","HTML5 Video",Tt,_n,Ut,ce)}const zt={opacity:0};function Ln({className:Tt,children:_n,cont:Ut,hostRef:ce}){const At=en(ce),$t=qt(null),wn=qt(null),Gn=qt(null),yi=qt(null),[ir,Oi]=Un(),[Rr,Qi]=Zt(!1),{pageKey:Bi}=Nt(),{disabled:ni,selected:li}=Yt(),at=Ee(),{height:Ge}=Xe(),ct=pt(),Cn=wt&&wt()||"desktop",jt=Ut&&Ut[ct]&&Ut[ct].params||Ut&&Ut[Cn]&&Ut[Cn].params||{},pn=qt({ClickAnimation:null,HoverAnimation:null,ScrollAnimation:null,LoadAnimation:null}),ki=qt(null),Ai=qt(Bi);Ct(()=>{$t.current&&($t.current.style.opacity=null)}),Ct(()=>{ni||Hr(),pn.current.ScrollAnimation&&jt.ScrollAnimation&&rr(jt.ScrollAnimation);const tn=Lo();return()=>{tn.widget&&kt.remove(tn.widget),tn.stagger&&kt.remove(tn.stagger),tn.animation&&kt.remove(tn.animation)}},[]),Ct(()=>{!jt||ki&&jt.updated&&ki.current===jt.updated||(ki.current=jt.updated,Object.keys(pn.current).forEach(tn=>or(tn)),Hr(),ni&&li?Si(jt.trigger+"Animation"):Gn.current!==ct&&(ci(),Si(jt.trigger+"Animation"),Gn.current=ct))},[jt]),Ct(()=>{!jt||(Object.keys(pn.current).forEach(tn=>or(tn)),ni||Hr(),pn.current.LoadAnimation&&At&&!ni&&Si("LoadAnimation"),pn.current.ScrollAnimation&&At&&!ni&&rr(jt.ScrollAnimation),ni&&Rr&&Qi(!1))},[ni,ct]),Ct(()=>{!jt||(ni&&li?Si(jt.trigger+["Animation"]):ni&&!li&&or(jt.trigger+["Animation"]))},[li]),Ct(()=>{pn.current.HoverAnimation&&Hr()},[At]),Ct(()=>{!jt||!pn.current.LoadAnimation||(At?Si("LoadAnimation"):jt.LoadAnimation.once||or("LoadAnimation"))},[At]),Ct(()=>{const{HoverAnimation:tn}=pn.current;if(!tn&&ir&&jt.HoverAnimation){const ti=ce.current;if(ti.classList.contains("running-loadanimation")||ti.closest(".running-loadanimation"))return;jr("HoverAnimation",!0),Si("HoverAnimation",!ir)}else jt&&tn&&Si("HoverAnimation",!ir)},[ir]),Ct(()=>{!jt||!pn.current.ScrollAnimation||ni||rr(jt.ScrollAnimation)},[at]),Ct(()=>{!jt||!pn.current.ClickAnimation||Si("ClickAnimation",!Rr)},[Rr]),Ct(()=>{var tn;((tn=jt==null?void 0:jt.HoverAnimation)==null?void 0:tn.triggers)&&Bi!==Ai.current&&(lr("HoverAnimation",jt.HoverAnimation.triggers),Ai.current=Bi)},[Bi,jt]);const jr=(tn,ti)=>{if(!jt[tn])return;const $n=jt[tn],es=$n.triggers&&Object.keys($n.triggers).length>0;if(es&&setTimeout(()=>lr(tn,$n.triggers),100),!es&&tn==="HoverAnimation"&&!ti)return;const os=kt.timeline({autoplay:!1,delay:cr(jt[tn])}),Ls=Lo();let Ga={targets:$n.stagger?Ls.stagger:Ls==null?void 0:Ls.animation,easing:$n.easing||"linear"},ha={targets:$n.stagger?Ls.stagger:Ls==null?void 0:Ls.widget,easing:$n.easing||"linear"};ha.duration=Ga.duration=$n.duration?Math.max($n.duration,1e-4)*1e3:1e3,$n.opacity&&(Ga.opacity=$n.opacity),$n.scale&&(Ga.scale=$n.scale),$n.move&&$n.move[0]!=="0px"&&(Ga.translateY=$n.move[0]),$n.move&&$n.move[1]!=="0px"&&(Ga.translateX=$n.move[1]),$n.translateX&&(Ga.translateX=[$n.translateX[0],$n.translateX[1]]),$n.translateY&&(Ga.translateY=[$n.translateY[0],$n.translateY[1]]),$n.rotate&&(Ga.rotate=[0,$n.rotate]),Ga.rotate3d=[],$n.color&&(ha.color=Nn($n.color)),$n.background&&(ha.backgroundColor=Nn($n.background)),$n.border&&(ha["border-radius"]=[$n.border[0],$n.border[1]]),($n.color||$n.background||$n.border)&&os.add({...ha}),os.add({...Ga}),pn.current[tn]=os,ni&&!li&&ci()},Si=(tn,ti)=>{const $n=pn.current[tn];if(ni&&!li||!$n||$n.began&&!$n.complete&&ti===void 0)return;const es=jt[tn].loop;if(!es){const os=ce.current;os.classList.add("running-"+tn.toLowerCase()),$n.finished.then(()=>os.classList.remove("running-"+tn.toLowerCase()))}jt[tn]&&es&&($n.complete=()=>{es==="restart"?$n.currentTime=0:$n.reverse(),$n.completed=!1,$n.play()}),Kr($n,ti)&&($n.began&&$n.pause(),ti!==void 0&&$n.reversed!==ti&&($n.reverse(),$n.completed=!1),$n.play())},or=tn=>{if(!!pn.current[tn]){if(!jt[tn])return ns(tn);pn.current[tn].pause(),pn.current[tn].reversed&&pn.current[tn].reverse(),pn.current[tn].seek(0),pn.current[tn].complete=null,pn.current[tn].began=!1,tn==="HoverAnimation"&&(wn.current&&sn(),Er(tn)&&lr(tn,jt[tn].triggers)),tn==="ClickAnimation"&&(yi.current&&_i(),Er(tn)&&lr(tn,jt[tn].triggers)),ni&&ci()}},ns=tn=>{pn.current[tn].pause(),pn.current[tn].seek(0),pn.current[tn]=null;const ti=Lo();ti!=null&&ti.widget&&kt.remove(ti==null?void 0:ti.widget),ti!=null&&ti.stagger&&kt.remove(ti==null?void 0:ti.stagger),ti!=null&&ti.animation&&kt.remove(ti==null?void 0:ti.animation),ci()},rr=tn=>{if(!tn)return;const ti=pn.current.ScrollAnimation,$n=tn.scrollOffsetStart?tn.scrollOffsetStart:0,es=tn.scrollOffsetEnd?tn.scrollOffsetEnd:0;let os;ce.current.classList.contains("__f")||ce.current.classList.contains("__pp")?os=(at+$n)/(Ge-es+$n):(os=$r(tn.event,$n,es),os=ti.duration/1e3-os);let Ls=ti.duration*os;Ls<0&&At&&(Ls=.01),ti.seek(Ls)},lr=gt((tn,ti)=>{const $n=[],es=[];Object.values(ti).forEach(os=>{if(!ce||!ce.current)return;const Ls=ce.current.getRootNode().getElementById((os==null?void 0:os.key)||os);Ls&&(tn==="ClickAnimation"?(Ls.addEventListener("click",xt),Ls.style.cursor="pointer",es.push(Ls)):tn==="HoverAnimation"&&(Ls.addEventListener("mouseenter",Oi.onMouseEnter),Ls.addEventListener("mouseleave",Oi.onMouseLeave),$n.push(Ls)))}),wn.current=$n,yi.current=es},[ce,wn,yi]),xt=()=>{const tn=pn.current.ClickAnimation;if(!tn.began)return tn.play();tn.reverse(),tn.completed=!1,tn.began=!1,tn.play()},sn=()=>{wn.current&&wn.current.forEach(tn=>{tn.removeEventListener("mouseleave",Oi.onMouseLeave),tn.removeEventListener("mouseenter",Oi.onMouseEnter)})},_i=()=>{yi.current&&yi.current.forEach(tn=>{tn.removeEventListener("click",xt),tn.style.cursor=null})},Hr=()=>{!jt||Object.keys(pn.current).forEach(tn=>{jt[tn]&&jr(tn)})},Er=tn=>{var ti;return Boolean(Object.keys(((ti=jt==null?void 0:jt[tn])==null?void 0:ti.triggers)||{}).length)};ln(()=>{var tn;return Boolean(Object.keys(((tn=jt==null?void 0:jt.HoverAnimation)==null?void 0:tn.triggers)||{}).length)},[jt]);const ci=()=>{if(!ce.current)return;const tn=Lo();tn.animation&&tn.animation.removeAttribute("style"),tn.widget&&tn.widget.removeAttribute("style"),tn.stagger&&[].forEach.call(tn.stagger,ti=>ti&&ti.removeAttribute("style"))},cr=tn=>{const ti=Math.max(tn.delay,0);return tn.stagger?kt.stagger(tn.stagger[0]*1e3,{start:ti*1e3,from:tn.stagger[1]}):ti*1e3},$r=(tn,ti,$n)=>{const es=ce.current.getBoundingClientRect(),os=Math.abs(Ge-$n<es.height?$n+(Ge-$n-es.height):$n);if(tn==="bot")return(es.bottom-es.height-os)/(Ge-es.height+ti-os);if(tn==="top")return(es.top-$n)/(es.height+ti-$n);if(tn==="mid")return(es.top-$n)/((Ge-es.height)/2+ti-$n)},Lo=()=>{let tn,ti,$n;return ce.current?(tn=ce.current.querySelector(".__wc"),tn?(ti=!!ce.current.querySelector(".__c")?tn:tn.querySelector("w"),$n=ce.current.classList.contains("__text")?tn.querySelectorAll("w div > *"):tn.querySelectorAll(".__c vev .__wc"),{animation:tn,widget:ti,stagger:$n}):{animation:tn,widget:ti,stagger:$n}):{animation:tn,widget:ti,stagger:$n}},Kr=(tn,ti)=>!(ti&&tn.currentTime===0||ti===!1&&tn.currentTime===tn.duration);let Na;return!ni&&jt&&(jt.LoadAnimation||jt.ScrollAnimation)&&(Na=zt),st.createElement("div",{className:Tt,style:Na,onClick:!Er("ClickAnimation")&&(()=>Qi(!Rr)),onMouseEnter:Er("HoverAnimation")||Oi==null?void 0:Oi.onMouseEnter,onMouseLeave:Er("HoverAnimation")||Oi==null?void 0:Oi.onMouseLeave,ref:$t},_n)}const Nn=Tt=>`rgba(${[Tt.r,Tt.g,Tt.b,Tt.a].toString()}`}}}),Bs.register("p7b63t4d",["react","vev"],function(Ki){"use strict";var gt,qt,Ct,Bn,En,Zt,ln,Fn,Rn;return{setters:[function(ri){gt=ri.useState,qt=ri.useEffect},function(ri){Ct=ri.useEditorState,Bn=ri.useGlobalStore,En=ri.useModel,Zt=ri.useGlobalStateRef,ln=ri.useSize,Fn=ri.useLiveEvent,Rn=ri.View}],execute:function(){Ki("wu8uG6mrVuI",Ee);const ri=/\/{2,}/g;function In(Xe="",pt,wt){Xe=Xe.replace(new RegExp("^\\/?"+en(wt||"")),""),Xe=Hn(en(Xe));const kt=pt.find(mt=>mt.index)||pt[0];if(!Xe||Xe==="/"||Xe===en(wt||""))return kt.key;for(const mt of pt){if(Xe.replace(/^\//,"")===mt.key)return mt.key;if(mt.index)continue;const St=Xe.indexOf(mt.path),It=Hn(mt.path||"");if(St!==-1&&Xe===It||Un(mt.path)===Un(Xe))return mt.key}return kt.key}const Hn=Xe=>Xe.replace(/(^\/)|(\/$)/g,""),Un=Xe=>Xe.replace(/^\/|\/$/g,"");function en(Xe){const pt=Xe?Xe.replace(/^\./,"").replace(/(\?|#).*$/,"").replace(ri,"/").replace(/(?!^\/)\/$/,"").replace(/index.html$/i,""):"";return/\.w+$/.test(pt)||pt.endsWith("/")?pt:pt+"/"}function Yt(Xe){var di;var pt=Xe.getBoundingClientRect();const wt=(di=Xe.className)==null?void 0:di.includes("__s");var kt=document.body,mt=document.documentElement,St=window.pageYOffset||mt.scrollTop||kt.scrollTop,It=window.pageXOffset||mt.scrollLeft||kt.scrollLeft,Tn=mt.clientTop||kt.clientTop||0,Ft=mt.clientLeft||kt.clientLeft||0,cn=pt.top-Xe.offsetTop+St-Tn,nn=pt.left-(wt?0:Xe.offsetLeft)+It-Ft;return{top:Math.round(cn),left:Math.round(nn)}}var Pn=window.innerWidth,Nt=window.innerHeight;function Ee({hostRef:Xe}){var at;const{disabled:pt}=Ct(),[wt,kt,mt,St]=Bn(Ge=>[Ge.zoom,Ge.viewport,Ge.device,Ge.route.pageKey]),It=En(),[Tn,Ft]=gt(null),[cn,nn]=gt(null),[di,Ri]=gt(null),[Ti,Gi]=gt(null),[Xn,zt]=gt(null),[Ln,Nn]=gt(null),[Tt,_n]=Zt(),{width:Ut,height:ce}=ln(Xe);qt(()=>{const Ge=Xe.current;if(!(pt||!Ge))return ni(Ge),$t(Ge),()=>ni(Ge)},[pt]),Fn("a","click",((at=Tt==null?void 0:Tt.current)==null?void 0:at.root)||void 0,(Ge,ct)=>{const Cn=ct.getAttribute("href")||"";if(!Cn)return;if(/(^(#|\/))/.test(Cn)&&!Cn.includes("//")&&(!location.host||!(Ge.ctrlKey||Ge.metaKey))){Ge.preventDefault();const{route:pn,pages:ki,dir:Ai,embed:jr}=Tt.current,[Si,or]=Cn.split("#"),ns=In(Si,ki,Ai),rr=pn.transition&&pn.transition.toPageKey||pn.pageKey;if(Cn.startsWith("#")||rr===ns){if(or){const lr=Xe.current.getRootNode().getElementById(or);if(Xe.current.contains(lr)){Ge.stopPropagation();const xt=Yt(lr),sn=xt.left/Ut;Rn.scrollTo(xt.top+Ut*sn,void 0,void 0);return}}return}}},[Xe,Tt.current.root,Ut,ce]),qt(()=>{if(!pt){var Ge=Xe.current;Pn=kt.width/wt,Nt=window.innerHeight/wt,Ge.style.maxHeight=Nt+"px",Tn&&(Tn.style.width=Pn+"px"),di&&(di.style.height=Nt+"px"),cn&&(cn.style.height=Nt+"px"),Ti&&Gn(Ti,cn)}},[wt,kt]);function At(){const Ge=document.createElement("div");Ge.style.position="absolute",Ge.style.height="100vh",document.body.appendChild(Ge);const ct=Ge.clientHeight;return Ge.remove(),ct}function $t(Ge){var ct=Oi(Ge),Cn=wn(ct);if(console.log(Cn,Cn==null?void 0:Cn.classList,It),Cn&&Cn.classList.contains("horiz-outter")){var jt=Cn.firstChild.firstChild;jt.appendChild(ct),Gn(Cn,jt)}else{var pn=Rr(ct),ki=Qi(pn),Ai=Bi(ki);zt(()=>()=>yi(Ai,pn)),Nn(()=>()=>ir(Ai,ki))}}qt(()=>{window.addEventListener("scroll",Xn),window.addEventListener("scroll",Ln)},[Xn,Ln]);function wn(Ge){var ct=Ge.previousElementSibling;return ct&&!ct.getBoundingClientRect().height&&(ct=wn(ct)),ct}function Gn(Ge,ct){var Cn=ct.getBoundingClientRect().width;if(Cn==0)Ge.style.height="0";else{var jt=Cn-Pn+Nt;Ge.style.height=jt+"px"}}const yi=(Ge,ct)=>{const Cn=Ge.getBoundingClientRect();var jt=Math.min(0,Cn.top);jt<0&&(jt=Math.max(jt,-(Cn.height-Nt))),ct.style.left=jt+"px"},ir=(Ge,ct)=>{var Cn=Ge.getBoundingClientRect();mt=="mobile"&&At(),Cn.top<=0&&Cn.bottom>Nt?(ct.style.position="fixed",ct.style.top="0"):Cn.top>0?(ct.style.position="absolute",ct.style.bottom="",ct.style.top="0"):mt=="mobile"?(ct.style.position="absolute",ct.style.bottom="0",ct.style.top=""):(ct.style.position="absolute",ct.style.top="",ct.style.bottom="0")};function Oi(Ge){var ct=document.createElement("div");return ct.classList.add("horiz-sizer"),ct.style.width=Ge.getBoundingClientRect().width+"px",window.getComputedStyle(Ge).display==="none"&&(ct.style.display="none"),Ge.parentNode.insertBefore(ct,Ge),ct.insertBefore(Ge,ct.childNodes[0]),Ft(ct),ct}function Rr(Ge){var ct=document.createElement("div");return ct.classList.add("horiz-translator"),ct.style.position="absolute",ct.style.width="auto",ct.style.height=Nt+"px",ct.style.willChange="transform",ct.style.display="flex",ct.style.alignItems="center",Ge.parentNode.insertBefore(ct,Ge),ct.insertBefore(Ge,ct.childNodes[0]),nn(ct),ct}function Qi(Ge){var ct=document.createElement("div");return ct.classList.add("horiz-sticky"),ct.style.top="0",ct.style.width=100+"%",ct.style.height=Nt+"px",Ge.parentNode.insertBefore(ct,Ge),ct.insertBefore(Ge,ct.childNodes[0]),Ri(ct),ct}function Bi(Ge){var ct=document.createElement("div");return ct.classList.add("horiz-outter"),ct.style.position="relative",ct.style.width=100+"%",ct.style.height=Xe.current.getBoundingClientRect().height+"px",Ge.parentNode.insertBefore(ct,Ge),ct.insertBefore(Ge,ct.childNodes[0]),Gi(ct),ct}function ni(Ge){var ct,Cn,jt,pn,ki,Ai,jr,Si;window.removeEventListener("scroll",Xn),window.removeEventListener("scroll",Ln),Ge!=null&&Ge.style&&(Ge.style.maxHeight=null),(Cn=(ct=Ge==null?void 0:Ge.parentElement)==null?void 0:ct.classList)!=null&&Cn.contains("horiz-sizer")&&li(Ge),(pn=(jt=Ge==null?void 0:Ge.parentElement)==null?void 0:jt.classList)!=null&&pn.contains("horiz-translator")&&li(Ge),(Ai=(ki=Ge==null?void 0:Ge.parentElement)==null?void 0:ki.classList)!=null&&Ai.contains("horiz-sticky")&&li(Ge),(Si=(jr=Ge==null?void 0:Ge.parentElement)==null?void 0:jr.classList)!=null&&Si.contains("horiz-outter")&&li(Ge)}function li(Ge){var ct=Ge.parentNode;ct.replaceWith(...ct.childNodes)}return st.createElement("div",null)}}}}),Bs.register("YPXcb_7Y0w",["react","vev","animejs"],function(Ki){"use strict";var gt,qt,Ct,Bn,En,Zt,ln,Fn,Rn,ri,In;return{setters:[function(Hn){gt=Hn.useRef,qt=Hn.useState,Ct=Hn.useEffect},function(Hn){Bn=Hn.useVisible,En=Hn.useHover,Zt=Hn.useEditorState,ln=Hn.useScrollTop,Fn=Hn.useViewport,Rn=Hn.useDevice,ri=Hn.useMainDevice},function(Hn){In=Hn.default}],execute:function(){Ki("wFynYMEB_7I",Un);const Hn={opacity:0};function Un({className:Yt,children:Pn,cont:Nt,hostRef:Ee}){gt(null),gt(null);const Xe=Bn(Ee),pt=gt(null),wt=gt(null),kt=gt(null),mt=gt(null),[St,It]=En(),[Tn,Ft]=qt(!1),{disabled:cn,selected:nn}=Zt(),di=ln(),{height:Ri}=Fn(),Ti=Rn(),Gi=ri&&ri()||"desktop",Xn=Nt&&Nt[Ti]&&Nt[Ti].params||Nt&&Nt[Gi]&&Nt[Gi].params||{},zt=gt({ClickAnimation:null,HoverAnimation:null,ScrollAnimation:null,LoadAnimation:null}),Ln=gt(null);Ct(()=>{pt.current&&(pt.current.style.opacity=null)}),Ct(()=>{cn||yi(),zt.current.ScrollAnimation&&Xn.ScrollAnimation&&ce(Xn.ScrollAnimation);const at=Bi();return()=>{at.widget&&In.remove(at.widget),at.stagger&&In.remove(at.stagger),at.animation&&In.remove(at.animation)}},[]),Ct(()=>{!Xn||Ln&&Xn.updated&&Ln.current===Xn.updated||(Ln.current=Xn.updated,Object.keys(zt.current).forEach(at=>_n(at)),yi(),cn&&nn?Tt(Xn.trigger+"Animation"):kt.current!==Ti&&(Tt(Xn.trigger+"Animation"),kt.current=Ti))},[Xn]),Ct(()=>{!Xn||(Object.keys(zt.current).forEach(at=>_n(at)),cn||yi(),zt.current.LoadAnimation&&Xe&&Tt("LoadAnimation"),zt.current.ScrollAnimation&&Xe&&!cn&&ce(Xn.ScrollAnimation),cn&&Tn&&Ft(!1))},[cn,Ti]),Ct(()=>{!Xn||(cn&&nn?Tt(Xn.trigger+["Animation"]):cn&&!nn&&_n(Xn.trigger+["Animation"]))},[nn]),Ct(()=>{!Xn||!zt.current.LoadAnimation||(Xe?Tt("LoadAnimation"):Xn.LoadAnimation.once||_n("LoadAnimation"))},[Xe]),Ct(()=>{!Xn||!zt.current.HoverAnimation||Tt("HoverAnimation",!St)},[St]),Ct(()=>{!Xn||!zt.current.ScrollAnimation||cn||ce(Xn.ScrollAnimation)},[di]),Ct(()=>{!Xn||!zt.current.ClickAnimation||Tt("ClickAnimation",!Tn)},[Tn]);const Nn=at=>{if(!Xn[at])return;const Ge=Xn[at],ct=In.timeline({autoplay:!1,delay:Rr(Xn[at])}),Cn=Bi();let jt={targets:Ge.stagger?Cn.stagger:Cn.animation,easing:Ge.easing||"linear"},pn={targets:Ge.stagger?Cn.stagger:Cn.widget,easing:Ge.easing||"linear"};pn.duration=jt.duration=Ge.duration?Math.max(Ge.duration,1e-4)*1e3:1e3,Ge.opacity&&(jt.opacity=Ge.opacity),Ge.scale&&(jt.scale=Ge.scale),Ge.move&&Ge.move[0]!=="0px"&&(jt.translateY=Ge.move[0]),Ge.move&&Ge.move[1]!=="0px"&&(jt.translateX=Ge.move[1]),Ge.translateX&&(jt.translateX=[Ge.translateX[0],Ge.translateX[1]]),Ge.translateY&&(jt.translateY=[Ge.translateY[0],Ge.translateY[1]]),Ge.rotate&&(jt.rotate=[0,Ge.rotate]),jt.rotate3d=[],Ge.color&&(pn.color=en(Ge.color)),Ge.background&&(pn.backgroundColor=en(Ge.background)),Ge.border&&(pn["border-radius"]=[Ge.border[0],Ge.border[1]]),(Ge.color||Ge.background||Ge.border)&&ct.add({...pn}),ct.add({...jt}),zt.current[at]=ct,Ge.triggers&&Object.keys(Ge.triggers).length&&setTimeout(()=>At(at,Ge.triggers),100),cn&&!nn&&Oi()},Tt=(at,Ge)=>{const ct=zt.current[at];cn&&!nn||!ct||ct.began&&!ct.complete&&Ge===void 0||(Xn[at]&&Xn[at].loop&&(ct.complete=()=>{ct.reverse(),ct.completed=!1,ct.play()}),ni(ct,Ge)&&(ct.began&&ct.pause(),Ge!==void 0&&ct.reversed!==Ge&&(ct.reverse(),ct.completed=!1),ct.play()))},_n=at=>{if(!!zt.current[at]){if(!Xn[at])return Ut(at);zt.current[at].pause(),zt.current[at].reversed&&zt.current[at].reverse(),zt.current[at].seek(0),zt.current[at].complete=null,zt.current[at].began=!1,at==="HoverAnimation"&&(wt.current&&wn(),ir(at)&&At(at,Xn[at].triggers)),at==="ClickAnimation"&&(mt.current&&Gn(),ir(at)&&At(at,Xn[at].triggers)),cn&&Oi()}},Ut=at=>{zt.current[at].pause(),zt.current[at].seek(0),zt.current[at]=null;const Ge=Bi();Ge.widget&&In.remove(Ge.widget),Ge.stagger&&In.remove(Ge.stagger),Ge.animation&&In.remove(Ge.animation),Oi()},ce=at=>{if(!at)return;const Ge=zt.current.ScrollAnimation,ct=at.scrollOffsetStart?at.scrollOffsetStart:0,Cn=at.scrollOffsetEnd?at.scrollOffsetEnd:0;let jt;Ee.current.classList.contains("__f")||Ee.current.classList.contains("__pp")?jt=(di+ct)/(Ri-Cn+ct):jt=Qi(at.event,ct,Cn);let pn=Ge.duration*jt;pn<0&&Xe&&(pn=.01),Ge.seek(pn)},At=(at,Ge)=>{const ct=[],Cn=[];Object.values(Ge).forEach(jt=>{const pn=document.getElementById(jt&&jt.key||jt);pn&&(at==="ClickAnimation"?(pn.addEventListener("click",$t),pn.style.cursor="pointer",Cn.push(pn)):at==="HoverAnimation"&&(pn.onmouseenter=It.onMouseEnter,pn.onmouseleave=It.onMouseLeave,ct.push(pn)))}),wt.current=ct,mt.current=Cn},$t=()=>{const at=zt.current.ClickAnimation;if(!at.began)return at.play();at.reverse(),at.completed=!1,at.began=!1,at.play()},wn=()=>{wt.current&&wt.current.forEach(at=>{at.onmouseenter=()=>!1,at.onmouseleave=()=>!1})},Gn=()=>{mt.current&&mt.current.forEach(at=>{at.removeEventListener("click",$t),at.style.cursor=null})},yi=()=>{!Xn||Object.keys(zt.current).forEach(at=>Xn[at]&&Nn(at))},ir=at=>!(!Xn||!Xn[at]||!Xn[at].triggers||!Object.keys(Xn[at].triggers).length),Oi=()=>{if(!Ee.current)return;const at=Bi();at.animation&&at.animation.removeAttribute("style"),at.widget&&at.widget.removeAttribute("style"),at.stagger&&[].forEach.call(at.stagger,Ge=>Ge&&Ge.removeAttribute("style"))},Rr=at=>{const Ge=Math.max(at.delay,0);return at.stagger?In.stagger(at.stagger[0]*1e3,{start:Ge*1e3,from:at.stagger[1]}):Ge*1e3},Qi=(at,Ge,ct)=>{const Cn=Ee.current.getBoundingClientRect(),jt=Cn.top/Ri;if(Cn.height>Ri*.8)return zt.current.ScrollAnimation.duration/1e3+(Cn.top-ct)/(Cn.height/2+Ge-ct);if(at==="bot"){const pn=Math.max(0,Ri/Cn.bottom);return Math.max(0,(Ri+Ge*pn)/(Cn.bottom+Ge*pn-ct))}else if(at==="top"){const pn=Cn.height/2*jt,ki=Cn.top+pn+Ge*jt-ct,Ai=Ri-Cn.height/2-ct;return 1-Math.max(0,ki/Ai)}else if(at==="mid"){const pn=Ri/2,ki=(Cn.top+Cn.height/2-pn)/(Ri-Cn.height/2-pn),Ai=Cn.top+Cn.height/2+Ge*ki-pn-ct,jr=Ri-Cn.height/2-pn-ct;return 1-Math.max(0,Ai/jr)}},Bi=()=>{if(!Ee.current)return;let at,Ge,ct;return at=Ee.current.querySelector(".__wc"),Ge=at&&at.querySelector("w"),Ee.current.className.includes("_frame")&&(Ge=at),ct=Ee.current.classList.contains("__text")?at==null?void 0:at.querySelectorAll("w div > *"):at==null?void 0:at.querySelectorAll(".__c vev .__wc"),{animation:at,widget:Ge,stagger:ct}},ni=(at,Ge)=>!(Ge&&at.currentTime===0||Ge===!1&&at.currentTime===at.duration);let li;return!cn&&Xn&&(Xn.LoadAnimation||Xn.ScrollAnimation)&&(li=Hn),st.createElement("div",{className:Yt,style:li,onClick:!ir("ClickAnimation")&&(()=>Ft(!Tn)),onMouseEnter:!ir("HoverAnimation")&&It.onMouseEnter,onMouseLeave:!ir("HoverAnimation")&&It.onMouseLeave,ref:pt},Pn)}const en=Yt=>`rgba(${[Yt.r,Yt.g,Yt.b,Yt.a].toString()}`}}}),Bs.register("p7ak0n2x",["react"],function(Ki){"use strict";var gt;return{setters:[function(qt){gt=qt.useRef}],execute:function(){Ki("wp423o6en5",qt);function qt(Ct){var Bn=Ct.className,En=Ct.children,Zt=gt(null);return st.createElement("div",{className:Bn,ref:Zt},st.createElement("div",{className:"fill"},En))}}}}),Bs.register("p7aab14x",["react","vev","animejs"],function(Ki){"use strict";var gt,qt,Ct,Bn,En,Zt;return{setters:[function(ln){gt=ln.useState,qt=ln.useRef,Ct=ln.useEffect},function(ln){Bn=ln.useRoute,En=ln.useEditorState},function(ln){Zt=ln.default}],execute:function(){Ki("w3KGW2DkF2",Nt);function ln(Ee){console.log("targ: ",Ee),Zt({targets:Ee,opacity:[0,1],duration:300,easing:"easeInOutQuad",begin:function(){Ee.style.display="inherit"}})}function Fn(Ee){Zt({targets:Ee,opacity:[1,0],duration:300,easing:"easeInOutQuad",complete:function(){Ee.style.display="none",Ee.style.transform=null}})}function Rn(Ee){Zt({targets:Ee,opacity:1,translateX:["100%","0%"],duration:300,easing:"easeInOutQuad",begin:function(){Ee.style.display="inherit"}})}function ri(Ee){Zt({targets:Ee,translateX:["0%","-100%"],duration:300,easing:"easeInOutQuad",complete:function(){Ee.style.display="none",Ee.style.transform=null}})}function In(Ee){Zt({targets:Ee,opacity:1,translateX:["-100%","0%"],duration:300,easing:"easeInOutQuad",begin:function(){Ee.style.display="inherit"}})}function Hn(Ee){Zt({targets:Ee,translateX:["0%","100%"],duration:300,easing:"easeInOutQuad",complete:function(){Ee.style.display="none",Ee.style.transform=null}})}function Un(Ee){Zt({targets:Ee,opacity:1,translateY:["100%","0%"],duration:300,easing:"easeInOutQuad",begin:function(){Ee.style.display="inherit"}})}function en(Ee){console.log("slideOut_up"),Zt({targets:Ee,translateY:"-100%",duration:300,easing:"easeInOutQuad",complete:function(){Ee.style.display="none",Ee.style.transform=""}})}function Yt(Ee){Zt({targets:Ee,opacity:1,translateY:["-100%","0%"],duration:300,easing:"easeInOutQuad",begin:function(){Ee.style.display="inherit"}})}function Pn(Ee){Zt({targets:Ee,translateY:["0%","100%"],duration:300,easing:"easeInOutQuad",complete:function(){Ee.style.display="none",Ee.style.transform=null}})}function Nt({hostRef:Ee,className:Xe,children:pt,showbyDefault:wt,showTriggers:kt,hideTriggers:mt,enterAnimation:St,leaveAnimation:It}){const[Tn,Ft]=gt(wt),cn=qt(wt),{pageKey:nn}=Bn(),{disabled:di}=En(),[Ri,Ti]=gt(!1),Gi=()=>Ln(!0),Xn=()=>Ln(!1),zt=()=>Nn();Ct(()=>{if(Ee.current){var Ut=[],ce=[],At=[];let $t=[...kt],wn=[...mt];Ut=[],ce=[];let Gn=$t.filter((Qi,Bi)=>{if(mt[Bi]&&(Qi==null?void 0:Qi.trigger.key)===mt[Bi].trigger.key)return $t.splice(Bi,1),wn.splice(Bi,1),!0});const yi=Ee.current.getRootNode();let ir,Oi=0;const Rr=()=>{let Qi=!1;if($t.length>0){for(var Bi=0;Bi<$t.length;Bi++)if($t[Bi]&&$t[Bi].trigger){var ni=yi.getElementById($t[Bi].trigger.key);ni&&Ut.indexOf(ni)===-1?(Ut.push(ni),ni.addEventListener("click",Gi),ni.style.cursor="pointer"):Qi=!0}}if(wn.length>0)for(var li=0;li<wn.length;li++)if(wn[li]&&wn[li].trigger){var ni=yi.getElementById(wn[li].trigger.key);ni&&ce.indexOf(ni)===-1&&(ce.push(ni),ni.addEventListener("click",Xn),ni.style.cursor="pointer")}else Qi=!0;if(Gn.length>0){for(var at=0;at<Gn.length;at++)if(Gn[at]&&Gn[at].trigger){var ni=yi.getElementById(Gn[at].trigger.key);ni&&At.indexOf(ni)===-1?(At.push(ni),ni.addEventListener("click",zt),ni.style.cursor="pointer"):Qi=!0}}Qi&&Oi<20&&(ir=setTimeout(Rr,400),Oi++)};return ir=setTimeout(Rr,400),()=>{clearTimeout(ir);for(var Qi=0;Qi<Ut.length;Qi++)Ut[Qi].removeEventListener("click",Gi),Ut[Qi].style.cursor="";for(var Bi=0;Bi<ce.length;Bi++)ce[Bi].removeEventListener("click",Xn),ce[Bi].style.cursor="";for(var ni=0;ni<At.length;ni++)At[ni].removeEventListener("click",zt),At[ni].style.cursor=""}}},[kt,mt,Ee,nn]),Ct(()=>{cn.current=wt,Ft(wt);const Ut=Ee.current;if(!!Ut&&!di)return wt||(Ut.style.display="none"),()=>{cn.current=wt,Ft(wt),Ut.style.display="",Ut.style.opacity="",Ti(!1)}},[wt,di]),Ct(()=>{if(!di){if(!Ri){Ti(!0);return}Tn?Tt():_n()}},[Tn,di]);const Ln=Ut=>{cn.current=Ut,Ft(Ut)},Nn=()=>{cn.current=!cn.current,Ft(cn.current)};function Tt(){switch(St){case"slide-left":Rn(Ee.current);break;case"slide-right":In(Ee.current);break;case"slide-up":Un(Ee.current);break;case"slide-down":Yt(Ee.current);break;default:ln(Ee.current);break}}function _n(){switch(It){case"slide-left":ri(Ee.current);break;case"slide-right":Hn(Ee.current);break;case"slide-up":en(Ee.current);break;case"slide-down":Pn(Ee.current);break;default:Fn(Ee.current);break}}return st.createElement("div",{className:Xe},pt)}}}}),Bs.register("4zA-oRX4mi",["react","vev"],function(Ki){"use strict";var gt,qt,Ct,Bn,En,Zt,ln,Fn;return{setters:[function(Rn){gt=Rn.useRef,qt=Rn.useEffect,Ct=Rn.useState},function(Rn){Bn=Rn.useEditorState,En=Rn.useScrollTop,Zt=Rn.View,ln=Rn.useFrame,Fn=Rn.isString}],execute:function(){Ki("chart",Gi);var Rn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ri(zt,Ln){return Ln={exports:{}},zt(Ln,Ln.exports),Ln.exports}var In=ri(function(zt,Ln){/*!
 * Chart.js v3.6.0
 * https://www.chartjs.org
 * (c) 2021 Chart.js Contributors
 * Released under the MIT License
 */(function(Nn,Tt){zt.exports=Tt()})(Rn,function(){const Nn=function(){return typeof window>"u"?function(h){return h()}:window.requestAnimationFrame}();function Tt(h,o,c){const d=c||(_=>Array.prototype.slice.call(_));let m=!1,y=[];return function(..._){y=d(_),m||(m=!0,Nn.call(window,()=>{m=!1,h.apply(o,y)}))}}function _n(h,o){let c;return function(...d){return o?(clearTimeout(c),c=setTimeout(h,o,d)):h.apply(this,d),o}}const Ut=h=>h==="start"?"left":h==="end"?"right":"center",ce=(h,o,c)=>h==="start"?o:h==="end"?c:(o+c)/2,At=(h,o,c,d)=>h===(d?"left":"right")?c:h==="center"?(o+c)/2:o;var $t=new class{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(h,o,c,d){const m=o.listeners[d],y=o.duration;m.forEach(_=>_({chart:h,initial:o.initial,numSteps:y,currentStep:Math.min(c-o.start,y)}))}_refresh(){this._request||(this._running=!0,this._request=Nn.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(h=Date.now()){let o=0;this._charts.forEach((c,d)=>{if(!c.running||!c.items.length)return;const m=c.items;let y=m.length-1,_=!1,T;for(;y>=0;--y)T=m[y],T._active?(T._total>c.duration&&(c.duration=T._total),T.tick(h),_=!0):(m[y]=m[m.length-1],m.pop());_&&(d.draw(),this._notify(d,c,h,"progress")),m.length||(c.running=!1,this._notify(d,c,h,"complete"),c.initial=!1),o+=m.length}),this._lastDate=h,o===0&&(this._running=!1)}_getAnims(h){const o=this._charts;let c=o.get(h);return c||(c={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},o.set(h,c)),c}listen(h,o,c){this._getAnims(h).listeners[o].push(c)}add(h,o){!o||!o.length||this._getAnims(h).items.push(...o)}has(h){return this._getAnims(h).items.length>0}start(h){const o=this._charts.get(h);!o||(o.running=!0,o.start=Date.now(),o.duration=o.items.reduce((c,d)=>Math.max(c,d._duration),0),this._refresh())}running(h){if(!this._running)return!1;const o=this._charts.get(h);return!(!o||!o.running||!o.items.length)}stop(h){const o=this._charts.get(h);if(!o||!o.items.length)return;const c=o.items;let d=c.length-1;for(;d>=0;--d)c[d].cancel();o.items=[],this._notify(h,o,Date.now(),"complete")}remove(h){return this._charts.delete(h)}};/*!
 * @kurkle/color v0.1.9
 * https://github.com/kurkle/color#readme
 * (c) 2020 Jukka Kurkela
 * Released under the MIT License
 */const wn={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Gn="0123456789ABCDEF",yi=h=>Gn[h&15],ir=h=>Gn[(h&240)>>4]+Gn[h&15],Oi=h=>(h&240)>>4===(h&15);function Rr(h){return Oi(h.r)&&Oi(h.g)&&Oi(h.b)&&Oi(h.a)}function Qi(h){var o=h.length,c;return h[0]==="#"&&(o===4||o===5?c={r:255&wn[h[1]]*17,g:255&wn[h[2]]*17,b:255&wn[h[3]]*17,a:o===5?wn[h[4]]*17:255}:(o===7||o===9)&&(c={r:wn[h[1]]<<4|wn[h[2]],g:wn[h[3]]<<4|wn[h[4]],b:wn[h[5]]<<4|wn[h[6]],a:o===9?wn[h[7]]<<4|wn[h[8]]:255})),c}function Bi(h){var o=Rr(h)?yi:ir;return h&&"#"+o(h.r)+o(h.g)+o(h.b)+(h.a<255?o(h.a):"")}function ni(h){return h+.5|0}const li=(h,o,c)=>Math.max(Math.min(h,c),o);function at(h){return li(ni(h*2.55),0,255)}function Ge(h){return li(ni(h*255),0,255)}function ct(h){return li(ni(h/2.55)/100,0,1)}function Cn(h){return li(ni(h*100),0,100)}function jt(h){const o=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/.exec(h);let c=255,d,m,y;if(!!o){if(o[7]!==d){const _=+o[7];c=255&(o[8]?at(_):_*255)}return d=+o[1],m=+o[3],y=+o[5],d=255&(o[2]?at(d):d),m=255&(o[4]?at(m):m),y=255&(o[6]?at(y):y),{r:d,g:m,b:y,a:c}}}function pn(h){return h&&(h.a<255?`rgba(${h.r}, ${h.g}, ${h.b}, ${ct(h.a)})`:`rgb(${h.r}, ${h.g}, ${h.b})`)}function ki(h,o,c){const d=o*Math.min(c,1-c),m=(y,_=(y+h/30)%12)=>c-d*Math.max(Math.min(_-3,9-_,1),-1);return[m(0),m(8),m(4)]}function Ai(h,o,c){const d=(m,y=(m+h/60)%6)=>c-c*o*Math.max(Math.min(y,4-y,1),0);return[d(5),d(3),d(1)]}function jr(h,o,c){const d=ki(h,1,.5);let m;for(o+c>1&&(m=1/(o+c),o*=m,c*=m),m=0;m<3;m++)d[m]*=1-o-c,d[m]+=o;return d}function Si(h){const c=h.r/255,d=h.g/255,m=h.b/255,y=Math.max(c,d,m),_=Math.min(c,d,m),T=(y+_)/2;let D,U,Y;return y!==_&&(Y=y-_,U=T>.5?Y/(2-y-_):Y/(y+_),D=y===c?(d-m)/Y+(d<m?6:0):y===d?(m-c)/Y+2:(c-d)/Y+4,D=D*60+.5),[D|0,U||0,T]}function or(h,o,c,d){return(Array.isArray(o)?h(o[0],o[1],o[2]):h(o,c,d)).map(Ge)}function ns(h,o,c){return or(ki,h,o,c)}function rr(h,o,c){return or(jr,h,o,c)}function lr(h,o,c){return or(Ai,h,o,c)}function xt(h){return(h%360+360)%360}function sn(h){const o=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/.exec(h);let c=255,d;if(!o)return;o[5]!==d&&(c=o[6]?at(+o[5]):Ge(+o[5]));const m=xt(+o[2]),y=+o[3]/100,_=+o[4]/100;return o[1]==="hwb"?d=rr(m,y,_):o[1]==="hsv"?d=lr(m,y,_):d=ns(m,y,_),{r:d[0],g:d[1],b:d[2],a:c}}function _i(h,o){var c=Si(h);c[0]=xt(c[0]+o),c=ns(c),h.r=c[0],h.g=c[1],h.b=c[2]}function Hr(h){if(!h)return;const o=Si(h),c=o[0],d=Cn(o[1]),m=Cn(o[2]);return h.a<255?`hsla(${c}, ${d}%, ${m}%, ${ct(h.a)})`:`hsl(${c}, ${d}%, ${m}%)`}const Er={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},ci={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function cr(){const h={},o=Object.keys(ci),c=Object.keys(Er);let d,m,y,_,T;for(d=0;d<o.length;d++){for(_=T=o[d],m=0;m<c.length;m++)y=c[m],T=T.replace(y,Er[y]);y=parseInt(ci[_],16),h[T]=[y>>16&255,y>>8&255,y&255]}return h}let $r;function Lo(h){$r||($r=cr(),$r.transparent=[0,0,0,0]);const o=$r[h.toLowerCase()];return o&&{r:o[0],g:o[1],b:o[2],a:o.length===4?o[3]:255}}function Kr(h,o,c){if(h){let d=Si(h);d[o]=Math.max(0,Math.min(d[o]+d[o]*c,o===0?360:1)),d=ns(d),h.r=d[0],h.g=d[1],h.b=d[2]}}function Na(h,o){return h&&Object.assign(o||{},h)}function tn(h){var o={r:0,g:0,b:0,a:255};return Array.isArray(h)?h.length>=3&&(o={r:h[0],g:h[1],b:h[2],a:255},h.length>3&&(o.a=Ge(h[3]))):(o=Na(h,{r:0,g:0,b:0,a:1}),o.a=Ge(o.a)),o}function ti(h){return h.charAt(0)==="r"?jt(h):sn(h)}class $n{constructor(o){if(o instanceof $n)return o;const c=typeof o;let d;c==="object"?d=tn(o):c==="string"&&(d=Qi(o)||Lo(o)||ti(o)),this._rgb=d,this._valid=!!d}get valid(){return this._valid}get rgb(){var o=Na(this._rgb);return o&&(o.a=ct(o.a)),o}set rgb(o){this._rgb=tn(o)}rgbString(){return this._valid?pn(this._rgb):this._rgb}hexString(){return this._valid?Bi(this._rgb):this._rgb}hslString(){return this._valid?Hr(this._rgb):this._rgb}mix(o,c){const d=this;if(o){const m=d.rgb,y=o.rgb;let _;const T=c===_?.5:c,D=2*T-1,U=m.a-y.a,Y=((D*U===-1?D:(D+U)/(1+D*U))+1)/2;_=1-Y,m.r=255&Y*m.r+_*y.r+.5,m.g=255&Y*m.g+_*y.g+.5,m.b=255&Y*m.b+_*y.b+.5,m.a=T*m.a+(1-T)*y.a,d.rgb=m}return d}clone(){return new $n(this.rgb)}alpha(o){return this._rgb.a=Ge(o),this}clearer(o){const c=this._rgb;return c.a*=1-o,this}greyscale(){const o=this._rgb,c=ni(o.r*.3+o.g*.59+o.b*.11);return o.r=o.g=o.b=c,this}opaquer(o){const c=this._rgb;return c.a*=1+o,this}negate(){const o=this._rgb;return o.r=255-o.r,o.g=255-o.g,o.b=255-o.b,this}lighten(o){return Kr(this._rgb,2,o),this}darken(o){return Kr(this._rgb,2,-o),this}saturate(o){return Kr(this._rgb,1,o),this}desaturate(o){return Kr(this._rgb,1,-o),this}rotate(o){return _i(this._rgb,o),this}}function es(h){return new $n(h)}const os=h=>h instanceof CanvasGradient||h instanceof CanvasPattern;function Ls(h){return os(h)?h:es(h)}function Ga(h){return os(h)?h:es(h).saturate(.5).darken(.1).hexString()}function ha(){}const kv=function(){let h=0;return function(){return h++}}();function Dr(h){return h===null||typeof h>"u"}function Tr(h){if(Array.isArray&&Array.isArray(h))return!0;const o=Object.prototype.toString.call(h);return o.substr(0,7)==="[object"&&o.substr(-6)==="Array]"}function ur(h){return h!==null&&Object.prototype.toString.call(h)==="[object Object]"}const Ws=h=>(typeof h=="number"||h instanceof Number)&&isFinite(+h);function ho(h,o){return Ws(h)?h:o}function gr(h,o){return typeof h>"u"?o:h}const ah=(h,o)=>typeof h=="string"&&h.endsWith("%")?parseFloat(h)/100:h/o,Tm=(h,o)=>typeof h=="string"&&h.endsWith("%")?parseFloat(h)/100*o:+h;function Or(h,o,c){if(h&&typeof h.call=="function")return h.apply(c,o)}function vr(h,o,c,d){let m,y,_;if(Tr(h))if(y=h.length,d)for(m=y-1;m>=0;m--)o.call(c,h[m],m);else for(m=0;m<y;m++)o.call(c,h[m],m);else if(ur(h))for(_=Object.keys(h),y=_.length,m=0;m<y;m++)o.call(c,h[_[m]],_[m])}function vf(h,o){let c,d,m,y;if(!h||!o||h.length!==o.length)return!1;for(c=0,d=h.length;c<d;++c)if(m=h[c],y=o[c],m.datasetIndex!==y.datasetIndex||m.index!==y.index)return!1;return!0}function yf(h){if(Tr(h))return h.map(yf);if(ur(h)){const o=Object.create(null),c=Object.keys(h),d=c.length;let m=0;for(;m<d;++m)o[c[m]]=yf(h[c[m]]);return o}return h}function zv(h){return["__proto__","prototype","constructor"].indexOf(h)===-1}function hu(h,o,c,d){if(!zv(h))return;const m=o[h],y=c[h];ur(m)&&ur(y)?dl(m,y,d):o[h]=yf(y)}function dl(h,o,c){const d=Tr(o)?o:[o],m=d.length;if(!ur(h))return h;c=c||{};const y=c.merger||hu;for(let _=0;_<m;++_){if(o=d[_],!ur(o))continue;const T=Object.keys(o);for(let D=0,U=T.length;D<U;++D)y(T[D],h,o,c)}return h}function oh(h,o){return dl(h,o,{merger:Uv})}function Uv(h,o,c){if(!zv(h))return;const d=o[h],m=c[h];ur(d)&&ur(m)?oh(d,m):Object.prototype.hasOwnProperty.call(o,h)||(o[h]=yf(m))}function Hv(h,o){const c=h.indexOf(".",o);return c===-1?h.length:c}function Mc(h,o){if(o==="")return h;let c=0,d=Hv(o,c);for(;h&&d>c;)h=h[o.substr(c,d-c)],c=d+1,d=Hv(o,c);return h}function Id(h){return h.charAt(0).toUpperCase()+h.slice(1)}const fo=h=>typeof h<"u",pl=h=>typeof h=="function",Am=(h,o)=>{if(h.size!==o.size)return!1;for(const c of h)if(!o.has(c))return!1;return!0},Sc=Object.create(null),Nd=Object.create(null);function lh(h,o){if(!o)return h;const c=o.split(".");for(let d=0,m=c.length;d<m;++d){const y=c[d];h=h[y]||(h[y]=Object.create(null))}return h}function Fd(h,o,c){return typeof o=="string"?dl(lh(h,o),c):dl(lh(h,""),o)}var Ir=new class{constructor(h){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=o=>o.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(o,c)=>Ga(c.backgroundColor),this.hoverBorderColor=(o,c)=>Ga(c.borderColor),this.hoverColor=(o,c)=>Ga(c.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.describe(h)}set(h,o){return Fd(this,h,o)}get(h){return lh(this,h)}describe(h,o){return Fd(Nd,h,o)}override(h,o){return Fd(Sc,h,o)}route(h,o,c,d){const m=lh(this,h),y=lh(this,c),_="_"+o;Object.defineProperties(m,{[_]:{value:m[o],writable:!0},[o]:{enumerable:!0,get(){const T=this[_],D=y[d];return ur(T)?Object.assign({},D,T):gr(T,D)},set(T){this[_]=T}}})}}({_scriptable:h=>!h.startsWith("on"),_indexable:h=>h!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}});const Cs=Math.PI,us=2*Cs,Lm=us+Cs,ch=Number.POSITIVE_INFINITY,Gv=Cs/180,Xs=Cs/2,uh=Cs/4,Cm=Cs*2/3,po=Math.log10,Xo=Math.sign;function Pm(h){const o=Math.round(h);h=hh(h,o,h/1e3)?o:h;const c=Math.pow(10,Math.floor(po(h))),d=h/c;return(d<=1?1:d<=2?2:d<=5?5:10)*c}function Vv(h){const o=[],c=Math.sqrt(h);let d;for(d=1;d<c;d++)h%d===0&&(o.push(d),o.push(h/d));return c===(c|0)&&o.push(c),o.sort((m,y)=>m-y).pop(),o}function fu(h){return!isNaN(parseFloat(h))&&isFinite(h)}function hh(h,o,c){return Math.abs(h-o)<c}function Wv(h,o){const c=Math.round(h);return c-o<=h&&c+o>=h}function Rm(h,o,c){let d,m,y;for(d=0,m=h.length;d<m;d++)y=h[d][c],isNaN(y)||(o.min=Math.min(o.min,y),o.max=Math.max(o.max,y))}function Co(h){return h*(Cs/180)}function Bd(h){return h*(180/Cs)}function Dm(h){if(!Ws(h))return;let o=1,c=0;for(;Math.round(h*o)/o!==h;)o*=10,c++;return c}function Xv(h,o){const c=o.x-h.x,d=o.y-h.y,m=Math.sqrt(c*c+d*d);let y=Math.atan2(d,c);return y<-.5*Cs&&(y+=us),{angle:y,distance:m}}function kd(h,o){return Math.sqrt(Math.pow(o.x-h.x,2)+Math.pow(o.y-h.y,2))}function qv(h,o){return(h-o+Lm)%us-Cs}function Po(h){return(h%us+us)%us}function xf(h,o,c,d){const m=Po(h),y=Po(o),_=Po(c),T=Po(y-m),D=Po(_-m),U=Po(m-y),Y=Po(m-_);return m===y||m===_||d&&y===_||T>D&&U<Y}function fa(h,o,c){return Math.max(o,Math.min(c,h))}function jv(h){return fa(h,-32768,32767)}function Yv(h){return!h||Dr(h.size)||Dr(h.family)?null:(h.style?h.style+" ":"")+(h.weight?h.weight+" ":"")+h.size+"px "+h.family}function _f(h,o,c,d,m){let y=o[m];return y||(y=o[m]=h.measureText(m).width,c.push(m)),y>d&&(d=y),d}function Zv(h,o,c,d){d=d||{};let m=d.data=d.data||{},y=d.garbageCollect=d.garbageCollect||[];d.font!==o&&(m=d.data={},y=d.garbageCollect=[],d.font=o),h.save(),h.font=o;let _=0;const T=c.length;let D,U,Y,Q,fe;for(D=0;D<T;D++)if(Q=c[D],Q!=null&&Tr(Q)!==!0)_=_f(h,m,y,_,Q);else if(Tr(Q))for(U=0,Y=Q.length;U<Y;U++)fe=Q[U],fe!=null&&!Tr(fe)&&(_=_f(h,m,y,_,fe));h.restore();const Te=y.length/2;if(Te>c.length){for(D=0;D<Te;D++)delete m[y[D]];y.splice(0,Te)}return _}function Ec(h,o,c){const d=h.currentDevicePixelRatio,m=c!==0?Math.max(c/2,.5):0;return Math.round((o-m)*d)/d+m}function Om(h,o){o=o||h.getContext("2d"),o.save(),o.resetTransform(),o.clearRect(0,0,h.width,h.height),o.restore()}function bf(h,o,c,d){let m,y,_,T,D;const U=o.pointStyle,Y=o.rotation,Q=o.radius;let fe=(Y||0)*Gv;if(U&&typeof U=="object"&&(m=U.toString(),m==="[object HTMLImageElement]"||m==="[object HTMLCanvasElement]")){h.save(),h.translate(c,d),h.rotate(fe),h.drawImage(U,-U.width/2,-U.height/2,U.width,U.height),h.restore();return}if(!(isNaN(Q)||Q<=0)){switch(h.beginPath(),U){default:h.arc(c,d,Q,0,us),h.closePath();break;case"triangle":h.moveTo(c+Math.sin(fe)*Q,d-Math.cos(fe)*Q),fe+=Cm,h.lineTo(c+Math.sin(fe)*Q,d-Math.cos(fe)*Q),fe+=Cm,h.lineTo(c+Math.sin(fe)*Q,d-Math.cos(fe)*Q),h.closePath();break;case"rectRounded":D=Q*.516,T=Q-D,y=Math.cos(fe+uh)*T,_=Math.sin(fe+uh)*T,h.arc(c-y,d-_,D,fe-Cs,fe-Xs),h.arc(c+_,d-y,D,fe-Xs,fe),h.arc(c+y,d+_,D,fe,fe+Xs),h.arc(c-_,d+y,D,fe+Xs,fe+Cs),h.closePath();break;case"rect":if(!Y){T=Math.SQRT1_2*Q,h.rect(c-T,d-T,2*T,2*T);break}fe+=uh;case"rectRot":y=Math.cos(fe)*Q,_=Math.sin(fe)*Q,h.moveTo(c-y,d-_),h.lineTo(c+_,d-y),h.lineTo(c+y,d+_),h.lineTo(c-_,d+y),h.closePath();break;case"crossRot":fe+=uh;case"cross":y=Math.cos(fe)*Q,_=Math.sin(fe)*Q,h.moveTo(c-y,d-_),h.lineTo(c+y,d+_),h.moveTo(c+_,d-y),h.lineTo(c-_,d+y);break;case"star":y=Math.cos(fe)*Q,_=Math.sin(fe)*Q,h.moveTo(c-y,d-_),h.lineTo(c+y,d+_),h.moveTo(c+_,d-y),h.lineTo(c-_,d+y),fe+=uh,y=Math.cos(fe)*Q,_=Math.sin(fe)*Q,h.moveTo(c-y,d-_),h.lineTo(c+y,d+_),h.moveTo(c+_,d-y),h.lineTo(c-_,d+y);break;case"line":y=Math.cos(fe)*Q,_=Math.sin(fe)*Q,h.moveTo(c-y,d-_),h.lineTo(c+y,d+_);break;case"dash":h.moveTo(c,d),h.lineTo(c+Math.cos(fe)*Q,d+Math.sin(fe)*Q);break}h.fill(),o.borderWidth>0&&h.stroke()}}function Tc(h,o,c){return c=c||.5,!o||h&&h.x>o.left-c&&h.x<o.right+c&&h.y>o.top-c&&h.y<o.bottom+c}function wf(h,o){h.save(),h.beginPath(),h.rect(o.left,o.top,o.right-o.left,o.bottom-o.top),h.clip()}function Mf(h){h.restore()}function Jv(h,o,c,d,m){if(!o)return h.lineTo(c.x,c.y);if(m==="middle"){const y=(o.x+c.x)/2;h.lineTo(y,o.y),h.lineTo(y,c.y)}else m==="after"!=!!d?h.lineTo(o.x,c.y):h.lineTo(c.x,o.y);h.lineTo(c.x,c.y)}function fh(h,o,c,d){if(!o)return h.lineTo(c.x,c.y);h.bezierCurveTo(d?o.cp1x:o.cp2x,d?o.cp1y:o.cp2y,d?c.cp2x:c.cp1x,d?c.cp2y:c.cp1y,c.x,c.y)}function mo(h,o,c,d,m,y={}){const _=Tr(o)?o:[o],T=y.strokeWidth>0&&y.strokeColor!=="";let D,U;for(h.save(),h.font=m.string,Im(h,y),D=0;D<_.length;++D)U=_[D],T&&(y.strokeColor&&(h.strokeStyle=y.strokeColor),Dr(y.strokeWidth)||(h.lineWidth=y.strokeWidth),h.strokeText(U,c,d,y.maxWidth)),h.fillText(U,c,d,y.maxWidth),dh(h,c,d,U,y),d+=m.lineHeight;h.restore()}function Im(h,o){o.translation&&h.translate(o.translation[0],o.translation[1]),Dr(o.rotation)||h.rotate(o.rotation),o.color&&(h.fillStyle=o.color),o.textAlign&&(h.textAlign=o.textAlign),o.textBaseline&&(h.textBaseline=o.textBaseline)}function dh(h,o,c,d,m){if(m.strikethrough||m.underline){const y=h.measureText(d),_=o-y.actualBoundingBoxLeft,T=o+y.actualBoundingBoxRight,D=c-y.actualBoundingBoxAscent,U=c+y.actualBoundingBoxDescent,Y=m.strikethrough?(D+U)/2:U;h.strokeStyle=h.fillStyle,h.beginPath(),h.lineWidth=m.decorationWidth||2,h.moveTo(_,Y),h.lineTo(T,Y),h.stroke()}}function ml(h,o){const{x:c,y:d,w:m,h:y,radius:_}=o;h.arc(c+_.topLeft,d+_.topLeft,_.topLeft,-Xs,Cs,!0),h.lineTo(c,d+y-_.bottomLeft),h.arc(c+_.bottomLeft,d+y-_.bottomLeft,_.bottomLeft,Cs,Xs,!0),h.lineTo(c+m-_.bottomRight,d+y),h.arc(c+m-_.bottomRight,d+y-_.bottomRight,_.bottomRight,Xs,0,!0),h.lineTo(c+m,d+_.topRight),h.arc(c+m-_.topRight,d+_.topRight,_.topRight,0,-Xs,!0),h.lineTo(c+_.topLeft,d)}function du(h,o,c){c=c||(_=>h[_]<o);let d=h.length-1,m=0,y;for(;d-m>1;)y=m+d>>1,c(y)?m=y:d=y;return{lo:m,hi:d}}const Ro=(h,o,c)=>du(h,c,d=>h[d][o]<c),Nm=(h,o,c)=>du(h,c,d=>h[d][o]>=c);function $v(h,o,c){let d=0,m=h.length;for(;d<m&&h[d]<o;)d++;for(;m>d&&h[m-1]>c;)m--;return d>0||m<h.length?h.slice(d,m):h}const Kv=["push","pop","shift","splice","unshift"];function Fm(h,o){if(h._chartjs){h._chartjs.listeners.push(o);return}Object.defineProperty(h,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[o]}}),Kv.forEach(c=>{const d="_onData"+Id(c),m=h[c];Object.defineProperty(h,c,{configurable:!0,enumerable:!1,value(...y){const _=m.apply(this,y);return h._chartjs.listeners.forEach(T=>{typeof T[d]=="function"&&T[d](...y)}),_}})})}function Bl(h,o){const c=h._chartjs;if(!c)return;const d=c.listeners,m=d.indexOf(o);m!==-1&&d.splice(m,1),!(d.length>0)&&(Kv.forEach(y=>{delete h[y]}),delete h._chartjs)}function ph(h){const o=new Set;let c,d;for(c=0,d=h.length;c<d;++c)o.add(h[c]);return o.size===d?h:Array.from(o)}function Bm(){return typeof window<"u"&&typeof document<"u"}function Sf(h){let o=h.parentNode;return o&&o.toString()==="[object ShadowRoot]"&&(o=o.host),o}function zd(h,o,c){let d;return typeof h=="string"?(d=parseInt(h,10),h.indexOf("%")!==-1&&(d=d/100*o.parentNode[c])):d=h,d}const Ud=h=>window.getComputedStyle(h,null);function Qv(h,o){return Ud(h).getPropertyValue(o)}const a_=["top","right","bottom","left"];function pu(h,o,c){const d={};c=c?"-"+c:"";for(let m=0;m<4;m++){const y=a_[m];d[y]=parseFloat(h[o+"-"+y+c])||0}return d.width=d.left+d.right,d.height=d.top+d.bottom,d}const o_=(h,o,c)=>(h>0||o>0)&&(!c||!c.shadowRoot);function mu(h,o){const c=h.native||h,d=c.touches,m=d&&d.length?d[0]:c,{offsetX:y,offsetY:_}=m;let T=!1,D,U;if(o_(y,_,c.target))D=y,U=_;else{const Y=o.getBoundingClientRect();D=m.clientX-Y.left,U=m.clientY-Y.top,T=!0}return{x:D,y:U,box:T}}function km(h,o){const{canvas:c,currentDevicePixelRatio:d}=o,m=Ud(c),y=m.boxSizing==="border-box",_=pu(m,"padding"),T=pu(m,"border","width"),{x:D,y:U,box:Y}=mu(h,c),Q=_.left+(Y&&T.left),fe=_.top+(Y&&T.top);let{width:Te,height:Ue}=o;return y&&(Te-=_.width+T.width,Ue-=_.height+T.height),{x:Math.round((D-Q)/Te*c.width/d),y:Math.round((U-fe)/Ue*c.height/d)}}function zm(h,o,c){let d,m;if(o===void 0||c===void 0){const y=Sf(h);if(!y)o=h.clientWidth,c=h.clientHeight;else{const _=y.getBoundingClientRect(),T=Ud(y),D=pu(T,"border","width"),U=pu(T,"padding");o=_.width-U.width-D.width,c=_.height-U.height-D.height,d=zd(T.maxWidth,y,"clientWidth"),m=zd(T.maxHeight,y,"clientHeight")}}return{width:o,height:c,maxWidth:d||ch,maxHeight:m||ch}}const Um=h=>Math.round(h*10)/10;function Ef(h,o,c,d){const m=Ud(h),y=pu(m,"margin"),_=zd(m.maxWidth,h,"clientWidth")||ch,T=zd(m.maxHeight,h,"clientHeight")||ch,D=zm(h,o,c);let{width:U,height:Y}=D;if(m.boxSizing==="content-box"){const Q=pu(m,"border","width"),fe=pu(m,"padding");U-=fe.width+Q.width,Y-=fe.height+Q.height}return U=Math.max(0,U-y.width),Y=Math.max(0,d?Math.floor(U/d):Y-y.height),U=Um(Math.min(U,_,D.maxWidth)),Y=Um(Math.min(Y,T,D.maxHeight)),U&&!Y&&(Y=Um(U/2)),{width:U,height:Y}}function gu(h,o,c){const d=o||1,m=Math.floor(h.height*d),y=Math.floor(h.width*d);h.height=m/d,h.width=y/d;const _=h.canvas;return _.style&&(c||!_.style.height&&!_.style.width)&&(_.style.height=`${h.height}px`,_.style.width=`${h.width}px`),h.currentDevicePixelRatio!==d||_.height!==m||_.width!==y?(h.currentDevicePixelRatio=d,_.height=m,_.width=y,h.ctx.setTransform(d,0,0,d,0,0),!0):!1}const Hm=function(){let h=!1;try{const o={get passive(){return h=!0,!1}};window.addEventListener("test",null,o),window.removeEventListener("test",null,o)}catch{}return h}();function go(h,o){const c=Qv(h,o),d=c&&c.match(/^(\d+)(\.\d+)?px$/);return d?+d[1]:void 0}function Qs(h,o){return"native"in h?{x:h.x,y:h.y}:km(h,o)}function Hd(h,o){const c=h.getSortedVisibleDatasetMetas();let d,m,y;for(let _=0,T=c.length;_<T;++_){({index:d,data:m}=c[_]);for(let D=0,U=m.length;D<U;++D)y=m[D],y.skip||o(y,d,D)}}function fr(h,o,c,d){const{controller:m,data:y,_sorted:_}=h,T=m._cachedMeta.iScale;if(T&&o===T.axis&&_&&y.length){const D=T._reversePixels?Nm:Ro;if(d){if(m._sharedOptions){const U=y[0],Y=typeof U.getRange=="function"&&U.getRange(o);if(Y){const Q=D(y,o,c-Y),fe=D(y,o,c+Y);return{lo:Q.lo,hi:fe.hi}}}}else return D(y,o,c)}return{lo:0,hi:y.length-1}}function vn(h,o,c,d,m){const y=h.getSortedVisibleDatasetMetas(),_=c[o];for(let T=0,D=y.length;T<D;++T){const{index:U,data:Y}=y[T],{lo:Q,hi:fe}=fr(y[T],o,_,m);for(let Te=Q;Te<=fe;++Te){const Ue=Y[Te];Ue.skip||d(Ue,U,Te)}}}function Ja(h){const o=h.indexOf("x")!==-1,c=h.indexOf("y")!==-1;return function(d,m){const y=o?Math.abs(d.x-m.x):0,_=c?Math.abs(d.y-m.y):0;return Math.sqrt(Math.pow(y,2)+Math.pow(_,2))}}function Ac(h,o,c,d){const m=[];return Tc(o,h.chartArea,h._minPadding)&&vn(h,c,o,function(y,_,T){y.inRange(o.x,o.y,d)&&m.push({element:y,datasetIndex:_,index:T})},!0),m}function kl(h,o,c,d,m){const y=Ja(c);let _=Number.POSITIVE_INFINITY,T=[];return Tc(o,h.chartArea,h._minPadding)&&vn(h,c,o,function(U,Y,Q){if(d&&!U.inRange(o.x,o.y,m))return;const fe=U.getCenterPoint(m);if(!Tc(fe,h.chartArea,h._minPadding)&&!U.inRange(o.x,o.y,m))return;const Te=y(o,fe);Te<_?(T=[{element:U,datasetIndex:Y,index:Q}],_=Te):Te===_&&T.push({element:U,datasetIndex:Y,index:Q})}),T}function ey(h,o,c,d){const m=Qs(o,h),y=[],_=c.axis,T=_==="x"?"inXRange":"inYRange";let D=!1;return Hd(h,(U,Y,Q)=>{U[T](m[_],d)&&y.push({element:U,datasetIndex:Y,index:Q}),U.inRange(m.x,m.y,d)&&(D=!0)}),c.intersect&&!D?[]:y}var gs={modes:{index(h,o,c,d){const m=Qs(o,h),y=c.axis||"x",_=c.intersect?Ac(h,m,y,d):kl(h,m,y,!1,d),T=[];return _.length?(h.getSortedVisibleDatasetMetas().forEach(D=>{const U=_[0].index,Y=D.data[U];Y&&!Y.skip&&T.push({element:Y,datasetIndex:D.index,index:U})}),T):[]},dataset(h,o,c,d){const m=Qs(o,h),y=c.axis||"xy";let _=c.intersect?Ac(h,m,y,d):kl(h,m,y,!1,d);if(_.length>0){const T=_[0].datasetIndex,D=h.getDatasetMeta(T).data;_=[];for(let U=0;U<D.length;++U)_.push({element:D[U],datasetIndex:T,index:U})}return _},point(h,o,c,d){const m=Qs(o,h),y=c.axis||"xy";return Ac(h,m,y,d)},nearest(h,o,c,d){const m=Qs(o,h),y=c.axis||"xy";return kl(h,m,y,c.intersect,d)},x(h,o,c,d){return c.axis="x",ey(h,o,c,d)},y(h,o,c,d){return c.axis="y",ey(h,o,c,d)}}};const vs=new RegExp(/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/),qo=new RegExp(/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/);function Gm(h,o){const c=(""+h).match(vs);if(!c||c[1]==="normal")return o*1.2;switch(h=+c[2],c[3]){case"px":return h;case"%":h/=100;break}return o*h}const Va=h=>+h||0;function De(h,o){const c={},d=ur(o),m=d?Object.keys(o):o,y=ur(h)?d?_=>gr(h[_],h[o[_]]):_=>h[_]:()=>h;for(const _ of m)c[_]=Va(y(_));return c}function Tf(h){return De(h,{top:"y",right:"x",bottom:"y",left:"x"})}function Lc(h){return De(h,["topLeft","topRight","bottomLeft","bottomRight"])}function Ps(h){const o=Tf(h);return o.width=o.left+o.right,o.height=o.top+o.bottom,o}function qs(h,o){h=h||{},o=o||Ir.font;let c=gr(h.size,o.size);typeof c=="string"&&(c=parseInt(c,10));let d=gr(h.style,o.style);d&&!(""+d).match(qo)&&(console.warn('Invalid font style specified: "'+d+'"'),d="");const m={family:gr(h.family,o.family),lineHeight:Gm(gr(h.lineHeight,o.lineHeight),c),size:c,style:d,weight:gr(h.weight,o.weight),string:""};return m.string=Yv(m),m}function $a(h,o,c,d){let m=!0,y,_,T;for(y=0,_=h.length;y<_;++y)if(T=h[y],T!==void 0&&(o!==void 0&&typeof T=="function"&&(T=T(o),m=!1),c!==void 0&&Tr(T)&&(T=T[c%T.length],m=!1),T!==void 0))return d&&!m&&(d.cacheable=!1),T}function mh(h,o,c){const{min:d,max:m}=h,y=Tm(o,(m-d)/2),_=(T,D)=>c&&T===0?0:T+D;return{min:_(d,-Math.abs(y)),max:_(m,y)}}function jo(h,o){return Object.assign(Object.create(h),o)}const vu=["left","top","right","bottom"];function gl(h,o){return h.filter(c=>c.pos===o)}function yu(h,o){return h.filter(c=>vu.indexOf(c.pos)===-1&&c.box.axis===o)}function Do(h,o){return h.sort((c,d)=>{const m=o?d:c,y=o?c:d;return m.weight===y.weight?m.index-y.index:m.weight-y.weight})}function Cc(h){const o=[];let c,d,m,y,_,T;for(c=0,d=(h||[]).length;c<d;++c)m=h[c],{position:y,options:{stack:_,stackWeight:T=1}}=m,o.push({index:c,box:m,pos:y,horizontal:m.isHorizontal(),weight:m.weight,stack:_&&y+_,stackWeight:T});return o}function xu(h){const o={};for(const c of h){const{stack:d,pos:m,stackWeight:y}=c;if(!d||!vu.includes(m))continue;const _=o[d]||(o[d]={count:0,placed:0,weight:0,size:0});_.count++,_.weight+=y}return o}function Af(h,o){const c=xu(h),{vBoxMaxWidth:d,hBoxMaxHeight:m}=o;let y,_,T;for(y=0,_=h.length;y<_;++y){T=h[y];const{fullSize:D}=T.box,U=c[T.stack],Y=U&&T.stackWeight/U.weight;T.horizontal?(T.width=Y?Y*d:D&&o.availableWidth,T.height=m):(T.width=d,T.height=Y?Y*m:D&&o.availableHeight)}return c}function Gd(h){const o=Cc(h),c=Do(o.filter(U=>U.box.fullSize),!0),d=Do(gl(o,"left"),!0),m=Do(gl(o,"right")),y=Do(gl(o,"top"),!0),_=Do(gl(o,"bottom")),T=yu(o,"x"),D=yu(o,"y");return{fullSize:c,leftAndTop:d.concat(y),rightAndBottom:m.concat(D).concat(_).concat(T),chartArea:gl(o,"chartArea"),vertical:d.concat(m).concat(D),horizontal:y.concat(_).concat(T)}}function Lf(h,o,c,d){return Math.max(h[c],o[c])+Math.max(h[d],o[d])}function Pc(h,o){h.top=Math.max(h.top,o.top),h.left=Math.max(h.left,o.left),h.bottom=Math.max(h.bottom,o.bottom),h.right=Math.max(h.right,o.right)}function l_(h,o,c,d){const{pos:m,box:y}=c,_=h.maxPadding;if(!ur(m)){c.size&&(h[m]-=c.size);const Q=d[c.stack]||{size:0,count:1};Q.size=Math.max(Q.size,c.horizontal?y.height:y.width),c.size=Q.size/Q.count,h[m]+=c.size}y.getPadding&&Pc(_,y.getPadding());const T=Math.max(0,o.outerWidth-Lf(_,h,"left","right")),D=Math.max(0,o.outerHeight-Lf(_,h,"top","bottom")),U=T!==h.w,Y=D!==h.h;return h.w=T,h.h=D,c.horizontal?{same:U,other:Y}:{same:Y,other:U}}function zl(h){const o=h.maxPadding;function c(d){const m=Math.max(o[d]-h[d],0);return h[d]+=m,m}h.y+=c("top"),h.x+=c("left"),c("right"),c("bottom")}function Ul(h,o){const c=o.maxPadding;function d(m){const y={left:0,top:0,right:0,bottom:0};return m.forEach(_=>{y[_]=Math.max(o[_],c[_])}),y}return d(h?["left","right"]:["top","bottom"])}function _u(h,o,c,d){const m=[];let y,_,T,D,U,Y;for(y=0,_=h.length,U=0;y<_;++y){T=h[y],D=T.box,D.update(T.width||o.w,T.height||o.h,Ul(T.horizontal,o));const{same:Q,other:fe}=l_(o,c,T,d);U|=Q&&m.length,Y=Y||fe,D.fullSize||m.push(T)}return U&&_u(m,o,c,d)||Y}function bu(h,o,c,d,m){h.top=c,h.left=o,h.right=o+d,h.bottom=c+m,h.width=d,h.height=m}function Hl(h,o,c,d){const m=c.padding;let{x:y,y:_}=o;for(const T of h){const D=T.box,U=d[T.stack]||{count:1,placed:0,weight:1},Y=T.stackWeight/U.weight||1;if(T.horizontal){const Q=o.w*Y,fe=U.size||D.height;fo(U.start)&&(_=U.start),D.fullSize?bu(D,m.left,_,c.outerWidth-m.right-m.left,fe):bu(D,o.left+U.placed,_,Q,fe),U.start=_,U.placed+=Q,_=D.bottom}else{const Q=o.h*Y,fe=U.size||D.width;fo(U.start)&&(y=U.start),D.fullSize?bu(D,y,m.top,fe,c.outerHeight-m.bottom-m.top):bu(D,y,o.top+U.placed,fe,Q),U.start=y,U.placed+=Q,y=D.right}}o.x=y,o.y=_}Ir.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}});var da={addBox(h,o){h.boxes||(h.boxes=[]),o.fullSize=o.fullSize||!1,o.position=o.position||"top",o.weight=o.weight||0,o._layers=o._layers||function(){return[{z:0,draw(c){o.draw(c)}}]},h.boxes.push(o)},removeBox(h,o){const c=h.boxes?h.boxes.indexOf(o):-1;c!==-1&&h.boxes.splice(c,1)},configure(h,o,c){o.fullSize=c.fullSize,o.position=c.position,o.weight=c.weight},update(h,o,c,d){if(!h)return;const m=Ps(h.options.layout.padding),y=Math.max(o-m.width,0),_=Math.max(c-m.height,0),T=Gd(h.boxes),D=T.vertical,U=T.horizontal;vr(h.boxes,it=>{typeof it.beforeLayout=="function"&&it.beforeLayout()});const Y=D.reduce((it,vt)=>vt.box.options&&vt.box.options.display===!1?it:it+1,0)||1,Q=Object.freeze({outerWidth:o,outerHeight:c,padding:m,availableWidth:y,availableHeight:_,vBoxMaxWidth:y/2/Y,hBoxMaxHeight:_/2}),fe=Object.assign({},m);Pc(fe,Ps(d));const Te=Object.assign({maxPadding:fe,w:y,h:_,x:m.left,y:m.top},m),Ue=Af(D.concat(U),Q);_u(T.fullSize,Te,Q,Ue),_u(D,Te,Q,Ue),_u(U,Te,Q,Ue)&&_u(D,Te,Q,Ue),zl(Te),Hl(T.leftAndTop,Te,Q,Ue),Te.x+=Te.w,Te.y+=Te.h,Hl(T.rightAndBottom,Te,Q,Ue),h.chartArea={left:Te.left,top:Te.top,right:Te.left+Te.w,bottom:Te.top+Te.h,height:Te.h,width:Te.w},vr(T.chartArea,it=>{const vt=it.box;Object.assign(vt,h.chartArea),vt.update(Te.w,Te.h)})}};function wu(h,o=[""],c=h,d,m=()=>h[0]){fo(d)||(d=Wm("_fallback",h));const y={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:h,_rootScopes:c,_fallback:d,_getTarget:m,override:_=>wu([_,...h],o,c,d)};return new Proxy(y,{deleteProperty(_,T){return delete _[T],delete _._keys,delete h[0][T],!0},get(_,T){return Oo(_,T,()=>h_(T,o,h,_))},getOwnPropertyDescriptor(_,T){return Reflect.getOwnPropertyDescriptor(_._scopes[0],T)},getPrototypeOf(){return Reflect.getPrototypeOf(h[0])},has(_,T){return Eu(_).includes(T)},ownKeys(_){return Eu(_)},set(_,T,D){const U=_._storage||(_._storage=m());return U[T]=D,delete _[T],delete _._keys,!0}})}function Gl(h,o,c,d){const m={_cacheable:!1,_proxy:h,_context:o,_subProxy:c,_stack:new Set,_descriptors:Mu(h,d),setContext:y=>Gl(h,y,c,d),override:y=>Gl(h.override(y),o,c,d)};return new Proxy(m,{deleteProperty(y,_){return delete y[_],delete h[_],!0},get(y,_,T){return Oo(y,_,()=>c_(y,_,T))},getOwnPropertyDescriptor(y,_){return y._descriptors.allKeys?Reflect.has(h,_)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(h,_)},getPrototypeOf(){return Reflect.getPrototypeOf(h)},has(y,_){return Reflect.has(h,_)},ownKeys(){return Reflect.ownKeys(h)},set(y,_,T){return h[_]=T,delete y[_],!0}})}function Mu(h,o={scriptable:!0,indexable:!0}){const{_scriptable:c=o.scriptable,_indexable:d=o.indexable,_allKeys:m=o.allKeys}=h;return{allKeys:m,scriptable:c,indexable:d,isScriptable:pl(c)?c:()=>c,isIndexable:pl(d)?d:()=>d}}const yr=(h,o)=>h?h+Id(o):o,Su=(h,o)=>ur(o)&&h!=="adapters";function Oo(h,o,c){if(Object.prototype.hasOwnProperty.call(h,o))return h[o];const d=c();return h[o]=d,d}function c_(h,o,c){const{_proxy:d,_context:m,_subProxy:y,_descriptors:_}=h;let T=d[o];return pl(T)&&_.isScriptable(o)&&(T=u_(o,T,h,c)),Tr(T)&&T.length&&(T=Rc(o,T,h,_.isIndexable)),Su(o,T)&&(T=Gl(T,m,y&&y[o],_)),T}function u_(h,o,c,d){const{_proxy:m,_context:y,_subProxy:_,_stack:T}=c;if(T.has(h))throw new Error("Recursion detected: "+Array.from(T).join("->")+"->"+h);return T.add(h),o=o(y,_||d),T.delete(h),ur(o)&&(o=Vd(m._scopes,m,h,o)),o}function Rc(h,o,c,d){const{_proxy:m,_context:y,_subProxy:_,_descriptors:T}=c;if(fo(y.index)&&d(h))o=o[y.index%o.length];else if(ur(o[0])){const D=o,U=m._scopes.filter(Y=>Y!==D);o=[];for(const Y of D){const Q=Vd(U,m,h,Y);o.push(Gl(Q,y,_&&_[h],T))}}return o}function Cf(h,o,c){return pl(h)?h(o,c):h}const vo=(h,o)=>h===!0?o:typeof h=="string"?Mc(o,h):void 0;function Pf(h,o,c,d){for(const m of o){const y=vo(c,m);if(y){h.add(y);const _=Cf(y._fallback,c,y);if(fo(_)&&_!==c&&_!==d)return _}else if(y===!1&&fo(d)&&c!==d)return null}return!1}function Vd(h,o,c,d){const m=o._rootScopes,y=Cf(o._fallback,c,d),_=[...h,...m],T=new Set;T.add(d);let D=Vm(T,_,c,y||c);return D===null||fo(y)&&y!==c&&(D=Vm(T,_,y,D),D===null)?!1:wu(Array.from(T),[""],m,y,()=>ty(o,c,d))}function Vm(h,o,c,d){for(;c;)c=Pf(h,o,c,d);return c}function ty(h,o,c){const d=h._getTarget();o in d||(d[o]={});const m=d[o];return Tr(m)&&ur(c)?c:m}function h_(h,o,c,d){let m;for(const y of o)if(m=Wm(yr(y,h),c),fo(m))return Su(h,m)?Vd(c,d,h,m):m}function Wm(h,o){for(const c of o){if(!c)continue;const d=c[h];if(fo(d))return d}}function Eu(h){let o=h._keys;return o||(o=h._keys=Vl(h._scopes)),o}function Vl(h){const o=new Set;for(const c of h)for(const d of Object.keys(c).filter(m=>!m.startsWith("_")))o.add(d);return Array.from(o)}const Wd=Number.EPSILON||1e-14,vl=(h,o)=>o<h.length&&!h[o].skip&&h[o],ny=h=>h==="x"?"y":"x";function iy(h,o,c,d){const m=h.skip?o:h,y=o,_=c.skip?o:c,T=kd(y,m),D=kd(_,y);let U=T/(T+D),Y=D/(T+D);U=isNaN(U)?0:U,Y=isNaN(Y)?0:Y;const Q=d*U,fe=d*Y;return{previous:{x:y.x-Q*(_.x-m.x),y:y.y-Q*(_.y-m.y)},next:{x:y.x+fe*(_.x-m.x),y:y.y+fe*(_.y-m.y)}}}function ry(h,o,c){const d=h.length;let m,y,_,T,D,U=vl(h,0);for(let Y=0;Y<d-1;++Y)if(D=U,U=vl(h,Y+1),!(!D||!U)){if(hh(o[Y],0,Wd)){c[Y]=c[Y+1]=0;continue}m=c[Y]/o[Y],y=c[Y+1]/o[Y],T=Math.pow(m,2)+Math.pow(y,2),!(T<=9)&&(_=3/Math.sqrt(T),c[Y]=m*_*o[Y],c[Y+1]=y*_*o[Y])}}function sy(h,o,c="x"){const d=ny(c),m=h.length;let y,_,T,D=vl(h,0);for(let U=0;U<m;++U){if(_=T,T=D,D=vl(h,U+1),!T)continue;const Y=T[c],Q=T[d];_&&(y=(Y-_[c])/3,T[`cp1${c}`]=Y-y,T[`cp1${d}`]=Q-y*o[U]),D&&(y=(D[c]-Y)/3,T[`cp2${c}`]=Y+y,T[`cp2${d}`]=Q+y*o[U])}}function Xm(h,o="x"){const c=ny(o),d=h.length,m=Array(d).fill(0),y=Array(d);let _,T,D,U=vl(h,0);for(_=0;_<d;++_)if(T=D,D=U,U=vl(h,_+1),!!D){if(U){const Y=U[o]-D[o];m[_]=Y!==0?(U[c]-D[c])/Y:0}y[_]=T?U?Xo(m[_-1])!==Xo(m[_])?0:(m[_-1]+m[_])/2:m[_-1]:m[_]}ry(h,m,y),sy(h,y,o)}function Xd(h,o,c){return Math.max(Math.min(h,c),o)}function f_(h,o){let c,d,m,y,_,T=Tc(h[0],o);for(c=0,d=h.length;c<d;++c)_=y,y=T,T=c<d-1&&Tc(h[c+1],o),y&&(m=h[c],_&&(m.cp1x=Xd(m.cp1x,o.left,o.right),m.cp1y=Xd(m.cp1y,o.top,o.bottom)),T&&(m.cp2x=Xd(m.cp2x,o.left,o.right),m.cp2y=Xd(m.cp2y,o.top,o.bottom)))}function Ni(h,o,c,d,m){let y,_,T,D;if(o.spanGaps&&(h=h.filter(U=>!U.skip)),o.cubicInterpolationMode==="monotone")Xm(h,m);else{let U=d?h[h.length-1]:h[0];for(y=0,_=h.length;y<_;++y)T=h[y],D=iy(U,T,h[Math.min(y+1,_-(d?0:1))%_],o.tension),T.cp1x=D.previous.x,T.cp1y=D.previous.y,T.cp2x=D.next.x,T.cp2y=D.next.y,U=T}o.capBezierPoints&&f_(h,c)}const gh=h=>h===0||h===1,ay=(h,o,c)=>-(Math.pow(2,10*(h-=1))*Math.sin((h-o)*us/c)),oy=(h,o,c)=>Math.pow(2,-10*h)*Math.sin((h-o)*us/c)+1,Ka={linear:h=>h,easeInQuad:h=>h*h,easeOutQuad:h=>-h*(h-2),easeInOutQuad:h=>(h/=.5)<1?.5*h*h:-.5*(--h*(h-2)-1),easeInCubic:h=>h*h*h,easeOutCubic:h=>(h-=1)*h*h+1,easeInOutCubic:h=>(h/=.5)<1?.5*h*h*h:.5*((h-=2)*h*h+2),easeInQuart:h=>h*h*h*h,easeOutQuart:h=>-((h-=1)*h*h*h-1),easeInOutQuart:h=>(h/=.5)<1?.5*h*h*h*h:-.5*((h-=2)*h*h*h-2),easeInQuint:h=>h*h*h*h*h,easeOutQuint:h=>(h-=1)*h*h*h*h+1,easeInOutQuint:h=>(h/=.5)<1?.5*h*h*h*h*h:.5*((h-=2)*h*h*h*h+2),easeInSine:h=>-Math.cos(h*Xs)+1,easeOutSine:h=>Math.sin(h*Xs),easeInOutSine:h=>-.5*(Math.cos(Cs*h)-1),easeInExpo:h=>h===0?0:Math.pow(2,10*(h-1)),easeOutExpo:h=>h===1?1:-Math.pow(2,-10*h)+1,easeInOutExpo:h=>gh(h)?h:h<.5?.5*Math.pow(2,10*(h*2-1)):.5*(-Math.pow(2,-10*(h*2-1))+2),easeInCirc:h=>h>=1?h:-(Math.sqrt(1-h*h)-1),easeOutCirc:h=>Math.sqrt(1-(h-=1)*h),easeInOutCirc:h=>(h/=.5)<1?-.5*(Math.sqrt(1-h*h)-1):.5*(Math.sqrt(1-(h-=2)*h)+1),easeInElastic:h=>gh(h)?h:ay(h,.075,.3),easeOutElastic:h=>gh(h)?h:oy(h,.075,.3),easeInOutElastic(h){return gh(h)?h:h<.5?.5*ay(h*2,.1125,.45):.5+.5*oy(h*2-1,.1125,.45)},easeInBack(h){return h*h*((1.70158+1)*h-1.70158)},easeOutBack(h){return(h-=1)*h*((1.70158+1)*h+1.70158)+1},easeInOutBack(h){let o=1.70158;return(h/=.5)<1?.5*(h*h*(((o*=1.525)+1)*h-o)):.5*((h-=2)*h*(((o*=1.525)+1)*h+o)+2)},easeInBounce:h=>1-Ka.easeOutBounce(1-h),easeOutBounce(h){return h<1/2.75?7.5625*h*h:h<2/2.75?7.5625*(h-=1.5/2.75)*h+.75:h<2.5/2.75?7.5625*(h-=2.25/2.75)*h+.9375:7.5625*(h-=2.625/2.75)*h+.984375},easeInOutBounce:h=>h<.5?Ka.easeInBounce(h*2)*.5:Ka.easeOutBounce(h*2-1)*.5+.5};function ya(h,o,c){return{x:h.x+c*(o.x-h.x),y:h.y+c*(o.y-h.y)}}function yl(h,o,c,d){return{x:h.x+c*(o.x-h.x),y:d==="middle"?c<.5?h.y:o.y:d==="after"?c<1?h.y:o.y:c>0?o.y:h.y}}function qd(h,o,c){const d={x:h.cp2x,y:h.cp2y},m={x:o.cp1x,y:o.cp1y},y=ya(h,d,c),_=ya(d,m,c),T=ya(m,o,c),D=ya(y,_,c),U=ya(_,T,c);return ya(D,U,c)}const xl=new Map;function vh(h,o){o=o||{};const c=h+JSON.stringify(o);let d=xl.get(c);return d||(d=new Intl.NumberFormat(h,o),xl.set(c,d)),d}function Yo(h,o,c){return vh(o,c).format(h)}const ly=function(h,o){return{x(c){return h+h+o-c},setWidth(c){o=c},textAlign(c){return c==="center"?c:c==="right"?"left":"right"},xPlus(c,d){return c-d},leftForLtr(c,d){return c-d}}},qm=function(){return{x(h){return h},setWidth(){},textAlign(h){return h},xPlus(h,o){return h+o},leftForLtr(h){return h}}};function Wl(h,o,c){return h?ly(o,c):qm()}function Rf(h,o){let c,d;(o==="ltr"||o==="rtl")&&(c=h.canvas.style,d=[c.getPropertyValue("direction"),c.getPropertyPriority("direction")],c.setProperty("direction",o,"important"),h.prevTextDirection=d)}function xa(h,o){o!==void 0&&(delete h.prevTextDirection,h.canvas.style.setProperty("direction",o[0],o[1]))}function jm(h){return h==="angle"?{between:xf,compare:qv,normalize:Po}:{between:(o,c,d)=>o>=Math.min(c,d)&&o<=Math.max(d,c),compare:(o,c)=>o-c,normalize:o=>o}}function Io({start:h,end:o,count:c,loop:d,style:m}){return{start:h%c,end:o%c,loop:d&&(o-h+1)%c===0,style:m}}function jd(h,o,c){const{property:d,start:m,end:y}=c,{between:_,normalize:T}=jm(d),D=o.length;let{start:U,end:Y,loop:Q}=h,fe,Te;if(Q){for(U+=D,Y+=D,fe=0,Te=D;fe<Te&&_(T(o[U%D][d]),m,y);++fe)U--,Y--;U%=D,Y%=D}return Y<U&&(Y+=D),{start:U,end:Y,loop:Q,style:h.style}}function Df(h,o,c){if(!c)return[h];const{property:d,start:m,end:y}=c,_=o.length,{compare:T,between:D,normalize:U}=jm(d),{start:Y,end:Q,loop:fe,style:Te}=jd(h,o,c),Ue=[];let it=!1,vt=null,Lt,Vn,zn;const yn=()=>D(m,zn,Lt)&&T(m,zn)!==0,Wn=()=>T(y,Lt)===0||D(y,zn,Lt),pi=()=>it||yn(),wi=()=>!it||Wn();for(let Vi=Y,Lr=Y;Vi<=Q;++Vi)Vn=o[Vi%_],!Vn.skip&&(Lt=U(Vn[d]),Lt!==zn&&(it=D(Lt,m,y),vt===null&&pi()&&(vt=T(Lt,m)===0?Vi:Lr),vt!==null&&wi()&&(Ue.push(Io({start:vt,end:Vi,loop:fe,count:_,style:Te})),vt=null),Lr=Vi,zn=Lt));return vt!==null&&Ue.push(Io({start:vt,end:Q,loop:fe,count:_,style:Te})),Ue}function Of(h,o){const c=[],d=h.segments;for(let m=0;m<d.length;m++){const y=Df(d[m],h.points,o);y.length&&c.push(...y)}return c}function Ym(h,o,c,d){let m=0,y=o-1;if(c&&!d)for(;m<o&&!h[m].skip;)m++;for(;m<o&&h[m].skip;)m++;for(m%=o,c&&(y+=m);y>m&&h[y%o].skip;)y--;return y%=o,{start:m,end:y}}function Mi(h,o,c,d){const m=h.length,y=[];let _=o,T=h[o],D;for(D=o+1;D<=c;++D){const U=h[D%m];U.skip||U.stop?T.skip||(d=!1,y.push({start:o%m,end:(D-1)%m,loop:d}),o=_=U.stop?D:null):(_=D,T.skip&&(o=D)),T=U}return _!==null&&y.push({start:o%m,end:_%m,loop:d}),y}function Yd(h,o){const c=h.points,d=h.options.spanGaps,m=c.length;if(!m)return[];const y=!!h._loop,{start:_,end:T}=Ym(c,m,y,d);if(d===!0)return cy(h,[{start:_,end:T,loop:y}],c,o);const D=T<_?T+m:T,U=!!h._fullLoop&&_===0&&T===m-1;return cy(h,Mi(c,_,D,U),c,o)}function cy(h,o,c,d){return!d||!d.setContext||!c?o:Yi(h,o,c,d)}function Yi(h,o,c,d){const m=h._chart.getContext(),y=yo(h.options),{_datasetIndex:_,options:{spanGaps:T}}=h,D=c.length,U=[];let Y=y,Q=o[0].start,fe=Q;function Te(Ue,it,vt,Lt){const Vn=T?-1:1;if(Ue!==it){for(Ue+=D;c[Ue%D].skip;)Ue-=Vn;for(;c[it%D].skip;)it+=Vn;Ue%D!==it%D&&(U.push({start:Ue%D,end:it%D,loop:vt,style:Lt}),Y=Lt,Q=it%D)}}for(const Ue of o){Q=T?Q:Ue.start;let it=c[Q%D],vt;for(fe=Q+1;fe<=Ue.end;fe++){const Lt=c[fe%D];vt=yo(d.setContext(jo(m,{type:"segment",p0:it,p1:Lt,p0DataIndex:(fe-1)%D,p1DataIndex:fe%D,datasetIndex:_}))),ws(vt,Y)&&Te(Q,fe-1,Ue.loop,Y),it=Lt,Y=vt}Q<fe-1&&Te(Q,fe-1,Ue.loop,Y)}return U}function yo(h){return{backgroundColor:h.backgroundColor,borderCapStyle:h.borderCapStyle,borderDash:h.borderDash,borderDashOffset:h.borderDashOffset,borderJoinStyle:h.borderJoinStyle,borderWidth:h.borderWidth,borderColor:h.borderColor}}function ws(h,o){return o&&JSON.stringify(h)!==JSON.stringify(o)}var Zd=Object.freeze({__proto__:null,easingEffects:Ka,color:Ls,getHoverColor:Ga,noop:ha,uid:kv,isNullOrUndef:Dr,isArray:Tr,isObject:ur,isFinite:Ws,finiteOrDefault:ho,valueOrDefault:gr,toPercentage:ah,toDimension:Tm,callback:Or,each:vr,_elementsEqual:vf,clone:yf,_merger:hu,merge:dl,mergeIf:oh,_mergerIf:Uv,_deprecated:function(h,o,c,d){o!==void 0&&console.warn(h+': "'+c+'" is deprecated. Please use "'+d+'" instead')},resolveObjectKey:Mc,_capitalize:Id,defined:fo,isFunction:pl,setsEqual:Am,toFontString:Yv,_measureText:_f,_longestText:Zv,_alignPixel:Ec,clearCanvas:Om,drawPoint:bf,_isPointInArea:Tc,clipArea:wf,unclipArea:Mf,_steppedLineTo:Jv,_bezierCurveTo:fh,renderText:mo,addRoundedRectPath:ml,_lookup:du,_lookupByKey:Ro,_rlookupByKey:Nm,_filterBetween:$v,listenArrayEvents:Fm,unlistenArrayEvents:Bl,_arrayUnique:ph,_createResolver:wu,_attachContext:Gl,_descriptors:Mu,splineCurve:iy,splineCurveMonotone:Xm,_updateBezierControlPoints:Ni,_isDomSupported:Bm,_getParentNode:Sf,getStyle:Qv,getRelativePosition:km,getMaximumSize:Ef,retinaScale:gu,supportsEventListenerOptions:Hm,readUsedSize:go,fontString:function(h,o,c){return o+" "+h+"px "+c},requestAnimFrame:Nn,throttled:Tt,debounce:_n,_toLeftRightCenter:Ut,_alignStartEnd:ce,_textX:At,_pointInLine:ya,_steppedInterpolation:yl,_bezierInterpolation:qd,formatNumber:Yo,toLineHeight:Gm,_readValueToProps:De,toTRBL:Tf,toTRBLCorners:Lc,toPadding:Ps,toFont:qs,resolve:$a,_addGrace:mh,createContext:jo,PI:Cs,TAU:us,PITAU:Lm,INFINITY:ch,RAD_PER_DEG:Gv,HALF_PI:Xs,QUARTER_PI:uh,TWO_THIRDS_PI:Cm,log10:po,sign:Xo,niceNum:Pm,_factorize:Vv,isNumber:fu,almostEquals:hh,almostWhole:Wv,_setMinAndMaxByKey:Rm,toRadians:Co,toDegrees:Bd,_decimalPlaces:Dm,getAngleFromPoint:Xv,distanceBetweenPoints:kd,_angleDiff:qv,_normalizeAngle:Po,_angleBetween:xf,_limitValue:fa,_int16Range:jv,getRtlAdapter:Wl,overrideTextDirection:Rf,restoreTextDirection:xa,_boundSegment:Df,_boundSegments:Of,_computeSegments:Yd});class sr{acquireContext(){}releaseContext(){return!1}addEventListener(){}removeEventListener(){}getDevicePixelRatio(){return 1}getMaximumSize(o,c,d,m){return c=Math.max(0,c||o.width),d=d||o.height,{width:c,height:Math.max(0,m?Math.floor(c/m):d)}}isAttached(){return!0}updateConfig(){}}class Jd extends sr{acquireContext(o){return o&&o.getContext&&o.getContext("2d")||null}updateConfig(o){o.options.animation=!1}}const yh="$chartjs",Zm={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},$d=h=>h===null||h==="";function If(h,o){const c=h.style,d=h.getAttribute("height"),m=h.getAttribute("width");if(h[yh]={initial:{height:d,width:m,style:{display:c.display,height:c.height,width:c.width}}},c.display=c.display||"block",c.boxSizing=c.boxSizing||"border-box",$d(m)){const y=go(h,"width");y!==void 0&&(h.width=y)}if($d(d))if(h.style.height==="")h.height=h.width/(o||2);else{const y=go(h,"height");y!==void 0&&(h.height=y)}return h}const Kd=Hm?{passive:!0}:!1;function Nf(h,o,c){h.addEventListener(o,c,Kd)}function is(h,o,c){h.canvas.removeEventListener(o,c,Kd)}function Jm(h,o){const c=Zm[h.type]||h.type,{x:d,y:m}=km(h,o);return{type:c,chart:o,native:h,x:d!==void 0?d:null,y:m!==void 0?m:null}}function d_(h,o,c){const d=h.canvas,m=new MutationObserver(y=>{for(const _ of y)for(const T of _.addedNodes)if(T===d||T.contains(d))return c()});return m.observe(document,{childList:!0,subtree:!0}),m}function uy(h,o,c){const d=h.canvas,m=new MutationObserver(y=>{for(const _ of y)for(const T of _.removedNodes)if(T===d||T.contains(d))return c()});return m.observe(document,{childList:!0,subtree:!0}),m}const Ff=new Map;let Zo=0;function Qd(){const h=window.devicePixelRatio;h!==Zo&&(Zo=h,Ff.forEach((o,c)=>{c.currentDevicePixelRatio!==h&&o()}))}function xh(h,o){Ff.size||window.addEventListener("resize",Qd),Ff.set(h,o)}function xo(h){Ff.delete(h),Ff.size||window.removeEventListener("resize",Qd)}function Bf(h,o,c){const d=h.canvas,m=d&&Sf(d);if(!m)return;const y=Tt((T,D)=>{const U=m.clientWidth;c(T,D),U<m.clientWidth&&c()},window),_=new ResizeObserver(T=>{const D=T[0],U=D.contentRect.width,Y=D.contentRect.height;U===0&&Y===0||y(U,Y)});return _.observe(m),xh(h,y),_}function aa(h,o,c){c&&c.disconnect(),o==="resize"&&xo(h)}function hs(h,o,c){const d=h.canvas,m=Tt(y=>{h.ctx!==null&&c(Jm(y,h))},h,y=>{const _=y[0];return[_,_.offsetX,_.offsetY]});return Nf(d,o,m),m}class $m extends sr{acquireContext(o,c){const d=o&&o.getContext&&o.getContext("2d");return d&&d.canvas===o?(If(o,c),d):null}releaseContext(o){const c=o.canvas;if(!c[yh])return!1;const d=c[yh].initial;["height","width"].forEach(y=>{const _=d[y];Dr(_)?c.removeAttribute(y):c.setAttribute(y,_)});const m=d.style||{};return Object.keys(m).forEach(y=>{c.style[y]=m[y]}),c.width=c.width,delete c[yh],!0}addEventListener(o,c,d){this.removeEventListener(o,c);const m=o.$proxies||(o.$proxies={}),y={attach:d_,detach:uy,resize:Bf}[c]||hs;m[c]=y(o,c,d)}removeEventListener(o,c){const d=o.$proxies||(o.$proxies={}),m=d[c];if(!m)return;({attach:aa,detach:aa,resize:aa}[c]||is)(o,c,m),d[c]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(o,c,d,m){return Ef(o,c,d,m)}isAttached(o){const c=Sf(o);return!!(c&&c.isConnected)}}function Dc(h){return!Bm()||typeof OffscreenCanvas<"u"&&h instanceof OffscreenCanvas?Jd:$m}var ep=Object.freeze({__proto__:null,_detectPlatform:Dc,BasePlatform:sr,BasicPlatform:Jd,DomPlatform:$m});const Xl="transparent",Oc={boolean(h,o,c){return c>.5?o:h},color(h,o,c){const d=Ls(h||Xl),m=d.valid&&Ls(o||Xl);return m&&m.valid?m.mix(d,c).hexString():o},number(h,o,c){return h+(o-h)*c}};class ql{constructor(o,c,d,m){const y=c[d];m=$a([o.to,m,y,o.from]);const _=$a([o.from,y,m]);this._active=!0,this._fn=o.fn||Oc[o.type||typeof _],this._easing=Ka[o.easing]||Ka.linear,this._start=Math.floor(Date.now()+(o.delay||0)),this._duration=this._total=Math.floor(o.duration),this._loop=!!o.loop,this._target=c,this._prop=d,this._from=_,this._to=m,this._promises=void 0}active(){return this._active}update(o,c,d){if(this._active){this._notify(!1);const m=this._target[this._prop],y=d-this._start,_=this._duration-y;this._start=d,this._duration=Math.floor(Math.max(_,o.duration)),this._total+=y,this._loop=!!o.loop,this._to=$a([o.to,c,m,o.from]),this._from=$a([o.from,m,c])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(o){const c=o-this._start,d=this._duration,m=this._prop,y=this._from,_=this._loop,T=this._to;let D;if(this._active=y!==T&&(_||c<d),!this._active){this._target[m]=T,this._notify(!0);return}if(c<0){this._target[m]=y;return}D=c/d%2,D=_&&D>1?2-D:D,D=this._easing(Math.min(1,Math.max(0,D))),this._target[m]=this._fn(y,T,D)}wait(){const o=this._promises||(this._promises=[]);return new Promise((c,d)=>{o.push({res:c,rej:d})})}_notify(o){const c=o?"res":"rej",d=this._promises||[];for(let m=0;m<d.length;m++)d[m][c]()}}Ir.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0});const Km=Object.keys(Ir.animation);Ir.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:h=>h!=="onProgress"&&h!=="onComplete"&&h!=="fn"}),Ir.set("animations",{colors:{type:"color",properties:["color","borderColor","backgroundColor"]},numbers:{type:"number",properties:["x","y","borderWidth","radius","tension"]}}),Ir.describe("animations",{_fallback:"animation"}),Ir.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:h=>h|0}}}});class kf{constructor(o,c){this._chart=o,this._properties=new Map,this.configure(c)}configure(o){if(!ur(o))return;const c=this._properties;Object.getOwnPropertyNames(o).forEach(d=>{const m=o[d];if(!ur(m))return;const y={};for(const _ of Km)y[_]=m[_];(Tr(m.properties)&&m.properties||[d]).forEach(_=>{(_===d||!c.has(_))&&c.set(_,y)})})}_animateOptions(o,c){const d=c.options,m=tp(o,d);if(!m)return[];const y=this._createAnimations(m,d);return d.$shared&&Qm(o.options.$animations,d).then(()=>{o.options=d},()=>{}),y}_createAnimations(o,c){const d=this._properties,m=[],y=o.$animations||(o.$animations={}),_=Object.keys(c),T=Date.now();let D;for(D=_.length-1;D>=0;--D){const U=_[D];if(U.charAt(0)==="$")continue;if(U==="options"){m.push(...this._animateOptions(o,c));continue}const Y=c[U];let Q=y[U];const fe=d.get(U);if(Q)if(fe&&Q.active()){Q.update(fe,Y,T);continue}else Q.cancel();if(!fe||!fe.duration){o[U]=Y;continue}y[U]=Q=new ql(fe,o,U,Y),m.push(Q)}return m}update(o,c){if(this._properties.size===0){Object.assign(o,c);return}const d=this._createAnimations(o,c);if(d.length)return $t.add(this._chart,d),!0}}function Qm(h,o){const c=[],d=Object.keys(o);for(let m=0;m<d.length;m++){const y=h[d[m]];y&&y.active()&&c.push(y.wait())}return Promise.all(c)}function tp(h,o){if(!o)return;let c=h.options;if(!c){h.options=o;return}return c.$shared&&(h.options=c=Object.assign({},c,{$shared:!1,$animations:{}})),c}function zf(h,o){const c=h&&h.options||{},d=c.reverse,m=c.min===void 0?o:0,y=c.max===void 0?o:0;return{start:d?y:m,end:d?m:y}}function np(h,o,c){if(c===!1)return!1;const d=zf(h,c),m=zf(o,c);return{top:m.end,right:d.end,bottom:m.start,left:d.start}}function _h(h){let o,c,d,m;return ur(h)?(o=h.top,c=h.right,d=h.bottom,m=h.left):o=c=d=m=h,{top:o,right:c,bottom:d,left:m,disabled:h===!1}}function Tu(h,o){const c=[],d=h._getSortedDatasetMetas(o);let m,y;for(m=0,y=d.length;m<y;++m)c.push(d[m].index);return c}function Au(h,o,c,d={}){const m=h.keys,y=d.mode==="single";let _,T,D,U;if(o!==null){for(_=0,T=m.length;_<T;++_){if(D=+m[_],D===c){if(d.all)continue;break}U=h.values[D],Ws(U)&&(y||o===0||Xo(o)===Xo(U))&&(o+=U)}return o}}function Uf(h){const o=Object.keys(h),c=new Array(o.length);let d,m,y;for(d=0,m=o.length;d<m;++d)y=o[d],c[d]={x:y,y:h[y]};return c}function Hf(h,o){const c=h&&h.options.stacked;return c||c===void 0&&o.stack!==void 0}function Ca(h,o,c){return`${h.id}.${o.id}.${c.stack||c.type}`}function hy(h){const{min:o,max:c,minDefined:d,maxDefined:m}=h.getUserBounds();return{min:d?o:Number.NEGATIVE_INFINITY,max:m?c:Number.POSITIVE_INFINITY}}function ip(h,o,c){const d=h[o]||(h[o]={});return d[c]||(d[c]={})}function eg(h,o,c,d){for(const m of o.getMatchingVisibleMetas(d).reverse()){const y=h[m.index];if(c&&y>0||!c&&y<0)return m.index}return null}function Lu(h,o){const{chart:c,_cachedMeta:d}=h,m=c._stacks||(c._stacks={}),{iScale:y,vScale:_,index:T}=d,D=y.axis,U=_.axis,Y=Ca(y,_,d),Q=o.length;let fe;for(let Te=0;Te<Q;++Te){const Ue=o[Te],{[D]:it,[U]:vt}=Ue,Lt=Ue._stacks||(Ue._stacks={});fe=Lt[U]=ip(m,Y,it),fe[T]=vt,fe._top=eg(fe,_,!0,d.type),fe._bottom=eg(fe,_,!1,d.type)}}function _a(h,o){const c=h.scales;return Object.keys(c).filter(d=>c[d].axis===o).shift()}function p_(h,o){return jo(h,{active:!1,dataset:void 0,datasetIndex:o,index:o,mode:"default",type:"dataset"})}function m_(h,o,c){return jo(h,{active:!1,dataIndex:o,parsed:void 0,raw:void 0,element:c,index:o,mode:"default",type:"data"})}function Gf(h,o){const c=h.controller.index,d=h.vScale&&h.vScale.axis;if(!!d){o=o||h._parsed;for(const m of o){const y=m._stacks;if(!y||y[d]===void 0||y[d][c]===void 0)return;delete y[d][c]}}}const Fa=h=>h==="reset"||h==="none",jl=(h,o)=>o?h:Object.assign({},h),ba=(h,o,c)=>h&&!o.hidden&&o._stacked&&{keys:Tu(c,!0),values:null};class Ba{constructor(o,c){this.chart=o,this._ctx=o.ctx,this.index=c,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.$context=void 0,this._syncList=[],this.initialize()}initialize(){const o=this._cachedMeta;this.configure(),this.linkScales(),o._stacked=Hf(o.vScale,o),this.addElements()}updateIndex(o){this.index!==o&&Gf(this._cachedMeta),this.index=o}linkScales(){const o=this.chart,c=this._cachedMeta,d=this.getDataset(),m=(Q,fe,Te,Ue)=>Q==="x"?fe:Q==="r"?Ue:Te,y=c.xAxisID=gr(d.xAxisID,_a(o,"x")),_=c.yAxisID=gr(d.yAxisID,_a(o,"y")),T=c.rAxisID=gr(d.rAxisID,_a(o,"r")),D=c.indexAxis,U=c.iAxisID=m(D,y,_,T),Y=c.vAxisID=m(D,_,y,T);c.xScale=this.getScaleForId(y),c.yScale=this.getScaleForId(_),c.rScale=this.getScaleForId(T),c.iScale=this.getScaleForId(U),c.vScale=this.getScaleForId(Y)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(o){return this.chart.scales[o]}_getOtherScale(o){const c=this._cachedMeta;return o===c.iScale?c.vScale:c.iScale}reset(){this._update("reset")}_destroy(){const o=this._cachedMeta;this._data&&Bl(this._data,this),o._stacked&&Gf(o)}_dataCheck(){const o=this.getDataset(),c=o.data||(o.data=[]),d=this._data;if(ur(c))this._data=Uf(c);else if(d!==c){if(d){Bl(d,this);const m=this._cachedMeta;Gf(m),m._parsed=[]}c&&Object.isExtensible(c)&&Fm(c,this),this._syncList=[],this._data=c}}addElements(){const o=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(o.dataset=new this.datasetElementType)}buildOrUpdateElements(o){const c=this._cachedMeta,d=this.getDataset();let m=!1;this._dataCheck();const y=c._stacked;c._stacked=Hf(c.vScale,c),c.stack!==d.stack&&(m=!0,Gf(c),c.stack=d.stack),this._resyncElements(o),(m||y!==c._stacked)&&Lu(this,c._parsed)}configure(){const o=this.chart.config,c=o.datasetScopeKeys(this._type),d=o.getOptionScopes(this.getDataset(),c,!0);this.options=o.createResolver(d,this.getContext()),this._parsing=this.options.parsing}parse(o,c){const{_cachedMeta:d,_data:m}=this,{iScale:y,_stacked:_}=d,T=y.axis;let D=o===0&&c===m.length?!0:d._sorted,U=o>0&&d._parsed[o-1],Y,Q,fe;if(this._parsing===!1)d._parsed=m,d._sorted=!0,fe=m;else{Tr(m[o])?fe=this.parseArrayData(d,m,o,c):ur(m[o])?fe=this.parseObjectData(d,m,o,c):fe=this.parsePrimitiveData(d,m,o,c);const Te=()=>Q[T]===null||U&&Q[T]<U[T];for(Y=0;Y<c;++Y)d._parsed[Y+o]=Q=fe[Y],D&&(Te()&&(D=!1),U=Q);d._sorted=D}_&&Lu(this,fe)}parsePrimitiveData(o,c,d,m){const{iScale:y,vScale:_}=o,T=y.axis,D=_.axis,U=y.getLabels(),Y=new Array(m);let Q,fe,Te;for(Q=0,fe=m;Q<fe;++Q)Te=Q+d,Y[Q]={[T]:y===_||y.parse(U[Te],Te),[D]:_.parse(c[Te],Te)};return Y}parseArrayData(o,c,d,m){const{xScale:y,yScale:_}=o,T=new Array(m);let D,U,Y,Q;for(D=0,U=m;D<U;++D)Y=D+d,Q=c[Y],T[D]={x:y.parse(Q[0],Y),y:_.parse(Q[1],Y)};return T}parseObjectData(o,c,d,m){const{xScale:y,yScale:_}=o,{xAxisKey:T="x",yAxisKey:D="y"}=this._parsing,U=new Array(m);let Y,Q,fe,Te;for(Y=0,Q=m;Y<Q;++Y)fe=Y+d,Te=c[fe],U[Y]={x:y.parse(Mc(Te,T),fe),y:_.parse(Mc(Te,D),fe)};return U}getParsed(o){return this._cachedMeta._parsed[o]}getDataElement(o){return this._cachedMeta.data[o]}applyStack(o,c,d){const m=this.chart,y=this._cachedMeta,_=c[o.axis],T={keys:Tu(m,!0),values:c._stacks[o.axis]};return Au(T,_,y.index,{mode:d})}updateRangeFromParsed(o,c,d,m){const y=d[c.axis];let _=y===null?NaN:y;const T=m&&d._stacks[c.axis];m&&T&&(m.values=T,_=Au(m,y,this._cachedMeta.index)),o.min=Math.min(o.min,_),o.max=Math.max(o.max,_)}getMinMax(o,c){const d=this._cachedMeta,m=d._parsed,y=d._sorted&&o===d.iScale,_=m.length,T=this._getOtherScale(o),D=ba(c,d,this.chart),U={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:Y,max:Q}=hy(T);let fe,Te;function Ue(){Te=m[fe];const it=Te[T.axis];return!Ws(Te[o.axis])||Y>it||Q<it}for(fe=0;fe<_&&!(!Ue()&&(this.updateRangeFromParsed(U,o,Te,D),y));++fe);if(y){for(fe=_-1;fe>=0;--fe)if(!Ue()){this.updateRangeFromParsed(U,o,Te,D);break}}return U}getAllParsedValues(o){const c=this._cachedMeta._parsed,d=[];let m,y,_;for(m=0,y=c.length;m<y;++m)_=c[m][o.axis],Ws(_)&&d.push(_);return d}getMaxOverflow(){return!1}getLabelAndValue(o){const c=this._cachedMeta,d=c.iScale,m=c.vScale,y=this.getParsed(o);return{label:d?""+d.getLabelForValue(y[d.axis]):"",value:m?""+m.getLabelForValue(y[m.axis]):""}}_update(o){const c=this._cachedMeta;this.configure(),this._cachedDataOpts={},this.update(o||"default"),c._clip=_h(gr(this.options.clip,np(c.xScale,c.yScale,this.getMaxOverflow())))}update(){}draw(){const o=this._ctx,c=this.chart,d=this._cachedMeta,m=d.data||[],y=c.chartArea,_=[],T=this._drawStart||0,D=this._drawCount||m.length-T;let U;for(d.dataset&&d.dataset.draw(o,y,T,D),U=T;U<T+D;++U){const Y=m[U];Y.hidden||(Y.active?_.push(Y):Y.draw(o,y))}for(U=0;U<_.length;++U)_[U].draw(o,y)}getStyle(o,c){const d=c?"active":"default";return o===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(d):this.resolveDataElementOptions(o||0,d)}getContext(o,c,d){const m=this.getDataset();let y;if(o>=0&&o<this._cachedMeta.data.length){const _=this._cachedMeta.data[o];y=_.$context||(_.$context=m_(this.getContext(),o,_)),y.parsed=this.getParsed(o),y.raw=m.data[o],y.index=y.dataIndex=o}else y=this.$context||(this.$context=p_(this.chart.getContext(),this.index)),y.dataset=m,y.index=y.datasetIndex=this.index;return y.active=!!c,y.mode=d,y}resolveDatasetElementOptions(o){return this._resolveElementOptions(this.datasetElementType.id,o)}resolveDataElementOptions(o,c){return this._resolveElementOptions(this.dataElementType.id,c,o)}_resolveElementOptions(o,c="default",d){const m=c==="active",y=this._cachedDataOpts,_=o+"-"+c,T=y[_],D=this.enableOptionSharing&&fo(d);if(T)return jl(T,D);const U=this.chart.config,Y=U.datasetElementScopeKeys(this._type,o),Q=m?[`${o}Hover`,"hover",o,""]:[o,""],fe=U.getOptionScopes(this.getDataset(),Y),Te=Object.keys(Ir.elements[o]),Ue=U.resolveNamedOptions(fe,Te,()=>this.getContext(d,m),Q);return Ue.$shared&&(Ue.$shared=D,y[_]=Object.freeze(jl(Ue,D))),Ue}_resolveAnimations(o,c,d){const m=this.chart,y=this._cachedDataOpts,_=`animation-${c}`,T=y[_];if(T)return T;let D;if(m.options.animation!==!1){const Y=this.chart.config,Q=Y.datasetAnimationScopeKeys(this._type,c),fe=Y.getOptionScopes(this.getDataset(),Q);D=Y.createResolver(fe,this.getContext(o,d,c))}const U=new kf(m,D&&D.animations);return D&&D._cacheable&&(y[_]=Object.freeze(U)),U}getSharedOptions(o){if(!!o.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},o))}includeOptions(o,c){return!c||Fa(o)||this.chart._animationsDisabled}updateElement(o,c,d,m){Fa(m)?Object.assign(o,d):this._resolveAnimations(c,m).update(o,d)}updateSharedOptions(o,c,d){o&&!Fa(c)&&this._resolveAnimations(void 0,c).update(o,d)}_setStyle(o,c,d,m){o.active=m;const y=this.getStyle(c,m);this._resolveAnimations(c,d,m).update(o,{options:!m&&this.getSharedOptions(y)||y})}removeHoverStyle(o,c,d){this._setStyle(o,d,"active",!1)}setHoverStyle(o,c,d){this._setStyle(o,d,"active",!0)}_removeDatasetHoverStyle(){const o=this._cachedMeta.dataset;o&&this._setStyle(o,void 0,"active",!1)}_setDatasetHoverStyle(){const o=this._cachedMeta.dataset;o&&this._setStyle(o,void 0,"active",!0)}_resyncElements(o){const c=this._data,d=this._cachedMeta.data;for(const[T,D,U]of this._syncList)this[T](D,U);this._syncList=[];const m=d.length,y=c.length,_=Math.min(y,m);_&&this.parse(0,_),y>m?this._insertElements(m,y-m,o):y<m&&this._removeElements(y,m-y)}_insertElements(o,c,d=!0){const m=this._cachedMeta,y=m.data,_=o+c;let T;const D=U=>{for(U.length+=c,T=U.length-1;T>=_;T--)U[T]=U[T-c]};for(D(y),T=o;T<_;++T)y[T]=new this.dataElementType;this._parsing&&D(m._parsed),this.parse(o,c),d&&this.updateElements(y,o,c,"reset")}updateElements(){}_removeElements(o,c){const d=this._cachedMeta;if(this._parsing){const m=d._parsed.splice(o,c);d._stacked&&Gf(d,m)}d.data.splice(o,c)}_sync(o){if(this._parsing)this._syncList.push(o);else{const[c,d,m]=o;this[c](d,m)}}_onDataPush(){const o=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-o,o])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(o,c){this._sync(["_removeElements",o,c]),this._sync(["_insertElements",o,arguments.length-2])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}Ba.defaults={},Ba.prototype.datasetElementType=null,Ba.prototype.dataElementType=null;class Pa{constructor(){this.x=void 0,this.y=void 0,this.active=!1,this.options=void 0,this.$animations=void 0}tooltipPosition(o){const{x:c,y:d}=this.getProps(["x","y"],o);return{x:c,y:d}}hasValue(){return fu(this.x)&&fu(this.y)}getProps(o,c){const d=this.$animations;if(!c||!d)return this;const m={};return o.forEach(y=>{m[y]=d[y]&&d[y].active()?d[y]._to:this[y]}),m}}Pa.defaults={},Pa.defaultRoutes=void 0;const bh={values(h){return Tr(h)?h:""+h},numeric(h,o,c){if(h===0)return"0";const d=this.chart.options.locale;let m,y=h;if(c.length>1){const U=Math.max(Math.abs(c[0].value),Math.abs(c[c.length-1].value));(U<1e-4||U>1e15)&&(m="scientific"),y=Ic(h,c)}const _=po(Math.abs(y)),T=Math.max(Math.min(-1*Math.floor(_),20),0),D={notation:m,minimumFractionDigits:T,maximumFractionDigits:T};return Object.assign(D,this.options.ticks.format),Yo(h,d,D)},logarithmic(h,o,c){if(h===0)return"0";const d=h/Math.pow(10,Math.floor(po(h)));return d===1||d===2||d===5?bh.numeric.call(this,h,o,c):""}};function Ic(h,o){let c=o.length>3?o[2].value-o[1].value:o[1].value-o[0].value;return Math.abs(c)>=1&&h!==Math.floor(h)&&(c=h-Math.floor(h)),c}var _l={formatters:bh};Ir.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",grace:0,grid:{display:!0,lineWidth:1,drawBorder:!0,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(h,o)=>o.lineWidth,tickColor:(h,o)=>o.color,offset:!1,borderDash:[],borderDashOffset:0,borderWidth:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:_l.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),Ir.route("scale.ticks","color","","color"),Ir.route("scale.grid","color","","borderColor"),Ir.route("scale.grid","borderColor","","borderColor"),Ir.route("scale.title","color","","color"),Ir.describe("scale",{_fallback:!1,_scriptable:h=>!h.startsWith("before")&&!h.startsWith("after")&&h!=="callback"&&h!=="parser",_indexable:h=>h!=="borderDash"&&h!=="tickBorderDash"}),Ir.describe("scales",{_fallback:"scale"}),Ir.describe("scale.ticks",{_scriptable:h=>h!=="backdropPadding"&&h!=="callback",_indexable:h=>h!=="backdropPadding"});function wh(h,o){const c=h.options.ticks,d=c.maxTicksLimit||Mh(h),m=c.major.enabled?sp(o):[],y=m.length,_=m[0],T=m[y-1],D=[];if(y>d)return fy(o,D,m,y/d),D;const U=rp(m,o,d);if(y>0){let Y,Q;const fe=y>1?Math.round((T-_)/(y-1)):null;for(ap(o,D,U,Dr(fe)?0:_-fe,_),Y=0,Q=y-1;Y<Q;Y++)ap(o,D,U,m[Y],m[Y+1]);return ap(o,D,U,T,Dr(fe)?o.length:T+fe),D}return ap(o,D,U),D}function Mh(h){const o=h.options.offset,c=h._tickSize(),d=h._length/c+(o?0:1),m=h._maxLength/c;return Math.floor(Math.min(d,m))}function rp(h,o,c){const d=g_(h),m=o.length/c;if(!d)return Math.max(m,1);const y=Vv(d);for(let _=0,T=y.length-1;_<T;_++){const D=y[_];if(D>m)return D}return Math.max(m,1)}function sp(h){const o=[];let c,d;for(c=0,d=h.length;c<d;c++)h[c].major&&o.push(c);return o}function fy(h,o,c,d){let m=0,y=c[0],_;for(d=Math.ceil(d),_=0;_<h.length;_++)_===y&&(o.push(h[_]),m++,y=c[m*d])}function ap(h,o,c,d,m){const y=gr(d,0),_=Math.min(gr(m,h.length),h.length);let T=0,D,U,Y;for(c=Math.ceil(c),m&&(D=m-d,c=D/Math.floor(D/c)),Y=y;Y<0;)T++,Y=Math.round(y+T*c);for(U=Math.max(y,0);U<_;U++)U===Y&&(o.push(h[U]),T++,Y=Math.round(y+T*c))}function g_(h){const o=h.length;let c,d;if(o<2)return!1;for(d=h[0],c=1;c<o;++c)if(h[c]-h[c-1]!==d)return!1;return d}const v_=h=>h==="left"?"right":h==="right"?"left":h,dy=(h,o,c)=>o==="top"||o==="left"?h[o]+c:h[o]-c;function py(h,o){const c=[],d=h.length/o,m=h.length;let y=0;for(;y<m;y+=d)c.push(h[Math.floor(y)]);return c}function y_(h,o,c){const d=h.ticks.length,m=Math.min(o,d-1),y=h._startPixel,_=h._endPixel,T=1e-6;let D=h.getPixelForTick(m),U;if(!(c&&(d===1?U=Math.max(D-y,_-D):o===0?U=(h.getPixelForTick(1)-D)/2:U=(D-h.getPixelForTick(m-1))/2,D+=m<o?U:-U,D<y-T||D>_+T)))return D}function x_(h,o){vr(h,c=>{const d=c.gc,m=d.length/2;let y;if(m>o){for(y=0;y<m;++y)delete c.data[d[y]];d.splice(0,m)}})}function Vf(h){return h.drawTicks?h.tickLength:0}function my(h,o){if(!h.display)return 0;const c=qs(h.font,o),d=Ps(h.padding);return(Tr(h.text)?h.text.length:1)*c.lineHeight+d.height}function __(h,o){return jo(h,{scale:o,type:"scale"})}function b_(h,o,c){return jo(h,{tick:c,index:o,type:"tick"})}function w_(h,o,c){let d=Ut(h);return(c&&o!=="right"||!c&&o==="right")&&(d=v_(d)),d}function M_(h,o,c,d){const{top:m,left:y,bottom:_,right:T,chart:D}=h,{chartArea:U,scales:Y}=D;let Q=0,fe,Te,Ue;const it=_-m,vt=T-y;if(h.isHorizontal()){if(Te=ce(d,y,T),ur(c)){const Lt=Object.keys(c)[0],Vn=c[Lt];Ue=Y[Lt].getPixelForValue(Vn)+it-o}else c==="center"?Ue=(U.bottom+U.top)/2+it-o:Ue=dy(h,c,o);fe=T-y}else{if(ur(c)){const Lt=Object.keys(c)[0],Vn=c[Lt];Te=Y[Lt].getPixelForValue(Vn)-vt+o}else c==="center"?Te=(U.left+U.right)/2-vt+o:Te=dy(h,c,o);Ue=ce(d,_,m),Q=c==="left"?-Xs:Xs}return{titleX:Te,titleY:Ue,maxWidth:fe,rotation:Q}}class Nc extends Pa{constructor(o){super(),this.id=o.id,this.type=o.type,this.options=void 0,this.ctx=o.ctx,this.chart=o.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(o){this.options=o.setContext(this.getContext()),this.axis=o.axis,this._userMin=this.parse(o.min),this._userMax=this.parse(o.max),this._suggestedMin=this.parse(o.suggestedMin),this._suggestedMax=this.parse(o.suggestedMax)}parse(o){return o}getUserBounds(){let{_userMin:o,_userMax:c,_suggestedMin:d,_suggestedMax:m}=this;return o=ho(o,Number.POSITIVE_INFINITY),c=ho(c,Number.NEGATIVE_INFINITY),d=ho(d,Number.POSITIVE_INFINITY),m=ho(m,Number.NEGATIVE_INFINITY),{min:ho(o,d),max:ho(c,m),minDefined:Ws(o),maxDefined:Ws(c)}}getMinMax(o){let{min:c,max:d,minDefined:m,maxDefined:y}=this.getUserBounds(),_;if(m&&y)return{min:c,max:d};const T=this.getMatchingVisibleMetas();for(let D=0,U=T.length;D<U;++D)_=T[D].controller.getMinMax(this,o),m||(c=Math.min(c,_.min)),y||(d=Math.max(d,_.max));return c=y&&c>d?d:c,d=m&&c>d?c:d,{min:ho(c,ho(d,c)),max:ho(d,ho(c,d))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const o=this.chart.data;return this.options.labels||(this.isHorizontal()?o.xLabels:o.yLabels)||o.labels||[]}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Or(this.options.beforeUpdate,[this])}update(o,c,d){const{beginAtZero:m,grace:y,ticks:_}=this.options,T=_.sampleSize;this.beforeUpdate(),this.maxWidth=o,this.maxHeight=c,this._margins=d=Object.assign({left:0,right:0,top:0,bottom:0},d),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+d.left+d.right:this.height+d.top+d.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=mh(this,y,m),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const D=T<this.ticks.length;this._convertTicksToLabels(D?py(this.ticks,T):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),_.display&&(_.autoSkip||_.source==="auto")&&(this.ticks=wh(this,this.ticks),this._labelSizes=null),D&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let o=this.options.reverse,c,d;this.isHorizontal()?(c=this.left,d=this.right):(c=this.top,d=this.bottom,o=!o),this._startPixel=c,this._endPixel=d,this._reversePixels=o,this._length=d-c,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Or(this.options.afterUpdate,[this])}beforeSetDimensions(){Or(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Or(this.options.afterSetDimensions,[this])}_callHooks(o){this.chart.notifyPlugins(o,this.getContext()),Or(this.options[o],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Or(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(o){const c=this.options.ticks;let d,m,y;for(d=0,m=o.length;d<m;d++)y=o[d],y.label=Or(c.callback,[y.value,d,o],this)}afterTickToLabelConversion(){Or(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Or(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const o=this.options,c=o.ticks,d=this.ticks.length,m=c.minRotation||0,y=c.maxRotation;let _=m,T,D,U;if(!this._isVisible()||!c.display||m>=y||d<=1||!this.isHorizontal()){this.labelRotation=m;return}const Y=this._getLabelSizes(),Q=Y.widest.width,fe=Y.highest.height,Te=fa(this.chart.width-Q,0,this.maxWidth);T=o.offset?this.maxWidth/d:Te/(d-1),Q+6>T&&(T=Te/(d-(o.offset?.5:1)),D=this.maxHeight-Vf(o.grid)-c.padding-my(o.title,this.chart.options.font),U=Math.sqrt(Q*Q+fe*fe),_=Bd(Math.min(Math.asin(fa((Y.highest.height+6)/T,-1,1)),Math.asin(fa(D/U,-1,1))-Math.asin(fa(fe/U,-1,1)))),_=Math.max(m,Math.min(y,_))),this.labelRotation=_}afterCalculateLabelRotation(){Or(this.options.afterCalculateLabelRotation,[this])}beforeFit(){Or(this.options.beforeFit,[this])}fit(){const o={width:0,height:0},{chart:c,options:{ticks:d,title:m,grid:y}}=this,_=this._isVisible(),T=this.isHorizontal();if(_){const D=my(m,c.options.font);if(T?(o.width=this.maxWidth,o.height=Vf(y)+D):(o.height=this.maxHeight,o.width=Vf(y)+D),d.display&&this.ticks.length){const{first:U,last:Y,widest:Q,highest:fe}=this._getLabelSizes(),Te=d.padding*2,Ue=Co(this.labelRotation),it=Math.cos(Ue),vt=Math.sin(Ue);if(T){const Lt=d.mirror?0:vt*Q.width+it*fe.height;o.height=Math.min(this.maxHeight,o.height+Lt+Te)}else{const Lt=d.mirror?0:it*Q.width+vt*fe.height;o.width=Math.min(this.maxWidth,o.width+Lt+Te)}this._calculatePadding(U,Y,vt,it)}}this._handleMargins(),T?(this.width=this._length=c.width-this._margins.left-this._margins.right,this.height=o.height):(this.width=o.width,this.height=this._length=c.height-this._margins.top-this._margins.bottom)}_calculatePadding(o,c,d,m){const{ticks:{align:y,padding:_},position:T}=this.options,D=this.labelRotation!==0,U=T!=="top"&&this.axis==="x";if(this.isHorizontal()){const Y=this.getPixelForTick(0)-this.left,Q=this.right-this.getPixelForTick(this.ticks.length-1);let fe=0,Te=0;D?U?(fe=m*o.width,Te=d*c.height):(fe=d*o.height,Te=m*c.width):y==="start"?Te=c.width:y==="end"?fe=o.width:(fe=o.width/2,Te=c.width/2),this.paddingLeft=Math.max((fe-Y+_)*this.width/(this.width-Y),0),this.paddingRight=Math.max((Te-Q+_)*this.width/(this.width-Q),0)}else{let Y=c.height/2,Q=o.height/2;y==="start"?(Y=0,Q=o.height):y==="end"&&(Y=c.height,Q=0),this.paddingTop=Y+_,this.paddingBottom=Q+_}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Or(this.options.afterFit,[this])}isHorizontal(){const{axis:o,position:c}=this.options;return c==="top"||c==="bottom"||o==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(o){this.beforeTickToLabelConversion(),this.generateTickLabels(o);let c,d;for(c=0,d=o.length;c<d;c++)Dr(o[c].label)&&(o.splice(c,1),d--,c--);this.afterTickToLabelConversion()}_getLabelSizes(){let o=this._labelSizes;if(!o){const c=this.options.ticks.sampleSize;let d=this.ticks;c<d.length&&(d=py(d,c)),this._labelSizes=o=this._computeLabelSizes(d,d.length)}return o}_computeLabelSizes(o,c){const{ctx:d,_longestTextCache:m}=this,y=[],_=[];let T=0,D=0,U,Y,Q,fe,Te,Ue,it,vt,Lt,Vn,zn;for(U=0;U<c;++U){if(fe=o[U].label,Te=this._resolveTickFontOptions(U),d.font=Ue=Te.string,it=m[Ue]=m[Ue]||{data:{},gc:[]},vt=Te.lineHeight,Lt=Vn=0,!Dr(fe)&&!Tr(fe))Lt=_f(d,it.data,it.gc,Lt,fe),Vn=vt;else if(Tr(fe))for(Y=0,Q=fe.length;Y<Q;++Y)zn=fe[Y],!Dr(zn)&&!Tr(zn)&&(Lt=_f(d,it.data,it.gc,Lt,zn),Vn+=vt);y.push(Lt),_.push(Vn),T=Math.max(Lt,T),D=Math.max(Vn,D)}x_(m,c);const yn=y.indexOf(T),Wn=_.indexOf(D),pi=wi=>({width:y[wi]||0,height:_[wi]||0});return{first:pi(0),last:pi(c-1),widest:pi(yn),highest:pi(Wn),widths:y,heights:_}}getLabelForValue(o){return o}getPixelForValue(){return NaN}getValueForPixel(){}getPixelForTick(o){const c=this.ticks;return o<0||o>c.length-1?null:this.getPixelForValue(c[o].value)}getPixelForDecimal(o){this._reversePixels&&(o=1-o);const c=this._startPixel+o*this._length;return jv(this._alignToPixels?Ec(this.chart,c,0):c)}getDecimalForPixel(o){const c=(o-this._startPixel)/this._length;return this._reversePixels?1-c:c}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:o,max:c}=this;return o<0&&c<0?c:o>0&&c>0?o:0}getContext(o){const c=this.ticks||[];if(o>=0&&o<c.length){const d=c[o];return d.$context||(d.$context=b_(this.getContext(),o,d))}return this.$context||(this.$context=__(this.chart.getContext(),this))}_tickSize(){const o=this.options.ticks,c=Co(this.labelRotation),d=Math.abs(Math.cos(c)),m=Math.abs(Math.sin(c)),y=this._getLabelSizes(),_=o.autoSkipPadding||0,T=y?y.widest.width+_:0,D=y?y.highest.height+_:0;return this.isHorizontal()?D*d>T*m?T/d:D/m:D*m<T*d?D/d:T/m}_isVisible(){const o=this.options.display;return o!=="auto"?!!o:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(o){const c=this.axis,d=this.chart,m=this.options,{grid:y,position:_}=m,T=y.offset,D=this.isHorizontal(),Y=this.ticks.length+(T?1:0),Q=Vf(y),fe=[],Te=y.setContext(this.getContext()),Ue=Te.drawBorder?Te.borderWidth:0,it=Ue/2,vt=function(hr){return Ec(d,hr,Ue)};let Lt,Vn,zn,yn,Wn,pi,wi,Vi,Lr,Br,Rs,Gr;if(_==="top")Lt=vt(this.bottom),pi=this.bottom-Q,Vi=Lt-it,Br=vt(o.top)+it,Gr=o.bottom;else if(_==="bottom")Lt=vt(this.top),Br=o.top,Gr=vt(o.bottom)-it,pi=Lt+it,Vi=this.top+Q;else if(_==="left")Lt=vt(this.right),Wn=this.right-Q,wi=Lt-it,Lr=vt(o.left)+it,Rs=o.right;else if(_==="right")Lt=vt(this.left),Lr=o.left,Rs=vt(o.right)-it,Wn=Lt+it,wi=this.left+Q;else if(c==="x"){if(_==="center")Lt=vt((o.top+o.bottom)/2+.5);else if(ur(_)){const hr=Object.keys(_)[0],Yr=_[hr];Lt=vt(this.chart.scales[hr].getPixelForValue(Yr))}Br=o.top,Gr=o.bottom,pi=Lt+it,Vi=pi+Q}else if(c==="y"){if(_==="center")Lt=vt((o.left+o.right)/2);else if(ur(_)){const hr=Object.keys(_)[0],Yr=_[hr];Lt=vt(this.chart.scales[hr].getPixelForValue(Yr))}Wn=Lt-it,wi=Wn-Q,Lr=o.left,Rs=o.right}const pa=gr(m.ticks.maxTicksLimit,Y),Xa=Math.max(1,Math.ceil(Y/pa));for(Vn=0;Vn<Y;Vn+=Xa){const hr=y.setContext(this.getContext(Vn)),Yr=hr.lineWidth,Zf=hr.color,Pu=y.borderDash||[],Dh=hr.borderDashOffset,Mp=hr.tickWidth,Oh=hr.tickColor,Jf=hr.tickBorderDash||[],Ru=hr.tickBorderDashOffset;zn=y_(this,Vn,T),zn!==void 0&&(yn=Ec(d,zn,Yr),D?Wn=wi=Lr=Rs=yn:pi=Vi=Br=Gr=yn,fe.push({tx1:Wn,ty1:pi,tx2:wi,ty2:Vi,x1:Lr,y1:Br,x2:Rs,y2:Gr,width:Yr,color:Zf,borderDash:Pu,borderDashOffset:Dh,tickWidth:Mp,tickColor:Oh,tickBorderDash:Jf,tickBorderDashOffset:Ru}))}return this._ticksLength=Y,this._borderValue=Lt,fe}_computeLabelItems(o){const c=this.axis,d=this.options,{position:m,ticks:y}=d,_=this.isHorizontal(),T=this.ticks,{align:D,crossAlign:U,padding:Y,mirror:Q}=y,fe=Vf(d.grid),Te=fe+Y,Ue=Q?-Y:Te,it=-Co(this.labelRotation),vt=[];let Lt,Vn,zn,yn,Wn,pi,wi,Vi,Lr,Br,Rs,Gr,pa="middle";if(m==="top")pi=this.bottom-Ue,wi=this._getXAxisLabelAlignment();else if(m==="bottom")pi=this.top+Ue,wi=this._getXAxisLabelAlignment();else if(m==="left"){const hr=this._getYAxisLabelAlignment(fe);wi=hr.textAlign,Wn=hr.x}else if(m==="right"){const hr=this._getYAxisLabelAlignment(fe);wi=hr.textAlign,Wn=hr.x}else if(c==="x"){if(m==="center")pi=(o.top+o.bottom)/2+Te;else if(ur(m)){const hr=Object.keys(m)[0],Yr=m[hr];pi=this.chart.scales[hr].getPixelForValue(Yr)+Te}wi=this._getXAxisLabelAlignment()}else if(c==="y"){if(m==="center")Wn=(o.left+o.right)/2-Te;else if(ur(m)){const hr=Object.keys(m)[0],Yr=m[hr];Wn=this.chart.scales[hr].getPixelForValue(Yr)}wi=this._getYAxisLabelAlignment(fe).textAlign}c==="y"&&(D==="start"?pa="top":D==="end"&&(pa="bottom"));const Xa=this._getLabelSizes();for(Lt=0,Vn=T.length;Lt<Vn;++Lt){zn=T[Lt],yn=zn.label;const hr=y.setContext(this.getContext(Lt));Vi=this.getPixelForTick(Lt)+y.labelOffset,Lr=this._resolveTickFontOptions(Lt),Br=Lr.lineHeight,Rs=Tr(yn)?yn.length:1;const Yr=Rs/2,Zf=hr.color,Pu=hr.textStrokeColor,Dh=hr.textStrokeWidth;_?(Wn=Vi,m==="top"?U==="near"||it!==0?Gr=-Rs*Br+Br/2:U==="center"?Gr=-Xa.highest.height/2-Yr*Br+Br:Gr=-Xa.highest.height+Br/2:U==="near"||it!==0?Gr=Br/2:U==="center"?Gr=Xa.highest.height/2-Yr*Br:Gr=Xa.highest.height-Rs*Br,Q&&(Gr*=-1)):(pi=Vi,Gr=(1-Rs)*Br/2);let Mp;if(hr.showLabelBackdrop){const Oh=Ps(hr.backdropPadding),Jf=Xa.heights[Lt],Ru=Xa.widths[Lt];let $o=pi+Gr-Oh.top,Du=Wn-Oh.left;switch(pa){case"middle":$o-=Jf/2;break;case"bottom":$o-=Jf;break}switch(wi){case"center":Du-=Ru/2;break;case"right":Du-=Ru;break}Mp={left:Du,top:$o,width:Ru+Oh.width,height:Jf+Oh.height,color:hr.backdropColor}}vt.push({rotation:it,label:yn,font:Lr,color:Zf,strokeColor:Pu,strokeWidth:Dh,textOffset:Gr,textAlign:wi,textBaseline:pa,translation:[Wn,pi],backdrop:Mp})}return vt}_getXAxisLabelAlignment(){const{position:o,ticks:c}=this.options;if(-Co(this.labelRotation))return o==="top"?"left":"right";let m="center";return c.align==="start"?m="left":c.align==="end"&&(m="right"),m}_getYAxisLabelAlignment(o){const{position:c,ticks:{crossAlign:d,mirror:m,padding:y}}=this.options,_=this._getLabelSizes(),T=o+y,D=_.widest.width;let U,Y;return c==="left"?m?(Y=this.right+y,d==="near"?U="left":d==="center"?(U="center",Y+=D/2):(U="right",Y+=D)):(Y=this.right-T,d==="near"?U="right":d==="center"?(U="center",Y-=D/2):(U="left",Y=this.left)):c==="right"?m?(Y=this.left+y,d==="near"?U="right":d==="center"?(U="center",Y-=D/2):(U="left",Y-=D)):(Y=this.left+T,d==="near"?U="left":d==="center"?(U="center",Y+=D/2):(U="right",Y=this.right)):U="right",{textAlign:U,x:Y}}_computeLabelArea(){if(this.options.ticks.mirror)return;const o=this.chart,c=this.options.position;if(c==="left"||c==="right")return{top:0,left:this.left,bottom:o.height,right:this.right};if(c==="top"||c==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:o.width}}drawBackground(){const{ctx:o,options:{backgroundColor:c},left:d,top:m,width:y,height:_}=this;c&&(o.save(),o.fillStyle=c,o.fillRect(d,m,y,_),o.restore())}getLineWidthForValue(o){const c=this.options.grid;if(!this._isVisible()||!c.display)return 0;const m=this.ticks.findIndex(y=>y.value===o);return m>=0?c.setContext(this.getContext(m)).lineWidth:0}drawGrid(o){const c=this.options.grid,d=this.ctx,m=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(o));let y,_;const T=(D,U,Y)=>{!Y.width||!Y.color||(d.save(),d.lineWidth=Y.width,d.strokeStyle=Y.color,d.setLineDash(Y.borderDash||[]),d.lineDashOffset=Y.borderDashOffset,d.beginPath(),d.moveTo(D.x,D.y),d.lineTo(U.x,U.y),d.stroke(),d.restore())};if(c.display)for(y=0,_=m.length;y<_;++y){const D=m[y];c.drawOnChartArea&&T({x:D.x1,y:D.y1},{x:D.x2,y:D.y2},D),c.drawTicks&&T({x:D.tx1,y:D.ty1},{x:D.tx2,y:D.ty2},{color:D.tickColor,width:D.tickWidth,borderDash:D.tickBorderDash,borderDashOffset:D.tickBorderDashOffset})}}drawBorder(){const{chart:o,ctx:c,options:{grid:d}}=this,m=d.setContext(this.getContext()),y=d.drawBorder?m.borderWidth:0;if(!y)return;const _=d.setContext(this.getContext(0)).lineWidth,T=this._borderValue;let D,U,Y,Q;this.isHorizontal()?(D=Ec(o,this.left,y)-y/2,U=Ec(o,this.right,_)+_/2,Y=Q=T):(Y=Ec(o,this.top,y)-y/2,Q=Ec(o,this.bottom,_)+_/2,D=U=T),c.save(),c.lineWidth=m.borderWidth,c.strokeStyle=m.borderColor,c.beginPath(),c.moveTo(D,Y),c.lineTo(U,Q),c.stroke(),c.restore()}drawLabels(o){if(!this.options.ticks.display)return;const d=this.ctx,m=this._computeLabelArea();m&&wf(d,m);const y=this._labelItems||(this._labelItems=this._computeLabelItems(o));let _,T;for(_=0,T=y.length;_<T;++_){const D=y[_],U=D.font,Y=D.label;D.backdrop&&(d.fillStyle=D.backdrop.color,d.fillRect(D.backdrop.left,D.backdrop.top,D.backdrop.width,D.backdrop.height));let Q=D.textOffset;mo(d,Y,0,Q,U,D)}m&&Mf(d)}drawTitle(){const{ctx:o,options:{position:c,title:d,reverse:m}}=this;if(!d.display)return;const y=qs(d.font),_=Ps(d.padding),T=d.align;let D=y.lineHeight/2;c==="bottom"||c==="center"||ur(c)?(D+=_.bottom,Tr(d.text)&&(D+=y.lineHeight*(d.text.length-1))):D+=_.top;const{titleX:U,titleY:Y,maxWidth:Q,rotation:fe}=M_(this,D,c,T);mo(o,d.text,0,0,y,{color:d.color,maxWidth:Q,rotation:fe,textAlign:w_(T,c,m),textBaseline:"middle",translation:[U,Y]})}draw(o){!this._isVisible()||(this.drawBackground(),this.drawGrid(o),this.drawBorder(),this.drawTitle(),this.drawLabels(o))}_layers(){const o=this.options,c=o.ticks&&o.ticks.z||0,d=gr(o.grid&&o.grid.z,-1);return!this._isVisible()||this.draw!==Nc.prototype.draw?[{z:c,draw:m=>{this.draw(m)}}]:[{z:d,draw:m=>{this.drawBackground(),this.drawGrid(m),this.drawTitle()}},{z:d+1,draw:()=>{this.drawBorder()}},{z:c,draw:m=>{this.drawLabels(m)}}]}getMatchingVisibleMetas(o){const c=this.chart.getSortedVisibleDatasetMetas(),d=this.axis+"AxisID",m=[];let y,_;for(y=0,_=c.length;y<_;++y){const T=c[y];T[d]===this.id&&(!o||T.type===o)&&m.push(T)}return m}_resolveTickFontOptions(o){const c=this.options.ticks.setContext(this.getContext(o));return qs(c.font)}_maxDigits(){const o=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/o}}class op{constructor(o,c,d){this.type=o,this.scope=c,this.override=d,this.items=Object.create(null)}isForType(o){return Object.prototype.isPrototypeOf.call(this.type.prototype,o.prototype)}register(o){const c=Object.getPrototypeOf(o);let d;T_(c)&&(d=this.register(c));const m=this.items,y=o.id,_=this.scope+"."+y;if(!y)throw new Error("class does not have id: "+o);return y in m||(m[y]=o,S_(o,_,d),this.override&&Ir.override(o.id,o.overrides)),_}get(o){return this.items[o]}unregister(o){const c=this.items,d=o.id,m=this.scope;d in c&&delete c[d],m&&d in Ir[m]&&(delete Ir[m][d],this.override&&delete Sc[d])}}function S_(h,o,c){const d=dl(Object.create(null),[c?Ir.get(c):{},Ir.get(o),h.defaults]);Ir.set(o,d),h.defaultRoutes&&E_(o,h.defaultRoutes),h.descriptors&&Ir.describe(o,h.descriptors)}function E_(h,o){Object.keys(o).forEach(c=>{const d=c.split("."),m=d.pop(),y=[h].concat(d).join("."),_=o[c].split("."),T=_.pop(),D=_.join(".");Ir.route(y,m,D,T)})}function T_(h){return"id"in h&&"defaults"in h}var bl=new class{constructor(){this.controllers=new op(Ba,"datasets",!0),this.elements=new op(Pa,"elements"),this.plugins=new op(Object,"plugins"),this.scales=new op(Nc,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...h){this._each("register",h)}remove(...h){this._each("unregister",h)}addControllers(...h){this._each("register",h,this.controllers)}addElements(...h){this._each("register",h,this.elements)}addPlugins(...h){this._each("register",h,this.plugins)}addScales(...h){this._each("register",h,this.scales)}getController(h){return this._get(h,this.controllers,"controller")}getElement(h){return this._get(h,this.elements,"element")}getPlugin(h){return this._get(h,this.plugins,"plugin")}getScale(h){return this._get(h,this.scales,"scale")}removeControllers(...h){this._each("unregister",h,this.controllers)}removeElements(...h){this._each("unregister",h,this.elements)}removePlugins(...h){this._each("unregister",h,this.plugins)}removeScales(...h){this._each("unregister",h,this.scales)}_each(h,o,c){[...o].forEach(d=>{const m=c||this._getRegistryForType(d);c||m.isForType(d)||m===this.plugins&&d.id?this._exec(h,m,d):vr(d,y=>{const _=c||this._getRegistryForType(y);this._exec(h,_,y)})})}_exec(h,o,c){const d=Id(h);Or(c["before"+d],[],c),o[h](c),Or(c["after"+d],[],c)}_getRegistryForType(h){for(let o=0;o<this._typedRegistries.length;o++){const c=this._typedRegistries[o];if(c.isForType(h))return c}return this.plugins}_get(h,o,c){const d=o.get(h);if(d===void 0)throw new Error('"'+h+'" is not a registered '+c+".");return d}};class A_{constructor(){this._init=[]}notify(o,c,d,m){c==="beforeInit"&&(this._init=this._createDescriptors(o,!0),this._notify(this._init,o,"install"));const y=m?this._descriptors(o).filter(m):this._descriptors(o),_=this._notify(y,o,c,d);return c==="destroy"&&(this._notify(y,o,"stop"),this._notify(this._init,o,"uninstall")),_}_notify(o,c,d,m){m=m||{};for(const y of o){const _=y.plugin,T=_[d],D=[c,m,y.options];if(Or(T,D,_)===!1&&m.cancelable)return!1}return!0}invalidate(){Dr(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(o){if(this._cache)return this._cache;const c=this._cache=this._createDescriptors(o);return this._notifyStateChanges(o),c}_createDescriptors(o,c){const d=o&&o.config,m=gr(d.options&&d.options.plugins,{}),y=L_(d);return m===!1&&!c?[]:P_(o,y,m,c)}_notifyStateChanges(o){const c=this._oldCache||[],d=this._cache,m=(y,_)=>y.filter(T=>!_.some(D=>T.plugin.id===D.plugin.id));this._notify(m(c,d),o,"stop"),this._notify(m(d,c),o,"start")}}function L_(h){const o=[],c=Object.keys(bl.plugins.items);for(let m=0;m<c.length;m++)o.push(bl.getPlugin(c[m]));const d=h.plugins||[];for(let m=0;m<d.length;m++){const y=d[m];o.indexOf(y)===-1&&o.push(y)}return o}function C_(h,o){return!o&&h===!1?null:h===!0?{}:h}function P_(h,o,c,d){const m=[],y=h.getContext();for(let _=0;_<o.length;_++){const T=o[_],D=T.id,U=C_(c[D],d);U!==null&&m.push({plugin:T,options:R_(h.config,T,U,y)})}return m}function R_(h,o,c,d){const m=h.pluginScopeKeys(o),y=h.getOptionScopes(c,m);return h.createResolver(y,d,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function tg(h,o){const c=Ir.datasets[h]||{};return((o.datasets||{})[h]||{}).indexAxis||o.indexAxis||c.indexAxis||"x"}function D_(h,o){let c=h;return h==="_index_"?c=o:h==="_value_"&&(c=o==="x"?"y":"x"),c}function O_(h,o){return h===o?"_index_":"_value_"}function I_(h){if(h==="top"||h==="bottom")return"x";if(h==="left"||h==="right")return"y"}function ng(h,o){return h==="x"||h==="y"?h:o.axis||I_(o.position)||h.charAt(0).toLowerCase()}function N_(h,o){const c=Sc[h.type]||{scales:{}},d=o.scales||{},m=tg(h.type,o),y=Object.create(null),_=Object.create(null);return Object.keys(d).forEach(T=>{const D=d[T];if(!ur(D))return console.error(`Invalid scale configuration for scale: ${T}`);if(D._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${T}`);const U=ng(T,D),Y=O_(U,m),Q=c.scales||{};y[U]=y[U]||T,_[T]=oh(Object.create(null),[{axis:U},D,Q[U],Q[Y]])}),h.data.datasets.forEach(T=>{const D=T.type||h.type,U=T.indexAxis||tg(D,o),Q=(Sc[D]||{}).scales||{};Object.keys(Q).forEach(fe=>{const Te=D_(fe,U),Ue=T[Te+"AxisID"]||y[Te]||Te;_[Ue]=_[Ue]||Object.create(null),oh(_[Ue],[{axis:Te},d[Ue],Q[fe]])})}),Object.keys(_).forEach(T=>{const D=_[T];oh(D,[Ir.scales[D.type],Ir.scale])}),_}function gy(h){const o=h.options||(h.options={});o.plugins=gr(o.plugins,{}),o.scales=N_(h,o)}function vy(h){return h=h||{},h.datasets=h.datasets||[],h.labels=h.labels||[],h}function F_(h){return h=h||{},h.data=vy(h.data),gy(h),h}const yy=new Map,xy=new Set;function lp(h,o){let c=yy.get(h);return c||(c=o(),yy.set(h,c),xy.add(c)),c}const Wf=(h,o,c)=>{const d=Mc(o,c);d!==void 0&&h.add(d)};class B_{constructor(o){this._config=F_(o),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(o){this._config.type=o}get data(){return this._config.data}set data(o){this._config.data=vy(o)}get options(){return this._config.options}set options(o){this._config.options=o}get plugins(){return this._config.plugins}update(){const o=this._config;this.clearCache(),gy(o)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(o){return lp(o,()=>[[`datasets.${o}`,""]])}datasetAnimationScopeKeys(o,c){return lp(`${o}.transition.${c}`,()=>[[`datasets.${o}.transitions.${c}`,`transitions.${c}`],[`datasets.${o}`,""]])}datasetElementScopeKeys(o,c){return lp(`${o}-${c}`,()=>[[`datasets.${o}.elements.${c}`,`datasets.${o}`,`elements.${c}`,""]])}pluginScopeKeys(o){const c=o.id,d=this.type;return lp(`${d}-plugin-${c}`,()=>[[`plugins.${c}`,...o.additionalOptionScopes||[]]])}_cachedScopes(o,c){const d=this._scopeCache;let m=d.get(o);return(!m||c)&&(m=new Map,d.set(o,m)),m}getOptionScopes(o,c,d){const{options:m,type:y}=this,_=this._cachedScopes(o,d),T=_.get(c);if(T)return T;const D=new Set;c.forEach(Y=>{o&&(D.add(o),Y.forEach(Q=>Wf(D,o,Q))),Y.forEach(Q=>Wf(D,m,Q)),Y.forEach(Q=>Wf(D,Sc[y]||{},Q)),Y.forEach(Q=>Wf(D,Ir,Q)),Y.forEach(Q=>Wf(D,Nd,Q))});const U=Array.from(D);return U.length===0&&U.push(Object.create(null)),xy.has(c)&&_.set(c,U),U}chartOptionScopes(){const{options:o,type:c}=this;return[o,Sc[c]||{},Ir.datasets[c]||{},{type:c},Ir,Nd]}resolveNamedOptions(o,c,d,m=[""]){const y={$shared:!0},{resolver:_,subPrefixes:T}=_y(this._resolverCache,o,m);let D=_;if(z_(_,c)){y.$shared=!1,d=pl(d)?d():d;const U=this.createResolver(o,d,T);D=Gl(_,d,U)}for(const U of c)y[U]=D[U];return y}createResolver(o,c,d=[""],m){const{resolver:y}=_y(this._resolverCache,o,d);return ur(c)?Gl(y,c,void 0,m):y}}function _y(h,o,c){let d=h.get(o);d||(d=new Map,h.set(o,d));const m=c.join();let y=d.get(m);return y||(y={resolver:wu(o,c),subPrefixes:c.filter(T=>!T.toLowerCase().includes("hover"))},d.set(m,y)),y}const k_=h=>ur(h)&&Object.getOwnPropertyNames(h).reduce((o,c)=>o||pl(h[c]),!1);function z_(h,o){const{isScriptable:c,isIndexable:d}=Mu(h);for(const m of o){const y=c(m),_=d(m),T=(_||y)&&h[m];if(y&&(pl(T)||k_(T))||_&&Tr(T))return!0}return!1}const U_=["top","bottom","left","right","chartArea"];function by(h,o){return h==="top"||h==="bottom"||U_.indexOf(h)===-1&&o==="x"}function wy(h,o){return function(c,d){return c[h]===d[h]?c[o]-d[o]:c[h]-d[h]}}function My(h){const o=h.chart,c=o.options.animation;o.notifyPlugins("afterRender"),Or(c&&c.onComplete,[h],o)}function H_(h){const o=h.chart,c=o.options.animation;Or(c&&c.onProgress,[h],o)}function Sy(h){return Bm()&&typeof h=="string"?h=document.getElementById(h):h&&h.length&&(h=h[0]),h&&h.canvas&&(h=h.canvas),h}const cp={},Ey=h=>{const o=Sy(h);return Object.values(cp).filter(c=>c.canvas===o).pop()};class js{constructor(o,c){const d=this.config=new B_(c),m=Sy(o),y=Ey(m);if(y)throw new Error("Canvas is already in use. Chart with ID '"+y.id+"' must be destroyed before the canvas can be reused.");const _=d.createResolver(d.chartOptionScopes(),this.getContext());this.platform=new(d.platform||Dc(m)),this.platform.updateConfig(d);const T=this.platform.acquireContext(m,_.aspectRatio),D=T&&T.canvas,U=D&&D.height,Y=D&&D.width;if(this.id=kv(),this.ctx=T,this.canvas=D,this.width=Y,this.height=U,this._options=_,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new A_,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=_n(Q=>this.update(Q),_.resizeDelay||0),cp[this.id]=this,!T||!D){console.error("Failed to create chart: can't acquire context from the given item");return}$t.listen(this,"complete",My),$t.listen(this,"progress",H_),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:o,maintainAspectRatio:c},width:d,height:m,_aspectRatio:y}=this;return Dr(o)?c&&y?y:m?d/m:null:o}get data(){return this.config.data}set data(o){this.config.data=o}get options(){return this._options}set options(o){this.config.options=o}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():gu(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return Om(this.canvas,this.ctx),this}stop(){return $t.stop(this),this}resize(o,c){$t.running(this)?this._resizeBeforeDraw={width:o,height:c}:this._resize(o,c)}_resize(o,c){const d=this.options,m=this.canvas,y=d.maintainAspectRatio&&this.aspectRatio,_=this.platform.getMaximumSize(m,o,c,y),T=d.devicePixelRatio||this.platform.getDevicePixelRatio(),D=this.width?"resize":"attach";this.width=_.width,this.height=_.height,this._aspectRatio=this.aspectRatio,gu(this,T,!0)&&(this.notifyPlugins("resize",{size:_}),Or(d.onResize,[this,_],this),this.attached&&this._doResize(D)&&this.render())}ensureScalesHaveIDs(){const c=this.options.scales||{};vr(c,(d,m)=>{d.id=m})}buildOrUpdateScales(){const o=this.options,c=o.scales,d=this.scales,m=Object.keys(d).reduce((_,T)=>(_[T]=!1,_),{});let y=[];c&&(y=y.concat(Object.keys(c).map(_=>{const T=c[_],D=ng(_,T),U=D==="r",Y=D==="x";return{options:T,dposition:U?"chartArea":Y?"bottom":"left",dtype:U?"radialLinear":Y?"category":"linear"}}))),vr(y,_=>{const T=_.options,D=T.id,U=ng(D,T),Y=gr(T.type,_.dtype);(T.position===void 0||by(T.position,U)!==by(_.dposition))&&(T.position=_.dposition),m[D]=!0;let Q=null;if(D in d&&d[D].type===Y)Q=d[D];else{const fe=bl.getScale(Y);Q=new fe({id:D,type:Y,ctx:this.ctx,chart:this}),d[Q.id]=Q}Q.init(T,o)}),vr(m,(_,T)=>{_||delete d[T]}),vr(d,_=>{da.configure(this,_,_.options),da.addBox(this,_)})}_updateMetasets(){const o=this._metasets,c=this.data.datasets.length,d=o.length;if(o.sort((m,y)=>m.index-y.index),d>c){for(let m=c;m<d;++m)this._destroyDatasetMeta(m);o.splice(c,d-c)}this._sortedMetasets=o.slice(0).sort(wy("order","index"))}_removeUnreferencedMetasets(){const{_metasets:o,data:{datasets:c}}=this;o.length>c.length&&delete this._stacks,o.forEach((d,m)=>{c.filter(y=>y===d._dataset).length===0&&this._destroyDatasetMeta(m)})}buildOrUpdateControllers(){const o=[],c=this.data.datasets;let d,m;for(this._removeUnreferencedMetasets(),d=0,m=c.length;d<m;d++){const y=c[d];let _=this.getDatasetMeta(d);const T=y.type||this.config.type;if(_.type&&_.type!==T&&(this._destroyDatasetMeta(d),_=this.getDatasetMeta(d)),_.type=T,_.indexAxis=y.indexAxis||tg(T,this.options),_.order=y.order||0,_.index=d,_.label=""+y.label,_.visible=this.isDatasetVisible(d),_.controller)_.controller.updateIndex(d),_.controller.linkScales();else{const D=bl.getController(T),{datasetElementType:U,dataElementType:Y}=Ir.datasets[T];Object.assign(D.prototype,{dataElementType:bl.getElement(Y),datasetElementType:U&&bl.getElement(U)}),_.controller=new D(this,d),o.push(_.controller)}}return this._updateMetasets(),o}_resetElements(){vr(this.data.datasets,(o,c)=>{this.getDatasetMeta(c).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(o){const c=this.config;c.update();const d=this._options=c.createResolver(c.chartOptionScopes(),this.getContext());vr(this.scales,U=>{da.removeBox(this,U)});const m=this._animationsDisabled=!d.animation;this.ensureScalesHaveIDs(),this.buildOrUpdateScales();const y=new Set(Object.keys(this._listeners)),_=new Set(d.events);if((!Am(y,_)||!!this._responsiveListeners!==d.responsive)&&(this.unbindEvents(),this.bindEvents()),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:o,cancelable:!0})===!1)return;const T=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let D=0;for(let U=0,Y=this.data.datasets.length;U<Y;U++){const{controller:Q}=this.getDatasetMeta(U),fe=!m&&T.indexOf(Q)===-1;Q.buildOrUpdateElements(fe),D=Math.max(+Q.getMaxOverflow(),D)}D=this._minPadding=d.layout.autoPadding?D:0,this._updateLayout(D),m||vr(T,U=>{U.reset()}),this._updateDatasets(o),this.notifyPlugins("afterUpdate",{mode:o}),this._layers.sort(wy("z","_idx")),this._lastEvent&&this._eventHandler(this._lastEvent,!0),this.render()}_updateLayout(o){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;da.update(this,this.width,this.height,o);const c=this.chartArea,d=c.width<=0||c.height<=0;this._layers=[],vr(this.boxes,m=>{d&&m.position==="chartArea"||(m.configure&&m.configure(),this._layers.push(...m._layers()))},this),this._layers.forEach((m,y)=>{m._idx=y}),this.notifyPlugins("afterLayout")}_updateDatasets(o){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:o,cancelable:!0})!==!1){for(let c=0,d=this.data.datasets.length;c<d;++c)this._updateDataset(c,pl(o)?o({datasetIndex:c}):o);this.notifyPlugins("afterDatasetsUpdate",{mode:o})}}_updateDataset(o,c){const d=this.getDatasetMeta(o),m={meta:d,index:o,mode:c,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",m)!==!1&&(d.controller._update(c),m.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",m))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&($t.has(this)?this.attached&&!$t.running(this)&&$t.start(this):(this.draw(),My({chart:this})))}draw(){let o;if(this._resizeBeforeDraw){const{width:d,height:m}=this._resizeBeforeDraw;this._resize(d,m),this._resizeBeforeDraw=null}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const c=this._layers;for(o=0;o<c.length&&c[o].z<=0;++o)c[o].draw(this.chartArea);for(this._drawDatasets();o<c.length;++o)c[o].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(o){const c=this._sortedMetasets,d=[];let m,y;for(m=0,y=c.length;m<y;++m){const _=c[m];(!o||_.visible)&&d.push(_)}return d}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const o=this.getSortedVisibleDatasetMetas();for(let c=o.length-1;c>=0;--c)this._drawDataset(o[c]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(o){const c=this.ctx,d=o._clip,m=!d.disabled,y=this.chartArea,_={meta:o,index:o.index,cancelable:!0};this.notifyPlugins("beforeDatasetDraw",_)!==!1&&(m&&wf(c,{left:d.left===!1?0:y.left-d.left,right:d.right===!1?this.width:y.right+d.right,top:d.top===!1?0:y.top-d.top,bottom:d.bottom===!1?this.height:y.bottom+d.bottom}),o.controller.draw(),m&&Mf(c),_.cancelable=!1,this.notifyPlugins("afterDatasetDraw",_))}getElementsAtEventForMode(o,c,d,m){const y=gs.modes[c];return typeof y=="function"?y(this,o,d,m):[]}getDatasetMeta(o){const c=this.data.datasets[o],d=this._metasets;let m=d.filter(y=>y&&y._dataset===c).pop();return m||(m={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:c&&c.order||0,index:o,_dataset:c,_parsed:[],_sorted:!1},d.push(m)),m}getContext(){return this.$context||(this.$context=jo(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(o){const c=this.data.datasets[o];if(!c)return!1;const d=this.getDatasetMeta(o);return typeof d.hidden=="boolean"?!d.hidden:!c.hidden}setDatasetVisibility(o,c){const d=this.getDatasetMeta(o);d.hidden=!c}toggleDataVisibility(o){this._hiddenIndices[o]=!this._hiddenIndices[o]}getDataVisibility(o){return!this._hiddenIndices[o]}_updateVisibility(o,c,d){const m=d?"show":"hide",y=this.getDatasetMeta(o),_=y.controller._resolveAnimations(void 0,m);fo(c)?(y.data[c].hidden=!d,this.update()):(this.setDatasetVisibility(o,d),_.update(y,{visible:d}),this.update(T=>T.datasetIndex===o?m:void 0))}hide(o,c){this._updateVisibility(o,c,!1)}show(o,c){this._updateVisibility(o,c,!0)}_destroyDatasetMeta(o){const c=this._metasets[o];c&&c.controller&&c.controller._destroy(),delete this._metasets[o]}_stop(){let o,c;for(this.stop(),$t.remove(this),o=0,c=this.data.datasets.length;o<c;++o)this._destroyDatasetMeta(o)}destroy(){const{canvas:o,ctx:c}=this;this._stop(),this.config.clearCache(),o&&(this.unbindEvents(),Om(o,c),this.platform.releaseContext(c),this.canvas=null,this.ctx=null),this.notifyPlugins("destroy"),delete cp[this.id]}toBase64Image(...o){return this.canvas.toDataURL(...o)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const o=this._listeners,c=this.platform,d=(y,_)=>{c.addEventListener(this,y,_),o[y]=_},m=(y,_,T)=>{y.offsetX=_,y.offsetY=T,this._eventHandler(y)};vr(this.options.events,y=>d(y,m))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const o=this._responsiveListeners,c=this.platform,d=(D,U)=>{c.addEventListener(this,D,U),o[D]=U},m=(D,U)=>{o[D]&&(c.removeEventListener(this,D,U),delete o[D])},y=(D,U)=>{this.canvas&&this.resize(D,U)};let _;const T=()=>{m("attach",T),this.attached=!0,this.resize(),d("resize",y),d("detach",_)};_=()=>{this.attached=!1,m("resize",y),this._stop(),this._resize(0,0),d("attach",T)},c.isAttached(this.canvas)?T():_()}unbindEvents(){vr(this._listeners,(o,c)=>{this.platform.removeEventListener(this,c,o)}),this._listeners={},vr(this._responsiveListeners,(o,c)=>{this.platform.removeEventListener(this,c,o)}),this._responsiveListeners=void 0}updateHoverStyle(o,c,d){const m=d?"set":"remove";let y,_,T,D;for(c==="dataset"&&(y=this.getDatasetMeta(o[0].datasetIndex),y.controller["_"+m+"DatasetHoverStyle"]()),T=0,D=o.length;T<D;++T){_=o[T];const U=_&&this.getDatasetMeta(_.datasetIndex).controller;U&&U[m+"HoverStyle"](_.element,_.datasetIndex,_.index)}}getActiveElements(){return this._active||[]}setActiveElements(o){const c=this._active||[],d=o.map(({datasetIndex:y,index:_})=>{const T=this.getDatasetMeta(y);if(!T)throw new Error("No dataset found at index "+y);return{datasetIndex:y,element:T.data[_],index:_}});!vf(d,c)&&(this._active=d,this._updateHoverStyles(d,c))}notifyPlugins(o,c,d){return this._plugins.notify(this,o,c,d)}_updateHoverStyles(o,c,d){const m=this.options.hover,y=(D,U)=>D.filter(Y=>!U.some(Q=>Y.datasetIndex===Q.datasetIndex&&Y.index===Q.index)),_=y(c,o),T=d?o:y(o,c);_.length&&this.updateHoverStyle(_,m.mode,!1),T.length&&m.mode&&this.updateHoverStyle(T,m.mode,!0)}_eventHandler(o,c){const d={event:o,replay:c,cancelable:!0},m=_=>(_.options.events||this.options.events).includes(o.native.type);if(this.notifyPlugins("beforeEvent",d,m)===!1)return;const y=this._handleEvent(o,c);return d.cancelable=!1,this.notifyPlugins("afterEvent",d,m),(y||d.changed)&&this.render(),this}_handleEvent(o,c){const{_active:d=[],options:m}=this,y=m.hover;let _=[],T=!1,D=null;return o.type!=="mouseout"&&(_=this.getElementsAtEventForMode(o,y.mode,y,c),D=o.type==="click"?this._lastEvent:o),this._lastEvent=null,Tc(o,this.chartArea,this._minPadding)&&(Or(m.onHover,[o,_,this],this),(o.type==="mouseup"||o.type==="click"||o.type==="contextmenu")&&Or(m.onClick,[o,_,this],this)),T=!vf(_,d),(T||c)&&(this._active=_,this._updateHoverStyles(_,d,c)),this._lastEvent=D,T}}const Ty=()=>vr(js.instances,h=>h._plugins.invalidate()),Fc=!0;Object.defineProperties(js,{defaults:{enumerable:Fc,value:Ir},instances:{enumerable:Fc,value:cp},overrides:{enumerable:Fc,value:Sc},registry:{enumerable:Fc,value:bl},version:{enumerable:Fc,value:"3.6.0"},getChart:{enumerable:Fc,value:Ey},register:{enumerable:Fc,value:(...h)=>{bl.add(...h),Ty()}},unregister:{enumerable:Fc,value:(...h)=>{bl.remove(...h),Ty()}}});function Cu(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class ig{constructor(o){this.options=o||{}}formats(){return Cu()}parse(){return Cu()}format(){return Cu()}add(){return Cu()}diff(){return Cu()}startOf(){return Cu()}endOf(){return Cu()}}ig.override=function(h){Object.assign(ig.prototype,h)};var Ay={_date:ig};function G_(h,o){if(!h._cache.$bar){const c=h.getMatchingVisibleMetas(o);let d=[];for(let m=0,y=c.length;m<y;m++)d=d.concat(c[m].controller.getAllParsedValues(h));h._cache.$bar=ph(d.sort((m,y)=>m-y))}return h._cache.$bar}function V_(h){const o=h.iScale,c=G_(o,h.type);let d=o._length,m,y,_,T;const D=()=>{_===32767||_===-32768||(fo(T)&&(d=Math.min(d,Math.abs(_-T)||d)),T=_)};for(m=0,y=c.length;m<y;++m)_=o.getPixelForValue(c[m]),D();for(T=void 0,m=0,y=o.ticks.length;m<y;++m)_=o.getPixelForTick(m),D();return d}function W_(h,o,c,d){const m=c.barThickness;let y,_;return Dr(m)?(y=o.min*c.categoryPercentage,_=c.barPercentage):(y=m*d,_=1),{chunk:y/d,ratio:_,start:o.pixels[h]-y/2}}function X_(h,o,c,d){const m=o.pixels,y=m[h];let _=h>0?m[h-1]:null,T=h<m.length-1?m[h+1]:null;const D=c.categoryPercentage;_===null&&(_=y-(T===null?o.end-o.start:T-y)),T===null&&(T=y+y-_);const U=y-(y-Math.min(_,T))/2*D;return{chunk:Math.abs(T-_)/2*D/d,ratio:c.barPercentage,start:U}}function q_(h,o,c,d){const m=c.parse(h[0],d),y=c.parse(h[1],d),_=Math.min(m,y),T=Math.max(m,y);let D=_,U=T;Math.abs(_)>Math.abs(T)&&(D=T,U=_),o[c.axis]=U,o._custom={barStart:D,barEnd:U,start:m,end:y,min:_,max:T}}function Ly(h,o,c,d){return Tr(h)?q_(h,o,c,d):o[c.axis]=c.parse(h,d),o}function Cy(h,o,c,d){const m=h.iScale,y=h.vScale,_=m.getLabels(),T=[];let D,U,Y,Q;for(D=c,U=c+d;D<U;++D)Q=o[D],Y={},Y[m.axis]=m===y||m.parse(_[D],D),T.push(Ly(Q,Y,y,D));return T}function rg(h){return h&&h.barStart!==void 0&&h.barEnd!==void 0}function j_(h,o,c){return h!==0?Xo(h):(o.isHorizontal()?1:-1)*(o.min>=c?1:-1)}function Y_(h){let o,c,d,m,y;return h.horizontal?(o=h.base>h.x,c="left",d="right"):(o=h.base<h.y,c="bottom",d="top"),o?(m="end",y="start"):(m="start",y="end"),{start:c,end:d,reverse:o,top:m,bottom:y}}function Z_(h,o,c,d){let m=o.borderSkipped;const y={};if(!m){h.borderSkipped=y;return}const{start:_,end:T,reverse:D,top:U,bottom:Y}=Y_(h);m==="middle"&&c&&(h.enableBorderRadius=!0,(c._top||0)===d?m=U:(c._bottom||0)===d?m=Y:(y[Py(Y,_,T,D)]=!0,m=U)),y[Py(m,_,T,D)]=!0,h.borderSkipped=y}function Py(h,o,c,d){return d?(h=J_(h,o,c),h=Ry(h,c,o)):h=Ry(h,o,c),h}function J_(h,o,c){return h===o?c:h===c?o:h}function Ry(h,o,c){return h==="start"?o:h==="end"?c:h}function $_(h,{inflateAmount:o},c){h.inflateAmount=o==="auto"?c===1?.33:0:o}class up extends Ba{parsePrimitiveData(o,c,d,m){return Cy(o,c,d,m)}parseArrayData(o,c,d,m){return Cy(o,c,d,m)}parseObjectData(o,c,d,m){const{iScale:y,vScale:_}=o,{xAxisKey:T="x",yAxisKey:D="y"}=this._parsing,U=y.axis==="x"?T:D,Y=_.axis==="x"?T:D,Q=[];let fe,Te,Ue,it;for(fe=d,Te=d+m;fe<Te;++fe)it=c[fe],Ue={},Ue[y.axis]=y.parse(Mc(it,U),fe),Q.push(Ly(Mc(it,Y),Ue,_,fe));return Q}updateRangeFromParsed(o,c,d,m){super.updateRangeFromParsed(o,c,d,m);const y=d._custom;y&&c===this._cachedMeta.vScale&&(o.min=Math.min(o.min,y.min),o.max=Math.max(o.max,y.max))}getMaxOverflow(){return 0}getLabelAndValue(o){const c=this._cachedMeta,{iScale:d,vScale:m}=c,y=this.getParsed(o),_=y._custom,T=rg(_)?"["+_.start+", "+_.end+"]":""+m.getLabelForValue(y[m.axis]);return{label:""+d.getLabelForValue(y[d.axis]),value:T}}initialize(){this.enableOptionSharing=!0,super.initialize();const o=this._cachedMeta;o.stack=this.getDataset().stack}update(o){const c=this._cachedMeta;this.updateElements(c.data,0,c.data.length,o)}updateElements(o,c,d,m){const{index:y,_cachedMeta:{vScale:_}}=this,T=_.getBasePixel(),D=_.isHorizontal(),U=this._getRuler(),Y=this.resolveDataElementOptions(c,m),Q=this.getSharedOptions(Y),fe=this.includeOptions(m,Q);this.updateSharedOptions(Q,m,Y);for(let Te=c;Te<c+d;Te++){const Ue=this.getParsed(Te),it=m==="reset"||Dr(Ue[_.axis])?{base:T,head:T}:this._calculateBarValuePixels(Te),vt=this._calculateBarIndexPixels(Te,U),Lt=(Ue._stacks||{})[_.axis],Vn={horizontal:D,base:it.base,enableBorderRadius:!Lt||rg(Ue._custom)||y===Lt._top||y===Lt._bottom,x:D?it.head:vt.center,y:D?vt.center:it.head,height:D?vt.size:Math.abs(it.size),width:D?Math.abs(it.size):vt.size};fe&&(Vn.options=Q||this.resolveDataElementOptions(Te,o[Te].active?"active":m));const zn=Vn.options||o[Te].options;Z_(Vn,zn,Lt,y),$_(Vn,zn,U.ratio),this.updateElement(o[Te],Te,Vn,m)}}_getStacks(o,c){const m=this._cachedMeta.iScale,y=m.getMatchingVisibleMetas(this._type),_=m.options.stacked,T=y.length,D=[];let U,Y;for(U=0;U<T;++U)if(Y=y[U],!!Y.controller.options.grouped){if(typeof c<"u"){const Q=Y.controller.getParsed(c)[Y.controller._cachedMeta.vScale.axis];if(Dr(Q)||isNaN(Q))continue}if((_===!1||D.indexOf(Y.stack)===-1||_===void 0&&Y.stack===void 0)&&D.push(Y.stack),Y.index===o)break}return D.length||D.push(void 0),D}_getStackCount(o){return this._getStacks(void 0,o).length}_getStackIndex(o,c,d){const m=this._getStacks(o,d),y=c!==void 0?m.indexOf(c):-1;return y===-1?m.length-1:y}_getRuler(){const o=this.options,c=this._cachedMeta,d=c.iScale,m=[];let y,_;for(y=0,_=c.data.length;y<_;++y)m.push(d.getPixelForValue(this.getParsed(y)[d.axis],y));const T=o.barThickness;return{min:T||V_(c),pixels:m,start:d._startPixel,end:d._endPixel,stackCount:this._getStackCount(),scale:d,grouped:o.grouped,ratio:T?1:o.categoryPercentage*o.barPercentage}}_calculateBarValuePixels(o){const{_cachedMeta:{vScale:c,_stacked:d},options:{base:m,minBarLength:y}}=this,_=m||0,T=this.getParsed(o),D=T._custom,U=rg(D);let Y=T[c.axis],Q=0,fe=d?this.applyStack(c,T,d):Y,Te,Ue;fe!==Y&&(Q=fe-Y,fe=Y),U&&(Y=D.barStart,fe=D.barEnd-D.barStart,Y!==0&&Xo(Y)!==Xo(D.barEnd)&&(Q=0),Q+=Y);const it=!Dr(m)&&!U?m:Q;let vt=c.getPixelForValue(it);if(this.chart.getDataVisibility(o)?Te=c.getPixelForValue(Q+fe):Te=vt,Ue=Te-vt,Math.abs(Ue)<y&&(Ue=j_(Ue,c,_)*y,Y===_&&(vt-=Ue/2),Te=vt+Ue),vt===c.getPixelForValue(_)){const Lt=Xo(Ue)*c.getLineWidthForValue(_)/2;vt+=Lt,Ue-=Lt}return{size:Ue,base:vt,head:Te,center:Te+Ue/2}}_calculateBarIndexPixels(o,c){const d=c.scale,m=this.options,y=m.skipNull,_=gr(m.maxBarThickness,1/0);let T,D;if(c.grouped){const U=y?this._getStackCount(o):c.stackCount,Y=m.barThickness==="flex"?X_(o,c,m,U):W_(o,c,m,U),Q=this._getStackIndex(this.index,this._cachedMeta.stack,y?o:void 0);T=Y.start+Y.chunk*Q+Y.chunk/2,D=Math.min(_,Y.chunk*Y.ratio)}else T=d.getPixelForValue(this.getParsed(o)[d.axis],o),D=Math.min(_,c.min*c.ratio);return{base:T-D/2,head:T+D/2,center:T,size:D}}draw(){const o=this._cachedMeta,c=o.vScale,d=o.data,m=d.length;let y=0;for(;y<m;++y)this.getParsed(y)[c.axis]!==null&&d[y].draw(this._ctx)}}up.id="bar",up.defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}},up.overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};class hp extends Ba{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(o,c,d,m){const y=super.parsePrimitiveData(o,c,d,m);for(let _=0;_<y.length;_++)y[_]._custom=this.resolveDataElementOptions(_+d).radius;return y}parseArrayData(o,c,d,m){const y=super.parseArrayData(o,c,d,m);for(let _=0;_<y.length;_++){const T=c[d+_];y[_]._custom=gr(T[2],this.resolveDataElementOptions(_+d).radius)}return y}parseObjectData(o,c,d,m){const y=super.parseObjectData(o,c,d,m);for(let _=0;_<y.length;_++){const T=c[d+_];y[_]._custom=gr(T&&T.r&&+T.r,this.resolveDataElementOptions(_+d).radius)}return y}getMaxOverflow(){const o=this._cachedMeta.data;let c=0;for(let d=o.length-1;d>=0;--d)c=Math.max(c,o[d].size(this.resolveDataElementOptions(d))/2);return c>0&&c}getLabelAndValue(o){const c=this._cachedMeta,{xScale:d,yScale:m}=c,y=this.getParsed(o),_=d.getLabelForValue(y.x),T=m.getLabelForValue(y.y),D=y._custom;return{label:c.label,value:"("+_+", "+T+(D?", "+D:"")+")"}}update(o){const c=this._cachedMeta.data;this.updateElements(c,0,c.length,o)}updateElements(o,c,d,m){const y=m==="reset",{iScale:_,vScale:T}=this._cachedMeta,D=this.resolveDataElementOptions(c,m),U=this.getSharedOptions(D),Y=this.includeOptions(m,U),Q=_.axis,fe=T.axis;for(let Te=c;Te<c+d;Te++){const Ue=o[Te],it=!y&&this.getParsed(Te),vt={},Lt=vt[Q]=y?_.getPixelForDecimal(.5):_.getPixelForValue(it[Q]),Vn=vt[fe]=y?T.getBasePixel():T.getPixelForValue(it[fe]);vt.skip=isNaN(Lt)||isNaN(Vn),Y&&(vt.options=this.resolveDataElementOptions(Te,Ue.active?"active":m),y&&(vt.options.radius=0)),this.updateElement(Ue,Te,vt,m)}this.updateSharedOptions(U,m,D)}resolveDataElementOptions(o,c){const d=this.getParsed(o);let m=super.resolveDataElementOptions(o,c);m.$shared&&(m=Object.assign({},m,{$shared:!1}));const y=m.radius;return c!=="active"&&(m.radius=0),m.radius+=gr(d&&d._custom,y),m}}hp.id="bubble",hp.defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}},hp.overrides={scales:{x:{type:"linear"},y:{type:"linear"}},plugins:{tooltip:{callbacks:{title(){return""}}}}};function K_(h,o,c){let d=1,m=1,y=0,_=0;if(o<us){const T=h,D=T+o,U=Math.cos(T),Y=Math.sin(T),Q=Math.cos(D),fe=Math.sin(D),Te=(zn,yn,Wn)=>xf(zn,T,D,!0)?1:Math.max(yn,yn*c,Wn,Wn*c),Ue=(zn,yn,Wn)=>xf(zn,T,D,!0)?-1:Math.min(yn,yn*c,Wn,Wn*c),it=Te(0,U,Q),vt=Te(Xs,Y,fe),Lt=Ue(Cs,U,Q),Vn=Ue(Cs+Xs,Y,fe);d=(it-Lt)/2,m=(vt-Vn)/2,y=-(it+Lt)/2,_=-(vt+Vn)/2}return{ratioX:d,ratioY:m,offsetX:y,offsetY:_}}class Sh extends Ba{constructor(o,c){super(o,c),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(o,c){const d=this.getDataset().data,m=this._cachedMeta;if(this._parsing===!1)m._parsed=d;else{let y=D=>+d[D];if(ur(d[o])){const{key:D="value"}=this._parsing;y=U=>+Mc(d[U],D)}let _,T;for(_=o,T=o+c;_<T;++_)m._parsed[_]=y(_)}}_getRotation(){return Co(this.options.rotation-90)}_getCircumference(){return Co(this.options.circumference)}_getRotationExtents(){let o=us,c=-us;for(let d=0;d<this.chart.data.datasets.length;++d)if(this.chart.isDatasetVisible(d)){const m=this.chart.getDatasetMeta(d).controller,y=m._getRotation(),_=m._getCircumference();o=Math.min(o,y),c=Math.max(c,y+_)}return{rotation:o,circumference:c-o}}update(o){const c=this.chart,{chartArea:d}=c,m=this._cachedMeta,y=m.data,_=this.getMaxBorderWidth()+this.getMaxOffset(y)+this.options.spacing,T=Math.max((Math.min(d.width,d.height)-_)/2,0),D=Math.min(ah(this.options.cutout,T),1),U=this._getRingWeight(this.index),{circumference:Y,rotation:Q}=this._getRotationExtents(),{ratioX:fe,ratioY:Te,offsetX:Ue,offsetY:it}=K_(Q,Y,D),vt=(d.width-_)/fe,Lt=(d.height-_)/Te,Vn=Math.max(Math.min(vt,Lt)/2,0),zn=Tm(this.options.radius,Vn),yn=Math.max(zn*D,0),Wn=(zn-yn)/this._getVisibleDatasetWeightTotal();this.offsetX=Ue*zn,this.offsetY=it*zn,m.total=this.calculateTotal(),this.outerRadius=zn-Wn*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-Wn*U,0),this.updateElements(y,0,y.length,o)}_circumference(o,c){const d=this.options,m=this._cachedMeta,y=this._getCircumference();return c&&d.animation.animateRotate||!this.chart.getDataVisibility(o)||m._parsed[o]===null||m.data[o].hidden?0:this.calculateCircumference(m._parsed[o]*y/us)}updateElements(o,c,d,m){const y=m==="reset",_=this.chart,T=_.chartArea,U=_.options.animation,Y=(T.left+T.right)/2,Q=(T.top+T.bottom)/2,fe=y&&U.animateScale,Te=fe?0:this.innerRadius,Ue=fe?0:this.outerRadius,it=this.resolveDataElementOptions(c,m),vt=this.getSharedOptions(it),Lt=this.includeOptions(m,vt);let Vn=this._getRotation(),zn;for(zn=0;zn<c;++zn)Vn+=this._circumference(zn,y);for(zn=c;zn<c+d;++zn){const yn=this._circumference(zn,y),Wn=o[zn],pi={x:Y+this.offsetX,y:Q+this.offsetY,startAngle:Vn,endAngle:Vn+yn,circumference:yn,outerRadius:Ue,innerRadius:Te};Lt&&(pi.options=vt||this.resolveDataElementOptions(zn,Wn.active?"active":m)),Vn+=yn,this.updateElement(Wn,zn,pi,m)}this.updateSharedOptions(vt,m,it)}calculateTotal(){const o=this._cachedMeta,c=o.data;let d=0,m;for(m=0;m<c.length;m++){const y=o._parsed[m];y!==null&&!isNaN(y)&&this.chart.getDataVisibility(m)&&!c[m].hidden&&(d+=Math.abs(y))}return d}calculateCircumference(o){const c=this._cachedMeta.total;return c>0&&!isNaN(o)?us*(Math.abs(o)/c):0}getLabelAndValue(o){const c=this._cachedMeta,d=this.chart,m=d.data.labels||[],y=Yo(c._parsed[o],d.options.locale);return{label:m[o]||"",value:y}}getMaxBorderWidth(o){let c=0;const d=this.chart;let m,y,_,T,D;if(!o){for(m=0,y=d.data.datasets.length;m<y;++m)if(d.isDatasetVisible(m)){_=d.getDatasetMeta(m),o=_.data,T=_.controller,T!==this&&T.configure();break}}if(!o)return 0;for(m=0,y=o.length;m<y;++m)D=T.resolveDataElementOptions(m),D.borderAlign!=="inner"&&(c=Math.max(c,D.borderWidth||0,D.hoverBorderWidth||0));return c}getMaxOffset(o){let c=0;for(let d=0,m=o.length;d<m;++d){const y=this.resolveDataElementOptions(d);c=Math.max(c,y.offset||0,y.hoverOffset||0)}return c}_getRingWeightOffset(o){let c=0;for(let d=0;d<o;++d)this.chart.isDatasetVisible(d)&&(c+=this._getRingWeight(d));return c}_getRingWeight(o){return Math.max(gr(this.chart.data.datasets[o].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}Sh.id="doughnut",Sh.defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"},Sh.descriptors={_scriptable:h=>h!=="spacing",_indexable:h=>h!=="spacing"},Sh.overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(h){const o=h.data;if(o.labels.length&&o.datasets.length){const{labels:{pointStyle:c}}=h.legend.options;return o.labels.map((d,m)=>{const _=h.getDatasetMeta(0).controller.getStyle(m);return{text:d,fillStyle:_.backgroundColor,strokeStyle:_.borderColor,lineWidth:_.borderWidth,pointStyle:c,hidden:!h.getDataVisibility(m),index:m}})}return[]}},onClick(h,o,c){c.chart.toggleDataVisibility(o.index),c.chart.update()}},tooltip:{callbacks:{title(){return""},label(h){let o=h.label;const c=": "+h.formattedValue;return Tr(o)?(o=o.slice(),o[0]+=c):o+=c,o}}}}};class Xf extends Ba{initialize(){this.enableOptionSharing=!0,super.initialize()}update(o){const c=this._cachedMeta,{dataset:d,data:m=[],_dataset:y}=c,_=this.chart._animationsDisabled;let{start:T,count:D}=Q_(c,m,_);this._drawStart=T,this._drawCount=D,eb(c)&&(T=0,D=m.length),d._chart=this.chart,d._datasetIndex=this.index,d._decimated=!!y._decimated,d.points=m;const U=this.resolveDatasetElementOptions(o);this.options.showLine||(U.borderWidth=0),U.segment=this.options.segment,this.updateElement(d,void 0,{animated:!_,options:U},o),this.updateElements(m,T,D,o)}updateElements(o,c,d,m){const y=m==="reset",{iScale:_,vScale:T,_stacked:D,_dataset:U}=this._cachedMeta,Y=this.resolveDataElementOptions(c,m),Q=this.getSharedOptions(Y),fe=this.includeOptions(m,Q),Te=_.axis,Ue=T.axis,{spanGaps:it,segment:vt}=this.options,Lt=fu(it)?it:Number.POSITIVE_INFINITY,Vn=this.chart._animationsDisabled||y||m==="none";let zn=c>0&&this.getParsed(c-1);for(let yn=c;yn<c+d;++yn){const Wn=o[yn],pi=this.getParsed(yn),wi=Vn?Wn:{},Vi=Dr(pi[Ue]),Lr=wi[Te]=_.getPixelForValue(pi[Te],yn),Br=wi[Ue]=y||Vi?T.getBasePixel():T.getPixelForValue(D?this.applyStack(T,pi,D):pi[Ue],yn);wi.skip=isNaN(Lr)||isNaN(Br)||Vi,wi.stop=yn>0&&pi[Te]-zn[Te]>Lt,vt&&(wi.parsed=pi,wi.raw=U.data[yn]),fe&&(wi.options=Q||this.resolveDataElementOptions(yn,Wn.active?"active":m)),Vn||this.updateElement(Wn,yn,wi,m),zn=pi}this.updateSharedOptions(Q,m,Y)}getMaxOverflow(){const o=this._cachedMeta,c=o.dataset,d=c.options&&c.options.borderWidth||0,m=o.data||[];if(!m.length)return d;const y=m[0].size(this.resolveDataElementOptions(0)),_=m[m.length-1].size(this.resolveDataElementOptions(m.length-1));return Math.max(d,y,_)/2}draw(){const o=this._cachedMeta;o.dataset.updateControlPoints(this.chart.chartArea,o.iScale.axis),super.draw()}}Xf.id="line",Xf.defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1},Xf.overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};function Q_(h,o,c){const d=o.length;let m=0,y=d;if(h._sorted){const{iScale:_,_parsed:T}=h,D=_.axis,{min:U,max:Y,minDefined:Q,maxDefined:fe}=_.getUserBounds();Q&&(m=fa(Math.min(Ro(T,_.axis,U).lo,c?d:Ro(o,D,_.getPixelForValue(U)).lo),0,d-1)),fe?y=fa(Math.max(Ro(T,_.axis,Y).hi+1,c?0:Ro(o,D,_.getPixelForValue(Y)).hi+1),m,d)-m:y=d-m}return{start:m,count:y}}function eb(h){const{xScale:o,yScale:c,_scaleRanges:d}=h,m={xmin:o.min,xmax:o.max,ymin:c.min,ymax:c.max};if(!d)return h._scaleRanges=m,!0;const y=d.xmin!==o.min||d.xmax!==o.max||d.ymin!==c.min||d.ymax!==c.max;return Object.assign(d,m),y}class fp extends Ba{constructor(o,c){super(o,c),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(o){const c=this._cachedMeta,d=this.chart,m=d.data.labels||[],y=Yo(c._parsed[o].r,d.options.locale);return{label:m[o]||"",value:y}}update(o){const c=this._cachedMeta.data;this._updateRadius(),this.updateElements(c,0,c.length,o)}_updateRadius(){const o=this.chart,c=o.chartArea,d=o.options,m=Math.min(c.right-c.left,c.bottom-c.top),y=Math.max(m/2,0),_=Math.max(d.cutoutPercentage?y/100*d.cutoutPercentage:1,0),T=(y-_)/o.getVisibleDatasetCount();this.outerRadius=y-T*this.index,this.innerRadius=this.outerRadius-T}updateElements(o,c,d,m){const y=this.chart,_=this.getDataset(),D=y.options.animation,U=this._cachedMeta.rScale,Y=U.xCenter,Q=U.yCenter,fe=U.getIndexAngle(0)-.5*Cs;let Te=fe,Ue;const it=360/this.countVisibleElements();for(Ue=0;Ue<c;++Ue)Te+=this._computeAngle(Ue,m,it);for(Ue=c;Ue<c+d;Ue++){const vt=o[Ue];let Lt=Te,Vn=Te+this._computeAngle(Ue,m,it),zn=y.getDataVisibility(Ue)?U.getDistanceFromCenterForValue(_.data[Ue]):0;Te=Vn,m==="reset"&&(D.animateScale&&(zn=0),D.animateRotate&&(Lt=Vn=fe));const yn={x:Y,y:Q,innerRadius:0,outerRadius:zn,startAngle:Lt,endAngle:Vn,options:this.resolveDataElementOptions(Ue,vt.active?"active":m)};this.updateElement(vt,Ue,yn,m)}}countVisibleElements(){const o=this.getDataset(),c=this._cachedMeta;let d=0;return c.data.forEach((m,y)=>{!isNaN(o.data[y])&&this.chart.getDataVisibility(y)&&d++}),d}_computeAngle(o,c,d){return this.chart.getDataVisibility(o)?Co(this.resolveDataElementOptions(o,c).angle||d):0}}fp.id="polarArea",fp.defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0},fp.overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(h){const o=h.data;if(o.labels.length&&o.datasets.length){const{labels:{pointStyle:c}}=h.legend.options;return o.labels.map((d,m)=>{const _=h.getDatasetMeta(0).controller.getStyle(m);return{text:d,fillStyle:_.backgroundColor,strokeStyle:_.borderColor,lineWidth:_.borderWidth,pointStyle:c,hidden:!h.getDataVisibility(m),index:m}})}return[]}},onClick(h,o,c){c.chart.toggleDataVisibility(o.index),c.chart.update()}},tooltip:{callbacks:{title(){return""},label(h){return h.chart.data.labels[h.dataIndex]+": "+h.formattedValue}}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};class sg extends Sh{}sg.id="pie",sg.defaults={cutout:0,rotation:0,circumference:360,radius:"100%"};class dp extends Ba{getLabelAndValue(o){const c=this._cachedMeta.vScale,d=this.getParsed(o);return{label:c.getLabels()[o],value:""+c.getLabelForValue(d[c.axis])}}update(o){const c=this._cachedMeta,d=c.dataset,m=c.data||[],y=c.iScale.getLabels();if(d.points=m,o!=="resize"){const _=this.resolveDatasetElementOptions(o);this.options.showLine||(_.borderWidth=0);const T={_loop:!0,_fullLoop:y.length===m.length,options:_};this.updateElement(d,void 0,T,o)}this.updateElements(m,0,m.length,o)}updateElements(o,c,d,m){const y=this.getDataset(),_=this._cachedMeta.rScale,T=m==="reset";for(let D=c;D<c+d;D++){const U=o[D],Y=this.resolveDataElementOptions(D,U.active?"active":m),Q=_.getPointPositionForValue(D,y.data[D]),fe=T?_.xCenter:Q.x,Te=T?_.yCenter:Q.y,Ue={x:fe,y:Te,angle:Q.angle,skip:isNaN(fe)||isNaN(Te),options:Y};this.updateElement(U,D,Ue,m)}}}dp.id="radar",dp.defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}},dp.overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};class pp extends Xf{}pp.id="scatter",pp.defaults={showLine:!1,fill:!1},pp.overrides={interaction:{mode:"point"},plugins:{tooltip:{callbacks:{title(){return""},label(h){return"("+h.label+", "+h.formattedValue+")"}}}},scales:{x:{type:"linear"},y:{type:"linear"}}};var Dy=Object.freeze({__proto__:null,BarController:up,BubbleController:hp,DoughnutController:Sh,LineController:Xf,PolarAreaController:fp,PieController:sg,RadarController:dp,ScatterController:pp});function Oy(h,o,c){const{startAngle:d,pixelMargin:m,x:y,y:_,outerRadius:T,innerRadius:D}=o;let U=m/T;h.beginPath(),h.arc(y,_,T,d-U,c+U),D>m?(U=m/D,h.arc(y,_,D,c+U,d-U,!0)):h.arc(y,_,m,c+Xs,d-Xs),h.closePath(),h.clip()}function tb(h){return De(h,["outerStart","outerEnd","innerStart","innerEnd"])}function nb(h,o,c,d){const m=tb(h.options.borderRadius),y=(c-o)/2,_=Math.min(y,d*o/2),T=D=>{const U=(c-Math.min(y,D))*d/2;return fa(D,0,Math.min(y,U))};return{outerStart:T(m.outerStart),outerEnd:T(m.outerEnd),innerStart:fa(m.innerStart,0,_),innerEnd:fa(m.innerEnd,0,_)}}function Eh(h,o,c,d){return{x:c+h*Math.cos(o),y:d+h*Math.sin(o)}}function ag(h,o,c,d,m){const{x:y,y:_,startAngle:T,pixelMargin:D,innerRadius:U}=o,Y=Math.max(o.outerRadius+d+c-D,0),Q=U>0?U+d+c+D:0;let fe=0;const Te=m-T;if(d){const Yr=U>0?U-d:0,Zf=Y>0?Y-d:0,Pu=(Yr+Zf)/2,Dh=Pu!==0?Te*Pu/(Pu+d):Te;fe=(Te-Dh)/2}const Ue=Math.max(.001,Te*Y-c/Cs)/Y,it=(Te-Ue)/2,vt=T+it+fe,Lt=m-it-fe,{outerStart:Vn,outerEnd:zn,innerStart:yn,innerEnd:Wn}=nb(o,Q,Y,Lt-vt),pi=Y-Vn,wi=Y-zn,Vi=vt+Vn/pi,Lr=Lt-zn/wi,Br=Q+yn,Rs=Q+Wn,Gr=vt+yn/Br,pa=Lt-Wn/Rs;if(h.beginPath(),h.arc(y,_,Y,Vi,Lr),zn>0){const Yr=Eh(wi,Lr,y,_);h.arc(Yr.x,Yr.y,zn,Lr,Lt+Xs)}const Xa=Eh(Rs,Lt,y,_);if(h.lineTo(Xa.x,Xa.y),Wn>0){const Yr=Eh(Rs,pa,y,_);h.arc(Yr.x,Yr.y,Wn,Lt+Xs,pa+Math.PI)}if(h.arc(y,_,Q,Lt-Wn/Q,vt+yn/Q,!0),yn>0){const Yr=Eh(Br,Gr,y,_);h.arc(Yr.x,Yr.y,yn,Gr+Math.PI,vt-Xs)}const hr=Eh(pi,vt,y,_);if(h.lineTo(hr.x,hr.y),Vn>0){const Yr=Eh(pi,Vi,y,_);h.arc(Yr.x,Yr.y,Vn,vt-Xs,Vi)}h.closePath()}function ib(h,o,c,d){const{fullCircles:m,startAngle:y,circumference:_}=o;let T=o.endAngle;if(m){ag(h,o,c,d,y+us);for(let D=0;D<m;++D)h.fill();isNaN(_)||(T=y+_%us,_%us===0&&(T+=us))}return ag(h,o,c,d,T),h.fill(),T}function rb(h,o,c){const{x:d,y:m,startAngle:y,pixelMargin:_,fullCircles:T}=o,D=Math.max(o.outerRadius-_,0),U=o.innerRadius+_;let Y;for(c&&Oy(h,o,y+us),h.beginPath(),h.arc(d,m,U,y+us,y,!0),Y=0;Y<T;++Y)h.stroke();for(h.beginPath(),h.arc(d,m,D,y,y+us),Y=0;Y<T;++Y)h.stroke()}function sb(h,o,c,d,m){const{options:y}=o,_=y.borderAlign==="inner";!y.borderWidth||(_?(h.lineWidth=y.borderWidth*2,h.lineJoin="round"):(h.lineWidth=y.borderWidth,h.lineJoin="bevel"),o.fullCircles&&rb(h,o,_),_&&Oy(h,o,m),ag(h,o,c,d,m),h.stroke())}class mp extends Pa{constructor(o){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,o&&Object.assign(this,o)}inRange(o,c,d){const m=this.getProps(["x","y"],d),{angle:y,distance:_}=Xv(m,{x:o,y:c}),{startAngle:T,endAngle:D,innerRadius:U,outerRadius:Y,circumference:Q}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],d),fe=this.options.spacing/2;return(Q>=us||xf(y,T,D))&&_>=U+fe&&_<=Y+fe}getCenterPoint(o){const{x:c,y:d,startAngle:m,endAngle:y,innerRadius:_,outerRadius:T}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius","circumference"],o),{offset:D,spacing:U}=this.options,Y=(m+y)/2,Q=(_+T+U+D)/2;return{x:c+Math.cos(Y)*Q,y:d+Math.sin(Y)*Q}}tooltipPosition(o){return this.getCenterPoint(o)}draw(o){const{options:c,circumference:d}=this,m=(c.offset||0)/2,y=(c.spacing||0)/2;if(this.pixelMargin=c.borderAlign==="inner"?.33:0,this.fullCircles=d>us?Math.floor(d/us):0,d===0||this.innerRadius<0||this.outerRadius<0)return;o.save();let _=0;if(m){_=m/2;const D=(this.startAngle+this.endAngle)/2;o.translate(Math.cos(D)*_,Math.sin(D)*_),this.circumference>=Cs&&(_=m)}o.fillStyle=c.backgroundColor,o.strokeStyle=c.borderColor;const T=ib(o,this,_,y);sb(o,this,_,y,T),o.restore()}}mp.id="arc",mp.defaults={borderAlign:"center",borderColor:"#fff",borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0},mp.defaultRoutes={backgroundColor:"backgroundColor"};function Iy(h,o,c=o){h.lineCap=gr(c.borderCapStyle,o.borderCapStyle),h.setLineDash(gr(c.borderDash,o.borderDash)),h.lineDashOffset=gr(c.borderDashOffset,o.borderDashOffset),h.lineJoin=gr(c.borderJoinStyle,o.borderJoinStyle),h.lineWidth=gr(c.borderWidth,o.borderWidth),h.strokeStyle=gr(c.borderColor,o.borderColor)}function ab(h,o,c){h.lineTo(c.x,c.y)}function ob(h){return h.stepped?Jv:h.tension||h.cubicInterpolationMode==="monotone"?fh:ab}function Ny(h,o,c={}){const d=h.length,{start:m=0,end:y=d-1}=c,{start:_,end:T}=o,D=Math.max(m,_),U=Math.min(y,T);return{count:d,start:D,loop:o.loop,ilen:U<D&&!(m<_&&y<_||m>T&&y>T)?d+U-D:U-D}}function lb(h,o,c,d){const{points:m,options:y}=o,{count:_,start:T,loop:D,ilen:U}=Ny(m,c,d),Y=ob(y);let{move:Q=!0,reverse:fe}=d||{},Te,Ue,it;for(Te=0;Te<=U;++Te)Ue=m[(T+(fe?U-Te:Te))%_],!Ue.skip&&(Q?(h.moveTo(Ue.x,Ue.y),Q=!1):Y(h,it,Ue,fe,y.stepped),it=Ue);return D&&(Ue=m[(T+(fe?U:0))%_],Y(h,it,Ue,fe,y.stepped)),!!D}function cb(h,o,c,d){const m=o.points,{count:y,start:_,ilen:T}=Ny(m,c,d),{move:D=!0,reverse:U}=d||{};let Y=0,Q=0,fe,Te,Ue,it,vt,Lt;const Vn=yn=>(_+(U?T-yn:yn))%y,zn=()=>{it!==vt&&(h.lineTo(Y,vt),h.lineTo(Y,it),h.lineTo(Y,Lt))};for(D&&(Te=m[Vn(0)],h.moveTo(Te.x,Te.y)),fe=0;fe<=T;++fe){if(Te=m[Vn(fe)],Te.skip)continue;const yn=Te.x,Wn=Te.y,pi=yn|0;pi===Ue?(Wn<it?it=Wn:Wn>vt&&(vt=Wn),Y=(Q*Y+yn)/++Q):(zn(),h.lineTo(yn,Wn),Ue=pi,Q=0,it=vt=Wn),Lt=Wn}zn()}function og(h){const o=h.options,c=o.borderDash&&o.borderDash.length;return!h._decimated&&!h._loop&&!o.tension&&o.cubicInterpolationMode!=="monotone"&&!o.stepped&&!c?cb:lb}function ub(h){return h.stepped?yl:h.tension||h.cubicInterpolationMode==="monotone"?qd:ya}function hb(h,o,c,d){let m=o._path;m||(m=o._path=new Path2D,o.path(m,c,d)&&m.closePath()),Iy(h,o.options),h.stroke(m)}function fb(h,o,c,d){const{segments:m,options:y}=o,_=og(o);for(const T of m)Iy(h,y,T.style),h.beginPath(),_(h,o,T,{start:c,end:c+d-1})&&h.closePath(),h.stroke()}const db=typeof Path2D=="function";function pb(h,o,c,d){db&&!o.options.segment?hb(h,o,c,d):fb(h,o,c,d)}class Bc extends Pa{constructor(o){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,o&&Object.assign(this,o)}updateControlPoints(o,c){const d=this.options;if((d.tension||d.cubicInterpolationMode==="monotone")&&!d.stepped&&!this._pointsUpdated){const m=d.spanGaps?this._loop:this._fullLoop;Ni(this._points,d,o,m,c),this._pointsUpdated=!0}}set points(o){this._points=o,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=Yd(this,this.options.segment))}first(){const o=this.segments,c=this.points;return o.length&&c[o[0].start]}last(){const o=this.segments,c=this.points,d=o.length;return d&&c[o[d-1].end]}interpolate(o,c){const d=this.options,m=o[c],y=this.points,_=Of(this,{property:c,start:m,end:m});if(!_.length)return;const T=[],D=ub(d);let U,Y;for(U=0,Y=_.length;U<Y;++U){const{start:Q,end:fe}=_[U],Te=y[Q],Ue=y[fe];if(Te===Ue){T.push(Te);continue}const it=Math.abs((m-Te[c])/(Ue[c]-Te[c])),vt=D(Te,Ue,it,d.stepped);vt[c]=o[c],T.push(vt)}return T.length===1?T[0]:T}pathSegment(o,c,d){return og(this)(o,this,c,d)}path(o,c,d){const m=this.segments,y=og(this);let _=this._loop;c=c||0,d=d||this.points.length-c;for(const T of m)_&=y(o,this,T,{start:c,end:c+d-1});return!!_}draw(o,c,d,m){const y=this.options||{};(this.points||[]).length&&y.borderWidth&&(o.save(),pb(o,this,d,m),o.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}Bc.id="line",Bc.defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0},Bc.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"},Bc.descriptors={_scriptable:!0,_indexable:h=>h!=="borderDash"&&h!=="fill"};function Fy(h,o,c,d){const m=h.options,{[c]:y}=h.getProps([c],d);return Math.abs(o-y)<m.radius+m.hitRadius}class gp extends Pa{constructor(o){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,o&&Object.assign(this,o)}inRange(o,c,d){const m=this.options,{x:y,y:_}=this.getProps(["x","y"],d);return Math.pow(o-y,2)+Math.pow(c-_,2)<Math.pow(m.hitRadius+m.radius,2)}inXRange(o,c){return Fy(this,o,"x",c)}inYRange(o,c){return Fy(this,o,"y",c)}getCenterPoint(o){const{x:c,y:d}=this.getProps(["x","y"],o);return{x:c,y:d}}size(o){o=o||this.options||{};let c=o.radius||0;c=Math.max(c,c&&o.hoverRadius||0);const d=c&&o.borderWidth||0;return(c+d)*2}draw(o,c){const d=this.options;this.skip||d.radius<.1||!Tc(this,c,this.size(d)/2)||(o.strokeStyle=d.borderColor,o.lineWidth=d.borderWidth,o.fillStyle=d.backgroundColor,bf(o,d,this.x,this.y))}getRange(){const o=this.options||{};return o.radius+o.hitRadius}}gp.id="point",gp.defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0},gp.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};function By(h,o){const{x:c,y:d,base:m,width:y,height:_}=h.getProps(["x","y","base","width","height"],o);let T,D,U,Y,Q;return h.horizontal?(Q=_/2,T=Math.min(c,m),D=Math.max(c,m),U=d-Q,Y=d+Q):(Q=y/2,T=c-Q,D=c+Q,U=Math.min(d,m),Y=Math.max(d,m)),{left:T,top:U,right:D,bottom:Y}}function kc(h,o,c,d){return h?0:fa(o,c,d)}function mb(h,o,c){const d=h.options.borderWidth,m=h.borderSkipped,y=Tf(d);return{t:kc(m.top,y.top,0,c),r:kc(m.right,y.right,0,o),b:kc(m.bottom,y.bottom,0,c),l:kc(m.left,y.left,0,o)}}function gb(h,o,c){const{enableBorderRadius:d}=h.getProps(["enableBorderRadius"]),m=h.options.borderRadius,y=Lc(m),_=Math.min(o,c),T=h.borderSkipped,D=d||ur(m);return{topLeft:kc(!D||T.top||T.left,y.topLeft,0,_),topRight:kc(!D||T.top||T.right,y.topRight,0,_),bottomLeft:kc(!D||T.bottom||T.left,y.bottomLeft,0,_),bottomRight:kc(!D||T.bottom||T.right,y.bottomRight,0,_)}}function vb(h){const o=By(h),c=o.right-o.left,d=o.bottom-o.top,m=mb(h,c/2,d/2),y=gb(h,c/2,d/2);return{outer:{x:o.left,y:o.top,w:c,h:d,radius:y},inner:{x:o.left+m.l,y:o.top+m.t,w:c-m.l-m.r,h:d-m.t-m.b,radius:{topLeft:Math.max(0,y.topLeft-Math.max(m.t,m.l)),topRight:Math.max(0,y.topRight-Math.max(m.t,m.r)),bottomLeft:Math.max(0,y.bottomLeft-Math.max(m.b,m.l)),bottomRight:Math.max(0,y.bottomRight-Math.max(m.b,m.r))}}}}function lg(h,o,c,d){const m=o===null,y=c===null,_=h&&!(m&&y)&&By(h,d);return _&&(m||o>=_.left&&o<=_.right)&&(y||c>=_.top&&c<=_.bottom)}function yb(h){return h.topLeft||h.topRight||h.bottomLeft||h.bottomRight}function xb(h,o){h.rect(o.x,o.y,o.w,o.h)}function cg(h,o,c={}){const d=h.x!==c.x?-o:0,m=h.y!==c.y?-o:0,y=(h.x+h.w!==c.x+c.w?o:0)-d,_=(h.y+h.h!==c.y+c.h?o:0)-m;return{x:h.x+d,y:h.y+m,w:h.w+y,h:h.h+_,radius:h.radius}}class vp extends Pa{constructor(o){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,o&&Object.assign(this,o)}draw(o){const{inflateAmount:c,options:{borderColor:d,backgroundColor:m}}=this,{inner:y,outer:_}=vb(this),T=yb(_.radius)?ml:xb;o.save(),(_.w!==y.w||_.h!==y.h)&&(o.beginPath(),T(o,cg(_,c,y)),o.clip(),T(o,cg(y,-c,_)),o.fillStyle=d,o.fill("evenodd")),o.beginPath(),T(o,cg(y,c)),o.fillStyle=m,o.fill(),o.restore()}inRange(o,c,d){return lg(this,o,c,d)}inXRange(o,c){return lg(this,o,null,c)}inYRange(o,c){return lg(this,null,o,c)}getCenterPoint(o){const{x:c,y:d,base:m,horizontal:y}=this.getProps(["x","y","base","horizontal"],o);return{x:y?(c+m)/2:c,y:y?d:(d+m)/2}}getRange(o){return o==="x"?this.width/2:this.height/2}}vp.id="bar",vp.defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0},vp.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};var ug=Object.freeze({__proto__:null,ArcElement:mp,LineElement:Bc,PointElement:gp,BarElement:vp});function _b(h,o,c,d,m){const y=m.samples||d;if(y>=c)return h.slice(o,o+c);const _=[],T=(c-2)/(y-2);let D=0,U=o,Y,Q,fe,Te,Ue;for(_[D++]=h[U],Y=0;Y<y-2;Y++){let it=0,vt=0,Lt;const Vn=Math.floor((Y+1)*T)+1+o,zn=Math.min(Math.floor((Y+2)*T)+1,c)+o,yn=zn-Vn;for(Lt=Vn;Lt<zn;Lt++)it+=h[Lt].x,vt+=h[Lt].y;it/=yn,vt/=yn;const Wn=Math.floor(Y*T)+1+o,pi=Math.min(Math.floor((Y+1)*T)+1,c)+o,{x:wi,y:Vi}=h[U];for(fe=Te=-1,Lt=Wn;Lt<pi;Lt++)Te=.5*Math.abs((wi-it)*(h[Lt].y-Vi)-(wi-h[Lt].x)*(vt-Vi)),Te>fe&&(fe=Te,Q=h[Lt],Ue=Lt);_[D++]=Q,U=Ue}return _[D++]=h[o+c-1],_}function bb(h,o,c,d){let m=0,y=0,_,T,D,U,Y,Q,fe,Te,Ue,it;const vt=[],Lt=h[o].x,Vn=h[o+c-1].x;for(_=o;_<o+c;++_){T=h[_],D=(T.x-Lt)/(Vn-Lt)*d,U=T.y;const zn=D|0;if(zn===Y)U<Ue?(Ue=U,Q=_):U>it&&(it=U,fe=_),m=(y*m+T.x)/++y;else{const yn=_-1;if(!Dr(Q)&&!Dr(fe)){const Wn=Math.min(Q,fe),pi=Math.max(Q,fe);Wn!==Te&&Wn!==yn&&vt.push({...h[Wn],x:m}),pi!==Te&&pi!==yn&&vt.push({...h[pi],x:m})}_>0&&yn!==Te&&vt.push(h[yn]),vt.push(T),Y=zn,y=0,Ue=it=U,Q=fe=Te=_}}return vt}function ky(h){if(h._decimated){const o=h._data;delete h._decimated,delete h._data,Object.defineProperty(h,"data",{value:o})}}function zy(h){h.data.datasets.forEach(o=>{ky(o)})}function wb(h,o){const c=o.length;let d=0,m;const{iScale:y}=h,{min:_,max:T,minDefined:D,maxDefined:U}=y.getUserBounds();return D&&(d=fa(Ro(o,y.axis,_).lo,0,c-1)),U?m=fa(Ro(o,y.axis,T).hi+1,d,c)-d:m=c-d,{start:d,count:m}}function Mb(h,o){const c=h.getDatasetMeta(o);return c&&h.isDatasetVisible(o)?c.dataset:null}function Sb(h){const o=h.options,c=o.fill;let d=gr(c&&c.target,c);return d===void 0&&(d=!!o.backgroundColor),d===!1||d===null?!1:d===!0?"origin":d}function Eb(h,o,c){const d=Sb(h);if(ur(d))return isNaN(d.value)?!1:d;let m=parseFloat(d);return Ws(m)&&Math.floor(m)===m?((d[0]==="-"||d[0]==="+")&&(m=o+m),m===o||m<0||m>=c?!1:m):["origin","start","end","stack","shape"].indexOf(d)>=0&&d}function Tb(h){const{scale:o={},fill:c}=h;let d=null,m;return c==="start"?d=o.bottom:c==="end"?d=o.top:ur(c)?d=o.getPixelForValue(c.value):o.getBasePixel&&(d=o.getBasePixel()),Ws(d)?(m=o.isHorizontal(),{x:m?d:null,y:m?null:d}):null}class Uy{constructor(o){this.x=o.x,this.y=o.y,this.radius=o.radius}pathSegment(o,c,d){const{x:m,y,radius:_}=this;return c=c||{start:0,end:us},o.arc(m,y,_,c.end,c.start,!0),!d.bounds}interpolate(o){const{x:c,y:d,radius:m}=this,y=o.angle;return{x:c+Math.cos(y)*m,y:d+Math.sin(y)*m,angle:y}}}function Ab(h){const{scale:o,fill:c}=h,d=o.options,m=o.getLabels().length,y=[],_=d.reverse?o.max:o.min,T=d.reverse?o.min:o.max;let D,U,Y;if(c==="start"?Y=_:c==="end"?Y=T:ur(c)?Y=c.value:Y=o.getBaseValue(),d.grid.circular)return U=o.getPointPositionForValue(0,_),new Uy({x:U.x,y:U.y,radius:o.getDistanceFromCenterForValue(Y)});for(D=0;D<m;++D)y.push(o.getPointPositionForValue(D,Y));return y}function Lb(h){return(h.scale||{}).getPointPositionForValue?Ab(h):Tb(h)}function Hy(h,o,c){for(;o>h;o--){const d=c[o];if(!isNaN(d.x)&&!isNaN(d.y))break}return o}function Cb(h,o){const{x:c=null,y:d=null}=h||{},m=o.points,y=[];return o.segments.forEach(({start:_,end:T})=>{T=Hy(_,T,m);const D=m[_],U=m[T];d!==null?(y.push({x:D.x,y:d}),y.push({x:U.x,y:d})):c!==null&&(y.push({x:c,y:D.y}),y.push({x:c,y:U.y}))}),y}function Ar(h){const{scale:o,index:c,line:d}=h,m=[],y=d.segments,_=d.points,T=ui(o,c);T.push(Gy({x:null,y:o.bottom},d));for(let D=0;D<y.length;D++){const U=y[D];for(let Y=U.start;Y<=U.end;Y++)wl(m,_[Y],T)}return new Bc({points:m,options:{}})}function ui(h,o){const c=[],d=h.getMatchingVisibleMetas("line");for(let m=0;m<d.length;m++){const y=d[m];if(y.index===o)break;y.hidden||c.unshift(y.dataset)}return c}function wl(h,o,c){const d=[];for(let m=0;m<c.length;m++){const y=c[m],{first:_,last:T,point:D}=Pb(y,o,"x");if(!(!D||_&&T)){if(_)d.unshift(D);else if(h.push(D),!T)break}}h.push(...d)}function Pb(h,o,c){const d=h.interpolate(o,c);if(!d)return{};const m=d[c],y=h.segments,_=h.points;let T=!1,D=!1;for(let U=0;U<y.length;U++){const Y=y[U],Q=_[Y.start][c],fe=_[Y.end][c];if(m>=Q&&m<=fe){T=m===Q,D=m===fe;break}}return{first:T,last:D,point:d}}function Rb(h){const{chart:o,fill:c,line:d}=h;if(Ws(c))return Mb(o,c);if(c==="stack")return Ar(h);if(c==="shape")return!0;const m=Lb(h);return m instanceof Uy?m:Gy(m,d)}function Gy(h,o){let c=[],d=!1;return Tr(h)?(d=!0,c=h):c=Cb(h,o),c.length?new Bc({points:c,options:{tension:0},_loop:d,_fullLoop:d}):null}function Db(h,o,c){let m=h[o].fill;const y=[o];let _;if(!c)return m;for(;m!==!1&&y.indexOf(m)===-1;){if(!Ws(m))return m;if(_=h[m],!_)return!1;if(_.visible)return m;y.push(m),m=_.fill}return!1}function Vy(h,o,c){h.beginPath(),o.path(h),h.lineTo(o.last().x,c),h.lineTo(o.first().x,c),h.closePath(),h.clip()}function hg(h,o,c,d){if(d)return;let m=o[h],y=c[h];return h==="angle"&&(m=Po(m),y=Po(y)),{property:h,start:m,end:y}}function Wy(h,o,c,d){return h&&o?d(h[c],o[c]):h?h[c]:o?o[c]:0}function Ob(h,o,c){const d=h.segments,m=h.points,y=o.points,_=[];for(const T of d){let{start:D,end:U}=T;U=Hy(D,U,m);const Y=hg(c,m[D],m[U],T.loop);if(!o.segments){_.push({source:T,target:Y,start:m[D],end:m[U]});continue}const Q=Of(o,Y);for(const fe of Q){const Te=hg(c,y[fe.start],y[fe.end],fe.loop),Ue=Df(T,m,Te);for(const it of Ue)_.push({source:it,target:fe,start:{[c]:Wy(Y,Te,"start",Math.max)},end:{[c]:Wy(Y,Te,"end",Math.min)}})}}return _}function Ib(h,o,c){const{top:d,bottom:m}=o.chart.chartArea,{property:y,start:_,end:T}=c||{};y==="x"&&(h.beginPath(),h.rect(_,d,T-_,m-d),h.clip())}function Xy(h,o,c,d){const m=o.interpolate(c,d);m&&h.lineTo(m.x,m.y)}function qy(h,o){const{line:c,target:d,property:m,color:y,scale:_}=o,T=Ob(c,d,m);for(const{source:D,target:U,start:Y,end:Q}of T){const{style:{backgroundColor:fe=y}={}}=D,Te=d!==!0;h.save(),h.fillStyle=fe,Ib(h,_,Te&&hg(m,Y,Q)),h.beginPath();const Ue=!!c.pathSegment(h,D);let it;if(Te){Ue?h.closePath():Xy(h,d,Q,m);const vt=!!d.pathSegment(h,U,{move:Ue,reverse:!0});it=Ue&&vt,it||Xy(h,d,Y,m)}h.closePath(),h.fill(it?"evenodd":"nonzero"),h.restore()}}function Nb(h,o){const{line:c,target:d,above:m,below:y,area:_,scale:T}=o,D=c._loop?"angle":o.axis;h.save(),D==="x"&&y!==m&&(Vy(h,d,_.top),qy(h,{line:c,target:d,color:m,scale:T,property:D}),h.restore(),h.save(),Vy(h,d,_.bottom)),qy(h,{line:c,target:d,color:y,scale:T,property:D}),h.restore()}function fg(h,o,c){const d=Rb(o),{line:m,scale:y,axis:_}=o,T=m.options,D=T.fill,U=T.backgroundColor,{above:Y=U,below:Q=U}=D||{};d&&m.points.length&&(wf(h,c),Nb(h,{line:m,target:d,above:Y,below:Q,area:c,scale:y,axis:_}),Mf(h))}const jy=(h,o)=>{let{boxHeight:c=o,boxWidth:d=o}=h;return h.usePointStyle&&(c=Math.min(c,o),d=Math.min(d,o)),{boxWidth:d,boxHeight:c,itemHeight:Math.max(o,c)}},qf=(h,o)=>h!==null&&o!==null&&h.datasetIndex===o.datasetIndex&&h.index===o.index;class Th extends Pa{constructor(o){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=o.chart,this.options=o.options,this.ctx=o.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(o,c,d){this.maxWidth=o,this.maxHeight=c,this._margins=d,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const o=this.options.labels||{};let c=Or(o.generateLabels,[this.chart],this)||[];o.filter&&(c=c.filter(d=>o.filter(d,this.chart.data))),o.sort&&(c=c.sort((d,m)=>o.sort(d,m,this.chart.data))),this.options.reverse&&c.reverse(),this.legendItems=c}fit(){const{options:o,ctx:c}=this;if(!o.display){this.width=this.height=0;return}const d=o.labels,m=qs(d.font),y=m.size,_=this._computeTitleHeight(),{boxWidth:T,itemHeight:D}=jy(d,y);let U,Y;c.font=m.string,this.isHorizontal()?(U=this.maxWidth,Y=this._fitRows(_,y,T,D)+10):(Y=this.maxHeight,U=this._fitCols(_,y,T,D)+10),this.width=Math.min(U,o.maxWidth||this.maxWidth),this.height=Math.min(Y,o.maxHeight||this.maxHeight)}_fitRows(o,c,d,m){const{ctx:y,maxWidth:_,options:{labels:{padding:T}}}=this,D=this.legendHitBoxes=[],U=this.lineWidths=[0],Y=m+T;let Q=o;y.textAlign="left",y.textBaseline="middle";let fe=-1,Te=-Y;return this.legendItems.forEach((Ue,it)=>{const vt=d+c/2+y.measureText(Ue.text).width;(it===0||U[U.length-1]+vt+2*T>_)&&(Q+=Y,U[U.length-(it>0?0:1)]=0,Te+=Y,fe++),D[it]={left:0,top:Te,row:fe,width:vt,height:m},U[U.length-1]+=vt+T}),Q}_fitCols(o,c,d,m){const{ctx:y,maxHeight:_,options:{labels:{padding:T}}}=this,D=this.legendHitBoxes=[],U=this.columnSizes=[];let Y=T,Q=0,fe=0,Te=0,Ue=0;return this.legendItems.forEach((it,vt)=>{const Lt=d+c/2+y.measureText(it.text).width;vt>0&&fe+m+2*T>_-o&&(Y+=Q+T,U.push({width:Q,height:fe}),Te+=Q+T,Ue++,Q=fe=0),D[vt]={left:Te,top:fe,col:Ue,width:Lt,height:m},Q=Math.max(Q,Lt),fe+=m+T}),Y+=Q,U.push({width:Q,height:fe}),Y}adjustHitBoxes(){if(!this.options.display)return;const o=this._computeTitleHeight(),{legendHitBoxes:c,options:{align:d,labels:{padding:m},rtl:y}}=this,_=Wl(y,this.left,this.width);if(this.isHorizontal()){let T=0,D=ce(d,this.left+m,this.right-this.lineWidths[T]);for(const U of c)T!==U.row&&(T=U.row,D=ce(d,this.left+m,this.right-this.lineWidths[T])),U.top+=this.top+o+m,U.left=_.leftForLtr(_.x(D),U.width),D+=U.width+m}else{let T=0,D=ce(d,this.top+o+m,this.bottom-this.columnSizes[T].height);for(const U of c)U.col!==T&&(T=U.col,D=ce(d,this.top+o+m,this.bottom-this.columnSizes[T].height)),U.top=D,U.left+=this.left+m,U.left=_.leftForLtr(_.x(U.left),U.width),D+=U.height+m}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const o=this.ctx;wf(o,this),this._draw(),Mf(o)}}_draw(){const{options:o,columnSizes:c,lineWidths:d,ctx:m}=this,{align:y,labels:_}=o,T=Ir.color,D=Wl(o.rtl,this.left,this.width),U=qs(_.font),{color:Y,padding:Q}=_,fe=U.size,Te=fe/2;let Ue;this.drawTitle(),m.textAlign=D.textAlign("left"),m.textBaseline="middle",m.lineWidth=.5,m.font=U.string;const{boxWidth:it,boxHeight:vt,itemHeight:Lt}=jy(_,fe),Vn=function(wi,Vi,Lr){if(isNaN(it)||it<=0||isNaN(vt)||vt<0)return;m.save();const Br=gr(Lr.lineWidth,1);if(m.fillStyle=gr(Lr.fillStyle,T),m.lineCap=gr(Lr.lineCap,"butt"),m.lineDashOffset=gr(Lr.lineDashOffset,0),m.lineJoin=gr(Lr.lineJoin,"miter"),m.lineWidth=Br,m.strokeStyle=gr(Lr.strokeStyle,T),m.setLineDash(gr(Lr.lineDash,[])),_.usePointStyle){const Rs={radius:it*Math.SQRT2/2,pointStyle:Lr.pointStyle,rotation:Lr.rotation,borderWidth:Br},Gr=D.xPlus(wi,it/2);bf(m,Rs,Gr,Vi+Te)}else{const Rs=Vi+Math.max((fe-vt)/2,0),Gr=D.leftForLtr(wi,it),pa=Lc(Lr.borderRadius);m.beginPath(),Object.values(pa).some(Xa=>Xa!==0)?ml(m,{x:Gr,y:Rs,w:it,h:vt,radius:pa}):m.rect(Gr,Rs,it,vt),m.fill(),Br!==0&&m.stroke()}m.restore()},zn=function(wi,Vi,Lr){mo(m,Lr.text,wi,Vi+Lt/2,U,{strikethrough:Lr.hidden,textAlign:D.textAlign(Lr.textAlign)})},yn=this.isHorizontal(),Wn=this._computeTitleHeight();yn?Ue={x:ce(y,this.left+Q,this.right-d[0]),y:this.top+Q+Wn,line:0}:Ue={x:this.left+Q,y:ce(y,this.top+Wn+Q,this.bottom-c[0].height),line:0},Rf(this.ctx,o.textDirection);const pi=Lt+Q;this.legendItems.forEach((wi,Vi)=>{m.strokeStyle=wi.fontColor||Y,m.fillStyle=wi.fontColor||Y;const Lr=m.measureText(wi.text).width,Br=D.textAlign(wi.textAlign||(wi.textAlign=_.textAlign)),Rs=it+Te+Lr;let Gr=Ue.x,pa=Ue.y;D.setWidth(this.width),yn?Vi>0&&Gr+Rs+Q>this.right&&(pa=Ue.y+=pi,Ue.line++,Gr=Ue.x=ce(y,this.left+Q,this.right-d[Ue.line])):Vi>0&&pa+pi>this.bottom&&(Gr=Ue.x=Gr+c[Ue.line].width+Q,Ue.line++,pa=Ue.y=ce(y,this.top+Wn+Q,this.bottom-c[Ue.line].height));const Xa=D.x(Gr);Vn(Xa,pa,wi),Gr=At(Br,Gr+it+Te,yn?Gr+Rs:this.right,o.rtl),zn(D.x(Gr),pa,wi),yn?Ue.x+=Rs+Q:Ue.y+=pi}),xa(this.ctx,o.textDirection)}drawTitle(){const o=this.options,c=o.title,d=qs(c.font),m=Ps(c.padding);if(!c.display)return;const y=Wl(o.rtl,this.left,this.width),_=this.ctx,T=c.position,D=d.size/2,U=m.top+D;let Y,Q=this.left,fe=this.width;if(this.isHorizontal())fe=Math.max(...this.lineWidths),Y=this.top+U,Q=ce(o.align,Q,this.right-fe);else{const Ue=this.columnSizes.reduce((it,vt)=>Math.max(it,vt.height),0);Y=U+ce(o.align,this.top,this.bottom-Ue-o.labels.padding-this._computeTitleHeight())}const Te=ce(T,Q,Q+fe);_.textAlign=y.textAlign(Ut(T)),_.textBaseline="middle",_.strokeStyle=c.color,_.fillStyle=c.color,_.font=d.string,mo(_,c.text,Te,Y,d)}_computeTitleHeight(){const o=this.options.title,c=qs(o.font),d=Ps(o.padding);return o.display?c.lineHeight+d.height:0}_getLegendItemAt(o,c){let d,m,y;if(o>=this.left&&o<=this.right&&c>=this.top&&c<=this.bottom){for(y=this.legendHitBoxes,d=0;d<y.length;++d)if(m=y[d],o>=m.left&&o<=m.left+m.width&&c>=m.top&&c<=m.top+m.height)return this.legendItems[d]}return null}handleEvent(o){const c=this.options;if(!Yy(o.type,c))return;const d=this._getLegendItemAt(o.x,o.y);if(o.type==="mousemove"){const m=this._hoveredItem,y=qf(m,d);m&&!y&&Or(c.onLeave,[o,m,this],this),this._hoveredItem=d,d&&!y&&Or(c.onHover,[o,d,this],this)}else d&&Or(c.onClick,[o,d,this],this)}}function Yy(h,o){return!!(h==="mousemove"&&(o.onHover||o.onLeave)||o.onClick&&(h==="click"||h==="mouseup"))}class dg extends Pa{constructor(o){super(),this.chart=o.chart,this.options=o.options,this.ctx=o.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(o,c){const d=this.options;if(this.left=0,this.top=0,!d.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=o,this.height=this.bottom=c;const m=Tr(d.text)?d.text.length:1;this._padding=Ps(d.padding);const y=m*qs(d.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=y:this.width=y}isHorizontal(){const o=this.options.position;return o==="top"||o==="bottom"}_drawArgs(o){const{top:c,left:d,bottom:m,right:y,options:_}=this,T=_.align;let D=0,U,Y,Q;return this.isHorizontal()?(Y=ce(T,d,y),Q=c+o,U=y-d):(_.position==="left"?(Y=d+o,Q=ce(T,m,c),D=Cs*-.5):(Y=y-o,Q=ce(T,c,m),D=Cs*.5),U=m-c),{titleX:Y,titleY:Q,maxWidth:U,rotation:D}}draw(){const o=this.ctx,c=this.options;if(!c.display)return;const d=qs(c.font),y=d.lineHeight/2+this._padding.top,{titleX:_,titleY:T,maxWidth:D,rotation:U}=this._drawArgs(y);mo(o,c.text,0,0,d,{color:c.color,maxWidth:D,rotation:U,textAlign:Ut(c.align),textBaseline:"middle",translation:[_,T]})}}function Fb(h,o){const c=new dg({ctx:h.ctx,options:o,chart:h});da.configure(h,c,o),da.addBox(h,c),h.titleBlock=c}const jf=new WeakMap,Ah={average(h){if(!h.length)return!1;let o,c,d=0,m=0,y=0;for(o=0,c=h.length;o<c;++o){const _=h[o].element;if(_&&_.hasValue()){const T=_.tooltipPosition();d+=T.x,m+=T.y,++y}}return{x:d/y,y:m/y}},nearest(h,o){if(!h.length)return!1;let c=o.x,d=o.y,m=Number.POSITIVE_INFINITY,y,_,T;for(y=0,_=h.length;y<_;++y){const D=h[y].element;if(D&&D.hasValue()){const U=D.getCenterPoint(),Y=kd(o,U);Y<m&&(m=Y,T=D)}}if(T){const D=T.tooltipPosition();c=D.x,d=D.y}return{x:c,y:d}}};function Jo(h,o){return o&&(Tr(o)?Array.prototype.push.apply(h,o):h.push(o)),h}function Ml(h){return(typeof h=="string"||h instanceof String)&&h.indexOf(`
`)>-1?h.split(`
`):h}function Zy(h,o){const{element:c,datasetIndex:d,index:m}=o,y=h.getDatasetMeta(d).controller,{label:_,value:T}=y.getLabelAndValue(m);return{chart:h,label:_,parsed:y.getParsed(m),raw:h.data.datasets[d].data[m],formattedValue:T,dataset:y.getDataset(),dataIndex:m,datasetIndex:d,element:c}}function pg(h,o){const c=h._chart.ctx,{body:d,footer:m,title:y}=h,{boxWidth:_,boxHeight:T}=o,D=qs(o.bodyFont),U=qs(o.titleFont),Y=qs(o.footerFont),Q=y.length,fe=m.length,Te=d.length,Ue=Ps(o.padding);let it=Ue.height,vt=0,Lt=d.reduce((yn,Wn)=>yn+Wn.before.length+Wn.lines.length+Wn.after.length,0);if(Lt+=h.beforeBody.length+h.afterBody.length,Q&&(it+=Q*U.lineHeight+(Q-1)*o.titleSpacing+o.titleMarginBottom),Lt){const yn=o.displayColors?Math.max(T,D.lineHeight):D.lineHeight;it+=Te*yn+(Lt-Te)*D.lineHeight+(Lt-1)*o.bodySpacing}fe&&(it+=o.footerMarginTop+fe*Y.lineHeight+(fe-1)*o.footerSpacing);let Vn=0;const zn=function(yn){vt=Math.max(vt,c.measureText(yn).width+Vn)};return c.save(),c.font=U.string,vr(h.title,zn),c.font=D.string,vr(h.beforeBody.concat(h.afterBody),zn),Vn=o.displayColors?_+2+o.boxPadding:0,vr(d,yn=>{vr(yn.before,zn),vr(yn.lines,zn),vr(yn.after,zn)}),Vn=0,c.font=Y.string,vr(h.footer,zn),c.restore(),vt+=Ue.width,{width:vt,height:it}}function Lh(h,o){const{y:c,height:d}=o;return c<d/2?"top":c>h.height-d/2?"bottom":"center"}function No(h,o,c,d){const{x:m,width:y}=d,_=c.caretSize+c.caretPadding;if(h==="left"&&m+y+_>o.width||h==="right"&&m-y-_<0)return!0}function _o(h,o,c,d){const{x:m,width:y}=c,{width:_,chartArea:{left:T,right:D}}=h;let U="center";return d==="center"?U=m<=(T+D)/2?"left":"right":m<=y/2?U="left":m>=_-y/2&&(U="right"),No(U,h,o,c)&&(U="center"),U}function mg(h,o,c){const d=o.yAlign||Lh(h,c);return{xAlign:o.xAlign||_o(h,o,c,d),yAlign:d}}function Bb(h,o){let{x:c,width:d}=h;return o==="right"?c-=d:o==="center"&&(c-=d/2),c}function kb(h,o,c){let{y:d,height:m}=h;return o==="top"?d+=c:o==="bottom"?d-=m+c:d-=m/2,d}function Jy(h,o,c,d){const{caretSize:m,caretPadding:y,cornerRadius:_}=h,{xAlign:T,yAlign:D}=c,U=m+y,{topLeft:Y,topRight:Q,bottomLeft:fe,bottomRight:Te}=Lc(_);let Ue=Bb(o,T);const it=kb(o,D,U);return D==="center"?T==="left"?Ue+=U:T==="right"&&(Ue-=U):T==="left"?Ue-=Math.max(Y,fe)+y:T==="right"&&(Ue+=Math.max(Q,Te)+y),{x:fa(Ue,0,d.width-o.width),y:fa(it,0,d.height-o.height)}}function yp(h,o,c){const d=Ps(c.padding);return o==="center"?h.x+h.width/2:o==="right"?h.x+h.width-d.right:h.x+d.left}function $y(h){return Jo([],Ml(h))}function zb(h,o,c){return jo(h,{tooltip:o,tooltipItems:c,type:"tooltip"})}function Ky(h,o){const c=o&&o.dataset&&o.dataset.tooltip&&o.dataset.tooltip.callbacks;return c?h.override(c):h}class gg extends Pa{constructor(o){super(),this.opacity=0,this._active=[],this._chart=o._chart,this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.options=o.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(o){this.options=o,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const o=this._cachedAnimations;if(o)return o;const c=this._chart,d=this.options.setContext(this.getContext()),m=d.enabled&&c.options.animation&&d.animations,y=new kf(this._chart,m);return m._cacheable&&(this._cachedAnimations=Object.freeze(y)),y}getContext(){return this.$context||(this.$context=zb(this._chart.getContext(),this,this._tooltipItems))}getTitle(o,c){const{callbacks:d}=c,m=d.beforeTitle.apply(this,[o]),y=d.title.apply(this,[o]),_=d.afterTitle.apply(this,[o]);let T=[];return T=Jo(T,Ml(m)),T=Jo(T,Ml(y)),T=Jo(T,Ml(_)),T}getBeforeBody(o,c){return $y(c.callbacks.beforeBody.apply(this,[o]))}getBody(o,c){const{callbacks:d}=c,m=[];return vr(o,y=>{const _={before:[],lines:[],after:[]},T=Ky(d,y);Jo(_.before,Ml(T.beforeLabel.call(this,y))),Jo(_.lines,T.label.call(this,y)),Jo(_.after,Ml(T.afterLabel.call(this,y))),m.push(_)}),m}getAfterBody(o,c){return $y(c.callbacks.afterBody.apply(this,[o]))}getFooter(o,c){const{callbacks:d}=c,m=d.beforeFooter.apply(this,[o]),y=d.footer.apply(this,[o]),_=d.afterFooter.apply(this,[o]);let T=[];return T=Jo(T,Ml(m)),T=Jo(T,Ml(y)),T=Jo(T,Ml(_)),T}_createItems(o){const c=this._active,d=this._chart.data,m=[],y=[],_=[];let T=[],D,U;for(D=0,U=c.length;D<U;++D)T.push(Zy(this._chart,c[D]));return o.filter&&(T=T.filter((Y,Q,fe)=>o.filter(Y,Q,fe,d))),o.itemSort&&(T=T.sort((Y,Q)=>o.itemSort(Y,Q,d))),vr(T,Y=>{const Q=Ky(o.callbacks,Y);m.push(Q.labelColor.call(this,Y)),y.push(Q.labelPointStyle.call(this,Y)),_.push(Q.labelTextColor.call(this,Y))}),this.labelColors=m,this.labelPointStyles=y,this.labelTextColors=_,this.dataPoints=T,T}update(o,c){const d=this.options.setContext(this.getContext()),m=this._active;let y,_=[];if(!m.length)this.opacity!==0&&(y={opacity:0});else{const T=Ah[d.position].call(this,m,this._eventPosition);_=this._createItems(d),this.title=this.getTitle(_,d),this.beforeBody=this.getBeforeBody(_,d),this.body=this.getBody(_,d),this.afterBody=this.getAfterBody(_,d),this.footer=this.getFooter(_,d);const D=this._size=pg(this,d),U=Object.assign({},T,D),Y=mg(this._chart,d,U),Q=Jy(d,U,Y,this._chart);this.xAlign=Y.xAlign,this.yAlign=Y.yAlign,y={opacity:1,x:Q.x,y:Q.y,width:D.width,height:D.height,caretX:T.x,caretY:T.y}}this._tooltipItems=_,this.$context=void 0,y&&this._resolveAnimations().update(this,y),o&&d.external&&d.external.call(this,{chart:this._chart,tooltip:this,replay:c})}drawCaret(o,c,d,m){const y=this.getCaretPosition(o,d,m);c.lineTo(y.x1,y.y1),c.lineTo(y.x2,y.y2),c.lineTo(y.x3,y.y3)}getCaretPosition(o,c,d){const{xAlign:m,yAlign:y}=this,{caretSize:_,cornerRadius:T}=d,{topLeft:D,topRight:U,bottomLeft:Y,bottomRight:Q}=Lc(T),{x:fe,y:Te}=o,{width:Ue,height:it}=c;let vt,Lt,Vn,zn,yn,Wn;return y==="center"?(yn=Te+it/2,m==="left"?(vt=fe,Lt=vt-_,zn=yn+_,Wn=yn-_):(vt=fe+Ue,Lt=vt+_,zn=yn-_,Wn=yn+_),Vn=vt):(m==="left"?Lt=fe+Math.max(D,Y)+_:m==="right"?Lt=fe+Ue-Math.max(U,Q)-_:Lt=this.caretX,y==="top"?(zn=Te,yn=zn-_,vt=Lt-_,Vn=Lt+_):(zn=Te+it,yn=zn+_,vt=Lt+_,Vn=Lt-_),Wn=zn),{x1:vt,x2:Lt,x3:Vn,y1:zn,y2:yn,y3:Wn}}drawTitle(o,c,d){const m=this.title,y=m.length;let _,T,D;if(y){const U=Wl(d.rtl,this.x,this.width);for(o.x=yp(this,d.titleAlign,d),c.textAlign=U.textAlign(d.titleAlign),c.textBaseline="middle",_=qs(d.titleFont),T=d.titleSpacing,c.fillStyle=d.titleColor,c.font=_.string,D=0;D<y;++D)c.fillText(m[D],U.x(o.x),o.y+_.lineHeight/2),o.y+=_.lineHeight+T,D+1===y&&(o.y+=d.titleMarginBottom-T)}}_drawColorBox(o,c,d,m,y){const _=this.labelColors[d],T=this.labelPointStyles[d],{boxHeight:D,boxWidth:U,boxPadding:Y}=y,Q=qs(y.bodyFont),fe=yp(this,"left",y),Te=m.x(fe),Ue=D<Q.lineHeight?(Q.lineHeight-D)/2:0,it=c.y+Ue;if(y.usePointStyle){const vt={radius:Math.min(U,D)/2,pointStyle:T.pointStyle,rotation:T.rotation,borderWidth:1},Lt=m.leftForLtr(Te,U)+U/2,Vn=it+D/2;o.strokeStyle=y.multiKeyBackground,o.fillStyle=y.multiKeyBackground,bf(o,vt,Lt,Vn),o.strokeStyle=_.borderColor,o.fillStyle=_.backgroundColor,bf(o,vt,Lt,Vn)}else{o.lineWidth=_.borderWidth||1,o.strokeStyle=_.borderColor,o.setLineDash(_.borderDash||[]),o.lineDashOffset=_.borderDashOffset||0;const vt=m.leftForLtr(Te,U-Y),Lt=m.leftForLtr(m.xPlus(Te,1),U-Y-2),Vn=Lc(_.borderRadius);Object.values(Vn).some(zn=>zn!==0)?(o.beginPath(),o.fillStyle=y.multiKeyBackground,ml(o,{x:vt,y:it,w:U,h:D,radius:Vn}),o.fill(),o.stroke(),o.fillStyle=_.backgroundColor,o.beginPath(),ml(o,{x:Lt,y:it+1,w:U-2,h:D-2,radius:Vn}),o.fill()):(o.fillStyle=y.multiKeyBackground,o.fillRect(vt,it,U,D),o.strokeRect(vt,it,U,D),o.fillStyle=_.backgroundColor,o.fillRect(Lt,it+1,U-2,D-2))}o.fillStyle=this.labelTextColors[d]}drawBody(o,c,d){const{body:m}=this,{bodySpacing:y,bodyAlign:_,displayColors:T,boxHeight:D,boxWidth:U,boxPadding:Y}=d,Q=qs(d.bodyFont);let fe=Q.lineHeight,Te=0;const Ue=Wl(d.rtl,this.x,this.width),it=function(Vi){c.fillText(Vi,Ue.x(o.x+Te),o.y+fe/2),o.y+=fe+y},vt=Ue.textAlign(_);let Lt,Vn,zn,yn,Wn,pi,wi;for(c.textAlign=_,c.textBaseline="middle",c.font=Q.string,o.x=yp(this,vt,d),c.fillStyle=d.bodyColor,vr(this.beforeBody,it),Te=T&&vt!=="right"?_==="center"?U/2+Y:U+2+Y:0,yn=0,pi=m.length;yn<pi;++yn){for(Lt=m[yn],Vn=this.labelTextColors[yn],c.fillStyle=Vn,vr(Lt.before,it),zn=Lt.lines,T&&zn.length&&(this._drawColorBox(c,o,yn,Ue,d),fe=Math.max(Q.lineHeight,D)),Wn=0,wi=zn.length;Wn<wi;++Wn)it(zn[Wn]),fe=Q.lineHeight;vr(Lt.after,it)}Te=0,fe=Q.lineHeight,vr(this.afterBody,it),o.y-=y}drawFooter(o,c,d){const m=this.footer,y=m.length;let _,T;if(y){const D=Wl(d.rtl,this.x,this.width);for(o.x=yp(this,d.footerAlign,d),o.y+=d.footerMarginTop,c.textAlign=D.textAlign(d.footerAlign),c.textBaseline="middle",_=qs(d.footerFont),c.fillStyle=d.footerColor,c.font=_.string,T=0;T<y;++T)c.fillText(m[T],D.x(o.x),o.y+_.lineHeight/2),o.y+=_.lineHeight+d.footerSpacing}}drawBackground(o,c,d,m){const{xAlign:y,yAlign:_}=this,{x:T,y:D}=o,{width:U,height:Y}=d,{topLeft:Q,topRight:fe,bottomLeft:Te,bottomRight:Ue}=Lc(m.cornerRadius);c.fillStyle=m.backgroundColor,c.strokeStyle=m.borderColor,c.lineWidth=m.borderWidth,c.beginPath(),c.moveTo(T+Q,D),_==="top"&&this.drawCaret(o,c,d,m),c.lineTo(T+U-fe,D),c.quadraticCurveTo(T+U,D,T+U,D+fe),_==="center"&&y==="right"&&this.drawCaret(o,c,d,m),c.lineTo(T+U,D+Y-Ue),c.quadraticCurveTo(T+U,D+Y,T+U-Ue,D+Y),_==="bottom"&&this.drawCaret(o,c,d,m),c.lineTo(T+Te,D+Y),c.quadraticCurveTo(T,D+Y,T,D+Y-Te),_==="center"&&y==="left"&&this.drawCaret(o,c,d,m),c.lineTo(T,D+Q),c.quadraticCurveTo(T,D,T+Q,D),c.closePath(),c.fill(),m.borderWidth>0&&c.stroke()}_updateAnimationTarget(o){const c=this._chart,d=this.$animations,m=d&&d.x,y=d&&d.y;if(m||y){const _=Ah[o.position].call(this,this._active,this._eventPosition);if(!_)return;const T=this._size=pg(this,o),D=Object.assign({},_,this._size),U=mg(c,o,D),Y=Jy(o,D,U,c);(m._to!==Y.x||y._to!==Y.y)&&(this.xAlign=U.xAlign,this.yAlign=U.yAlign,this.width=T.width,this.height=T.height,this.caretX=_.x,this.caretY=_.y,this._resolveAnimations().update(this,Y))}}draw(o){const c=this.options.setContext(this.getContext());let d=this.opacity;if(!d)return;this._updateAnimationTarget(c);const m={width:this.width,height:this.height},y={x:this.x,y:this.y};d=Math.abs(d)<.001?0:d;const _=Ps(c.padding),T=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;c.enabled&&T&&(o.save(),o.globalAlpha=d,this.drawBackground(y,o,m,c),Rf(o,c.textDirection),y.y+=_.top,this.drawTitle(y,o,c),this.drawBody(y,o,c),this.drawFooter(y,o,c),xa(o,c.textDirection),o.restore())}getActiveElements(){return this._active||[]}setActiveElements(o,c){const d=this._active,m=o.map(({datasetIndex:T,index:D})=>{const U=this._chart.getDatasetMeta(T);if(!U)throw new Error("Cannot find a dataset at index "+T);return{datasetIndex:T,element:U.data[D],index:D}}),y=!vf(d,m),_=this._positionChanged(m,c);(y||_)&&(this._active=m,this._eventPosition=c,this.update(!0))}handleEvent(o,c){const d=this.options,m=this._active||[];let y=!1,_=[];o.type!=="mouseout"&&(_=this._chart.getElementsAtEventForMode(o,d.mode,d,c),d.reverse&&_.reverse());const T=this._positionChanged(_,o);return y=c||!vf(_,m)||T,y&&(this._active=_,(d.enabled||d.external)&&(this._eventPosition={x:o.x,y:o.y},this.update(!0,c))),y}_positionChanged(o,c){const{caretX:d,caretY:m,options:y}=this,_=Ah[y.position].call(this,o,c);return _!==!1&&(d!==_.x||m!==_.y)}}gg.positioners=Ah;var Qy=Object.freeze({__proto__:null,Decimation:{id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(h,o,c)=>{if(!c.enabled){zy(h);return}const d=h.width;h.data.datasets.forEach((m,y)=>{const{_data:_,indexAxis:T}=m,D=h.getDatasetMeta(y),U=_||m.data;if($a([T,h.options.indexAxis])==="y"||D.type!=="line")return;const Y=h.scales[D.xAxisID];if(Y.type!=="linear"&&Y.type!=="time"||h.options.parsing)return;let{start:Q,count:fe}=wb(D,U);const Te=c.threshold||4*d;if(fe<=Te){ky(m);return}Dr(_)&&(m._data=U,delete m.data,Object.defineProperty(m,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(it){this._data=it}}));let Ue;switch(c.algorithm){case"lttb":Ue=_b(U,Q,fe,d,c);break;case"min-max":Ue=bb(U,Q,fe,d);break;default:throw new Error(`Unsupported decimation algorithm '${c.algorithm}'`)}m._decimated=Ue})},destroy(h){zy(h)}},Filler:{id:"filler",afterDatasetsUpdate(h,o,c){const d=(h.data.datasets||[]).length,m=[];let y,_,T,D;for(_=0;_<d;++_)y=h.getDatasetMeta(_),T=y.dataset,D=null,T&&T.options&&T instanceof Bc&&(D={visible:h.isDatasetVisible(_),index:_,fill:Eb(T,_,d),chart:h,axis:y.controller.options.indexAxis,scale:y.vScale,line:T}),y.$filler=D,m.push(D);for(_=0;_<d;++_)D=m[_],!(!D||D.fill===!1)&&(D.fill=Db(m,_,c.propagate))},beforeDraw(h,o,c){const d=c.drawTime==="beforeDraw",m=h.getSortedVisibleDatasetMetas(),y=h.chartArea;for(let _=m.length-1;_>=0;--_){const T=m[_].$filler;!T||(T.line.updateControlPoints(y,T.axis),d&&fg(h.ctx,T,y))}},beforeDatasetsDraw(h,o,c){if(c.drawTime!=="beforeDatasetsDraw")return;const d=h.getSortedVisibleDatasetMetas();for(let m=d.length-1;m>=0;--m){const y=d[m].$filler;y&&fg(h.ctx,y,h.chartArea)}},beforeDatasetDraw(h,o,c){const d=o.meta.$filler;!d||d.fill===!1||c.drawTime!=="beforeDatasetDraw"||fg(h.ctx,d,h.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}},Legend:{id:"legend",_element:Th,start(h,o,c){const d=h.legend=new Th({ctx:h.ctx,options:c,chart:h});da.configure(h,d,c),da.addBox(h,d)},stop(h){da.removeBox(h,h.legend),delete h.legend},beforeUpdate(h,o,c){const d=h.legend;da.configure(h,d,c),d.options=c},afterUpdate(h){const o=h.legend;o.buildLabels(),o.adjustHitBoxes()},afterEvent(h,o){o.replay||h.legend.handleEvent(o.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(h,o,c){const d=o.datasetIndex,m=c.chart;m.isDatasetVisible(d)?(m.hide(d),o.hidden=!0):(m.show(d),o.hidden=!1)},onHover:null,onLeave:null,labels:{color:h=>h.chart.options.color,boxWidth:40,padding:10,generateLabels(h){const o=h.data.datasets,{labels:{usePointStyle:c,pointStyle:d,textAlign:m,color:y}}=h.legend.options;return h._getSortedDatasetMetas().map(_=>{const T=_.controller.getStyle(c?0:void 0),D=Ps(T.borderWidth);return{text:o[_.index].label,fillStyle:T.backgroundColor,fontColor:y,hidden:!_.visible,lineCap:T.borderCapStyle,lineDash:T.borderDash,lineDashOffset:T.borderDashOffset,lineJoin:T.borderJoinStyle,lineWidth:(D.width+D.height)/4,strokeStyle:T.borderColor,pointStyle:d||T.pointStyle,rotation:T.rotation,textAlign:m||T.textAlign,borderRadius:0,datasetIndex:_.index}},this)}},title:{color:h=>h.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:h=>!h.startsWith("on"),labels:{_scriptable:h=>!["generateLabels","filter","sort"].includes(h)}}},SubTitle:{id:"subtitle",start(h,o,c){const d=new dg({ctx:h.ctx,options:c,chart:h});da.configure(h,d,c),da.addBox(h,d),jf.set(h,d)},stop(h){da.removeBox(h,jf.get(h)),jf.delete(h)},beforeUpdate(h,o,c){const d=jf.get(h);da.configure(h,d,c),d.options=c},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}},Title:{id:"title",_element:dg,start(h,o,c){Fb(h,c)},stop(h){const o=h.titleBlock;da.removeBox(h,o),delete h.titleBlock},beforeUpdate(h,o,c){const d=h.titleBlock;da.configure(h,d,c),d.options=c},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}},Tooltip:{id:"tooltip",_element:gg,positioners:Ah,afterInit(h,o,c){c&&(h.tooltip=new gg({_chart:h,options:c}))},beforeUpdate(h,o,c){h.tooltip&&h.tooltip.initialize(c)},reset(h,o,c){h.tooltip&&h.tooltip.initialize(c)},afterDraw(h){const o=h.tooltip,c={tooltip:o};h.notifyPlugins("beforeTooltipDraw",c)!==!1&&(o&&o.draw(h.ctx),h.notifyPlugins("afterTooltipDraw",c))},afterEvent(h,o){if(h.tooltip){const c=o.replay;h.tooltip.handleEvent(o.event,c)&&(o.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(h,o)=>o.bodyFont.size,boxWidth:(h,o)=>o.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:{beforeTitle:ha,title(h){if(h.length>0){const o=h[0],c=o.chart.data.labels,d=c?c.length:0;if(this&&this.options&&this.options.mode==="dataset")return o.dataset.label||"";if(o.label)return o.label;if(d>0&&o.dataIndex<d)return c[o.dataIndex]}return""},afterTitle:ha,beforeBody:ha,beforeLabel:ha,label(h){if(this&&this.options&&this.options.mode==="dataset")return h.label+": "+h.formattedValue||h.formattedValue;let o=h.dataset.label||"";o&&(o+=": ");const c=h.formattedValue;return Dr(c)||(o+=c),o},labelColor(h){const c=h.chart.getDatasetMeta(h.datasetIndex).controller.getStyle(h.dataIndex);return{borderColor:c.borderColor,backgroundColor:c.backgroundColor,borderWidth:c.borderWidth,borderDash:c.borderDash,borderDashOffset:c.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(h){const c=h.chart.getDatasetMeta(h.datasetIndex).controller.getStyle(h.dataIndex);return{pointStyle:c.pointStyle,rotation:c.rotation}},afterLabel:ha,afterBody:ha,beforeFooter:ha,footer:ha,afterFooter:ha}},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:h=>h!=="filter"&&h!=="itemSort"&&h!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]}});const Ub=(h,o,c)=>typeof o=="string"?h.push(o)-1:isNaN(o)?null:c;function Hb(h,o,c){const d=h.indexOf(o);if(d===-1)return Ub(h,o,c);const m=h.lastIndexOf(o);return d!==m?c:d}const Gb=(h,o)=>h===null?null:fa(Math.round(h),0,o);class xp extends Nc{constructor(o){super(o),this._startValue=void 0,this._valueRange=0}parse(o,c){if(Dr(o))return null;const d=this.getLabels();return c=isFinite(c)&&d[c]===o?c:Hb(d,o,gr(c,o)),Gb(c,d.length-1)}determineDataLimits(){const{minDefined:o,maxDefined:c}=this.getUserBounds();let{min:d,max:m}=this.getMinMax(!0);this.options.bounds==="ticks"&&(o||(d=0),c||(m=this.getLabels().length-1)),this.min=d,this.max=m}buildTicks(){const o=this.min,c=this.max,d=this.options.offset,m=[];let y=this.getLabels();y=o===0&&c===y.length-1?y:y.slice(o,c+1),this._valueRange=Math.max(y.length-(d?0:1),1),this._startValue=this.min-(d?.5:0);for(let _=o;_<=c;_++)m.push({value:_});return m}getLabelForValue(o){const c=this.getLabels();return o>=0&&o<c.length?c[o]:o}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(o){return typeof o!="number"&&(o=this.parse(o)),o===null?NaN:this.getPixelForDecimal((o-this._startValue)/this._valueRange)}getPixelForTick(o){const c=this.ticks;return o<0||o>c.length-1?null:this.getPixelForValue(c[o].value)}getValueForPixel(o){return Math.round(this._startValue+this.getDecimalForPixel(o)*this._valueRange)}getBasePixel(){return this.bottom}}xp.id="category",xp.defaults={ticks:{callback:xp.prototype.getLabelForValue}};function Vb(h,o){const c=[],{bounds:d,step:m,min:y,max:_,precision:T,count:D,maxTicks:U,maxDigits:Y,includeBounds:Q}=h,fe=m||1,Te=U-1,{min:Ue,max:it}=o,vt=!Dr(y),Lt=!Dr(_),Vn=!Dr(D),zn=(it-Ue)/(Y+1);let yn=Pm((it-Ue)/Te/fe)*fe,Wn,pi,wi,Vi;if(yn<1e-14&&!vt&&!Lt)return[{value:Ue},{value:it}];Vi=Math.ceil(it/yn)-Math.floor(Ue/yn),Vi>Te&&(yn=Pm(Vi*yn/Te/fe)*fe),Dr(T)||(Wn=Math.pow(10,T),yn=Math.ceil(yn*Wn)/Wn),d==="ticks"?(pi=Math.floor(Ue/yn)*yn,wi=Math.ceil(it/yn)*yn):(pi=Ue,wi=it),vt&&Lt&&m&&Wv((_-y)/m,yn/1e3)?(Vi=Math.round(Math.min((_-y)/yn,U)),yn=(_-y)/Vi,pi=y,wi=_):Vn?(pi=vt?y:pi,wi=Lt?_:wi,Vi=D-1,yn=(wi-pi)/Vi):(Vi=(wi-pi)/yn,hh(Vi,Math.round(Vi),yn/1e3)?Vi=Math.round(Vi):Vi=Math.ceil(Vi));const Lr=Math.max(Dm(yn),Dm(pi));Wn=Math.pow(10,Dr(T)?Lr:T),pi=Math.round(pi*Wn)/Wn,wi=Math.round(wi*Wn)/Wn;let Br=0;for(vt&&(Q&&pi!==y?(c.push({value:y}),pi<y&&Br++,hh(Math.round((pi+Br*yn)*Wn)/Wn,y,e0(y,zn,h))&&Br++):pi<y&&Br++);Br<Vi;++Br)c.push({value:Math.round((pi+Br*yn)*Wn)/Wn});return Lt&&Q&&wi!==_?c.length&&hh(c[c.length-1].value,_,e0(_,zn,h))?c[c.length-1].value=_:c.push({value:_}):(!Lt||wi===_)&&c.push({value:wi}),c}function e0(h,o,{horizontal:c,minRotation:d}){const m=Co(d),y=(c?Math.sin(m):Math.cos(m))||.001,_=.75*o*(""+h).length;return Math.min(o/y,_)}class _p extends Nc{constructor(o){super(o),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(o){return Dr(o)||(typeof o=="number"||o instanceof Number)&&!isFinite(+o)?null:+o}handleTickRangeOptions(){const{beginAtZero:o}=this.options,{minDefined:c,maxDefined:d}=this.getUserBounds();let{min:m,max:y}=this;const _=D=>m=c?m:D,T=D=>y=d?y:D;if(o){const D=Xo(m),U=Xo(y);D<0&&U<0?T(0):D>0&&U>0&&_(0)}if(m===y){let D=1;(y>=Number.MAX_SAFE_INTEGER||m<=Number.MIN_SAFE_INTEGER)&&(D=Math.abs(y*.05)),T(y+D),o||_(m-D)}this.min=m,this.max=y}getTickLimit(){const o=this.options.ticks;let{maxTicksLimit:c,stepSize:d}=o,m;return d?(m=Math.ceil(this.max/d)-Math.floor(this.min/d)+1,m>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${d} would result generating up to ${m} ticks. Limiting to 1000.`),m=1e3)):(m=this.computeTickLimit(),c=c||11),c&&(m=Math.min(c,m)),m}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const o=this.options,c=o.ticks;let d=this.getTickLimit();d=Math.max(2,d);const m={maxTicks:d,bounds:o.bounds,min:o.min,max:o.max,precision:c.precision,step:c.stepSize,count:c.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:c.minRotation||0,includeBounds:c.includeBounds!==!1},y=this._range||this,_=Vb(m,y);return o.bounds==="ticks"&&Rm(_,this,"value"),o.reverse?(_.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),_}configure(){const o=this.ticks;let c=this.min,d=this.max;if(super.configure(),this.options.offset&&o.length){const m=(d-c)/Math.max(o.length-1,1)/2;c-=m,d+=m}this._startValue=c,this._endValue=d,this._valueRange=d-c}getLabelForValue(o){return Yo(o,this.chart.options.locale)}}class vg extends _p{determineDataLimits(){const{min:o,max:c}=this.getMinMax(!0);this.min=Ws(o)?o:0,this.max=Ws(c)?c:1,this.handleTickRangeOptions()}computeTickLimit(){const o=this.isHorizontal(),c=o?this.width:this.height,d=Co(this.options.ticks.minRotation),m=(o?Math.sin(d):Math.cos(d))||.001,y=this._resolveTickFontOptions(0);return Math.ceil(c/Math.min(40,y.lineHeight/m))}getPixelForValue(o){return o===null?NaN:this.getPixelForDecimal((o-this._startValue)/this._valueRange)}getValueForPixel(o){return this._startValue+this.getDecimalForPixel(o)*this._valueRange}}vg.id="linear",vg.defaults={ticks:{callback:_l.formatters.numeric}};function t0(h){return h/Math.pow(10,Math.floor(po(h)))===1}function Wb(h,o){const c=Math.floor(po(o.max)),d=Math.ceil(o.max/Math.pow(10,c)),m=[];let y=ho(h.min,Math.pow(10,Math.floor(po(o.min)))),_=Math.floor(po(y)),T=Math.floor(y/Math.pow(10,_)),D=_<0?Math.pow(10,Math.abs(_)):1;do m.push({value:y,major:t0(y)}),++T,T===10&&(T=1,++_,D=_>=0?1:D),y=Math.round(T*Math.pow(10,_)*D)/D;while(_<c||_===c&&T<d);const U=ho(h.max,y);return m.push({value:U,major:t0(y)}),m}class yg extends Nc{constructor(o){super(o),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(o,c){const d=_p.prototype.parse.apply(this,[o,c]);if(d===0){this._zero=!0;return}return Ws(d)&&d>0?d:null}determineDataLimits(){const{min:o,max:c}=this.getMinMax(!0);this.min=Ws(o)?Math.max(0,o):null,this.max=Ws(c)?Math.max(0,c):null,this.options.beginAtZero&&(this._zero=!0),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:o,maxDefined:c}=this.getUserBounds();let d=this.min,m=this.max;const y=D=>d=o?d:D,_=D=>m=c?m:D,T=(D,U)=>Math.pow(10,Math.floor(po(D))+U);d===m&&(d<=0?(y(1),_(10)):(y(T(d,-1)),_(T(m,1)))),d<=0&&y(T(m,-1)),m<=0&&_(T(d,1)),this._zero&&this.min!==this._suggestedMin&&d===T(this.min,0)&&y(T(d,-1)),this.min=d,this.max=m}buildTicks(){const o=this.options,c={min:this._userMin,max:this._userMax},d=Wb(c,this);return o.bounds==="ticks"&&Rm(d,this,"value"),o.reverse?(d.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),d}getLabelForValue(o){return o===void 0?"0":Yo(o,this.chart.options.locale)}configure(){const o=this.min;super.configure(),this._startValue=po(o),this._valueRange=po(this.max)-po(o)}getPixelForValue(o){return(o===void 0||o===0)&&(o=this.min),o===null||isNaN(o)?NaN:this.getPixelForDecimal(o===this.min?0:(po(o)-this._startValue)/this._valueRange)}getValueForPixel(o){const c=this.getDecimalForPixel(o);return Math.pow(10,this._startValue+c*this._valueRange)}}yg.id="logarithmic",yg.defaults={ticks:{callback:_l.formatters.logarithmic,major:{enabled:!0}}};function xg(h){const o=h.ticks;if(o.display&&h.display){const c=Ps(o.backdropPadding);return gr(o.font&&o.font.size,Ir.font.size)+c.height}return 0}function Xb(h,o,c){return c=Tr(c)?c:[c],{w:Zv(h,o.string,c),h:c.length*o.lineHeight}}function n0(h,o,c,d,m){return h===d||h===m?{start:o-c/2,end:o+c/2}:h<d||h>m?{start:o-c,end:o}:{start:o,end:o+c}}function qb(h){const o={l:0,r:h.width,t:0,b:h.height-h.paddingTop},c={},d=[],m=[],y=h.getLabels().length;for(let _=0;_<y;_++){const T=h.options.pointLabels.setContext(h.getPointLabelContext(_));m[_]=T.padding;const D=h.getPointPosition(_,h.drawingArea+m[_]),U=qs(T.font),Y=Xb(h.ctx,U,h._pointLabels[_]);d[_]=Y;const Q=h.getIndexAngle(_),fe=Bd(Q),Te=n0(fe,D.x,Y.w,0,180),Ue=n0(fe,D.y,Y.h,90,270);Te.start<o.l&&(o.l=Te.start,c.l=Q),Te.end>o.r&&(o.r=Te.end,c.r=Q),Ue.start<o.t&&(o.t=Ue.start,c.t=Q),Ue.end>o.b&&(o.b=Ue.end,c.b=Q)}h._setReductions(h.drawingArea,o,c),h._pointLabelItems=jb(h,d,m)}function jb(h,o,c){const d=[],m=h.getLabels().length,y=h.options,_=xg(y),T=h.getDistanceFromCenterForValue(y.ticks.reverse?h.min:h.max);for(let D=0;D<m;D++){const U=D===0?_/2:0,Y=h.getPointPosition(D,T+U+c[D]),Q=Bd(h.getIndexAngle(D)),fe=o[D],Te=Jb(Y.y,fe.h,Q),Ue=Yb(Q),it=Zb(Y.x,fe.w,Ue);d.push({x:Y.x,y:Te,textAlign:Ue,left:it,top:Te,right:it+fe.w,bottom:Te+fe.h})}return d}function Yb(h){return h===0||h===180?"center":h<180?"left":"right"}function Zb(h,o,c){return c==="right"?h-=o:c==="center"&&(h-=o/2),h}function Jb(h,o,c){return c===90||c===270?h-=o/2:(c>270||c<90)&&(h-=o),h}function $b(h,o){const{ctx:c,options:{pointLabels:d}}=h;for(let m=o-1;m>=0;m--){const y=d.setContext(h.getPointLabelContext(m)),_=qs(y.font),{x:T,y:D,textAlign:U,left:Y,top:Q,right:fe,bottom:Te}=h._pointLabelItems[m],{backdropColor:Ue}=y;if(!Dr(Ue)){const it=Ps(y.backdropPadding);c.fillStyle=Ue,c.fillRect(Y-it.left,Q-it.top,fe-Y+it.width,Te-Q+it.height)}mo(c,h._pointLabels[m],T,D+_.lineHeight/2,_,{color:y.color,textAlign:U,textBaseline:"middle"})}}function i0(h,o,c,d){const{ctx:m}=h;if(c)m.arc(h.xCenter,h.yCenter,o,0,us);else{let y=h.getPointPosition(0,o);m.moveTo(y.x,y.y);for(let _=1;_<d;_++)y=h.getPointPosition(_,o),m.lineTo(y.x,y.y)}}function Kb(h,o,c,d){const m=h.ctx,y=o.circular,{color:_,lineWidth:T}=o;!y&&!d||!_||!T||c<0||(m.save(),m.strokeStyle=_,m.lineWidth=T,m.setLineDash(o.borderDash),m.lineDashOffset=o.borderDashOffset,m.beginPath(),i0(h,c,y,d),m.closePath(),m.stroke(),m.restore())}function bp(h){return fu(h)?h:0}function r0(h,o,c){return jo(h,{label:c,index:o,type:"pointLabel"})}class Ch extends _p{constructor(o){super(o),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){this.width=this.maxWidth,this.height=this.maxHeight,this.paddingTop=xg(this.options)/2,this.xCenter=Math.floor(this.width/2),this.yCenter=Math.floor((this.height-this.paddingTop)/2),this.drawingArea=Math.min(this.height-this.paddingTop,this.width)/2}determineDataLimits(){const{min:o,max:c}=this.getMinMax(!1);this.min=Ws(o)&&!isNaN(o)?o:0,this.max=Ws(c)&&!isNaN(c)?c:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/xg(this.options))}generateTickLabels(o){_p.prototype.generateTickLabels.call(this,o),this._pointLabels=this.getLabels().map((c,d)=>{const m=Or(this.options.pointLabels.callback,[c,d],this);return m||m===0?m:""})}fit(){const o=this.options;o.display&&o.pointLabels.display?qb(this):this.setCenterPoint(0,0,0,0)}_setReductions(o,c,d){let m=c.l/Math.sin(d.l),y=Math.max(c.r-this.width,0)/Math.sin(d.r),_=-c.t/Math.cos(d.t),T=-Math.max(c.b-(this.height-this.paddingTop),0)/Math.cos(d.b);m=bp(m),y=bp(y),_=bp(_),T=bp(T),this.drawingArea=Math.max(o/2,Math.min(Math.floor(o-(m+y)/2),Math.floor(o-(_+T)/2))),this.setCenterPoint(m,y,_,T)}setCenterPoint(o,c,d,m){const y=this.width-c-this.drawingArea,_=o+this.drawingArea,T=d+this.drawingArea,D=this.height-this.paddingTop-m-this.drawingArea;this.xCenter=Math.floor((_+y)/2+this.left),this.yCenter=Math.floor((T+D)/2+this.top+this.paddingTop)}getIndexAngle(o){const c=us/this.getLabels().length,d=this.options.startAngle||0;return Po(o*c+Co(d))}getDistanceFromCenterForValue(o){if(Dr(o))return NaN;const c=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-o)*c:(o-this.min)*c}getValueForDistanceFromCenter(o){if(Dr(o))return NaN;const c=o/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-c:this.min+c}getPointLabelContext(o){const c=this._pointLabels||[];if(o>=0&&o<c.length){const d=c[o];return r0(this.getContext(),o,d)}}getPointPosition(o,c){const d=this.getIndexAngle(o)-Xs;return{x:Math.cos(d)*c+this.xCenter,y:Math.sin(d)*c+this.yCenter,angle:d}}getPointPositionForValue(o,c){return this.getPointPosition(o,this.getDistanceFromCenterForValue(c))}getBasePosition(o){return this.getPointPositionForValue(o||0,this.getBaseValue())}getPointLabelPosition(o){const{left:c,top:d,right:m,bottom:y}=this._pointLabelItems[o];return{left:c,top:d,right:m,bottom:y}}drawBackground(){const{backgroundColor:o,grid:{circular:c}}=this.options;if(o){const d=this.ctx;d.save(),d.beginPath(),i0(this,this.getDistanceFromCenterForValue(this._endValue),c,this.getLabels().length),d.closePath(),d.fillStyle=o,d.fill(),d.restore()}}drawGrid(){const o=this.ctx,c=this.options,{angleLines:d,grid:m}=c,y=this.getLabels().length;let _,T,D;if(c.pointLabels.display&&$b(this,y),m.display&&this.ticks.forEach((U,Y)=>{if(Y!==0){T=this.getDistanceFromCenterForValue(U.value);const Q=m.setContext(this.getContext(Y-1));Kb(this,Q,T,y)}}),d.display){for(o.save(),_=this.getLabels().length-1;_>=0;_--){const U=d.setContext(this.getPointLabelContext(_)),{color:Y,lineWidth:Q}=U;!Q||!Y||(o.lineWidth=Q,o.strokeStyle=Y,o.setLineDash(U.borderDash),o.lineDashOffset=U.borderDashOffset,T=this.getDistanceFromCenterForValue(c.ticks.reverse?this.min:this.max),D=this.getPointPosition(_,T),o.beginPath(),o.moveTo(this.xCenter,this.yCenter),o.lineTo(D.x,D.y),o.stroke())}o.restore()}}drawBorder(){}drawLabels(){const o=this.ctx,c=this.options,d=c.ticks;if(!d.display)return;const m=this.getIndexAngle(0);let y,_;o.save(),o.translate(this.xCenter,this.yCenter),o.rotate(m),o.textAlign="center",o.textBaseline="middle",this.ticks.forEach((T,D)=>{if(D===0&&!c.reverse)return;const U=d.setContext(this.getContext(D)),Y=qs(U.font);if(y=this.getDistanceFromCenterForValue(this.ticks[D].value),U.showLabelBackdrop){o.font=Y.string,_=o.measureText(T.label).width,o.fillStyle=U.backdropColor;const Q=Ps(U.backdropPadding);o.fillRect(-_/2-Q.left,-y-Y.size/2-Q.top,_+Q.width,Y.size+Q.height)}mo(o,T.label,0,-y,Y,{color:U.color})}),o.restore()}drawTitle(){}}Ch.id="radialLinear",Ch.defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:_l.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(h){return h},padding:5}},Ch.defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"},Ch.descriptors={angleLines:{_fallback:"grid"}};const Ph={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Wa=Object.keys(Ph);function Qb(h,o){return h-o}function Yl(h,o){if(Dr(o))return null;const c=h._adapter,{parser:d,round:m,isoWeekday:y}=h._parseOpts;let _=o;return typeof d=="function"&&(_=d(_)),Ws(_)||(_=typeof d=="string"?c.parse(_,d):c.parse(_)),_===null?null:(m&&(_=m==="week"&&(fu(y)||y===!0)?c.startOf(_,"isoWeek",y):c.startOf(_,m)),+_)}function _g(h,o,c,d){const m=Wa.length;for(let y=Wa.indexOf(h);y<m-1;++y){const _=Ph[Wa[y]],T=_.steps?_.steps:Number.MAX_SAFE_INTEGER;if(_.common&&Math.ceil((c-o)/(T*_.size))<=d)return Wa[y]}return Wa[m-1]}function ew(h,o,c,d,m){for(let y=Wa.length-1;y>=Wa.indexOf(c);y--){const _=Wa[y];if(Ph[_].common&&h._adapter.diff(m,d,_)>=o-1)return _}return Wa[c?Wa.indexOf(c):0]}function tw(h){for(let o=Wa.indexOf(h)+1,c=Wa.length;o<c;++o)if(Ph[Wa[o]].common)return Wa[o]}function bg(h,o,c){if(!c)h[o]=!0;else if(c.length){const{lo:d,hi:m}=du(c,o),y=c[d]>=o?c[d]:c[m];h[y]=!0}}function s0(h,o,c,d){const m=h._adapter,y=+m.startOf(o[0].value,d),_=o[o.length-1].value;let T,D;for(T=y;T<=_;T=+m.add(T,1,d))D=c[T],D>=0&&(o[D].major=!0);return o}function Rh(h,o,c){const d=[],m={},y=o.length;let _,T;for(_=0;_<y;++_)T=o[_],m[T]=_,d.push({value:T,major:!1});return y===0||!c?d:s0(h,d,m,c)}class Yf extends Nc{constructor(o){super(o),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(o,c){const d=o.time||(o.time={}),m=this._adapter=new Ay._date(o.adapters.date);oh(d.displayFormats,m.formats()),this._parseOpts={parser:d.parser,round:d.round,isoWeekday:d.isoWeekday},super.init(o),this._normalized=c.normalized}parse(o){return o===void 0?null:Yl(this,o)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const o=this.options,c=this._adapter,d=o.time.unit||"day";let{min:m,max:y,minDefined:_,maxDefined:T}=this.getUserBounds();function D(U){!_&&!isNaN(U.min)&&(m=Math.min(m,U.min)),!T&&!isNaN(U.max)&&(y=Math.max(y,U.max))}(!_||!T)&&(D(this._getLabelBounds()),(o.bounds!=="ticks"||o.ticks.source!=="labels")&&D(this.getMinMax(!1))),m=Ws(m)&&!isNaN(m)?m:+c.startOf(Date.now(),d),y=Ws(y)&&!isNaN(y)?y:+c.endOf(Date.now(),d)+1,this.min=Math.min(m,y-1),this.max=Math.max(m+1,y)}_getLabelBounds(){const o=this.getLabelTimestamps();let c=Number.POSITIVE_INFINITY,d=Number.NEGATIVE_INFINITY;return o.length&&(c=o[0],d=o[o.length-1]),{min:c,max:d}}buildTicks(){const o=this.options,c=o.time,d=o.ticks,m=d.source==="labels"?this.getLabelTimestamps():this._generate();o.bounds==="ticks"&&m.length&&(this.min=this._userMin||m[0],this.max=this._userMax||m[m.length-1]);const y=this.min,_=this.max,T=$v(m,y,_);return this._unit=c.unit||(d.autoSkip?_g(c.minUnit,this.min,this.max,this._getLabelCapacity(y)):ew(this,T.length,c.minUnit,this.min,this.max)),this._majorUnit=!d.major.enabled||this._unit==="year"?void 0:tw(this._unit),this.initOffsets(m),o.reverse&&T.reverse(),Rh(this,T,this._majorUnit)}initOffsets(o){let c=0,d=0,m,y;this.options.offset&&o.length&&(m=this.getDecimalForValue(o[0]),o.length===1?c=1-m:c=(this.getDecimalForValue(o[1])-m)/2,y=this.getDecimalForValue(o[o.length-1]),o.length===1?d=y:d=(y-this.getDecimalForValue(o[o.length-2]))/2);const _=o.length<3?.5:.25;c=fa(c,0,_),d=fa(d,0,_),this._offsets={start:c,end:d,factor:1/(c+1+d)}}_generate(){const o=this._adapter,c=this.min,d=this.max,m=this.options,y=m.time,_=y.unit||_g(y.minUnit,c,d,this._getLabelCapacity(c)),T=gr(y.stepSize,1),D=_==="week"?y.isoWeekday:!1,U=fu(D)||D===!0,Y={};let Q=c,fe,Te;if(U&&(Q=+o.startOf(Q,"isoWeek",D)),Q=+o.startOf(Q,U?"day":_),o.diff(d,c,_)>1e5*T)throw new Error(c+" and "+d+" are too far apart with stepSize of "+T+" "+_);const Ue=m.ticks.source==="data"&&this.getDataTimestamps();for(fe=Q,Te=0;fe<d;fe=+o.add(fe,T,_),Te++)bg(Y,fe,Ue);return(fe===d||m.bounds==="ticks"||Te===1)&&bg(Y,fe,Ue),Object.keys(Y).sort((it,vt)=>it-vt).map(it=>+it)}getLabelForValue(o){const c=this._adapter,d=this.options.time;return d.tooltipFormat?c.format(o,d.tooltipFormat):c.format(o,d.displayFormats.datetime)}_tickFormatFunction(o,c,d,m){const y=this.options,_=y.time.displayFormats,T=this._unit,D=this._majorUnit,U=T&&_[T],Y=D&&_[D],Q=d[c],fe=D&&Y&&Q&&Q.major,Te=this._adapter.format(o,m||(fe?Y:U)),Ue=y.ticks.callback;return Ue?Or(Ue,[Te,c,d],this):Te}generateTickLabels(o){let c,d,m;for(c=0,d=o.length;c<d;++c)m=o[c],m.label=this._tickFormatFunction(m.value,c,o)}getDecimalForValue(o){return o===null?NaN:(o-this.min)/(this.max-this.min)}getPixelForValue(o){const c=this._offsets,d=this.getDecimalForValue(o);return this.getPixelForDecimal((c.start+d)*c.factor)}getValueForPixel(o){const c=this._offsets,d=this.getDecimalForPixel(o)/c.factor-c.end;return this.min+d*(this.max-this.min)}_getLabelSize(o){const c=this.options.ticks,d=this.ctx.measureText(o).width,m=Co(this.isHorizontal()?c.maxRotation:c.minRotation),y=Math.cos(m),_=Math.sin(m),T=this._resolveTickFontOptions(0).size;return{w:d*y+T*_,h:d*_+T*y}}_getLabelCapacity(o){const c=this.options.time,d=c.displayFormats,m=d[c.unit]||d.millisecond,y=this._tickFormatFunction(o,0,Rh(this,[o],this._majorUnit),m),_=this._getLabelSize(y),T=Math.floor(this.isHorizontal()?this.width/_.w:this.height/_.h)-1;return T>0?T:1}getDataTimestamps(){let o=this._cache.data||[],c,d;if(o.length)return o;const m=this.getMatchingVisibleMetas();if(this._normalized&&m.length)return this._cache.data=m[0].controller.getAllParsedValues(this);for(c=0,d=m.length;c<d;++c)o=o.concat(m[c].controller.getAllParsedValues(this));return this._cache.data=this.normalize(o)}getLabelTimestamps(){const o=this._cache.labels||[];let c,d;if(o.length)return o;const m=this.getLabels();for(c=0,d=m.length;c<d;++c)o.push(Yl(this,m[c]));return this._cache.labels=this._normalized?o:this.normalize(o)}normalize(o){return ph(o.sort(Qb))}}Yf.id="time",Yf.defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",major:{enabled:!1}}};function wp(h,o,c){let d=0,m=h.length-1,y,_,T,D;c?(o>=h[d].pos&&o<=h[m].pos&&({lo:d,hi:m}=Ro(h,"pos",o)),{pos:y,time:T}=h[d],{pos:_,time:D}=h[m]):(o>=h[d].time&&o<=h[m].time&&({lo:d,hi:m}=Ro(h,"time",o)),{time:y,pos:T}=h[d],{time:_,pos:D}=h[m]);const U=_-y;return U?T+(D-T)*(o-y)/U:T}class wg extends Yf{constructor(o){super(o),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const o=this._getTimestampsForTable(),c=this._table=this.buildLookupTable(o);this._minPos=wp(c,this.min),this._tableRange=wp(c,this.max)-this._minPos,super.initOffsets(o)}buildLookupTable(o){const{min:c,max:d}=this,m=[],y=[];let _,T,D,U,Y;for(_=0,T=o.length;_<T;++_)U=o[_],U>=c&&U<=d&&m.push(U);if(m.length<2)return[{time:c,pos:0},{time:d,pos:1}];for(_=0,T=m.length;_<T;++_)Y=m[_+1],D=m[_-1],U=m[_],Math.round((Y+D)/2)!==U&&y.push({time:U,pos:_/(T-1)});return y}_getTimestampsForTable(){let o=this._cache.all||[];if(o.length)return o;const c=this.getDataTimestamps(),d=this.getLabelTimestamps();return c.length&&d.length?o=this.normalize(c.concat(d)):o=c.length?c:d,o=this._cache.all=o,o}getDecimalForValue(o){return(wp(this._table,o)-this._minPos)/this._tableRange}getValueForPixel(o){const c=this._offsets,d=this.getDecimalForPixel(o)/c.factor-c.end;return wp(this._table,d*this._tableRange+this._minPos,!0)}}wg.id="timeseries",wg.defaults=Yf.defaults;var a0=Object.freeze({__proto__:null,CategoryScale:xp,LinearScale:vg,LogarithmicScale:yg,RadialLinearScale:Ch,TimeScale:Yf,TimeSeriesScale:wg});return js.register(Dy,a0,ug,Qy),js.helpers={...Zd},js._adapters=Ay,js.Animation=ql,js.Animations=kf,js.animator=$t,js.controllers=bl.controllers.items,js.DatasetController=Ba,js.Element=Pa,js.elements=ug,js.Interaction=gs,js.layouts=da,js.platforms=ep,js.Scale=Nc,js.Ticks=_l,Object.assign(js,Dy,a0,ug,Qy,ep),js.Chart=js,typeof window<"u"&&(window.Chart=js),js})}),Hn=In.Chart,Un=In.registerables;In.ChartData,In.ChartDataset;function en(zt,Ln){switch(Ln){case"bottom":return zt.bottom-Zt.height;case"center":return Zt.height/2-(zt.top+zt.height/2)}return zt.top}function Yt(zt,Ln,Nn,Tt,_n,Ut,ce,At,$t){const wn=Zt.isIE?"":null,Gn=zt.style;Gn.top=Ln===null?wn:Fn(Ln)?Ln:Ln+"px",Gn.left=Nn===null?wn:Fn(Nn)?Nn:Nn+"px",Gn.bottom=Tt===null?wn:Fn(Tt)?Tt:Tt+"px",Gn.width=_n===null?wn:_n+"px",Gn.height=Ut===null?wn:Ut+"px",Gn.position=ce===null?wn:ce,Gn.margin=ce===null?wn:"0",Gn.zIndex=At===null?wn:At+"",Gn.transform=$t===null?wn:`translateY(${$t}px)`}function Pn({pos:zt=0,where:Ln="top",type:Nn=1,dist:Tt,children:_n,layer:Ut,hostRef:ce}){const{disabled:At}=Bn(),$t=gt(null),wn=gt(!1),Gn=gt(null),yi=gt(!1),ir=gt(!1),Oi=gt(0),Rr=En(),Qi=gt(0),Bi=gt(null);qt(()=>()=>{ce.current.classList.add("__pp"),Yt(ce.current,null,null,null,null,null,null,null,null)},[]),Bi.current=()=>{console.log("isSticky: ",yi.current);let Ge=ce.current;Zt.isIE;const ct=Ge.style;console.log("initialViewWidth: ",Qi),console.log("newWidth: ",window.innerWidth);let Cn=window.innerWidth-Qi.current;yi.current&&(ct.transform=`translateX(${Cn/2}px)`)},qt(()=>{const Ge=()=>{if(!yi.current)return;console.log("handler..."),console.log("isSticky: ",yi.current);let ct=ce.current;Zt.isIE;const Cn=ct.style;let jt=window.innerWidth-Qi.current;console.log("delta: ",jt),Cn.transform=`translateX(${jt/2}px)`};return window.addEventListener("resize",Ge),()=>{console.log("unmount be like..."),window.removeEventListener("resize",Ge)}},[]),qt(()=>{At||(Qi.current=Zt.width),Yt(ce.current,null,null,null,null,null,null,null,null)},[At]),ln(()=>{const Ge=ce.current;if(At||!Ge)return li(!1);const ct=Zt.scrollTop;if(Oi.current==Rr){if(ir.current)return;ir.current=!0}else ir.current=!1;Oi.current=Rr;const Cn=Ge.getBoundingClientRect();if($t.current){const[jt,pn]=$t.current;jt>=ct||ct>=pn?li(ct>pn):ct<pn&&ni()}else{const jt=en(Cn,Ln);let pn=Ln==="bottom"?-zt:zt;if(jt<pn){const ki=jt-pn;$t.current=[Zt.scrollTop+ki,Zt.scrollTop+at(ki)],ni()}}});const ni=()=>{if(yi.current&&ce.current.style.position==="fixed")return;yi.current=!0;const Ge=ce.current.getBoundingClientRect();let ct,Cn;switch(Ln){case"bottom":Cn=zt,ct="auto";break;case"center":default:ct=zt,Cn="auto"}ce.current.classList.contains("__s")&&(Gn.current||(Gn.current=document.createElement("div")),Gn.current.style.height=ce.current.clientHeight+"px",ce.current.insertAdjacentElement("afterend",Gn.current)),Yt(ce.current,ct,Ge.left,Cn,Ge.width,Ge.height,"fixed",Ut==1?null:Ut?-1:11,null)},li=Ge=>{if(!yi.current)return;yi.current=!1,wn.current=Ge,Ge||($t.current=null),Gn.current&&Gn.current.remove();let ct=null;Ge&&(ct=$t.current[1]-$t.current[0]),Yt(ce.current,null,null,null,null,null,null,null,Ge?ct:null)};function at(Ge,ct){switch(Nn){case 1:return Tt+Ge;default:return 1/0}}return _n}const Nt=zt=>window.getComputedStyle(zt,null);function Ee(zt,Ln){return Nt(zt).getPropertyValue(Ln)}const Xe=function(){return typeof window>"u"?function(zt){return zt()}:window.requestAnimationFrame}();var pt="$chartjs_deferred",wt="$deferred";function kt(zt,Ln){Ln?window.setTimeout(zt,Ln):Xe.call(window,zt)}function mt(zt,Ln){var Nn=parseInt(zt,10);return isNaN(Nn)?0:typeof zt=="string"&&zt.indexOf("%")!==-1?Nn/100*Ln:Nn}function St(zt){var Ln=zt[wt].options,Nn=zt.canvas;if(!Nn||Nn.offsetParent===null)return!1;var Tt=Nn.getBoundingClientRect(),_n=mt(Ln.yOffset||0,Tt.height),Ut=mt(Ln.xOffset||0,Tt.width);return Tt.right-Ut>=0&&Tt.bottom-_n>=0&&Tt.left+Ut<=window.innerWidth&&Tt.top+_n<=window.innerHeight}function It(zt){var Ln=zt.target,Nn=Ln[pt];Nn.ticking||(Nn.ticking=!0,kt(function(){var Tt=Nn.charts.slice(),_n=Tt.length,Ut,ce;for(ce=0;ce<_n;++ce)Ut=Tt[ce],St(Ut)&&(cn(Ut),Ut[wt].appeared=!0,Ut.update());Nn.ticking=!1},!1))}function Tn(zt){var Ln=zt.nodeType;if(Ln===Node.ELEMENT_NODE){var Nn=Ee(zt,"overflow-x"),Tt=Ee(zt,"overflow-y");return Nn==="auto"||Nn==="scroll"||Tt==="auto"||Tt==="scroll"}return zt.nodeType===Node.DOCUMENT_NODE}function Ft(zt){for(var Ln=zt.canvas,Nn=Ln.parentElement,Tt,_n;Nn;)Tn(Nn)&&(Tt=Nn[pt]||(Nn[pt]={}),_n=Tt.charts||(Tt.charts=[]),_n.length===0&&Nn.addEventListener("scroll",It),_n.push(zt),zt[wt].elements.push(Nn)),Nn=Nn.parentElement||Nn.ownerDocument}function cn(zt){zt[wt].elements.forEach(function(Ln){var Nn=Ln[pt].charts;Nn.splice(Nn.indexOf(zt),1),Nn.length||(Ln.removeEventListener("scroll",It),delete Ln[pt])}),zt[wt].elements=[]}const nn={id:"deferred",defaults:{xOffset:0,yOffset:0,delay:0},beforeInit:function(zt,Ln,Nn){zt[wt]={options:Nn,appeared:!1,delayed:!1,loaded:!1,elements:[]},Ft(zt)},beforeDatasetsUpdate:function(zt,Ln,Nn){var Tt=zt[wt];if(!Tt.loaded){if(!Tt.appeared&&!St(zt))return!1;if(Tt.appeared=!0,Tt.loaded=!0,cn(zt),Nn.delay>0)return Tt.delayed=!0,kt(function(){zt.ctx&&(Tt.delayed=!1,zt.update())},Nn.delay),!1}if(Tt.delayed)return!1},destroy:function(zt){cn(zt)}},di={id:"legendPadding",beforeInit:function(zt,Ln,Nn){var _n;if(((_n=zt==null?void 0:zt.legend)==null?void 0:_n.position)=="bottom")return;const Tt=zt.legend.fit;zt.legend.fit=function(){return Tt.bind(zt.legend)(),this.height+=10}}},Ri={maintainAspectRatio:!1},Ti={labels:["2000","2001","2002","2003","2004","2005"],datasets:[{label:"Apples",data:["5","3","7","2","7","2"]}]};Hn.register(...Un||[]);function Gi(zt){const{hostRef:Ln,data:Nn,chartType:Tt,datasetsOptions:_n,nonIndexableDatasetOptions:Ut,axesOptions:ce,legendOptions:At,animationSettings:$t}=zt,[wn,Gn]=Ct(Ti),[yi,ir]=Ct(Ri),[Oi,Rr]=Ct(0),[Qi,Bi]=Ct(0),{disabled:ni}=Bn(),li=gt(null),at=gt(null),Ge=gt([]),ct=gt(0);console.log(Nn);const Cn=["radar","polarArea"],jt=["doughnut","pie"];qt(()=>{const or=()=>{Rr(Ln.current.ownerDocument.documentElement.scrollTop)};let ns=null;return Ln.current&&(Bi(Ln.current.ownerDocument.documentElement.scrollTop+Ln.current.getBoundingClientRect().top),Ln.current.ownerDocument.addEventListener("scroll",or),ns=Ln.current.ownerDocument),()=>{Ai(),ns&&ns.removeEventListener("scroll",or)}},[ni]),qt(()=>{pn()},[Oi]),qt(()=>{!Tt||setTimeout(()=>ki(),0)},[wn,yi,ni]),qt(()=>{!Tt||!_n||!ce||!At||jr()},[Tt,_n,ce,At]),qt(()=>{!Nn||!_n||!Ut||Si(Nn,_n,Ut)},[Nn,_n,Ut]);function pn(){if(ni||!at.current||!$t.addAnimations||$t.animationType!=="scroll"||Date.now()-ct.current<50)return;const or=["bar","doughnut","pie","polarArea"],ns=$t.scrollTopDistance?$t.scrollTopDistance:0,rr=1-($t.scrollLength+Qi-ns-Oi)/$t.scrollLength;if($t.byDataset){const lr=at.current.data.datasets.length;let xt=lr;rr>=1?xt=lr:rr<=0?xt=0:xt=Math.ceil(lr*rr);for(let sn=0;sn<lr;sn++)sn<xt?at.current.setDatasetVisibility(sn,!0):at.current.setDatasetVisibility(sn,!1)}else{let lr=0;at.current.data.datasets.forEach((sn,_i)=>{lr=Math.max(at.current.data.datasets[_i].data.length,lr)});let xt=lr;if(rr>=1?xt=lr:rr<=0?xt=0:xt=Math.ceil(lr*rr),or.indexOf(Tt)>=0)for(let sn=0;sn<lr;sn++)sn<xt?at.current.getDataVisibility(sn)==!1&&at.current.toggleDataVisibility(sn):at.current.getDataVisibility(sn)==!0&&at.current.toggleDataVisibility(sn);else at.current.data.datasets.forEach((sn,_i)=>{if(!Ge.current[_i])return;const Hr=[...Ge.current[_i].slice(0,xt),...new Array(Ge.current[_i].length-xt).fill(0)];at.current.data.datasets[_i].data=Hr})}at.current.update(),ct.current=Date.now()}function ki(){if(!li.current)return;const or=li.current.getContext("2d");at.current&&at.current.destroy(),console.log("chart data",wn),at.current=new Hn(or,{type:Tt,data:wn,options:yi,plugins:[nn,di]}),ct.current=0,pn()}function Ai(){at.current&&at.current.destroy()}function jr(){const or=lr=>lr.dataset.unformattedValue[lr.dataIndex],ns=lr=>{var xt;return(xt=lr.dataset)==null?void 0:xt.unformattedValue[lr.dataIndex]},rr={...Ri,layout:{padding:20},...Tt=="bar"&&{indexAxis:ce.indexAxis},scales:{...Cn.indexOf(Tt)===-1&&jt.indexOf(Tt)===-1&&{x:{display:ce.x.display,grid:{color:ce.x.grid.color,display:ce.x.grid.display,drawTicks:ce.x.grid.drawTicks,lineWidth:ce.x.grid.lineWidth?ce.x.grid.lineWidth:0,tickColor:ce.x.grid.tickColor,tickLength:ce.x.grid.tickLength?ce.x.grid.tickLength:0,tickWidth:ce.x.grid.tickWidth,drawBorder:!1},ticks:{display:ce.x.ticks.display,color:ce.x.ticks.color,font:{size:ce.x.ticks.font.size,weight:ce.x.ticks.font.weight,family:ce.x.ticks.font.family},minRotation:Math.abs(ce.x.ticks.minRotation)%91,padding:ce.x.ticks.padding?ce.x.ticks.padding:0},position:ce.x.position,min:ce.x.min?ce.x.min:0,max:ce.x.max?ce.x.max:0,reverse:ce.x.reverse,stacked:ce.x.stacked}},...Cn.indexOf(Tt)===-1&&jt.indexOf(Tt)===-1&&{y:{display:ce.y.display,grid:{color:ce.y.grid.color,display:ce.y.grid.display,drawTicks:ce.y.grid.drawTicks,lineWidth:ce.y.grid.lineWidth,tickColor:ce.y.grid.tickColor,tickLength:ce.y.grid.tickLength?ce.y.grid.tickLength:0,tickWidth:ce.y.grid.tickWidth,drawBorder:!1},ticks:{display:ce.y.ticks.display,color:ce.y.ticks.color,font:{size:ce.y.ticks.font.size,weight:ce.y.ticks.font.weight,family:ce.y.ticks.font.family},minRotation:Math.abs(ce.y.ticks.minRotation)%91,padding:ce.y.ticks.padding?ce.y.ticks.padding:0},position:ce.y.position,min:ce.y.min?ce.y.min:0,max:ce.y.max?ce.y.max:0,reverse:ce.y.reverse,stacked:ce.y.stacked}},...Cn.indexOf(Tt)>=0&&{r:{pointLabels:{color:ce.r.ticks.color,display:ce.r.ticks.display,centerPointLabels:!0,font:{size:ce.r.ticks.font.size,weight:ce.r.ticks.font.weight,family:ce.r.ticks.font.family}},display:ce.r.display,grid:{color:ce.r.grid.color,display:ce.r.grid.display,drawTicks:ce.r.grid.drawTicks,lineWidth:ce.r.grid.lineWidth,tickColor:ce.r.grid.tickColor,tickLength:ce.r.grid.tickLength?ce.r.grid.tickLength:0,tickWidth:ce.r.grid.tickWidth,drawBorder:!1},ticks:{z:1,backdropColor:"rgba(255, 255, 255, 0)",display:ce.r.ticks.displayNumeric,color:ce.r.ticks.color,font:{size:ce.r.ticks.font.size,weight:ce.r.ticks.font.weight,family:ce.r.ticks.font.family}},min:ce.r.min?ce.r.min:0,max:ce.r.max?ce.r.max:0,reverse:ce.r.reverse,stacked:ce.r.stacked}}},plugins:{legend:{display:At.display,position:At.position,align:At.align,labels:{boxWidth:At.labels.boxWidth?At.labels.boxWidth:0,boxHeight:At.labels.boxHeight?At.labels.boxHeight:0,color:At.labels.color,font:{size:At.labels.font.size?At.labels.font.size:0,weight:At.labels.font.weight,family:At.labels.font.family}},reverse:At.reverse},...jt.indexOf(Tt)!==-1&&{tooltip:{callbacks:{title:ns,label:or}}},...(Tt==="bar"||Tt==="radar")&&{tooltip:{callbacks:{label:lr=>{const xt=lr.dataset.label,sn=lr.dataset.unformattedValue[lr.dataIndex];return`${xt}: ${sn}`}}}},...$t.addAnimations&&$t.animationType==="view"&&{deferred:{xOffset:$t.xOffset?$t.xOffset+"%":0,yOffset:$t.yOffset?$t.yOffset+"%":0,delay:$t.delay?$t.delay:0}}},...!$t.addAnimations&&{animation:{duration:0}},maintainAspectRatio:!1};ir(rr)}function Si(or,ns,rr){var Er;const{length:lr}=Object.keys(or[0]),xt=or.length,sn={labels:[],datasets:[]};Ge.current=[];for(let ci=1;ci<lr;ci++){Ge.current.push([]);for(let cr=1;cr<xt;cr++)Ge.current[ci-1].push(or[cr][ci])}const _i=ci=>parseFloat(ci.replaceAll(",",""));for(let ci=0;ci<Ge.current.length;ci++){const cr=ns[ci+1]&&Xn(ns[ci+1]);let $r={};Tt=="bar"||Tt=="polarArea"?$r={label:or[0][ci+1],data:Ge.current[ci].map(_i),unformattedValue:Ge.current[ci],...cr&&{backgroundColor:cr.backgroundColor},...cr&&{hoverBackgroundColor:cr.hoverBackgroundColor},...cr&&{borderColor:cr.borderColor},...cr&&{borderWidth:cr.borderWidth},...cr&&{borderRadius:cr.borderRadius}}:Tt=="line"?$r={label:or[0][ci+1],data:Ge.current[ci].map(_i),unformattedValue:Ge.current[ci],...rr[ci+1]&&{borderColor:rr[ci+1].borderColor},...rr[ci+1]&&{backgroundColor:rr[ci+1].backgroundColor},...rr[ci+1]&&{fill:rr[ci+1].fill}}:Tt=="radar"?$r={label:or[0][ci+1],data:Ge.current[ci].map(_i),unformattedValue:Ge.current[ci],...rr[ci+1]&&{backgroundColor:rr[ci+1].backgroundColor},...rr[ci+1]&&{borderColor:rr[ci+1].borderColor}}:(Tt=="doughnut"||Tt=="pie")&&($r={label:or[0][ci+1],data:Ge.current[ci].map(_i),unformattedValue:Ge.current[ci],...cr&&{backgroundColor:cr.backgroundColor},...cr&&{hoverBackgroundColor:cr.hoverBackgroundColor},...cr&&{borderColor:cr.borderColor},...cr&&{borderWidth:cr.borderWidth},...cr&&{borderRadius:cr.borderRadius},...rr[ci+1]&&{circumference:rr[ci+1].circumference},...((Er=rr[ci+1])==null?void 0:Er.rotation)&&{rotation:rr[ci+1].rotation},...rr[ci+1]&&{cutout:rr[ci+1].cutout?rr[ci+1].cutout:0}}),sn.datasets.push($r)}const Hr=[];for(let ci=1;ci<xt;ci++)Hr.push(or[ci][0]);sn.labels=Hr,Gn(sn)}return Tt?st.createElement(st.Fragment,null,$t.addAnimations&&$t.animationType==="scroll"?st.createElement(Pn,{pos:$t.scrollTopDistance?$t.scrollTopDistance:0,where:"top",type:1,dist:$t.scrollLength,layer:1,hostRef:Ln},st.createElement("div",{className:"graphContainer"},st.createElement("canvas",{id:"chart",ref:li}))):st.createElement("canvas",{id:"chart",ref:li})):st.createElement("div",{className:"center"},st.createElement("h2",null,"Select Chart Type"),st.createElement("p",null,"double-click"))}function Xn(zt){const Ln={backgroundColor:[],hoverBackgroundColor:[],borderColor:[],borderWidth:[],borderRadius:[]};return Object.keys(zt).sort((Nn,Tt)=>parseInt(Nn)-parseInt(Tt)).forEach(Nn=>{Ln.backgroundColor.push(zt[Nn].backgroundColor),Ln.hoverBackgroundColor.push(zt[Nn].hoverBackgroundColor),zt[Nn].addBorderColor&&Ln.borderColor.push(zt[Nn].borderColor),zt[Nn].addBorderColor?Ln.borderWidth.push(zt[Nn].borderWidth):Ln.borderWidth.push(0),zt[Nn].addBorderColor&&zt[Nn].addBorderRadius&&Ln.borderRadius.push(zt[Nn].borderRadius)}),Ln}}}}),Bs.register("p781xluu",["vev","react"],function(Ki){"use strict";var gt,qt,Ct,Bn,En,Zt;return{setters:[function(ln){gt=ln.useEditorState,qt=ln.Icon,Ct=ln.useVisible},function(ln){Bn=ln.useState,En=ln.useEffect,Zt=ln.useRef}],execute:function(){Ki({w781xmok:ln,w781xncq:Fn,w781y5zf:Rn,w781zgam:In,w94GI2BwO:en});function ln({playerParams:Yt}){const[Pn,Nt]=Bn(null),{disabled:Ee}=gt();return En(()=>{const{url:Xe,color:pt,autoplay:wt,classic:kt}=Yt;let mt="https://w.soundcloud.com/player/?url="+Xe;wt&&!Ee&&(mt+="&auto_play=true"),pt&&(mt+="&color=%23"+Yt.color),kt||(mt+="&visual=true"),Nt(mt)},[Yt,Ee]),st.createElement("iframe",{width:"100%",height:"100%",scrolling:"no",allow:"autoplay",src:Pn})}function Fn({url:Yt}){const Pn=Nt=>{let Ee=Nt;return Ee.match(/\/browse/g)&&(Ee=Ee.replace(/\/browse/g,"")),Ee.match(/album/g)&&!Ee.match(/albums/g)&&(Ee=Ee.replace(/album/g,"albums")),Ee.match(/track/g)&&!Ee.match(/tracks/g)&&(Ee=Ee.replace(/track/g,"tracks")),Ee.match(/video/g)&&!Ee.match(/videos/g)&&(Ee=Ee.replace(/video/g,"videos")),Ee.match(/playlist/g)&&!Ee.match(/playlists/g)&&(Ee=Ee.replace(/playlist/g,"playlists")),Ee.match(/embed.tidal.com/g)||(Ee=Ee.replace(/tidal.com/g,"embed.tidal.com")),Ee};return st.createElement("iframe",{src:Pn(Yt),allowFullScreen:!0,frameBorder:"0",style:{width:"100%",height:"100%"}})}function Rn({id:Yt}){const[Pn,Nt]=Bn(null);return En(()=>{!Yt||(Yt.includes("embed.music.apple.com")?Nt(Yt):Nt(Yt.replace(/music.apple.com/g,"embed.music.apple.com")))},[Yt]),st.createElement("iframe",{allow:"autoplay *; encrypted-media *;",frameBorder:"0",height:"450",style:{width:"100%",height:"100%",overflow:"hidden",background:"url(https://tools.applemusic.com/en-us/lockup.svg?)"},sandbox:"allow-forms allow-popups allow-same-origin allow-scripts allow-storage-access-by-user-activation allow-top-navigation-by-user-activation",src:Pn})}function ri({onClick:Yt,loop:Pn,playerRef:Nt,playing:Ee,url:Xe}){return st.createElement("div",{style:{width:"100%",height:"100%"}},st.createElement("div",{className:"button",onClick:Yt},st.createElement(qt,{d:Ee?"pause":"play",className:"icon"})),st.createElement("audio",{preload:"none",ref:Nt,loop:Pn},st.createElement("source",{src:Xe,type:"audio/mpeg"}),"Your browser does not support the audio element"))}function In({controls:Yt,upload:Pn,url:Nt,auto:Ee,loop:Xe,hostRef:pt,color:wt,variant:kt,title:mt,rangeColor:St,rangeBg:It}){const{disabled:Tn}=gt(),[Ft,cn]=Bn(!1),nn=Zt(null),[di,Ri]=Bn(100),Ti=Pn&&Pn.url?Pn.url:Nt;let Gi=Ct(pt);const Xn=Zt(!1);Gi&&(Xn.current=!0),Xn.current&&(Gi=!0);const zt=Hn(pt);En(()=>{if(Gi)return Ln(),()=>Nn()},[Yt,Gi]),En(()=>{!Gi||(Tn&&Ft&&nn.current.pause(),!Tn&&Ee&&zt&&setTimeout(()=>nn.current.play(),600))},[Tn,Gi]),En(()=>{if(!Gi)return;const Ut=Un(pt.current.id,wt,kt,St,It),ce=document==null?void 0:document.createElement("style");return ce&&(ce.innerText=Ut,pt.current.appendChild(ce)),()=>ce==null?void 0:ce.remove()},[wt,kt,St,It]);const Ln=()=>{!(nn!=null&&nn.current)||(nn.current.addEventListener("play",()=>cn(!0)),nn.current.addEventListener("pause",()=>cn(!1)))},Nn=()=>{!(nn!=null&&nn.current)||(nn.current.removeEventListener("play",()=>cn(!0)),nn.current.addEventListener("pause",()=>cn(!1)))},Tt=()=>{Ft?nn.current.pause():nn.current.play()},_n=Ut=>{const ce=Ut.target.value;Ri(ce),nn.current&&(nn.current.volume=ce/100)};return Gi?kt===2?st.createElement("div",{className:"controls fill column container"},kt===2&&st.createElement("input",{onChange:_n,type:"range",id:"audio-mixer",className:"range",min:"0",max:"100",value:di}),st.createElement("div",{className:"fill row wrapper"},kt===2&&mt&&st.createElement("p",{className:"title"},mt),st.createElement("audio",{preload:"none",ref:nn,controls:Yt,style:{width:"100%",height:"100%"},loop:Xe},st.createElement("source",{src:Ti,type:"audio/mpeg"}),"Your browser does not support the audio element."))):Yt?st.createElement("audio",{preload:"none",ref:nn,controls:Yt,style:{width:"100%",height:"100%"},loop:Xe},st.createElement("source",{src:Ti,type:"audio/mpeg"}),"Your browser does not support the audio element."):st.createElement(ri,{url:Ti,onClick:Tt,playerRef:nn,playing:Ft,loop:Xe}):null}const Hn=Yt=>{var Pn;return Ct(Yt),!!((Pn=Yt.current)!=null&&Pn.offsetParent)};function Un(Yt,Pn,Nt,Ee,Xe){let pt=`#${Yt} audio::-webkit-media-controls-panel {background-color: #${Pn};}`;return Nt===2&&(pt+=`#${Yt} audio::-webkit-media-controls-mute-button{display:none;}`,pt+=`#${Yt} audio::-webkit-media-controls-volume-slider{display:none;}`,pt+=`.range{color: #${Pn};}`,pt+=`#${Yt} input[type=range]::-ms-thumb{background:#${Ee};}`,pt+=`#${Yt} input[type=range]::-webkit-slider-thumb{background:#${Ee};}`,pt+=`#${Yt} input[type=range]::-moz-range-thumb{background:#${Ee};}`,pt+=`#${Yt} input[type=range]::-moz-range-track {background:#${Xe};}`,pt+=`#${Yt} input[type=range]::-webkit-slider-runnable-track{background: #${Xe};}`,pt+=`#${Yt} input[type=range]::-ms-fill-upper{background:#${Xe};}`,pt+=`#${Yt} input[type=range]::-ms-fill-lower{background:#${Xe};}`),pt}function en({link:Yt}){const Pn=Yt.replace("open.spotify.com/","open.spotify.com/embed/");return Pn.indexOf("open.spotify.com/embed")!==-1?st.createElement("iframe",{src:Pn,width:"100%",height:"100%",frameBorder:"0",allowTransparency:!0,allow:"encrypted-media"}):st.createElement("h3",{style:{textAlign:"center",position:"absolute",bottom:0,left:0,width:"100%"}},"Invalid Spotify link")}}}}),Bs.register("p77ya0hd",["react","animejs","vev"],function(Ki){"use strict";var gt,qt,Ct,Bn,En,Zt,ln;return{setters:[function(Fn){gt=Fn.useRef,qt=Fn.useState,Ct=Fn.useEffect,Bn=Fn.useMemo,En=Fn.useLayoutEffect},function(Fn){Zt=Fn.default},function(Fn){ln=Fn.useVisible}],execute:function(){Ki({"w1c5oka1gh-1sbm":Fn,w2xkRVSdQS:Un,w77ya1ds:en,wg1jCVsk4q:Yt,wtaXRnCbPjA:Pn});function Fn({before:Nt,after:Ee,timer:Xe,loops:pt,words:wt}){const[kt,mt,St,It]=[0,1,2,3],Tn=gt(null),[Ft,cn]=qt(0),[nn,di]=qt(kt),[Ri,Ti]=qt(0),[Gi,Xn]=qt(""),[zt,Ln]=qt(0),[Nn,Tt]=qt(0);Ct(()=>{Tn.current=_n},[_n]),Ct(()=>{let ce=setInterval(function(){Tn.current()},Xe);return()=>{clearInterval(ce)}},[Xe]);function _n(){const ce=wt[zt];if(nn===kt){if(Ft%5===0&&Ti(Ri+1),Ri>ce.length){Ut();return}}else if(nn===mt){if(Ft===50){Ut();return}}else if(nn===St){if(pt&&Nn>=pt-1)return;if(Ft%3===0&&Ti(Ri-2),Ri<0){Ut();return}}else if(nn===It){if(Ti(0),Ft===1){const At=(zt+1)%wt.length;Ln(At)}if(Ft===50){Ut();return}}Xn(ce.substring(0,Ri)),cn(Ft+1)}function Ut(){cn(0),di((nn+1)%4),nn===St&&Tt(Nn+1)}return st.createElement("div",null,st.createElement("p",null,Nt,Gi,Ee))}const Rn=(Nt,Ee,Xe,pt=0,wt=1)=>{let kt={targets:Nt,delay:In(Ee.delayPreset,Ee.delay||pt,Ee.modifier||wt)};Ee.easing?kt.easing=Ee.easing:kt.easing="linear";const{opacity:mt,scale:St}=Ee;Ee.fade&&typeof mt<"u"&&(kt.opacity=[typeof mt.from=="number"?mt.from:0,typeof mt.to=="number"?mt.to:1]),Ee.scaleText&&typeof St<"u"&&(kt.scale=[typeof St.from=="number"?St.from:1,typeof St.to=="number"?St.to:1]);const It=["translateX","translateY","translateZ","rotateX","rotateY","rotateZ"];for(let Tn in It){const Ft=It[Tn];Xe?((!Xe[Ft]||!Xe[Ft].to)&&(Xe[Ft]={to:0}),Ee[Ft]&&typeof Xe[Ft].to<"u"&&typeof Ee[Ft].to<"u"&&(kt[Ft]=[Xe[Ft].to,Ee[Ft].to])):Ee[Ft]&&typeof Ee[Ft].from<"u"&&typeof Ee[Ft].to<"u"&&(kt[Ft]=[Ee[Ft].from,Ee[Ft].to])}return kt},ri=(Nt,Ee,Xe=0,pt="linear",wt=3)=>{let kt={};switch(Ee){case 0:kt={translateY:["1.1em",0],easing:pt||"easeInOutQuad",opacity:[0,1],translateZ:0,duration:700,delay:In(5,Xe,wt)};break;case 1:kt={opacity:[0,1],translateZ:0,easing:pt||"easeInOutQuad",duration:2250,delay:In(1,Xe,wt)};break;case 2:kt={scale:[.3,1],opacity:[0,1],translateZ:0,easing:pt||"easeOutExpo",duration:600,delay:In(2,Xe,wt)};break;case 3:kt={translateX:[40,0],translateZ:0,opacity:[0,1],easing:"easeOutExpo",duration:1200,delay:In(3,Xe,wt)};break;case 4:kt={translateY:["6.1em",0],translateX:["6.55em",0],translateZ:0,rotateZ:[180,0],duration:750,easing:pt||"easeOutExpo",delay:In(4,Xe,wt)};break;case 5:kt={scale:[4,1],opacity:[0,1],translateZ:0,easing:pt||"easeOutExpo",duration:950,delay:In(4,Xe,wt)};break;default:kt={translateY:["1.1em",0],opacity:[0,1],translateZ:0,duration:750,delay:In(0,Xe,wt)};break}return kt.targets=Nt,kt},In=(Nt,Ee=0,Xe=1,pt=!1)=>{switch(Nt){case!0:return(wt,kt)=>Ee+50*kt*Xe;case 1:return(wt,kt)=>Ee+150*(kt+1)*Xe;case 2:return(wt,kt)=>Ee+70*(kt+10)*Xe;case 3:return(wt,kt)=>Ee+(50+30*kt)*Xe;case 4:return(wt,kt)=>Ee+70*kt*Xe;case 5:return(wt,kt)=>Ee+80*kt*Xe;default:return(wt,kt)=>Ee+50*kt*Xe}},Hn=(Nt,Ee,Xe=0,pt="linear",wt=1)=>{let kt={};switch(Ee){case 0:kt={translateY:["1.1em",0],opacity:[0,1],translateZ:0,duration:750,delay:In(0,Xe,wt)},pt&&(kt.easing=pt);break;case 1:kt={opacity:[0,1],translateZ:0,easing:pt||"easeInOutQuad",duration:2250,delay:In(1,Xe,wt)};break;case 2:kt={scale:[.3,1],opacity:[0,1],translateZ:0,easing:pt||"easeOutExpo",duration:600,delay:In(2,Xe,wt)};break;case 3:kt={translateX:[40,0],translateZ:0,opacity:[0,1],easing:pt||"easeOutExpo",duration:1200,delay:In(3,Xe,wt)};break;case 4:kt={translateY:["6.1em",0],translateX:["6.55em",0],translateZ:0,rotateZ:[180,0],duration:750,easing:pt||"easeOutExpo",delay:In(4,Xe,wt)};break;case 5:kt={scale:[4,1],opacity:[0,1],translateZ:0,easing:pt||"easeOutExpo",duration:950,delay:In(4,Xe,wt)}}return kt.targets=Nt,kt};function Un({text:Nt,easing:Ee,hostRef:Xe,iterations:pt,startDelay:wt,endDelay:kt,loop:mt,runOnce:St}){const[It,Tn]=qt(!1),Ft=gt(null),cn=ln(Ft);return Ct(()=>{if(It&&St||St&&!cn&&!It)return;const nn=Ft.current;nn.innerHTML=nn.textContent.replace(/\S/g,"<span class='letter'>$&</span>"),Ft.current.innerHTML=nn.textContent.replace(/(\S+)/g,'<div class="word">$&</div>');const di=Ft.current.querySelectorAll(".word");Zt.remove([di]),Ft.current.setAttribute("style",null);for(let Ti in di){const Gi=di[Ti];Gi&&Gi.setAttribute&&Gi.setAttribute("style",null)}const Ri=Zt.timeline({loop:mt});pt.forEach((Ti,Gi)=>{Ri.add(Rn(di,Ti,Gi>0?pt[Gi-1]:null))}),Tn(!0)},[Ft.current,Nt,pt,wt,kt,mt,cn,Ee,St,It]),st.createElement("div",{className:"fill animation-wrapper"},st.createElement("span",{className:"animate-text",ref:Ft},Nt||"Great Thinkers"))}function en({text:Nt,easing:Ee,hostRef:Xe,fadeOutElement:pt,animationPreset:wt,startDelay:kt,endDelay:mt,loop:St}){const[It,Tn]=qt(!1),[Ft,cn]=qt(null),nn=gt(null),di=ln(nn),Ri=Bn(()=>Array.from(Nt).map(Ti=>Ti===" "?" ":'<span class="letter"> '+Ti+"</span>").join(""),[Nt]);return Ct(()=>{Tn(!1)},[St,kt,mt]),Ct(()=>{if(!St&&!di&&!It||It&&!St)return;const Ti=nn.current;Ti.innerHTML=Ri;const Gi=nn.current.querySelectorAll(".letter");Zt.remove(Ft),nn.current.setAttribute("style",null);for(let zt in Gi){const Ln=Gi[zt];Ln&&Ln.setAttribute&&Ln.setAttribute("style",null)}cn([nn.current,Gi]);const Xn=Zt.timeline({loop:St});Xn.add(Hn(Gi,wt,kt,Ee)),St&&(pt==="word"?Xn.add({targets:nn.current,opacity:0,duration:1e3,easing:"easeOutExpo",delay:mt}):Xn.add({targets:Gi,opacity:0,duration:1e3,easing:"easeOutExpo",delay:(zt,Ln)=>mt+150*(Ln+1)})),Tn(!0)},[nn.current,Nt,pt,wt,kt,mt,St,di,Ee,It,Ri]),st.createElement("div",{className:"fill animation-wrapper"},st.createElement("span",{className:"animate-text",ref:nn},Nt||"Great Thinkers"))}function Yt({text:Nt,easing:Ee,hostRef:Xe,iterations:pt,startDelay:wt,endDelay:kt,loop:mt,runOnce:St}){const[It,Tn]=qt(!1),[Ft,cn]=qt(null),nn=gt(null),di=ln(nn);return Ct(()=>{if(It&&St||St&&!di&&!It)return;const Ri=nn.current;Ri.innerHTML=Ri.textContent.replace(/\S/g,"<span class='letter'>$&</span>");const Ti=nn.current.querySelectorAll(".letter");Zt.remove(Ft),nn.current.setAttribute("style",null);for(let Xn in Ti){const zt=Ti[Xn];zt&&zt.setAttribute&&zt.setAttribute("style",null)}cn([nn.current,Ti]);const Gi=Zt.timeline({loop:mt});pt.forEach((Xn,zt)=>{Gi.add(Rn(Ti,Xn,zt>0?pt[zt-1]:null),wt)}),Tn(!0)},[nn.current,Nt,pt,wt,kt,mt,di,Ee,It,St]),st.createElement("div",{className:"fill animation-wrapper"},st.createElement("span",{className:"animate-text",ref:nn},Nt||"Great Thinkers"))}function Pn({text:Nt,hostRef:Ee,animationPreset:Xe,startDelay:pt=0,endDelay:wt=0,loop:kt,runOnce:mt,easing:St,fadeOutElement:It}){const[Tn,Ft]=qt(!1),[cn,nn]=qt(!1),[di,Ri]=qt(null),Ti=gt(null),Gi=ln(Ti);return Ct(()=>{Ft(!1),Zt.remove(di)},[kt,wt,pt]),Ct(()=>nn(!0),[]),En(()=>{if(!cn||Tn&&mt||mt&&!Gi&&!Tn)return;const Xn=Ti.current;Ti.current.innerHTML=Xn.textContent.replace(/(\S+)/g,'<div class="word">$&</div>');const zt=Ti.current.querySelectorAll(".word");Zt.remove(di),Ri([Ti.current,zt]);const Ln=Zt.timeline({loop:kt}),Nn=ri(zt,Xe,pt,St,3);Ln.add(Nn);const Tt=Ti.current;if(setTimeout(()=>{Tt&&(Tt.style.opacity="1")},200),kt)if(It==="word")Ln.add({targets:Ti.current,opacity:0,duration:1e3,easing:"easeOutExpo",delay:wt});else{Xn.innerHTML=Xn.textContent.replace(/\S/g,"<span class='letter'>$&</span>");const _n=Ti.current.querySelectorAll(".letter");Ln.add({targets:_n,opacity:0,duration:1e3,easing:"easeOutExpo",delay:(Ut,ce)=>wt+150*(ce+1)})}Ft(!0)},[cn,Nt,Xe,pt,wt,kt,Gi,St,It,mt,Tn]),st.createElement("div",{className:"fill animation-wrapper"},st.createElement("span",{className:"animate-text",ref:Ti,style:{opacity:0}},Nt||"Great Thinkers"))}}}}),Bs.register("pjHM9-mK7Rk",["vev","react"],function(Ki){"use strict";var gt,qt,Ct,Bn,En,Zt;return{setters:[function(ln){gt=ln.useSize,qt=ln.useEditorState},function(ln){Ct=ln.useRef,Bn=ln.useState,En=ln.useEffect,Zt=ln.Fragment}],execute:function(){Ki("wdbrcHrdHj",ri);const ln=Un=>(Un=Un||"https://www.dinogame.net/game/index.html",/^https?:\/\//i.test(Un)?Un:"https://"+Un),Fn=(Un,en)=>({height:0,width:0,maxHeight:Un.heigth/(en||1),maxWidth:Un.width/(en||1),minHeight:Un.height/(en||1),minWidth:Un.width/(en||1),transform:en&&en!==1?`scale(${en})`:null});var Rn=Ki("w74kv33h",({hostRef:Un,src:en,scale:Yt})=>st.createElement("iframe",{frameBorder:0,allowFullScreen:!0,src:ln(en),style:Fn(gt(Un),Yt)}));function ri(Un){return Un.useIframe?st.createElement(In,Object.assign({},Un)):st.createElement(Hn,Object.assign({},Un))}function In({html:Un}){const en=Ct(null),[Yt,Pn]=Bn("auto");En(()=>{function Ee(Xe){Xe.data.iframeHeight&&Pn(`${Xe.data.iframeHeight}px`)}return window.addEventListener("message",Ee),()=>{window.removeEventListener("message",Ee)}},[]);function Nt(){const pt=en.current.contentDocument.body.scrollHeight;Pn(pt)}return st.createElement("iframe",{ref:en,title:"Auto-resizing iframe",srcDoc:`<!DOCTYPE html>
      <html lang="en">
      <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <style>html,body{margin:0;padding:0;height:auto;overflow:hidden;}</style>
      </head>
      <body>
       <script>
          let prevHeight = 0;
          function postHeight() {
            const height = document.body.scrollHeight;
            if(prevHeight !== height){
              prevHeight = height;
              window.parent.postMessage({ iframeHeight: height }, '*');
            }
          }

          window.addEventListener('resize', postHeight);

          const observer = new ResizeObserver(postHeight);
          observer.observe(document.body);
          postHeight();
          setInterval(postHeight,500);
        <\/script>
        ${Un}
       
      </body>
      </html>`,style:{height:Yt,width:"100%",background:"transparent",border:"none"},onLoad:Nt})}function Hn({html:Un,hostRef:en}){const{disabled:Yt}=qt(),[Pn,Nt]=Bn(!1);return En(()=>{Nt(!0)},[]),En(()=>{if(Yt||!Pn)return;const Ee=[];return en.current.querySelectorAll("script").forEach(Xe=>{const pt=document.createElement("script");Xe.src?pt.src=Xe.src:pt.text=Xe.innerText||"";const wt=Xe.getAttribute("integrity"),kt=Xe.getAttribute("crossorigin");wt&&pt.setAttribute("integrity",wt),kt&&pt.setAttribute("crossorigin",kt),document.body.appendChild(pt),Ee.push(pt)}),()=>{Ee.forEach(Xe=>Xe.remove())}},[en.current,Un,Yt]),Pn?Yt?st.createElement("div",{className:"fill instructions"},st.createElement("h3",null,"Embedded code will run in preview and on published site"),st.createElement("p",null,"If you want more coding flexibility, we recommend using a coded element created in the Code Editor.")):Un?st.createElement(Zt,null,st.createElement("div",{className:"fill",dangerouslySetInnerHTML:{__html:Un}})):st.createElement("div",{className:"fill instructions"},st.createElement("h3",null,"Double-click this widget to add your HTML inside"),st.createElement("p",null,"Note: Not all embed codes will only run on published site, as it may behave differently in the editor")):null}}}}),Bs.register("gDvSW10Q07",[],function(){"use strict";return{execute:function(){}}}),Bs.register("ppBuS3zgHnP",["react","vev","https://cdnjs.cloudflare.com/ajax/libs/bodymovin/5.6.5/lottie.min.js"],function(Ki){"use strict";var gt,qt,Ct,Bn,En,Zt;return{setters:[function(ln){gt=ln.useRef,qt=ln.useEffect},function(ln){Ct=ln.useHover,Bn=ln.useScrollTop,En=ln.useVisible,Zt=ln.View},function(){}],execute:function(){Ki("w75hbqbv",ln);function ln({file:Fn,loop:Rn,aspectRatio:ri,hostRef:In,trigger:Hn,hoverRestart:Un,speed:en,scrollOffsetStart:Yt=0,scrollOffsetStop:Pn=0}){const Nt=gt(null),[Ee,Xe]=Ct(),pt=gt(null),wt=Bn(!0),kt=En(Nt);qt(()=>{const St={container:Nt.current,renderer:"svg",loop:(Hn==="click"||Hn==="visible"||!Hn)&&Rn,autoplay:Hn==="visible"&&kt,path:Fn&&Fn.url?Fn.url:"https://cdn.vev.design/private/dk3UctceTPWKJtA1g8n4EFqTvuo2/U0u8nMs-C_blueLottieLogoAnimated.json.json"};return ri||(St.rendererSettings={preserveAspectRatio:"none"}),pt.current=lottie.loadAnimation(St),console.log("SPEED",en),en&&en!==1&&pt.current.setSpeed(en),()=>pt.current.destroy()},[Fn,ri,Rn,Hn,en]),qt(()=>{const St=pt.current;St&&(!Hn||Hn==="visible"?St[kt?"play":"stop"]():Hn==="hover"&&(St.setDirection(!Ee&&Un?-1:1),Ee||Un?St.play():St.pause()))},[kt,Ee,pt]),qt(()=>{const St=pt.current;if(Hn==="scroll"&&St.totalFrames){let It=wt;if(!In.current.classList.contains("__f")&&kt){const Tn=Nt.current.getBoundingClientRect();It=(Tn.top+Yt+Tn.height)/(Zt.height+Tn.height+Pn)}else It=1-wt;St.goToAndStop(St.totalFrames/St.frameRate*1e3*(1-It))}},[wt]);let mt={};switch(Hn){case"click":mt.onClick=()=>pt.current&&pt.current[pt.current.isPaused?"play":"pause"]();break;case"hover":mt=Xe;break}return st.createElement("div",Object.assign({className:"fill"},mt,{ref:Nt,dangerouslySetInnerHTML:{__html:""}}))}}}}),Bs.register("pWZZK88Bj0M",["react","vev","animejs"],function(Ki){"use strict";var gt,qt,Ct,Bn,En,Zt,ln,Fn;return{setters:[function(Rn){gt=Rn.useRef,qt=Rn.useEffect},function(Rn){Ct=Rn.useEditorState,Bn=Rn.useVisible,En=Rn.useFrame,Zt=Rn.View,ln=Rn.raf},function(Rn){Fn=Rn.default}],execute:function(){Ki({w1WUiehfza:Rn,w71fppy9:pt,w76py6xb:wt,wdu2rjhi:kt});function Rn({speed:mt,className:St,children:It,hostRef:Tn}){const Ft=gt(null),{disabled:cn}=Ct(),nn=Bn(Ft);return qt(()=>{const di=Ft.current;if(!!di)return di.style.willChange="transform",()=>di.removeAttribute("will-change")},[]),En(()=>{if(!Ft.current||!Tn.current)return;if(cn)return Ft.current.style.transform=null;if(!mt&&mt!==0&&(mt=.8),!nn)return;const di=Tn.current.getBoundingClientRect();if(di.top<Zt.height&&Zt.scrollTop>=Zt.rootNodeOffsetTop){const Ri=Math.max(Zt.height-(Zt.scrollTop+di.top),0)+Zt.rootNodeOffsetTop,Ti=(Zt.height-di.top-Ri)*(1-mt);Ft.current.style.transform=`translateY(${Ti}px)`}},[mt,cn,nn]),st.createElement("div",{className:St,ref:Ft},It)}const ri=.3;let In=0,Hn=0,Un=Date.now();window.addEventListener("scroll",()=>{let mt=Date.now();In=(Zt.scrollTop-Hn)/(mt-Un),Hn=Zt.scrollTop,Un=mt});const en=[];let Yt,Pn;const Nt={top:0};function Ee(mt){return en.push(mt),Yt||(Yt=ln(Xe,!0)),()=>{const St=en.indexOf(mt);St!==-1&&en.splice(St,1)}}function Xe(){if(!en.length)Yt(),Pn&&Pn.pause(),Yt=null,Pn=null;else if(Pn&&In<0)Pn.pause(),Pn=null;else if(!Pn&&Math.abs(In)<.7&&In>0){let mt,St=1/0;for(let It of en){let{top:Tn,height:Ft}=It.getBoundingClientRect();Ft<Zt.height*.9&&(Tn-=Zt.height/2-Ft/2),Zt.scrollDir>0&&Math.abs(Tn)<Math.abs(St)&&(St=Tn,mt=It)}mt&&1-St/Zt.height>ri&&(Nt.top=Zt.scrollTop,Pn=Fn({targets:Nt,top:Nt.top+St,easing:"easeOutSine",duration:St/1200*1e3,round:1,update(){Zt.scrollTo(Nt.top,!0)},complete(){Pn=null}}))}}function pt({children:mt,hostRef:St}){const It=Bn(St),{disabled:Tn}=Ct();return qt(()=>{if(!(!It||Tn))return Ee(St.current)},[It,Tn]),mt}function wt({className:mt,children:St,scale:It,showOverflow:Tn,hostRef:Ft}){const cn=Bn(Ft),nn=gt();return En(()=>{if(!cn)return;const Ri=Ft.current.getBoundingClientRect().top/Zt.height;nn.current.style.transform=`scale(${1+(It||.2)*(1-Ri)})`}),st.createElement("div",{className:mt+(Tn?" show":"")},st.createElement("div",{ref:nn,className:"content"},St))}function kt({className:mt,children:St,time:It}){return st.createElement("div",{className:mt,onClick:()=>Zt.scrollTo(0,!1,It)},St)}}}}),Bs.register("scrollyteller",["react","vev","animejs"],function(Ki){"use strict";var gt,qt,Ct,Bn,En,Zt,ln,Fn,Rn,ri,In,Hn,Un;return{setters:[function(en){gt=en.default,qt=en.useRef,Ct=en.useEffect,Bn=en.useLayoutEffect,En=en.Fragment,Zt=en.useState},function(en){ln=en.View,Fn=en.useEditorState,Rn=en.useHover,ri=en.Tracking,In=en.raf,Hn=en.Icon},function(en){Un=en.default}],execute:function(){var Tt,_n;Ki({"wQwq0xf-9u":Xn,wUNTsB8PHK:zt,"wgT9kyli-m":Nn});const en=location.hash.includes("debug");var Yt;(function(Ut){Ut[Ut.hidden=0]="hidden",Ut[Ut.active=1]="active",Ut[Ut.showing=2]="showing"})(Yt||(Yt={}));class Pn{constructor(ce){this.isPinned=!1,this.isOverlayPinned=!1,this.isShowing=!1,this.isActive=!1,this.top=0,this.height=0,this.bottom=0,this.offset=[null,null],this.completed=!1,this.scrollBg=!1,this.handleComplete=()=>{this.completed=!0,this.complete&&this.complete(this)},this.container=ce.container,this.content=ce.content,this.overlay=ce.overlay,this.scrollBg=ce.scrollBg||!1,this.active=ce.active,this.ani=Un({targets:[this.content,this.overlay],opacity:[0,1],duration:ce.duration||350,easing:ce.easing||"linear",autoplay:!1})}state(){return this.isShowing&&this.isActive?Yt.showing:this.isActive?Yt.active:Yt.hidden}emitState(){this.active&&this.active(this.state())}debug(){this.debugging=!0,this.debugEl||(this.debugEl=document.createElement("div"),this.debugEl.setAttribute("style","position:fixed;bottom:0;left:0;background:white;z-index:10000;padding:3px;font-size:10px")),this.container.append(this.debugEl),this.debugEl.style.width=this.content.clientWidth+"px",this.debugEl.style.left=this.content.offsetLeft+"px",this.debugEl.innerHTML=`State: ${this.state()}`}setActive(ce){this.isActive!==ce&&(this.debugging&&this.debug(),en&&console.log("Set active",this.container.id,"isActive:",ce),this.isActive=ce,this.emitState())}setContentHeight(ce){if(this.scrollBg){let At=this.container.getBoundingClientRect().height;this.contentHeight=At}else ce!==this.contentHeight&&(this.contentHeight=ce,this.content.style.height=ln.zoom===1?"100vh":ce+"px")}setOffset(ce,At){(this.offset[0]!==ce||this.offset[1]!==At&&this.isActive)&&(en&&console.log("Update offset",this.container.id,`top:${ce};bottom:${At}`),this.offset=[ce,At],this.content.style.top=ce?ce==="auto"?ce:`${ce}px`:null,this.content.style.bottom=At?At==="auto"?At:`${At}px`:null)}inView(ce){return this.top-ce<=0&&this.bottom-ce>=window.innerHeight}show(ce){this.isShowing||(en&&console.log("Show item",this.container.id),this.isShowing=!0,this.animate(!1,ce),this.emitState()),ce&&this.setActive(!0)}hide(ce){this.isShowing&&(en&&console.log("Hide item",this.container.id,"instant",ce),this.isShowing=!1,this.animate(!0,ce)),ce&&this.setActive(!1)}animate(ce,At=!1){this.ani.pause(),en&&console.log("Pin overly",this.container.id,`reverse:${ce};instant:${At}`),ce!==this.ani.reversed&&this.ani.reverse(),this.ani.began=!1,this.ani.completed=!1,At&&this.ani.seek(this.ani.duration-10),this.ani.play(),this.completed=!1,clearTimeout(this.timeout),this.timeout=setTimeout(this.handleComplete,At?1:this.ani.duration)}setPin(ce,At){ce!==this.isPinned&&(this.isPinned||this.isActive)&&(en&&console.log("Pin item",this.container.id,`Pin top:${ce};bottom:${At}`),this.isPinned=ce,this.content.style.position=ce?"fixed":"absolute",this.content.style.bottom=ce||At?"0":"auto",this.content.style.top=!ce&&At?"auto":null)}setOverlayPin(ce,At){const $t=Boolean(ce||At);$t!==this.isOverlayPinned&&(this.isOverlayPinned||this.isActive)&&(en&&console.log("Pin overly",this.container.id,`Pin top:${ce};bottom:${At}`),this.isOverlayPinned=$t,this.overlay.style.position=$t?"fixed":"absolute",$t?(this.overlay.style.height=this.height+"px",this.overlay.style.top=`${At?-(this.height-window.innerHeight):0}px`):(this.overlay.style.top="0px",this.overlay.style.height="auto"))}update(){let ce=(this.container.getBoundingClientRect().top+ln.scrollTop)*(ln.zoom||1);const At=this.scrollBg?this.container.clientHeight*(ln.zoom||1):this.container.clientHeight*(ln.zoom||1);return this.debugging&&this.debug(),this.top!==ce||this.height!==At?(en&&console.log("Item has changes",this.container,ce),this.top=ce,this.height=At,this.bottom=ce+At,!0):!1}}function Nt(Ut){const ce=Ut.split("/");return ce[ce.length-1].split(".")[0]}const Ee=()=>{var ce;if(/iP(hone|od|ad)/.test(navigator==null?void 0:navigator.platform)){var Ut=((ce=navigator.appVersion)==null?void 0:ce.match(/OS (\d+)_(\d+)_?(\d+)?/))||["14","1"];return parseInt(Ut[1],10)===15&&parseInt(Ut[2],10)>=5}return!1},Xe=gt.forwardRef((Ut,ce)=>{const At=Ee(),{video:$t,autoPlay:wn,loop:Gn=!0,mute:yi=!0,controls:ir,startVisible:Oi=!0,noTracking:Rr=!1,thumbnail:Qi=null,lazy:Bi=!1}=Ut,ni=qt({current:0,maxProgress:0}),li=!0,{disabled:at}=Fn(),[Ge,ct]=Rn();let Cn=1;if(Ct(()=>{const pn=ce.current;if(Rr||!pn||!$t)return;const ki=["play","pause","ended","timeupdate"],Ai=jr=>{const Si=ce.current;if(!Si)return;const or=$t.name||Nt($t.sources[0].url);switch(jr.type){case"timeupdate":const ns=Math.round(100*Si.currentTime/Si.duration),rr={current:ns,maxProgress:Math.max(ns,ni.current.maxProgress)};ns>ni.current.maxProgress&&pt("Video Progress",or,ni.current.maxProgress),Si.currentTime>Cn*Si.duration/5&&(pt(`Video Progress ${Cn*20}`,or),Cn++),ni.current.current=rr.current,ni.current.maxProgress=rr.maxProgress;break;case"play":return pt("Play",or);case"pause":return pt("Pause",or,ni.current.current);case"ended":return pt("Finished",or)}};return ki.forEach(jr=>pn.addEventListener(jr,Ai,!1)),()=>ki.forEach(jr=>pn.removeEventListener(jr,Ai))},[$t,Rr,li]),Ct(()=>{const pn=ce.current;!pn||(at?(pn.load(),pn.pause()):pn.readyState>=3&&Oi&&wn&&pn.play())},[li,Oi,at]),Bn(()=>{ce.current&&(ce.current.setAttribute("autobuffer","true"),yi?ce.current.setAttribute("muted","true"):ce.current.removeAttribute("muted"))},[yi]),Bi&&!li)return null;const jt={};return Gn&&(jt.loop=!0),jt.autoPlay=!0,ir&&(jt.controls=!0),$t&&$t.name&&!Ge&&(jt.title=$t.name),(ln.isIE||ln.isEdge)&&(jt.className="ie"),gt.createElement(En,null,!$t&&gt.createElement("div",{className:"fill row v-center h-center",style:{color:"white"}},gt.createElement("h3",null,"Double click to select video")),gt.createElement("video",Object.assign({ref:ce,playsInline:!0,controls:ir,muted:yi,autobuffer:!0,onLoadedData:pn=>{var Ai;const ki=pn.currentTarget;ki.readyState>=3&&li&&Oi&&wn&&!at&&((Ai=ki.play)==null||Ai.call(ki),At&&setTimeout(()=>{ki!=null&&ki.style&&(ki.style.opacity="1")},400))},onPlaying:pn=>{if(At){const ki=pn.currentTarget;setTimeout(()=>{ki!=null&&ki.style&&(ki.style.opacity="1")},400)}},preload:"auto",style:{opacity:At?0:null}},jt,ct),$t&&$t.sources&&$t.sources.sort(pn=>pn.format==="video/webm"?-1:1).map(pn=>gt.createElement("source",{key:pn.url,src:pn.url,type:pn.format||"video/mp4"})),"Your browser does not support this video"))});function pt(Ut,ce,At,$t){ri.send("video","HTML5 Video",Ut,ce,At,$t)}const wt=(_n=(Tt=location.hash)==null?void 0:Tt.includes)==null?void 0:_n.call(Tt,"debug");class kt{constructor(ce){this.items=ce,this.handleComplete=At=>{let $t=this.items.indexOf(At);if(At.isShowing)for(;$t--;)this.items[$t].setActive(!1);At.isShowing||At.setActive(!1)},this.first=this.items[0],this.last=this.items[ce.length-1],this.updateSize();for(const At of this.items)At.complete=this.handleComplete;this.showFirstOrLast(ln.scrollTop)}debug(){for(let ce=0;ce<this.items.length;ce++)this.items[ce].debug(),this.items[ce].content.style.width=100/this.items.length+"vw",this.items[ce].content.style.marginLeft=ce/this.items.length*100+"vw"}inView(ce){return this.top-ce<=0&&this.bottom-ce>=window.innerHeight}updateSize(){this.first&&this.last&&(this.first.update(),this.last.update(),this.top=this.first.top,this.bottom=this.last.bottom,this.height=this.bottom-this.top);const ce=this.height<window.innerHeight?this.height+"px":null;for(const At of this.items)At.content.style.maxHeight=ce,At.content.style.minHeight=ce}update(ce){wt&&console.time("Group update");const At=window.innerHeight;if(this.top>ce+At||this.bottom<ce){this.items.forEach(wn=>{wn.setPin(!1),wn.setOverlayPin(!1,!1),wn.setActive(!1)});return}let $t=ce>this.top&&ce<this.bottom-At;this.items.forEach((wn,Gn)=>{let yi=!1;if(Gn===0?yi=wn.top<ce+At:yi=wn.top<ce+At/2,yi){let ir=!1;(Gn===0&&this.top>=ce||Gn===this.items.length-1&&this.bottom<=ce)&&(ir=!0),wn.show(ir)}else wn.hide();wn.setPin($t),wn.setOverlayPin($t&&wn.top>=ce,wn.bottom<=ce+At&&this.bottom>ce+At),$t?wn.setOffset(null,null):this.height>At&&ce>=this.bottom-At?wn.setOffset("auto",wn.bottom-this.bottom):wn.setOffset(this.top-wn.top,"auto")}),this.items.forEach((wn,Gn)=>{const yi=this.items[Gn+1];(yi==null?void 0:yi.isShowing)&&yi.completed&&wn.completed&&wn.bottom<ce?wn.setActive(!1):wn.isShowing&&wn.setActive(!0)}),wt&&console.timeEnd("Group update")}showFirstOrLast(ce){ce>this.bottom?this.last.show(!0):this.first.show(!0)}}const mt=500,St=20,It=[],Tn=[];let Ft=-1e3,cn=-1,nn,di=-1e3;const Ri=(Ut,ce)=>Ut.top<ce.top?-1:1;function Ti(Ut){let ce=!1;if(Ut-Ft>mt){Ft=Ut;for(const At of It)At.update()&&(ce=!0);if(ce){It.sort(Ri),Tn.length=0;const At=It.filter($t=>$t.height);for(let $t=0;$t<At.length;$t++){let wn=At[$t];const Gn=[wn];for($t=$t+1;$t<At.length;$t++){const yi=At[$t];if(yi.top-wn.bottom>5){$t--;break}wn=yi,Gn.push(yi)}Tn.push(new kt(Gn))}}}if(Ut-di>St&&cn!==ln.scrollTop||ce){di=Ut,cn=ln.scrollTop;for(const At of Tn)At.update(cn)}}function Gi(Ut){const ce=new Pn(Ut);return It.push(ce),nn||(nn=In(Ti,!0)),()=>{const At=It.indexOf(ce);At!==-1&&It.splice(At,1),It.length||(nn(),nn=null)}}window.debugStory=()=>{for(const Ut of Tn)Ut.debug()},window.storyGroups=Tn,window.storyItems=It;function Xn({hostRef:Ut,duration:ce,mediaType:At,noTracking:$t,video:wn,videoControls:Gn,embedUrl:yi,noLoop:ir,controlsPlacement:Oi,easing:Rr="linear"}){Oi||(Oi="top-right");const[Qi,Bi]=Zt(Yt.hidden),ni=qt(null),li=qt(null),[at,Ge]=Zt(!0),ct=qt(null),{disabled:Cn}=Fn();Ct(()=>Gi({container:Ut.current,content:ni.current,overlay:li.current,active:Bi,duration:ce,easing:Rr}),[ce,Rr]),Ct(()=>{Qi||Ge(!0)},[Qi]);const jt=Ai=>{Ai.stopPropagation(),ct.current&&(ct.current.currentTime=0),ki()},pn=Ai=>{Ai.stopPropagation(),Ge(!at),ki()},ki=()=>{const Ai=ct.current;Ai&&Ai.play()};return gt.createElement(En,null,gt.createElement("div",{ref:ni,className:["fixedWrapper fill"].join(" ")},Cn||Qi?gt.createElement("div",{className:["contents fill"].join(" ")},gt.createElement(En,null,Gn&&gt.createElement(En,null,gt.createElement("div",{className:"media-controls",style:{top:Oi.includes("top")?"5%":"auto",bottom:Oi.includes("bottom")?"5%":"auto",right:Oi.includes("right")?"5%":"auto",left:Oi.includes("left")?"5%":"auto"}},gt.createElement(Hn,{d:at?"mute_icon":"audio_100_icon",onClick:pn,className:"mediaIcon audioButton"}),gt.createElement(Hn,{d:"media_restart",onClick:jt,className:"mediaIcon restartButton"}))),wn&&gt.createElement(Xe,{video:wn,mute:at,loop:!ir,autoPlay:Qi===Yt.showing,controls:!1,noTracking:$t,ref:ct}),!wn&&gt.createElement("div",{className:"no-image fill row center-center"},gt.createElement("h3",null,"Please select a video")))):gt.createElement(En,null),gt.createElement("img",{className:"posterImage",src:wn&&wn.thumbnail})),gt.createElement("div",{className:"fill overlay",ref:li}))}function zt({hostRef:Ut,duration:ce,zoom:At,scrollBg:$t=!1,speed:wn,easing:Gn="linear"}){const[yi,ir]=Zt(Yt.hidden),Oi=qt(null),Rr=qt(null),Qi=qt(null),{disabled:Bi}=Fn();return Ct(()=>Gi({container:Ut.current,content:Oi.current,overlay:Qi.current,active:ir,duration:ce,easing:Gn,scrollBg:$t}),[ce,Gn]),gt.createElement(En,null,gt.createElement("div",{className:"contents",style:{width:1,height:1,maxHeight:1,opacity:0,position:"absolute"}}),gt.createElement("div",{ref:Oi,className:["fixedWrapper fill"].join(" ")},Bi||yi?gt.createElement("div",{ref:Rr,className:["contents fill",At?"zoom":""].join(" ")}):gt.createElement(En,null)),gt.createElement("div",{className:"fill overlay",ref:Qi}))}const Ln=gt.forwardRef((Ut,ce)=>{const{embedUrl:At,stretch:$t,mute:wn,autoplay:Gn=!0,controls:yi,repeat:ir,displayTitle:Oi,displayDescription:Rr,trackingName:Qi}=Ut,Bi=qt(null);let ni,li=At&&At.replace(/(^\w+:|^)\/\//,"").replace(/(\.html|\.js)/,"").split("/"),at=li&&li[li.length-1];at&&at.indexOf("-")&&(ni=at.split("-"));const Ge=ni?ni[0]:null,ct=ni?ni[1]:null,Cn=(Ai,jr)=>{ri.send("video","JW player",Ai,Qi||At,jr)};let jt=!1,pn=1;const ki=[{event:"setupError",callback:({message:Ai})=>Cn("setupError",Ai)},{event:"autostartNotAllowed",callback:()=>Cn("autostartNotAllowed")},{event:"firstFrame",callback:()=>Cn("Play")},{event:"time",callback:({currentTime:Ai,duration:jr})=>{Ai>10&&!jt&&(jt=!0,Cn("atTenSeconds")),Ai>pn*jr/5&&(Cn("videoProgress",pn*20),pn++)}},{event:"pause",callback:()=>Cn("Pause")},{event:"complete",callback:()=>Cn("Finished")}];return Ct(()=>(Bs.import(`https://cdn.jwplayer.com/libraries/${ct}.js`).then(()=>{let Ai=jwDefaults.key,jr={autostart:!0,cast:{appid:"00000000"},controls:!1,displaydescription:Rr,displaytitle:Oi,flashplayer:"//ssl.p.jwpcdn.com/player/v/8.8.4/jwplayer.flash.swf",height:"100%",key:Ai,mute:wn,ph:3,pid:ct,playbackRateControls:!1,playlist:`//cdn.jwplayer.com/v2/media/${Ge}?recommendations_playlist_id=irwrDqTZ`,preload:"auto",repeat:ir,stagevideo:!1,stretching:$t||"fill",width:"100%"},Si=jwplayer(Bi.current).setup(jr);ce.current=Si;for(const or of ki)jwplayer().on(or.event,or.callback)}),()=>{jwplayer(Bi.current).remove(),ce.current=null}),[ct,Ge,$t,wn,Gn,yi,ir,Oi,Rr]),At?gt.createElement("div",{ref:Bi,dangerouslySetInnerHTML:{__html:""}}):gt.createElement("div",{className:"fill placeholder"},"Please add an embedURL")});function Nn({hostRef:Ut,duration:ce,cover:At,stretch:$t,embedUrl:wn,autoplay:Gn,trackingName:yi,videoControls:ir,easing:Oi="linear",playerScript:Rr,mediaId:Qi}){const[Bi,ni]=Zt(Yt.hidden),li=qt(null),at=qt(null),[Ge,ct]=Zt(!0),{disabled:Cn}=Fn(),jt=qt(null);Ct(()=>Gi({container:Ut.current,content:li.current,overlay:at.current,active:ni,duration:ce,easing:Oi}),[ce,Oi]),Ct(()=>{Bi||(ct(!0),jt.current=null)},[Bi]);const pn=Ai=>{Ai.stopPropagation(),jt.current&&jt.current.seek(0)},ki=Ai=>{jt.current&&(Ai.stopPropagation(),jt.current.setMute(),ct(!Ge))};return Ct(()=>{!jt.current||(Bi===Yt.showing?jt.current.play():jt.current.pause())},[Bi]),gt.createElement(En,null,gt.createElement("div",{ref:li,className:["fixedWrapper fill"].join(" ")},Cn||Bi?gt.createElement("div",{className:["contents fill"].join(" ")},gt.createElement(En,null,ir&&gt.createElement(En,null,gt.createElement("div",{className:"media-controls"},gt.createElement(Hn,{d:Ge?"mute_icon":"audio_100_icon",onClick:ki,className:"mediaIcon audioButton"}),gt.createElement(Hn,{d:"media_restart",onClick:pn,className:"mediaIcon restartButton"}),!1)),wn&&gt.createElement("div",{className:`${At?"fill":""} jw-wrapper`},gt.createElement("div",{className:"jw-container"},gt.createElement(Ln,{ref:jt,embedUrl:wn,stretch:$t,autoplay:!0,mute:!0}))),!wn&&gt.createElement("div",{className:"no-image fill row center-center"},gt.createElement("h3",null,"Please select a video")))):gt.createElement(En,null)),gt.createElement("div",{className:"fill overlay",ref:at}))}}}}),Bs.register("pL-YXwgdPSb8",["vev","react"],function(Ki){"use strict";var gt,qt,Ct,Bn,En,Zt,ln,Fn,Rn,ri;return{setters:[function(In){gt=In.useEditorState,qt=In.useScrollTop,Ct=In.View,Bn=In.useFrame,En=In.isString},function(In){Zt=In.useRef,ln=In.useEffect,Fn=In.useLayoutEffect,Rn=In.useCallback,ri=In.useState}],execute:function(){Ki({"w1cal72054-hh4":Un,wmPe8MXwzAC:en});function In(Yt,Pn){switch(Pn){case"bottom":return Yt.bottom-Ct.height;case"center":return Ct.height/2-(Yt.top+Yt.height/2)}return Yt.top}function Hn(Yt,Pn,Nt,Ee,Xe,pt,wt,kt,mt,St){if(!Yt)return;const It=null,Tn=Yt.style;Tn.top=Pn===null?It:En(Pn)?Pn:Pn+"px",Tn.left=Nt===null?It:En(Nt)?Nt:Nt+"px",Tn.bottom=Ee===null?It:En(Ee)?Ee:Ee+"px",Tn.width=Xe===null?It:Xe+"px",Tn.height=pt===null?It:pt+"px",Tn.minHeight=pt===null?It:pt+"px",Tn.position=wt===null?It:wt,Tn.margin=wt===null?It:"0",Tn.zIndex=kt===null?It:kt+"";let Ft=[];mt!==null&&Ft.push(`translateY(${mt}px)`),St!==null&&Ft.push(`translateX(${St}px)`),Tn.transform=Ft.join(" ")||It}function Un({pos:Yt=0,where:Pn="top",type:Nt,dist:Ee,children:Xe,widget:pt,layer:wt,bottom:kt,hostRef:mt,className:St}){const It=Zt(null),{disabled:Tn}=gt(),Ft=Zt(null),cn=Zt(!1),nn=Zt(null),di=Zt(!1),Ri=Zt(!1),Ti=Zt(0),Gi=qt(),Xn=Zt(0),zt=Zt(null);ln(()=>{const _n=mt.current;if(_n)return()=>{_n.classList.add("__pp"),Hn(mt.current,null,null,null,null,null,null,null,null,null)}},[]),zt.current=()=>{let _n=mt.current;if(!_n)return;Ct.isIE;const Ut=_n.style;let ce=window.innerWidth-Xn.current;di.current&&(Ut.transform=`translateX(${ce/2}px)`)},ln(()=>{const _n=()=>{if(!di.current)return;let Ut=mt.current;Ut.style.willChange="translateX",Ct.isIE;const ce=Ut.style;let At=window.innerWidth-Xn.current;ce.transform=`translateX(${At/2}px)`};return window.addEventListener("resize",_n),()=>{window.removeEventListener("resize",_n)}},[]),Fn(()=>{Tn||(Xn.current=Ct.width),mt.current&&Hn(mt.current,null,null,null,null,null,null,null,null,null)},[Tn]),Bn(()=>{const _n=mt.current;if(Tn||!_n)return Nn(!1);const Ut=Ct.scrollTop;if(Ti.current==Gi){if(Ri.current)return;Ri.current=!0}else Ri.current=!1;Ti.current=Gi;const ce=_n.getBoundingClientRect();if(Ft.current){const At=In(ce,Pn);let $t=Pn==="bottom"?-Yt:Yt;const wn=At-$t;Ft.current[1]=Ct.scrollTop+Tt(wn,ce);const[Gn,yi]=Ft.current;Gn>=Ut||Ut>=yi?Nn(Ut>yi):Ut<=yi&&Ln()}else{const At=In(ce,Pn);let $t=Pn==="bottom"?-Yt:Yt;if(At<=$t){const wn=At-$t;Ft.current=[Ct.scrollTop+wn,Ct.scrollTop+Tt(wn,ce)],Ln()}}});const Ln=()=>{if(di.current&&mt.current.style.position==="fixed")return;di.current=!0;const _n=mt.current.getBoundingClientRect();let Ut,ce;switch(Pn){case"bottom":ce=Yt,Ut="auto";break;case"center":default:Ut=Yt,ce="auto"}const At=mt.current.ownerDocument;mt.current.classList.contains("__s")&&(nn.current||(nn.current=At==null?void 0:At.createElement("div")),nn.current.style.height=mt.current.clientHeight+"px",mt.current.insertAdjacentElement("afterend",nn.current)),Hn(mt.current,Ut,_n.left,ce,_n.width,_n.height,"fixed",wt==1?null:wt?-1:11,null,null)},Nn=_n=>{if(!di.current)return;di.current=!1,cn.current=_n,_n||(Ft.current=null),nn.current&&nn.current.remove();let Ut=null;_n&&(Ut=Ft.current[1]-Ft.current[0]),Hn(mt.current,null,null,null,null,null,null,wt===0?2:null,_n?Ut:null,null)},Tt=Rn((_n,Ut)=>{switch(Nt){case 1:return Ee+_n;case 2:{const ce=mt.current.getRootNode(),At=pt&&ce.getElementById(pt&&pt.key||pt);if(At)return At.getBoundingClientRect().top-Ut.top+_n-Ut.height-(kt||0)}default:return 1/0}},[mt,pt,Ee]);return st.createElement("div",{className:St,ref:It},Xe)}function en({text:Yt}){const[Pn,Nt]=ri(0),{disabled:Ee}=gt();return st.createElement(st.Fragment,null,st.createElement("h1",null,Yt),st.createElement("p",null,Ee?"Disabled":"Enabled"),st.createElement("p",{onClick:()=>Nt(Pn+1)},"Counter ",Pn))}}}}),Bs.register("mDYZza5j7",["vev"],function(Ki){"use strict";var gt;return{setters:[function(qt){gt=qt.useHover}],execute:function(){Ki("wbRtdVlpud",qt);function qt({hoverText:Bn,hoverVideo:En,text:Zt,video:ln}){const[Fn,Rn]=gt(),ri={opacity:Fn?1:0,transition:"opacity 400ms ease"};return st.createElement("div",Object.assign({},Rn,{className:"fill"}),ln?st.createElement(st.Fragment,null,st.createElement("div",{className:"normal"},!Fn&&st.createElement("span",null,Zt)),st.createElement(Ct,{video:ln})):st.createElement("div",{className:"fill row v-center h-center missing-video-warning"},st.createElement("h3",null,"Double-click to select video")),st.createElement("div",{style:{position:"absolute",top:0,left:0,height:"100%",width:"100%",zIndex:2,...ri}},ln&&st.createElement("div",{className:"hovered"},st.createElement("span",null,Bn)),En&&st.createElement(Ct,{video:En})))}const Ct=({video:Bn})=>Bn?st.createElement("div",{className:"videoHolder"},st.createElement("video",{playsInline:!0,preload:"on",autoPlay:!0,loop:!0,controls:!1,muted:!0},Bn&&Bn.sources&&Bn.sources.sort(En=>En.format==="video/webm"?-1:1).map(En=>st.createElement("source",{key:En.url,src:En.url,type:En.format||"video/mp4"})),"Your browser does not support this video")):null}}}),Bs.register("IoGa7RjYJD",["react","vev"],function(Ki){"use strict";var gt,qt,Ct,Bn;return{setters:[function(En){gt=En.useRef,qt=En.useEffect},function(En){Ct=En.useVisible,Bn=En.useHover}],execute:function(){Ki("w4lBnnlt6_J",En);function En({className:Zt,children:ln,x:Fn,y:Rn,z:ri,animate:In,trigger:Hn}){const Un=gt(null),en=Ct(Un),[Yt,Pn]=Bn();var Nt=500;qt(()=>{if(In&&Hn!=="onScroll"?Un.current.style.transition="all ease 800ms":Un.current.style.transition="",In)switch(Hn){case"onVisible":en?Ee():Xe();break;case"onHover":Yt?Ee():Xe();break;case"onScroll":if(en){const pt=Un.current,wt=()=>{const{top:kt}=pt.getBoundingClientRect(),mt=1-kt/window.innerHeight;Ee(mt)};return wt(),document.addEventListener("scroll",wt),()=>{document.removeEventListener("scroll",wt)}}break}else Ee()},[Fn,Rn,ri,In,Hn,In,en,Yt]),qt(()=>{},[]);function Ee(pt=1){Un.current.style.transform=`perspective(${Nt}px) rotateX(${Fn*pt}deg) rotateY(${Rn*pt}deg) rotateZ(${ri*pt}deg)`}function Xe(){Un.current.style.transform=`perspective(${Nt}px) rotateX(${0}deg) rotateY(${0}deg) rotateZ(${0}deg)`}return st.createElement("div",Object.assign({},Pn,{className:`isometric ${Zt}`,ref:Un}),st.createElement("div",{className:"fill"},ln))}}}}),Bs.register("MijsznNoWo",["react","vev"],function(Ki){"use strict";var gt,qt,Ct;return{setters:[function(Bn){gt=Bn.useEffect},function(Bn){qt=Bn.useGlobalStore,Ct=Bn.View}],execute:function(){Ki("wjoxNqyDxx6",Bn);function Bn(En){var Zt=En.noScalingUrl,ln=qt(function(In,Hn){return[In.route,Hn]}),Fn=ln[0],Rn=ln[1],ri=Ct.isFirefox||Ct.isIOS&&(Ct.zoom>1||Ct.zoom<1);return gt(function(){ri&&(console.log("REDIRECT USER",Ct.isFirefox,Ct.isIOS,Ct.zoom),window.location.href=Zt||"https://www.vev.design")},[ri]),ri?st.createElement("div",{className:"no-support fill"},"Browser not supported!"):st.createElement("div",null)}}}}),Bs.register("YtUwZxjr3g",["react","vev"],function(Ki){"use strict";var gt,qt,Ct,Bn,En,Zt,ln,Fn;return{setters:[function(Rn){gt=Rn.useState,qt=Rn.useRef,Ct=Rn.useEffect},function(Rn){Bn=Rn.useSize,En=Rn.useDevice,Zt=Rn.Gesture,ln=Rn.Link,Fn=Rn.Icon}],execute:function(){Ki("w-0pL1YdUlJ",Rn);function Rn({items:ri,hostRef:In,tile_gap_desktop:Hn,tile_gap_tablet:Un,tile_gap_mobile:en}){const[Yt,Pn]=gt(0),Nt=qt(null),{width:Ee}=Bn(In),Xe=En();Ct(()=>{St();function St(){let It=ri.length,Tn=360/It,Ft=In.current.getBoundingClientRect().width;console.log("new cell size",Ft);let cn=Math.round(Ft/2/Math.tan(Math.PI/It)),nn=Nt.current.children;for(var di=0;di<nn.length;di++){var Ri=nn[di];Ri.style.opacity="1";var Ti=Tn*di;Ri.style.transform="rotateY("+Ti+"deg) translateZ("+cn+"px)"}pt()}},[ri,Nt,Xe,Hn,Un,en,Ee]);function pt(){let St=ri.length,It=360/St,Tn=In.current.getBoundingClientRect().width,Ft=Math.round(Tn/2/Math.tan(Math.PI/St));var cn=It*Yt*-1;Nt.current.style.transform="translateZ("+-Ft+"px) rotateY("+cn+"deg)"}Ct(()=>{let St=ri.length,It=360/St,Tn=In.current.getBoundingClientRect().width,Ft=Math.round(Tn/2/Math.tan(Math.PI/St));var cn=It*Yt*-1;Nt.current.style.transform="translateZ("+-Ft+"px) rotateY("+cn+"deg)"},[Yt]);const wt=()=>{let St=Yt+1;Pn(St)},kt=()=>{let St=Yt-1;Pn(St)},mt=()=>{switch(Xe){case"desktop":return Hn;case"tablet":return Un;case"mobile":return en}};return st.createElement(st.Fragment,null,st.createElement(Zt,{onSwipeLeft:wt,onSwipeRight:kt},st.createElement("div",{className:"scene"},st.createElement("div",{ref:Nt,className:"carousel"},ri.map((St,It)=>st.createElement("div",{key:It,className:"carousel_cell"},st.createElement("div",{className:"content",style:{backgroundImage:St.image&&"url('"+St.image.url+"')",margin:"0px "+mt()+"px"}},st.createElement("div",{className:"overlay"}),st.createElement("div",{className:"text-content"},st.createElement("h1",{className:"title"},St.title),st.createElement("p",{className:"description"},St.description),St.isLink&&st.createElement(ln,{to:St.link,className:"link"},st.createElement("div",{className:"link-button"}," ",St.linkLabel||"View more"," "))))))))),st.createElement("nav",null,st.createElement(Fn,{className:"icon nav left",d:"left",onClick:kt}),st.createElement(Fn,{className:"icon nav right",d:"right",onClick:wt})))}}}}),Bs.register("puuOUGN6Cid",["react","vev"],function(Ki){"use strict";var gt,qt,Ct,Bn,En;return{setters:[function(Zt){gt=Zt.useState,qt=Zt.useEffect},function(Zt){Ct=Zt.useScrollTop,Bn=Zt.useEditorState,En=Zt.View}],execute:function(){Ki("wUyMTg7qKw",Zt);function Zt({hostRef:ln,children:Fn}){const Rn=Ct(),{disabled:ri}=Bn(),[In,Hn]=gt(!1),[Un,en]=gt(()=>window.matchMedia("print").matches);return qt(()=>{if(In||ri)return;const{top:Yt}=ln.current.getBoundingClientRect();Yt<En.height*1.5&&Hn(!0)},[Rn,In,ri]),qt(()=>{const Yt=window.matchMedia("print");return Yt.onchange=Pn=>{en(Pn.matches)},()=>Yt.onchange=null},[]),In||Un||ri?Fn:null}}}}),Bs.register("gEJidNxqGs",["react","vev"],function(Ki){"use strict";var gt,qt,Ct,Bn;return{setters:[function(En){gt=En.useRef,qt=En.useEffect},function(En){Ct=En.useEditorState,Bn=En.useSize}],execute:function(){Ki("wWNWbdOWGT5",En);function En({dir:Zt,className:ln,space:Fn,children:Rn,hostRef:ri}){const{disabled:In}=Ct(),{height:Hn}=Bn(ri),Un=gt(null);return qt(()=>{if(!In&&Hn){const en=Un.current,Yt=()=>{const{left:Nt,width:Ee}=ri.current.getBoundingClientRect();if(Zt==="full"){let Xe=-Nt;en.style.width=`calc(100vw - ${Fn*2}px)`,en.style.maxWidth=`calc(100vw - ${Fn*2}px)`,Xe+=Fn,en.style.transform=`translateX(${Xe}px)`}else{let Xe=-Nt;Zt==="right"?Xe+=window.innerWidth-(Ee+Fn):Xe+=Fn,en.style.transform=`translateX(${Xe}px)`}};window.addEventListener("resize",Yt,{passive:!0}),Yt();const Pn=setInterval(Yt,800);return()=>{clearInterval(Pn),window.removeEventListener("resize",Yt),en.style.transform=null,en.style.width=null}}},[In,Zt,Fn,ri,Hn]),st.createElement("div",{className:ln,ref:Un},Rn)}}}}),Bs.register("beNzzf2XK9",["react","vev"],function(Ki){"use strict";var gt,qt,Ct;return{setters:[function(Bn){gt=Bn.useCallback,qt=Bn.useEffect},function(Bn){Ct=Bn.useGlobalStore}],execute:function(){Ki("w-LhdQExosj",Zt);let Bn=!1,En;function Zt({hostRef:ln,anchorId:Fn,children:Rn,block:ri,elementOrPosition:In,scrollBehavior:Hn,offset:Un}){const[en]=Ct(Ee=>[Ee.zoom]),Yt=gt(Ee=>{for(var Xe=0;Ee!=null&&(Ee.tagName||"").toLowerCase()!="html";)Xe+=Ee.offsetTop||0,Ee=Ee.parentElement;return Xe},[]),Pn=gt(()=>{if(!!(ln!=null&&ln.current)){for(var Ee=ln.current.ownerDocument.querySelector(".vev"),Xe=0;Ee!=null&&(Ee.tagName||"").toLowerCase()!="html";)Xe+=Ee.offsetTop||0,Ee=Ee.parentElement;return Xe}},[ln]),Nt=gt(()=>{var kt,mt,St,It;const Ee=new URLSearchParams(window.location.search),Xe=ln!=null&&ln.current?ln.current.getRootNode():null;let pt=window.location.hash;if(pt.indexOf("?")!==-1&&(pt=pt.substring(0,pt.indexOf("?")-1)),!pt&&!Ee.get("scrollTarget")&&(pt="#"+Ee.get("scrollTarget")),pt&&!Bn){var wt=Xe?Xe.querySelector(pt):null;if(!wt)En=setTimeout(Nt,500);else{Bn=!0;const Tn=((kt=wt.dataset)==null?void 0:kt.scrollVariant)||"element";(mt=wt.dataset)!=null&&mt.scrollBlock;const Ft=((St=wt.dataset)==null?void 0:St.scrollBehavior)||"auto",cn=parseInt((It=wt.dataset)==null?void 0:It.scrollOffset)||0,nn=wt.getBoundingClientRect().top+window.pageYOffset+cn;if(Tn==="element"){let di=Yt(wt),Ri=Pn();window.scrollTo({behavior:Ft,top:(di-Ri)*en})}else window.scrollTo({behavior:Ft,top:nn});clearTimeout(En)}}},[ln]);return qt(()=>{Nt()},[]),st.createElement("div",{id:Fn,className:"fill","data-scroll-target":Fn,"data-scroll-block":ri,"data-scroll-behavior":Hn,"data-scroll-offset":Un,"data-scroll-variant":In},Rn)}}}}),Bs.register("pDzQGCY5y",["react","vev","animejs"],function(Ki){"use strict";var gt,qt,Ct,Bn,En,Zt,ln,Fn,Rn,ri,In,Hn;return{setters:[function(Un){gt=Un.useRef,qt=Un.useState,Ct=Un.useEffect},function(Un){Bn=Un.useVisible,En=Un.useHover,Zt=Un.useEditorState,ln=Un.useScrollTop,Fn=Un.useViewport,Rn=Un.useDevice,ri=Un.View,In=Un.isString},function(Un){Hn=Un.default}],execute:function(){Ki("w77s30so",en);const Un={opacity:0};function en({className:Pn,children:Nt,cont:Ee,hostRef:Xe,pos:pt=0,where:wt="top",type:kt,dist:mt,widget:St,layer:It,bottom:Tn}){const Ft=Bn(Xe),cn=gt(),nn=gt(),di=gt(),Ri=gt(),[Ti,Gi]=En(),[Xn,zt]=qt(!1),{disabled:Ln,selected:Nn}=Zt(),Tt=ln(),{height:_n}=Fn(),Ut=Rn(),ce=Ee&&Ee[Ut]&&Ee[Ut].params||{},At=gt(null),$t=gt(!1),wn=gt(!1),Gn=gt({ClickAnimation:null,HoverAnimation:null,ScrollAnimation:null,LoadAnimation:null}),yi=gt();Ct(()=>{cn.current&&(cn.current.style.opacity=null)}),Ct(()=>{Ln||Ai(),Gn.current.ScrollAnimation&&ce.ScrollAnimation&&ct(ce.ScrollAnimation);const xt=ns();return()=>{xt.widget&&Hn.remove(xt.widget),xt.stagger&&Hn.remove(xt.stagger),xt.animation&&Hn.remove(xt.animation)}},[]),Ct(()=>{!ce||yi&&ce.updated&&yi.current===ce.updated||(yi.current=ce.updated,Object.keys(Gn.current).forEach(xt=>at(xt)),Ai(),Ln&&Nn?li(ce.trigger+"Animation"):di.current!==Ut&&(li(ce.trigger+"Animation"),di.current=Ut))},[ce]),Ct(()=>{!ce||(Object.keys(Gn.current).forEach(xt=>at(xt)),Gn.current.LoadAnimation&&Ft&&li("LoadAnimation"),Gn.current.ScrollAnimation&&Ft&&!Ln&&ct(ce.ScrollAnimation))},[Ln,Ut]),Ct(()=>{!ce||(Ln&&Nn?li(ce.trigger+["Animation"]):Ln&&!Nn&&at(ce.trigger+["Animation"]))},[Nn]),Ct(()=>{!ce||!Gn.current.LoadAnimation||(Ft?li("LoadAnimation"):ce.LoadAnimation.once||at("LoadAnimation"))},[Ft]),Ct(()=>{!ce||!Gn.current.HoverAnimation||li("HoverAnimation",!Ti)},[Ti]),Ct(()=>{!Ln&&ce&&Gn.current.ScrollAnimation&&ct(ce.ScrollAnimation);const xt=Xe.current;if(Ln||!xt)return Qi(!1);const sn=xt.getBoundingClientRect();if(At.current){const[_i,Hr]=At.current;_i>=Tt||Tt>=Hr?Qi(Tt>Hr):Tt<Hr&&Rr()}else{const _i=ir(sn,wt);let Hr=wt==="bottom"?-pt:pt;if(_i<=Hr){const Er=_i-Hr;At.current=[ri.scrollTop+Er,ri.scrollTop+Bi(Er,sn)],Rr()}}},[Tt]),Ct(()=>{!ce||!Gn.current.ClickAnimation||li("ClickAnimation",!Xn)},[Xn]);function ir(xt,sn){switch(sn){case"bottom":return xt.bottom-ri.height;case"center":return ri.height/2-(xt.top+xt.height/2)}return xt.top}function Oi(xt,sn,_i,Hr,Er,ci,cr,$r,Lo){if(!xt)return;const Kr=ri.isIE?"":null,Na=xt.style;Na.top=sn===null?Kr:In(sn)?sn:sn+"px",Na.left=_i===null?Kr:In(_i)?_i:_i+"px",Na.bottom=Hr===null?Kr:In(Hr)?Hr:Hr+"px",Na.width=Er===null?Kr:Er+"px",Na.height=ci===null?Kr:ci+"px",Na.position=cr===null?Kr:cr,Na.zIndex=$r===null?Kr:$r+"",Na.transform=Lo===null?Kr:`translateY(${Lo}px)`}Ct(()=>()=>{Oi(Xe.current,null,null,null,null,null,null,null,null)},[]);const Rr=()=>{if(wn.current)return;wn.current=!0;const xt=Xe.current.getBoundingClientRect();let sn,_i;switch(wt){case"bottom":_i=pt,sn="auto";break;case"center":default:sn=pt,_i="auto"}Oi(Xe.current,sn,xt.left,_i,xt.width,xt.height,"fixed",It==1?null:It?-1:11,null)},Qi=xt=>{!wn.current||(wn.current=!1,$t.current=xt,xt||(At.current=null),Oi(Xe.current,null,null,null,null,null,null,null,xt?At.current[1]-At.current[0]:null))};function Bi(xt,sn){switch(kt){case 1:return mt+xt;case 2:{const _i=St&&document.getElementById(St&&St.key||St);if(_i)return _i.getBoundingClientRect().top-sn.top+xt-sn.height-(Tn||0)}default:return 1/0}}const ni=xt=>{if(!ce[xt])return;const sn=ce[xt],_i=Hn.timeline({autoplay:!1,delay:or(ce[xt])}),Hr=ns();let Er={targets:sn.stagger?Hr.stagger:Hr.animation,easing:sn.easing||"linear"},ci={targets:sn.stagger?Hr.stagger:Hr.widget,easing:sn.easing||"linear"};ci.duration=Er.duration=sn.duration?Math.max(sn.duration,1e-4)*1e3:1e3,sn.opacity&&(Er.opacity=sn.opacity),sn.scale&&(Er.scale=sn.scale),sn.move&&sn.move[0]!=="0px"&&(Er.translateY=sn.move[0]),sn.move&&sn.move[1]!=="0px"&&(Er.translateX=sn.move[1]),sn.translateX&&(Er.translateX=[sn.translateX[0],sn.translateX[1]]),sn.translateY&&(Er.translateY=[sn.translateY[0],sn.translateY[1]]),sn.rotate&&(Er.rotate=[0,sn.rotate]),Er.rotate3d=[],sn.color&&(ci.color=Yt(sn.color)),sn.background&&(ci.backgroundColor=Yt(sn.background)),sn.border&&(ci["border-radius"]=[sn.border[0],sn.border[1]]),(sn.color||sn.background||sn.border)&&_i.add({...ci}),_i.add({...Er}),Gn.current[xt]=_i,sn.triggers&&Object.keys(sn.triggers).length&&Cn(xt,sn.triggers),Ln&&!Nn&&Si()},li=(xt,sn)=>{const _i=Gn.current[xt];Ln&&!Nn||!_i||_i.began&&!_i.complete&&sn===void 0||(ce[xt]&&ce[xt].loop&&(_i.complete=()=>{_i.reverse(),_i.completed=!1,_i.play()}),rr(_i,sn)&&(_i.began&&_i.pause(),sn!==void 0&&_i.reversed!==sn&&(_i.reverse(),_i.completed=!1),_i.play()))},at=xt=>{if(!!Gn.current[xt]){if(!ce[xt])return Ge(xt);Gn.current[xt].pause(),Gn.current[xt].reversed&&Gn.current[xt].reverse(),Gn.current[xt].seek(0),Gn.current[xt].complete=null,Gn.current[xt].began=!1,xt==="HoverAnimation"&&(nn.current&&pn(),jr(xt)&&Cn(xt,ce[xt].triggers)),xt==="ClickAnimation"&&(Ri.current&&ki(),jr(xt)&&Cn(xt,ce[xt].triggers)),Ln&&Si()}},Ge=xt=>{Gn.current[xt].pause(),Gn.current[xt].seek(0),Gn.current[xt]=null;const sn=ns();sn.widget&&Hn.remove(sn.widget),sn.stagger&&Hn.remove(sn.stagger),sn.animation&&Hn.remove(sn.animation),Si()},ct=xt=>{if(!xt)return;const sn=Gn.current.ScrollAnimation,_i=xt.scrollOffsetStart?xt.scrollOffsetStart:0,Hr=xt.scrollOffsetEnd?xt.scrollOffsetEnd:0;let Er;if(!Xe.current.classList.contains("__f")&&Xe.current.style.position!=="fixed")return;let ci=0,cr=Xe.current;for(;cr;)cr.classList.contains("__section")?(ci+=cr.offsetTop,cr=null):cr=cr.parentElement;Er=(Tt-ci+_i)/(_n-Hr+_i);let $r=sn.duration*Er;$r<0&&Ft&&($r=.01),sn.seek($r)},Cn=(xt,sn)=>{const _i=[],Hr=[];Object.values(sn).forEach(Er=>{const ci=document.getElementById(Er&&Er.key||Er);ci&&(xt==="ClickAnimation"?(ci.onclick=()=>jt(),ci.style.cursor="pointer",Hr.push(ci)):xt==="HoverAnimation"&&(ci.onmouseenter=Gi.onMouseEnter,ci.onmouseleave=Gi.onMouseLeave,_i.push(ci)))}),nn.current=_i,Ri.current=Hr},jt=()=>{const xt=Gn.current.ClickAnimation;if(!xt.began)return xt.play();xt.reverse(),xt.completed=!1,xt.play()},pn=()=>{nn.current&&nn.current.forEach(xt=>{xt.onmouseenter=()=>!1,xt.onmouseleave=()=>!1})},ki=()=>{Ri.current&&Ri.current.forEach(xt=>{xt.onclick=()=>!1,xt.style.cursor=null})},Ai=()=>{!ce||Object.keys(Gn.current).forEach(xt=>ce[xt]&&ni(xt))},jr=xt=>!(!ce||!ce[xt]||!ce[xt].triggers||!Object.keys(ce[xt].triggers).length),Si=()=>{if(!Xe.current)return;const xt=ns();xt.animation&&xt.animation.removeAttribute("style"),xt.widget&&xt.widget.removeAttribute("style"),xt.stagger&&[].forEach.call(xt.stagger,sn=>sn&&sn.removeAttribute("style"))},or=xt=>xt.stagger?Hn.stagger(xt.stagger[0]*1e3,{start:xt.delay*1e3,from:xt.stagger[1]}):xt.delay*1e3,ns=()=>{if(!Xe.current)return;let xt,sn,_i;return xt=Xe.current.querySelector(".__wc"),sn=xt&&xt.querySelector("w"),_i=Xe.current.classList.contains("__text")?xt.querySelectorAll("w div > *"):xt.querySelectorAll(".__c vev .__wc w:not(.frame)"),{animation:xt,widget:sn,stagger:_i}},rr=(xt,sn)=>!(sn&&xt.currentTime===0||sn===!1&&xt.currentTime===xt.duration);let lr;return!Ln&&ce&&(ce.LoadAnimation||ce.ScrollAnimation)&&(lr=Un),st.createElement("div",{className:Pn,style:lr,onClick:!jr("ClickAnimation")&&(()=>zt(Xn)),onMouseEnter:!jr("HoverAnimation")&&Gi.onMouseEnter,onMouseLeave:!jr("HoverAnimation")&&Gi.onMouseLeave,ref:cn},Nt)}const Yt=Pn=>`rgba(${[Pn.r,Pn.g,Pn.b,Pn.a].toString()}`}}}),Bs.register("DFkMApDq9I",["react","vev"],function(Ki){"use strict";var gt,qt,Ct,Bn,En,Zt,ln;return{setters:[function(Fn){gt=Fn.useRef,qt=Fn.useState,Ct=Fn.useEffect,Bn=Fn.useCallback,En=Fn.Fragment},function(Fn){Zt=Fn.useEditorState,ln=Fn.useSize}],execute:function(){Ki("threeModel",pA);var Fn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Rn(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function ri(r,i){return i={exports:{}},r(i,i.exports),i.exports}var In=ri(function(r,i){(function(n,u){u(i)})(Fn,function(n){function u(xe,S){xe.prototype=Object.create(S.prototype),xe.prototype.constructor=xe,xe.__proto__=S}function p(xe){if(xe===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return xe}/*!
 * GSAP 3.8.0
 * https://greensock.com
 *
 * @license Copyright 2008-2021, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var g={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},b={duration:.5,overwrite:!1,delay:0},M,A=1e8,C=1/A,F=Math.PI*2,O=F/4,k=0,N=Math.sqrt,X=Math.cos,ne=Math.sin,te=function(S){return typeof S=="string"},j=function(S){return typeof S=="function"},W=function(S){return typeof S=="number"},Pe=function(S){return typeof S>"u"},Re=function(S){return typeof S=="object"},Ne=function(S){return S!==!1},de=function(){return typeof window<"u"},$e=function(S){return j(S)||te(S)},Gt=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},dt=Array.isArray,an=/(?:-?\.?\d|\.)+/gi,_t=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,et=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,rt=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,je=/[+-]=-?[.\d]+/,Ve=/[^,'"\[\]\s]+/gi,ht=/[\d.+\-=]+(?:e[-+]\d*)*/i,ft,Wt,An,Vt,Dn={},Ci={},vi,he=function(S){return(Ci=er(S,Dn))&&ko},K=function(S,L){return console.warn("Invalid property",S,"set to",L,"Missing plugin? gsap.registerPlugin()")},Fe=function(S,L){return!L&&console.warn(S)},me=function(S,L){return S&&(Dn[S]=L)&&Ci&&(Ci[S]=L)||Dn},Le=function(){return 0},Be={},Ye=[],ke={},He,Je={},ot={},bt=30,Mt=[],ue="",oe=function(S){var L=S[0],I,B;if(Re(L)||j(L)||(S=[S]),!(I=(L._gsap||{}).harness)){for(B=Mt.length;B--&&!Mt[B].targetTest(L););I=Mt[B]}for(B=S.length;B--;)S[B]&&(S[B]._gsap||(S[B]._gsap=new rd(S[B],I)))||S.splice(B,1);return S},lt=function(S){return S._gsap||oe(la(S))[0]._gsap},yt=function(S,L,I){return(I=S[L])&&j(I)?S[L]():Pe(I)&&S.getAttribute&&S.getAttribute(L)||I},Ce=function(S,L){return(S=S.split(",")).forEach(L)||S},Pt=function(S){return Math.round(S*1e5)/1e5||0},Kt=function(S){return Math.round(S*1e7)/1e7||0},qn=function(S,L){for(var I=L.length,B=0;S.indexOf(L[B])<0&&++B<I;);return B<I},xn=function(){var S=Ye.length,L=Ye.slice(0),I,B;for(ke={},Ye.length=0,I=0;I<S;I++)B=L[I],B&&B._lazy&&(B.render(B._lazy[0],B._lazy[1],!0)._lazy=0)},Oe=function(S,L,I,B){Ye.length&&xn(),S.render(L,I,B),Ye.length&&xn()},Ht=function(S){var L=parseFloat(S);return(L||L===0)&&(S+"").match(Ve).length<2?L:te(S)?S.trim():S},Kn=function(S){return S},hn=function(S,L){for(var I in L)I in S||(S[I]=L[I]);return S},jn=function(S,L){for(var I in L)I in S||I==="duration"||I==="ease"||(S[I]=L[I])},er=function(S,L){for(var I in L)S[I]=L[I];return S},ts=function xe(S,L){for(var I in L)I!=="__proto__"&&I!=="constructor"&&I!=="prototype"&&(S[I]=Re(L[I])?xe(S[I]||(S[I]={}),L[I]):L[I]);return S},wa=function(S,L){var I={},B;for(B in S)B in L||(I[B]=S[B]);return I},zs=function(S){var L=S.parent||ft,I=S.keyframes?jn:hn;if(Ne(S.inherit))for(;L;)I(S,L.vars.defaults),L=L.parent||L._dp;return S},Ra=function(S,L){for(var I=S.length,B=I===L.length;B&&I--&&S[I]===L[I];);return I<0},ec=function(S,L,I,B,Z){I===void 0&&(I="_first"),B===void 0&&(B="_last");var $=S[B],ee;if(Z)for(ee=L[Z];$&&$[Z]>ee;)$=$._prev;return $?(L._next=$._next,$._next=L):(L._next=S[I],S[I]=L),L._next?L._next._prev=L:S[B]=L,L._prev=$,L.parent=L._dp=S,L},to=function(S,L,I,B){I===void 0&&(I="_first"),B===void 0&&(B="_last");var Z=L._prev,$=L._next;Z?Z._next=$:S[I]===L&&(S[I]=$),$?$._prev=Z:S[B]===L&&(S[B]=Z),L._next=L._prev=L.parent=null},Ds=function(S,L){S.parent&&(!L||S.parent.autoRemoveChildren)&&S.parent.remove(S),S._act=0},xs=function(S,L){if(S&&(!L||L._end>S._dur||L._start<0))for(var I=S;I;)I._dirty=1,I=I.parent;return S},tl=function(S){for(var L=S.parent;L&&L.parent;)L._dirty=1,L.totalDuration(),L=L.parent;return S},no=function xe(S){return!S||S._ts&&xe(S.parent)},El=function(S){return S._repeat?ta(S._tTime,S=S.duration()+S._rDelay)*S:0},ta=function(S,L){var I=Math.floor(S/=L);return S&&I===S?I-1:I},io=function(S,L){return(S-L._start)*L._ts+(L._ts>=0?0:L._dirty?L.totalDuration():L._tDur)},bo=function(S){return S._end=Kt(S._start+(S._tDur/Math.abs(S._ts||S._rts||C)||0))},nl=function(S,L){var I=S._dp;return I&&I.smoothChildTiming&&S._ts&&(S._start=Kt(I._time-(S._ts>0?L/S._ts:((S._dirty?S.totalDuration():S._tDur)-L)/-S._ts)),bo(S),I._dirty||xs(I,S)),S},ye=function(S,L){var I;if((L._time||L._initted&&!L._dur)&&(I=io(S.rawTime(),L),(!L._dur||Wr(0,L.totalDuration(),I)-L._tTime>C)&&L.render(I,!0)),xs(S,L)._dp&&S._initted&&S._time>=S._dur&&S._ts){if(S._dur<S.duration())for(I=S;I._dp;)I.rawTime()>=0&&I.totalTime(I._tTime),I=I._dp;S._zTime=-C}},Dt=function(S,L,I,B){return L.parent&&Ds(L),L._start=Kt((W(I)?I:I||S!==ft?Ii(S,I,L):S._time)+L._delay),L._end=Kt(L._start+(L.totalDuration()/Math.abs(L.timeScale())||0)),ec(S,L,"_first","_last",S._sort?"_start":0),ar(L)||(S._recent=L),B||ye(S,L),S},Rt=function(S,L){return(Dn.ScrollTrigger||K("scrollTrigger",L))&&Dn.ScrollTrigger.create(L,S)},rn=function(S,L,I,B){if(Hu(S,L),!S._initted)return 1;if(!I&&S._pt&&(S._dur&&S.vars.lazy!==!1||!S._dur&&S.vars.lazy)&&He!==Mo.frame)return Ye.push(S),S._lazy=[L,B],1},Qn=function xe(S){var L=S.parent;return L&&L._ts&&L._initted&&!L._lock&&(L.rawTime()<0||xe(L))},ar=function(S){var L=S.data;return L==="isFromStart"||L==="isStart"},dr=function(S,L,I,B){var Z=S.ratio,$=L<0||!L&&(!S._start&&Qn(S)&&!(!S._initted&&ar(S))||(S._ts<0||S._dp._ts<0)&&!ar(S))?0:1,ee=S._rDelay,we=0,Ie,Ae,Et;if(ee&&S._repeat&&(we=Wr(0,S._tDur,L),Ae=ta(we,ee),Et=ta(S._tTime,ee),S._yoyo&&Ae&1&&($=1-$),Ae!==Et&&(Z=1-$,S.vars.repeatRefresh&&S._initted&&S.invalidate())),$!==Z||B||S._zTime===C||!L&&S._zTime){if(!S._initted&&rn(S,L,B,I))return;for(Et=S._zTime,S._zTime=L||(I?C:0),I||(I=L&&!Et),S.ratio=$,S._from&&($=1-$),S._time=0,S._tTime=we,Ie=S._pt;Ie;)Ie.r($,Ie.d),Ie=Ie._next;S._startAt&&L<0&&S._startAt.render(L,!0,!0),S._onUpdate&&!I&&wo(S,"onUpdate"),we&&S._repeat&&!I&&S.parent&&wo(S,"onRepeat"),(L>=S._tDur||L<0)&&S.ratio===$&&($&&Ds(S,1),I||(wo(S,$?"onComplete":"onReverseComplete",!0),S._prom&&S._prom()))}else S._zTime||(S._zTime=L)},Mr=function(S,L,I){var B;if(I>L)for(B=S._first;B&&B._start<=I;){if(!B._dur&&B.data==="isPause"&&B._start>L)return B;B=B._next}else for(B=S._last;B&&B._start>=I;){if(!B._dur&&B.data==="isPause"&&B._start<L)return B;B=B._prev}},tr=function(S,L,I,B){var Z=S._repeat,$=Kt(L)||0,ee=S._tTime/S._tDur;return ee&&!B&&(S._time*=$/S._dur),S._dur=$,S._tDur=Z?Z<0?1e10:Kt($*(Z+1)+S._rDelay*Z):$,ee&&!B?nl(S,S._tTime=S._tDur*ee):S.parent&&bo(S),I||xs(S.parent,S),S},Os=function(S){return S instanceof Oa?xs(S):tr(S,S._dur)},Is={_start:0,endTime:Le,totalDuration:Le},Ii=function xe(S,L,I){var B=S.labels,Z=S._recent||Is,$=S.duration()>=A?Z.endTime(!1):S._dur,ee,we,Ie;return te(L)&&(isNaN(L)||L in B)?(we=L.charAt(0),Ie=L.substr(-1)==="%",ee=L.indexOf("="),we==="<"||we===">"?(ee>=0&&(L=L.replace(/=/,"")),(we==="<"?Z._start:Z.endTime(Z._repeat>=0))+(parseFloat(L.substr(1))||0)*(Ie?(ee<0?Z:I).totalDuration()/100:1)):ee<0?(L in B||(B[L]=$),B[L]):(we=parseFloat(L.charAt(ee-1)+L.substr(ee+1)),Ie&&I&&(we=we/100*(dt(I)?I[0]:I).totalDuration()),ee>1?xe(S,L.substr(0,ee-1),I)+we:$+we)):L==null?$:+L},Vr=function(S,L,I){var B=W(L[1]),Z=(B?2:1)+(S<2?0:1),$=L[Z],ee,we;if(B&&($.duration=L[1]),$.parent=I,S){for(ee=$,we=I;we&&!("immediateRender"in ee);)ee=we.vars.defaults||{},we=Ne(we.vars.inherit)&&we.parent;$.immediateRender=Ne(ee.immediateRender),S<2?$.runBackwards=1:$.startAt=L[Z-1]}return new Ts(L[0],$,L[Z+1])},oa=function(S,L){return S||S===0?L(S):L},Wr=function(S,L,I){return I<S?S:I>L?L:I},Us=function(S){if(typeof S!="string")return"";var L=ht.exec(S);return L?S.substr(L.index+L[0].length):""},Zs=function(S,L,I){return oa(I,function(B){return Wr(S,L,B)})},tc=[].slice,ma=function(S,L){return S&&Re(S)&&"length"in S&&(!L&&!S.length||S.length-1 in S&&Re(S[0]))&&!S.nodeType&&S!==Wt},nc=function(S,L,I){return I===void 0&&(I=[]),S.forEach(function(B){var Z;return te(B)&&!L||ma(B,1)?(Z=I).push.apply(Z,la(B)):I.push(B)})||I},la=function(S,L,I){return te(S)&&!I&&(An||!ku())?tc.call((L||Vt).querySelectorAll(S),0):dt(S)?nc(S,I):ma(S)?tc.call(S,0):S?[S]:[]},ic=function(S){return S=la(S)[0]||Fe("Invalid scope")||{},function(L){var I=S.current||S.nativeElement||S;return la(L,I.querySelectorAll?I:I===S?Fe("Invalid scope")||Vt.createElement("div"):S)}},Up=function(S){return S.sort(function(){return .5-Math.random()})},Ug=function(S){if(j(S))return S;var L=Re(S)?S:{each:S},I=sc(L.ease),B=L.from||0,Z=parseFloat(L.base)||0,$={},ee=B>0&&B<1,we=isNaN(B)||ee,Ie=L.axis,Ae=B,Et=B;return te(B)?Ae=Et={center:.5,edges:.5,end:1}[B]||0:!ee&&we&&(Ae=B[0],Et=B[1]),function(ut,qe,mn){var tt=(mn||L).length,gn=$[tt],Mn,ii,Zn,gi,Yn,Jn,hi,xi,si;if(!gn){if(si=L.grid==="auto"?0:(L.grid||[1,A])[1],!si){for(hi=-A;hi<(hi=mn[si++].getBoundingClientRect().left)&&si<tt;);si--}for(gn=$[tt]=[],Mn=we?Math.min(si,tt)*Ae-.5:B%si,ii=we?tt*Et/si-.5:B/si|0,hi=0,xi=A,Jn=0;Jn<tt;Jn++)Zn=Jn%si-Mn,gi=ii-(Jn/si|0),gn[Jn]=Yn=Ie?Math.abs(Ie==="y"?gi:Zn):N(Zn*Zn+gi*gi),Yn>hi&&(hi=Yn),Yn<xi&&(xi=Yn);B==="random"&&Up(gn),gn.max=hi-xi,gn.min=xi,gn.v=tt=(parseFloat(L.amount)||parseFloat(L.each)*(si>tt?tt-1:Ie?Ie==="y"?tt/si:si:Math.max(si,tt/si))||0)*(B==="edges"?-1:1),gn.b=tt<0?Z-tt:Z,gn.u=Us(L.amount||L.each)||0,I=I&&tt<0?qc(I):I}return tt=(gn[ut]-gn.min)/gn.max||0,Kt(gn.b+(I?I(tt):tt)*gn.v)+gn.u}},Hp=function(S){var L=Math.pow(10,((S+"").split(".")[1]||"").length);return function(I){var B=Math.round(parseFloat(I)/S)*S*L;return(B-B%1)/L+(W(I)?0:Us(I))}},Hg=function(S,L){var I=dt(S),B,Z;return!I&&Re(S)&&(B=I=S.radius||A,S.values?(S=la(S.values),(Z=!W(S[0]))&&(B*=B)):S=Hp(S.increment)),oa(L,I?j(S)?function($){return Z=S($),Math.abs(Z-$)<=B?Z:$}:function($){for(var ee=parseFloat(Z?$.x:$),we=parseFloat(Z?$.y:0),Ie=A,Ae=0,Et=S.length,ut,qe;Et--;)Z?(ut=S[Et].x-ee,qe=S[Et].y-we,ut=ut*ut+qe*qe):ut=Math.abs(S[Et]-ee),ut<Ie&&(Ie=ut,Ae=Et);return Ae=!B||Ie<=B?S[Ae]:$,Z||Ae===$||W($)?Ae:Ae+Us($)}:Hp(S))},Gg=function(S,L,I,B){return oa(dt(S)?!L:I===!0?!!(I=0):!B,function(){return dt(S)?S[~~(Math.random()*S.length)]:(I=I||1e-5)&&(B=I<1?Math.pow(10,(I+"").length-2):1)&&Math.floor(Math.round((S-I/2+Math.random()*(L-S+I*.99))/I)*I*B)/B})},k0=function(){for(var S=arguments.length,L=new Array(S),I=0;I<S;I++)L[I]=arguments[I];return function(B){return L.reduce(function(Z,$){return $(Z)},B)}},z0=function(S,L){return function(I){return S(parseFloat(I))+(L||Us(I))}},U0=function(S,L,I){return Wg(S,L,0,1,I)},Vg=function(S,L,I){return oa(I,function(B){return S[~~L(B)]})},H0=function xe(S,L,I){var B=L-S;return dt(S)?Vg(S,xe(0,S.length),L):oa(I,function(Z){return(B+(Z-S)%B)%B+S})},G0=function xe(S,L,I){var B=L-S,Z=B*2;return dt(S)?Vg(S,xe(0,S.length-1),L):oa(I,function($){return $=(Z+($-S)%Z)%Z||0,S+($>B?Z-$:$)})},Uh=function(S){for(var L=0,I="",B,Z,$,ee;~(B=S.indexOf("random(",L));)$=S.indexOf(")",B),ee=S.charAt(B+7)==="[",Z=S.substr(B+7,$-B-7).match(ee?Ve:an),I+=S.substr(L,B-L)+Gg(ee?Z:+Z[0],ee?0:+Z[1],+Z[2]||1e-5),L=$+1;return I+S.substr(L,S.length-L)},Wg=function(S,L,I,B,Z){var $=L-S,ee=B-I;return oa(Z,function(we){return I+((we-S)/$*ee||0)})},V0=function xe(S,L,I,B){var Z=isNaN(S+L)?0:function(qe){return(1-qe)*S+qe*L};if(!Z){var $=te(S),ee={},we,Ie,Ae,Et,ut;if(I===!0&&(B=1)&&(I=null),$)S={p:S},L={p:L};else if(dt(S)&&!dt(L)){for(Ae=[],Et=S.length,ut=Et-2,Ie=1;Ie<Et;Ie++)Ae.push(xe(S[Ie-1],S[Ie]));Et--,Z=function(mn){mn*=Et;var tt=Math.min(ut,~~mn);return Ae[tt](mn-tt)},I=L}else B||(S=er(dt(S)?[]:{},S));if(!Ae){for(we in L)sd.call(ee,S,we,"get",L[we]);Z=function(mn){return Li(mn,ee)||($?S.p:S)}}}return oa(I,Z)},Xg=function(S,L,I){var B=S.labels,Z=A,$,ee,we;for($ in B)ee=B[$]-L,ee<0==!!I&&ee&&Z>(ee=Math.abs(ee))&&(we=$,Z=ee);return we},wo=function(S,L,I){var B=S.vars,Z=B[L],$,ee;if(!!Z)return $=B[L+"Params"],ee=B.callbackScope||S,I&&Ye.length&&xn(),$?Z.apply(ee,$):Z.call(ee)},Hh=function(S){return Ds(S),S.scrollTrigger&&S.scrollTrigger.kill(!1),S.progress()<1&&wo(S,"onInterrupt"),S},Bu,W0=function(S){S=!S.name&&S.default||S;var L=S.name,I=j(S),B=L&&!I&&S.init?function(){this._props=[]}:S,Z={init:Le,render:Li,add:sd,kill:bn,modifier:Xh,rawVars:0},$={targetTest:0,get:0,getSetter:Wh,aliases:{},register:0};if(ku(),S!==B){if(Je[L])return;hn(B,hn(wa(S,Z),$)),er(B.prototype,er(Z,wa(S,$))),Je[B.prop=L]=B,S.targetTest&&(Mt.push(B),Be[L]=1),L=(L==="css"?"CSS":L.charAt(0).toUpperCase()+L.substr(1))+"Plugin"}me(L,B),S.register&&S.register(ko,B,na)},fs=255,Gh={aqua:[0,fs,fs],lime:[0,fs,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,fs],navy:[0,0,128],white:[fs,fs,fs],olive:[128,128,0],yellow:[fs,fs,0],orange:[fs,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[fs,0,0],pink:[fs,192,203],cyan:[0,fs,fs],transparent:[fs,fs,fs,0]},Gp=function(S,L,I){return S=S<0?S+1:S>1?S-1:S,(S*6<1?L+(I-L)*S*6:S<.5?I:S*3<2?L+(I-L)*(2/3-S)*6:L)*fs+.5|0},qg=function(S,L,I){var B=S?W(S)?[S>>16,S>>8&fs,S&fs]:0:Gh.black,Z,$,ee,we,Ie,Ae,Et,ut,qe,mn;if(!B){if(S.substr(-1)===","&&(S=S.substr(0,S.length-1)),Gh[S])B=Gh[S];else if(S.charAt(0)==="#"){if(S.length<6&&(Z=S.charAt(1),$=S.charAt(2),ee=S.charAt(3),S="#"+Z+Z+$+$+ee+ee+(S.length===5?S.charAt(4)+S.charAt(4):"")),S.length===9)return B=parseInt(S.substr(1,6),16),[B>>16,B>>8&fs,B&fs,parseInt(S.substr(7),16)/255];S=parseInt(S.substr(1),16),B=[S>>16,S>>8&fs,S&fs]}else if(S.substr(0,3)==="hsl"){if(B=mn=S.match(an),!L)we=+B[0]%360/360,Ie=+B[1]/100,Ae=+B[2]/100,$=Ae<=.5?Ae*(Ie+1):Ae+Ie-Ae*Ie,Z=Ae*2-$,B.length>3&&(B[3]*=1),B[0]=Gp(we+1/3,Z,$),B[1]=Gp(we,Z,$),B[2]=Gp(we-1/3,Z,$);else if(~S.indexOf("="))return B=S.match(_t),I&&B.length<4&&(B[3]=1),B}else B=S.match(an)||Gh.transparent;B=B.map(Number)}return L&&!mn&&(Z=B[0]/fs,$=B[1]/fs,ee=B[2]/fs,Et=Math.max(Z,$,ee),ut=Math.min(Z,$,ee),Ae=(Et+ut)/2,Et===ut?we=Ie=0:(qe=Et-ut,Ie=Ae>.5?qe/(2-Et-ut):qe/(Et+ut),we=Et===Z?($-ee)/qe+($<ee?6:0):Et===$?(ee-Z)/qe+2:(Z-$)/qe+4,we*=60),B[0]=~~(we+.5),B[1]=~~(Ie*100+.5),B[2]=~~(Ae*100+.5)),I&&B.length<4&&(B[3]=1),B},jg=function(S){var L=[],I=[],B=-1;return S.split(rc).forEach(function(Z){var $=Z.match(et)||[];L.push.apply(L,$),I.push(B+=$.length+1)}),L.c=I,L},Yg=function(S,L,I){var B="",Z=(S+B).match(rc),$=L?"hsla(":"rgba(",ee=0,we,Ie,Ae,Et;if(!Z)return S;if(Z=Z.map(function(ut){return(ut=qg(ut,L,1))&&$+(L?ut[0]+","+ut[1]+"%,"+ut[2]+"%,"+ut[3]:ut.join(","))+")"}),I&&(Ae=jg(S),we=I.c,we.join(B)!==Ae.c.join(B)))for(Ie=S.replace(rc,"1").split(et),Et=Ie.length-1;ee<Et;ee++)B+=Ie[ee]+(~we.indexOf(ee)?Z.shift()||$+"0,0,0,0)":(Ae.length?Ae:Z.length?Z:I).shift());if(!Ie)for(Ie=S.split(rc),Et=Ie.length-1;ee<Et;ee++)B+=Ie[ee]+Z[ee];return B+Ie[Et]},rc=function(){var xe="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",S;for(S in Gh)xe+="|"+S+"\\b";return new RegExp(xe+")","gi")}(),X0=/hsl[a]?\(/,Zg=function(S){var L=S.join(" "),I;if(rc.lastIndex=0,rc.test(L))return I=X0.test(L),S[1]=Yg(S[1],I),S[0]=Yg(S[0],I,jg(S[1])),!0},td,Mo=function(){var xe=Date.now,S=500,L=33,I=xe(),B=I,Z=1e3/240,$=Z,ee=[],we,Ie,Ae,Et,ut,qe,mn=function tt(gn){var Mn=xe()-B,ii=gn===!0,Zn,gi,Yn,Jn;if(Mn>S&&(I+=Mn-L),B+=Mn,Yn=B-I,Zn=Yn-$,(Zn>0||ii)&&(Jn=++Et.frame,ut=Yn-Et.time*1e3,Et.time=Yn=Yn/1e3,$+=Zn+(Zn>=Z?4:Z-Zn),gi=1),ii||(we=Ie(tt)),gi)for(qe=0;qe<ee.length;qe++)ee[qe](Yn,ut,Jn,gn)};return Et={time:0,frame:0,tick:function(){mn(!0)},deltaRatio:function(gn){return ut/(1e3/(gn||60))},wake:function(){vi&&(!An&&de()&&(Wt=An=window,Vt=Wt.document||{},Dn.gsap=ko,(Wt.gsapVersions||(Wt.gsapVersions=[])).push(ko.version),he(Ci||Wt.GreenSockGlobals||!Wt.gsap&&Wt||{}),Ae=Wt.requestAnimationFrame),we&&Et.sleep(),Ie=Ae||function(gn){return setTimeout(gn,$-Et.time*1e3+1|0)},td=1,mn(2))},sleep:function(){(Ae?Wt.cancelAnimationFrame:clearTimeout)(we),td=0,Ie=Le},lagSmoothing:function(gn,Mn){S=gn||1/C,L=Math.min(Mn,S,0)},fps:function(gn){Z=1e3/(gn||240),$=Et.time*1e3+Z},add:function(gn){ee.indexOf(gn)<0&&ee.push(gn),ku()},remove:function(gn){var Mn;~(Mn=ee.indexOf(gn))&&ee.splice(Mn,1)&&qe>=Mn&&qe--},_listeners:ee},Et}(),ku=function(){return!td&&Mo.wake()},kr={},q0=/^[\d.\-M][\d.\-,\s]/,nd=/["']/g,id=function(S){for(var L={},I=S.substr(1,S.length-3).split(":"),B=I[0],Z=1,$=I.length,ee,we,Ie;Z<$;Z++)we=I[Z],ee=Z!==$-1?we.lastIndexOf(","):we.length,Ie=we.substr(0,ee),L[B]=isNaN(Ie)?Ie.replace(nd,"").trim():+Ie,B=we.substr(ee+1).trim();return L},Vp=function(S){var L=S.indexOf("(")+1,I=S.indexOf(")"),B=S.indexOf("(",L);return S.substring(L,~B&&B<I?S.indexOf(")",I+1):I)},zu=function(S){var L=(S+"").split("("),I=kr[L[0]];return I&&L.length>1&&I.config?I.config.apply(null,~S.indexOf("{")?[id(L[1])]:Vp(S).split(",").map(Ht)):kr._CE&&q0.test(S)?kr._CE("",S):I},qc=function(S){return function(L){return 1-S(1-L)}},Vh=function xe(S,L){for(var I=S._first,B;I;)I instanceof Oa?xe(I,L):I.vars.yoyoEase&&(!I._yoyo||!I._repeat)&&I._yoyo!==L&&(I.timeline?xe(I.timeline,L):(B=I._ease,I._ease=I._yEase,I._yEase=B,I._yoyo=L)),I=I._next},sc=function(S,L){return S&&(j(S)?S:kr[S]||zu(S))||L},ac=function(S,L,I,B){I===void 0&&(I=function(we){return 1-L(1-we)}),B===void 0&&(B=function(we){return we<.5?L(we*2)/2:1-L((1-we)*2)/2});var Z={easeIn:L,easeOut:I,easeInOut:B},$;return Ce(S,function(ee){kr[ee]=Dn[ee]=Z,kr[$=ee.toLowerCase()]=I;for(var we in Z)kr[$+(we==="easeIn"?".in":we==="easeOut"?".out":".inOut")]=kr[ee+"."+we]=Z[we]}),Z},Jg=function(S){return function(L){return L<.5?(1-S(1-L*2))/2:.5+S((L-.5)*2)/2}},Da=function xe(S,L,I){var B=L>=1?L:1,Z=(I||(S?.3:.45))/(L<1?L:1),$=Z/F*(Math.asin(1/B)||0),ee=function(Ae){return Ae===1?1:B*Math.pow(2,-10*Ae)*ne((Ae-$)*Z)+1},we=S==="out"?ee:S==="in"?function(Ie){return 1-ee(1-Ie)}:Jg(ee);return Z=F/Z,we.config=function(Ie,Ae){return xe(S,Ie,Ae)},we},Uu=function xe(S,L){L===void 0&&(L=1.70158);var I=function($){return $?--$*$*((L+1)*$+L)+1:0},B=S==="out"?I:S==="in"?function(Z){return 1-I(1-Z)}:Jg(I);return B.config=function(Z){return xe(S,Z)},B};Ce("Linear,Quad,Cubic,Quart,Quint,Strong",function(xe,S){var L=S<5?S+1:S;ac(xe+",Power"+(L-1),S?function(I){return Math.pow(I,L)}:function(I){return I},function(I){return 1-Math.pow(1-I,L)},function(I){return I<.5?Math.pow(I*2,L)/2:1-Math.pow((1-I)*2,L)/2})}),kr.Linear.easeNone=kr.none=kr.Linear.easeIn,ac("Elastic",Da("in"),Da("out"),Da()),function(xe,S){var L=1/S,I=2*L,B=2.5*L,Z=function(ee){return ee<L?xe*ee*ee:ee<I?xe*Math.pow(ee-1.5/S,2)+.75:ee<B?xe*(ee-=2.25/S)*ee+.9375:xe*Math.pow(ee-2.625/S,2)+.984375};ac("Bounce",function($){return 1-Z(1-$)},Z)}(7.5625,2.75),ac("Expo",function(xe){return xe?Math.pow(2,10*(xe-1)):0}),ac("Circ",function(xe){return-(N(1-xe*xe)-1)}),ac("Sine",function(xe){return xe===1?1:-X(xe*O)+1}),ac("Back",Uu("in"),Uu("out"),Uu()),kr.SteppedEase=kr.steps=Dn.SteppedEase={config:function(S,L){S===void 0&&(S=1);var I=1/S,B=S+(L?0:1),Z=L?1:0,$=1-C;return function(ee){return((B*Wr(0,$,ee)|0)+Z)*I}}},b.ease=kr["quad.out"],Ce("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(xe){return ue+=xe+","+xe+"Params,"});var rd=function(S,L){this.id=k++,S._gsap=this,this.target=S,this.harness=L,this.get=L?L.get:yt,this.set=L?L.getSetter:Wh},jc=function(){function xe(L){this.vars=L,this._delay=+L.delay||0,(this._repeat=L.repeat===1/0?-2:L.repeat||0)&&(this._rDelay=L.repeatDelay||0,this._yoyo=!!L.yoyo||!!L.yoyoEase),this._ts=1,tr(this,+L.duration,1,1),this.data=L.data,td||Mo.wake()}var S=xe.prototype;return S.delay=function(I){return I||I===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+I-this._delay),this._delay=I,this):this._delay},S.duration=function(I){return arguments.length?this.totalDuration(this._repeat>0?I+(I+this._rDelay)*this._repeat:I):this.totalDuration()&&this._dur},S.totalDuration=function(I){return arguments.length?(this._dirty=0,tr(this,this._repeat<0?I:(I-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},S.totalTime=function(I,B){if(ku(),!arguments.length)return this._tTime;var Z=this._dp;if(Z&&Z.smoothChildTiming&&this._ts){for(nl(this,I),!Z._dp||Z.parent||ye(Z,this);Z&&Z.parent;)Z.parent._time!==Z._start+(Z._ts>=0?Z._tTime/Z._ts:(Z.totalDuration()-Z._tTime)/-Z._ts)&&Z.totalTime(Z._tTime,!0),Z=Z.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&I<this._tDur||this._ts<0&&I>0||!this._tDur&&!I)&&Dt(this._dp,this,this._start-this._delay)}return(this._tTime!==I||!this._dur&&!B||this._initted&&Math.abs(this._zTime)===C||!I&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=I),Oe(this,I,B)),this},S.time=function(I,B){return arguments.length?this.totalTime(Math.min(this.totalDuration(),I+El(this))%(this._dur+this._rDelay)||(I?this._dur:0),B):this._time},S.totalProgress=function(I,B){return arguments.length?this.totalTime(this.totalDuration()*I,B):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},S.progress=function(I,B){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-I:I)+El(this),B):this.duration()?Math.min(1,this._time/this._dur):this.ratio},S.iteration=function(I,B){var Z=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(I-1)*Z,B):this._repeat?ta(this._tTime,Z)+1:1},S.timeScale=function(I){if(!arguments.length)return this._rts===-C?0:this._rts;if(this._rts===I)return this;var B=this.parent&&this._ts?io(this.parent._time,this):this._tTime;return this._rts=+I||0,this._ts=this._ps||I===-C?0:this._rts,tl(this.totalTime(Wr(-this._delay,this._tDur,B),!0)),bo(this),this},S.paused=function(I){return arguments.length?(this._ps!==I&&(this._ps=I,I?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(ku(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==C&&(this._tTime-=C)))),this):this._ps},S.startTime=function(I){if(arguments.length){this._start=I;var B=this.parent||this._dp;return B&&(B._sort||!this.parent)&&Dt(B,this,I-this._delay),this}return this._start},S.endTime=function(I){return this._start+(Ne(I)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},S.rawTime=function(I){var B=this.parent||this._dp;return B?I&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?io(B.rawTime(I),this):this._tTime:this._tTime},S.globalTime=function(I){for(var B=this,Z=arguments.length?I:B.rawTime();B;)Z=B._start+Z/(B._ts||1),B=B._dp;return Z},S.repeat=function(I){return arguments.length?(this._repeat=I===1/0?-2:I,Os(this)):this._repeat===-2?1/0:this._repeat},S.repeatDelay=function(I){if(arguments.length){var B=this._time;return this._rDelay=I,Os(this),B?this.time(B):this}return this._rDelay},S.yoyo=function(I){return arguments.length?(this._yoyo=I,this):this._yoyo},S.seek=function(I,B){return this.totalTime(Ii(this,I),Ne(B))},S.restart=function(I,B){return this.play().totalTime(I?-this._delay:0,Ne(B))},S.play=function(I,B){return I!=null&&this.seek(I,B),this.reversed(!1).paused(!1)},S.reverse=function(I,B){return I!=null&&this.seek(I||this.totalDuration(),B),this.reversed(!0).paused(!1)},S.pause=function(I,B){return I!=null&&this.seek(I,B),this.paused(!0)},S.resume=function(){return this.paused(!1)},S.reversed=function(I){return arguments.length?(!!I!==this.reversed()&&this.timeScale(-this._rts||(I?-C:0)),this):this._rts<0},S.invalidate=function(){return this._initted=this._act=0,this._zTime=-C,this},S.isActive=function(){var I=this.parent||this._dp,B=this._start,Z;return!!(!I||this._ts&&this._initted&&I.isActive()&&(Z=I.rawTime(!0))>=B&&Z<this.endTime(!0)-C)},S.eventCallback=function(I,B,Z){var $=this.vars;return arguments.length>1?(B?($[I]=B,Z&&($[I+"Params"]=Z),I==="onUpdate"&&(this._onUpdate=B)):delete $[I],this):$[I]},S.then=function(I){var B=this;return new Promise(function(Z){var $=j(I)?I:Kn,ee=function(){var Ie=B.then;B.then=null,j($)&&($=$(B))&&($.then||$===B)&&(B.then=Ie),Z($),B.then=Ie};B._initted&&B.totalProgress()===1&&B._ts>=0||!B._tTime&&B._ts<0?ee():B._prom=ee})},S.kill=function(){Hh(this)},xe}();hn(jc.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-C,_prom:0,_ps:!1,_rts:1});var Oa=function(xe){u(S,xe);function S(I,B){var Z;return I===void 0&&(I={}),Z=xe.call(this,I)||this,Z.labels={},Z.smoothChildTiming=!!I.smoothChildTiming,Z.autoRemoveChildren=!!I.autoRemoveChildren,Z._sort=Ne(I.sortChildren),ft&&Dt(I.parent||ft,p(Z),B),I.reversed&&Z.reverse(),I.paused&&Z.paused(!0),I.scrollTrigger&&Rt(p(Z),I.scrollTrigger),Z}var L=S.prototype;return L.to=function(B,Z,$){return Vr(0,arguments,this),this},L.from=function(B,Z,$){return Vr(1,arguments,this),this},L.fromTo=function(B,Z,$,ee){return Vr(2,arguments,this),this},L.set=function(B,Z,$){return Z.duration=0,Z.parent=this,zs(Z).repeatDelay||(Z.repeat=0),Z.immediateRender=!!Z.immediateRender,new Ts(B,Z,Ii(this,$),1),this},L.call=function(B,Z,$){return Dt(this,Ts.delayedCall(0,B,Z),$)},L.staggerTo=function(B,Z,$,ee,we,Ie,Ae){return $.duration=Z,$.stagger=$.stagger||ee,$.onComplete=Ie,$.onCompleteParams=Ae,$.parent=this,new Ts(B,$,Ii(this,we)),this},L.staggerFrom=function(B,Z,$,ee,we,Ie,Ae){return $.runBackwards=1,zs($).immediateRender=Ne($.immediateRender),this.staggerTo(B,Z,$,ee,we,Ie,Ae)},L.staggerFromTo=function(B,Z,$,ee,we,Ie,Ae,Et){return ee.startAt=$,zs(ee).immediateRender=Ne(ee.immediateRender),this.staggerTo(B,Z,ee,we,Ie,Ae,Et)},L.render=function(B,Z,$){var ee=this._time,we=this._dirty?this.totalDuration():this._tDur,Ie=this._dur,Ae=B<=0?0:Kt(B),Et=this._zTime<0!=B<0&&(this._initted||!Ie),ut,qe,mn,tt,gn,Mn,ii,Zn,gi,Yn,Jn,hi;if(this!==ft&&Ae>we&&B>=0&&(Ae=we),Ae!==this._tTime||$||Et){if(ee!==this._time&&Ie&&(Ae+=this._time-ee,B+=this._time-ee),ut=Ae,gi=this._start,Zn=this._ts,Mn=!Zn,Et&&(Ie||(ee=this._zTime),(B||!Z)&&(this._zTime=B)),this._repeat){if(Jn=this._yoyo,gn=Ie+this._rDelay,this._repeat<-1&&B<0)return this.totalTime(gn*100+B,Z,$);if(ut=Kt(Ae%gn),Ae===we?(tt=this._repeat,ut=Ie):(tt=~~(Ae/gn),tt&&tt===Ae/gn&&(ut=Ie,tt--),ut>Ie&&(ut=Ie)),Yn=ta(this._tTime,gn),!ee&&this._tTime&&Yn!==tt&&(Yn=tt),Jn&&tt&1&&(ut=Ie-ut,hi=1),tt!==Yn&&!this._lock){var xi=Jn&&Yn&1,si=xi===(Jn&&tt&1);if(tt<Yn&&(xi=!xi),ee=xi?0:Ie,this._lock=1,this.render(ee||(hi?0:Kt(tt*gn)),Z,!Ie)._lock=0,this._tTime=Ae,!Z&&this.parent&&wo(this,"onRepeat"),this.vars.repeatRefresh&&!hi&&(this.invalidate()._lock=1),ee&&ee!==this._time||Mn!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(Ie=this._dur,we=this._tDur,si&&(this._lock=2,ee=xi?Ie:-1e-4,this.render(ee,!0),this.vars.repeatRefresh&&!hi&&this.invalidate()),this._lock=0,!this._ts&&!Mn)return this;Vh(this,hi)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(ii=Mr(this,Kt(ee),Kt(ut)),ii&&(Ae-=ut-(ut=ii._start))),this._tTime=Ae,this._time=ut,this._act=!Zn,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=B,ee=0),!ee&&ut&&!Z&&(wo(this,"onStart"),this._tTime!==Ae))return this;if(ut>=ee&&B>=0)for(qe=this._first;qe;){if(mn=qe._next,(qe._act||ut>=qe._start)&&qe._ts&&ii!==qe){if(qe.parent!==this)return this.render(B,Z,$);if(qe.render(qe._ts>0?(ut-qe._start)*qe._ts:(qe._dirty?qe.totalDuration():qe._tDur)+(ut-qe._start)*qe._ts,Z,$),ut!==this._time||!this._ts&&!Mn){ii=0,mn&&(Ae+=this._zTime=-C);break}}qe=mn}else{qe=this._last;for(var Cr=B<0?B:ut;qe;){if(mn=qe._prev,(qe._act||Cr<=qe._end)&&qe._ts&&ii!==qe){if(qe.parent!==this)return this.render(B,Z,$);if(qe.render(qe._ts>0?(Cr-qe._start)*qe._ts:(qe._dirty?qe.totalDuration():qe._tDur)+(Cr-qe._start)*qe._ts,Z,$),ut!==this._time||!this._ts&&!Mn){ii=0,mn&&(Ae+=this._zTime=Cr?-C:C);break}}qe=mn}}if(ii&&!Z&&(this.pause(),ii.render(ut>=ee?0:-C)._zTime=ut>=ee?1:-1,this._ts))return this._start=gi,bo(this),this.render(B,Z,$);this._onUpdate&&!Z&&wo(this,"onUpdate",!0),(Ae===we&&we>=this.totalDuration()||!Ae&&ee)&&(gi===this._start||Math.abs(Zn)!==Math.abs(this._ts))&&(this._lock||((B||!Ie)&&(Ae===we&&this._ts>0||!Ae&&this._ts<0)&&Ds(this,1),!Z&&!(B<0&&!ee)&&(Ae||ee||!we)&&(wo(this,Ae===we&&B>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(Ae<we&&this.timeScale()>0)&&this._prom())))}return this},L.add=function(B,Z){var $=this;if(W(Z)||(Z=Ii(this,Z,B)),!(B instanceof jc)){if(dt(B))return B.forEach(function(ee){return $.add(ee,Z)}),this;if(te(B))return this.addLabel(B,Z);if(j(B))B=Ts.delayedCall(0,B);else return this}return this!==B?Dt(this,B,Z):this},L.getChildren=function(B,Z,$,ee){B===void 0&&(B=!0),Z===void 0&&(Z=!0),$===void 0&&($=!0),ee===void 0&&(ee=-A);for(var we=[],Ie=this._first;Ie;)Ie._start>=ee&&(Ie instanceof Ts?Z&&we.push(Ie):($&&we.push(Ie),B&&we.push.apply(we,Ie.getChildren(!0,Z,$)))),Ie=Ie._next;return we},L.getById=function(B){for(var Z=this.getChildren(1,1,1),$=Z.length;$--;)if(Z[$].vars.id===B)return Z[$]},L.remove=function(B){return te(B)?this.removeLabel(B):j(B)?this.killTweensOf(B):(to(this,B),B===this._recent&&(this._recent=this._last),xs(this))},L.totalTime=function(B,Z){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=Kt(Mo.time-(this._ts>0?B/this._ts:(this.totalDuration()-B)/-this._ts))),xe.prototype.totalTime.call(this,B,Z),this._forcing=0,this):this._tTime},L.addLabel=function(B,Z){return this.labels[B]=Ii(this,Z),this},L.removeLabel=function(B){return delete this.labels[B],this},L.addPause=function(B,Z,$){var ee=Ts.delayedCall(0,Z||Le,$);return ee.data="isPause",this._hasPause=1,Dt(this,ee,Ii(this,B))},L.removePause=function(B){var Z=this._first;for(B=Ii(this,B);Z;)Z._start===B&&Z.data==="isPause"&&Ds(Z),Z=Z._next},L.killTweensOf=function(B,Z,$){for(var ee=this.getTweensOf(B,$),we=ee.length;we--;)oc!==ee[we]&&ee[we].kill(B,Z);return this},L.getTweensOf=function(B,Z){for(var $=[],ee=la(B),we=this._first,Ie=W(Z),Ae;we;)we instanceof Ts?qn(we._targets,ee)&&(Ie?(!oc||we._initted&&we._ts)&&we.globalTime(0)<=Z&&we.globalTime(we.totalDuration())>Z:!Z||we.isActive())&&$.push(we):(Ae=we.getTweensOf(ee,Z)).length&&$.push.apply($,Ae),we=we._next;return $},L.tweenTo=function(B,Z){Z=Z||{};var $=this,ee=Ii($,B),we=Z,Ie=we.startAt,Ae=we.onStart,Et=we.onStartParams,ut=we.immediateRender,qe,mn=Ts.to($,hn({ease:Z.ease||"none",lazy:!1,immediateRender:!1,time:ee,overwrite:"auto",duration:Z.duration||Math.abs((ee-(Ie&&"time"in Ie?Ie.time:$._time))/$.timeScale())||C,onStart:function(){if($.pause(),!qe){var gn=Z.duration||Math.abs((ee-(Ie&&"time"in Ie?Ie.time:$._time))/$.timeScale());mn._dur!==gn&&tr(mn,gn,0,1).render(mn._time,!0,!0),qe=1}Ae&&Ae.apply(mn,Et||[])}},Z));return ut?mn.render(0):mn},L.tweenFromTo=function(B,Z,$){return this.tweenTo(Z,hn({startAt:{time:Ii(this,B)}},$))},L.recent=function(){return this._recent},L.nextLabel=function(B){return B===void 0&&(B=this._time),Xg(this,Ii(this,B))},L.previousLabel=function(B){return B===void 0&&(B=this._time),Xg(this,Ii(this,B),1)},L.currentLabel=function(B){return arguments.length?this.seek(B,!0):this.previousLabel(this._time+C)},L.shiftChildren=function(B,Z,$){$===void 0&&($=0);for(var ee=this._first,we=this.labels,Ie;ee;)ee._start>=$&&(ee._start+=B,ee._end+=B),ee=ee._next;if(Z)for(Ie in we)we[Ie]>=$&&(we[Ie]+=B);return xs(this)},L.invalidate=function(){var B=this._first;for(this._lock=0;B;)B.invalidate(),B=B._next;return xe.prototype.invalidate.call(this)},L.clear=function(B){B===void 0&&(B=!0);for(var Z=this._first,$;Z;)$=Z._next,this.remove(Z),Z=$;return this._dp&&(this._time=this._tTime=this._pTime=0),B&&(this.labels={}),xs(this)},L.totalDuration=function(B){var Z=0,$=this,ee=$._last,we=A,Ie,Ae,Et;if(arguments.length)return $.timeScale(($._repeat<0?$.duration():$.totalDuration())/($.reversed()?-B:B));if($._dirty){for(Et=$.parent;ee;)Ie=ee._prev,ee._dirty&&ee.totalDuration(),Ae=ee._start,Ae>we&&$._sort&&ee._ts&&!$._lock?($._lock=1,Dt($,ee,Ae-ee._delay,1)._lock=0):we=Ae,Ae<0&&ee._ts&&(Z-=Ae,(!Et&&!$._dp||Et&&Et.smoothChildTiming)&&($._start+=Ae/$._ts,$._time-=Ae,$._tTime-=Ae),$.shiftChildren(-Ae,!1,-1/0),we=0),ee._end>Z&&ee._ts&&(Z=ee._end),ee=Ie;tr($,$===ft&&$._time>Z?$._time:Z,1,1),$._dirty=0}return $._tDur},S.updateRoot=function(B){if(ft._ts&&(Oe(ft,io(B,ft)),He=Mo.frame),Mo.frame>=bt){bt+=g.autoSleep||120;var Z=ft._first;if((!Z||!Z._ts)&&g.autoSleep&&Mo._listeners.length<2){for(;Z&&!Z._ts;)Z=Z._next;Z||Mo.sleep()}}},S}(jc);hn(Oa.prototype,{_lock:0,_hasPause:0,_forcing:0});var $g=function(S,L,I,B,Z,$,ee){var we=new na(this._pt,S,L,0,1,cd,null,Z),Ie=0,Ae=0,Et,ut,qe,mn,tt,gn,Mn,ii;for(we.b=I,we.e=B,I+="",B+="",(Mn=~B.indexOf("random("))&&(B=Uh(B)),$&&(ii=[I,B],$(ii,S,L),I=ii[0],B=ii[1]),ut=I.match(rt)||[];Et=rt.exec(B);)mn=Et[0],tt=B.substring(Ie,Et.index),qe?qe=(qe+1)%5:tt.substr(-5)==="rgba("&&(qe=1),mn!==ut[Ae++]&&(gn=parseFloat(ut[Ae-1])||0,we._pt={_next:we._pt,p:tt||Ae===1?tt:",",s:gn,c:mn.charAt(1)==="="?parseFloat(mn.substr(2))*(mn.charAt(0)==="-"?-1:1):parseFloat(mn)-gn,m:qe&&qe<4?Math.round:0},Ie=rt.lastIndex);return we.c=Ie<B.length?B.substring(Ie,B.length):"",we.fp=ee,(je.test(B)||Mn)&&(we.e=0),this._pt=we,we},sd=function(S,L,I,B,Z,$,ee,we,Ie){j(B)&&(B=B(Z||0,S,$));var Ae=S[L],Et=I!=="get"?I:j(Ae)?Ie?S[L.indexOf("set")||!j(S["get"+L.substr(3)])?L:"get"+L.substr(3)](Ie):S[L]():Ae,ut=j(Ae)?Ie?Ia:il:od,qe;if(te(B)&&(~B.indexOf("random(")&&(B=Uh(B)),B.charAt(1)==="="&&(qe=parseFloat(Et)+parseFloat(B.substr(2))*(B.charAt(0)==="-"?-1:1)+(Us(Et)||0),(qe||qe===0)&&(B=qe))),Et!==B)return!isNaN(Et*B)&&B!==""?(qe=new na(this._pt,S,L,+Et||0,B-(Et||0),typeof Ae=="boolean"?Y0:nr,0,ut),Ie&&(qe.fp=Ie),ee&&qe.modifier(ee,this,S),this._pt=qe):(!Ae&&!(L in S)&&K(L,B),$g.call(this,S,L,Et,B,ut,we||g.stringFilter,Ie))},Kg=function(S,L,I,B,Z){if(j(S)&&(S=Yc(S,Z,L,I,B)),!Re(S)||S.style&&S.nodeType||dt(S)||Gt(S))return te(S)?Yc(S,Z,L,I,B):S;var $={},ee;for(ee in S)$[ee]=Yc(S[ee],Z,L,I,B);return $},Qg=function(S,L,I,B,Z,$){var ee,we,Ie,Ae;if(Je[S]&&(ee=new Je[S]).init(Z,ee.rawVars?L[S]:Kg(L[S],B,Z,$,I),I,B,$)!==!1&&(I._pt=we=new na(I._pt,Z,S,0,1,ee.render,ee,0,ee.priority),I!==Bu))for(Ie=I._ptLookup[I._targets.indexOf(Z)],Ae=ee._props.length;Ae--;)Ie[ee._props[Ae]]=we;return ee},oc,Hu=function xe(S,L){var I=S.vars,B=I.ease,Z=I.startAt,$=I.immediateRender,ee=I.lazy,we=I.onUpdate,Ie=I.onUpdateParams,Ae=I.callbackScope,Et=I.runBackwards,ut=I.yoyoEase,qe=I.keyframes,mn=I.autoRevert,tt=S._dur,gn=S._startAt,Mn=S._targets,ii=S.parent,Zn=ii&&ii.data==="nested"?ii.parent._targets:Mn,gi=S._overwrite==="auto"&&!M,Yn=S.timeline,Jn,hi,xi,si,Cr,ls,Ns,ra,Hs,xr,Ea,Ya,ol;if(Yn&&(!qe||!B)&&(B="none"),S._ease=sc(B,b.ease),S._yEase=ut?qc(sc(ut===!0?B:ut,b.ease)):0,ut&&S._yoyo&&!S._repeat&&(ut=S._yEase,S._yEase=S._ease,S._ease=ut),S._from=!Yn&&!!I.runBackwards,!Yn){if(ra=Mn[0]?lt(Mn[0]).harness:0,Ya=ra&&I[ra.prop],Jn=wa(I,Be),gn&&gn.render(-1,!0).kill(),Z)if(Ds(S._startAt=Ts.set(Mn,hn({data:"isStart",overwrite:!1,parent:ii,immediateRender:!0,lazy:Ne(ee),startAt:null,delay:0,onUpdate:we,onUpdateParams:Ie,callbackScope:Ae,stagger:0},Z))),L<0&&!$&&!mn&&S._startAt.render(-1,!0),$){if(L>0&&!mn&&(S._startAt=0),tt&&L<=0){L&&(S._zTime=L);return}}else mn===!1&&(S._startAt=0);else if(Et&&tt){if(gn)!mn&&(S._startAt=0);else if(L&&($=!1),xi=hn({overwrite:!1,data:"isFromStart",lazy:$&&Ne(ee),immediateRender:$,stagger:0,parent:ii},Jn),Ya&&(xi[ra.prop]=Ya),Ds(S._startAt=Ts.set(Mn,xi)),L<0&&S._startAt.render(-1,!0),!$)xe(S._startAt,C);else if(!L)return}for(S._pt=0,ee=tt&&Ne(ee)||ee&&!tt,hi=0;hi<Mn.length;hi++){if(Cr=Mn[hi],Ns=Cr._gsap||oe(Mn)[hi]._gsap,S._ptLookup[hi]=xr={},ke[Ns.id]&&Ye.length&&xn(),Ea=Zn===Mn?hi:Zn.indexOf(Cr),ra&&(Hs=new ra).init(Cr,Ya||Jn,S,Ea,Zn)!==!1&&(S._pt=si=new na(S._pt,Cr,Hs.name,0,1,Hs.render,Hs,0,Hs.priority),Hs._props.forEach(function(Ho){xr[Ho]=si}),Hs.priority&&(ls=1)),!ra||Ya)for(xi in Jn)Je[xi]&&(Hs=Qg(xi,Jn,S,Ea,Cr,Zn))?Hs.priority&&(ls=1):xr[xi]=si=sd.call(S,Cr,xi,"get",Jn[xi],Ea,Zn,0,I.stringFilter);S._op&&S._op[hi]&&S.kill(Cr,S._op[hi]),gi&&S._pt&&(oc=S,ft.killTweensOf(Cr,xr,S.globalTime(L)),ol=!S.parent,oc=0),S._pt&&ee&&(ke[Ns.id]=1)}ls&&Gu(S),S._onInit&&S._onInit(S)}S._onUpdate=we,S._initted=(!S._op||S._pt)&&!ol},j0=function(S,L){var I=S[0]?lt(S[0]).harness:0,B=I&&I.aliases,Z,$,ee,we;if(!B)return L;Z=er({},L);for($ in B)if($ in Z)for(we=B[$].split(","),ee=we.length;ee--;)Z[we[ee]]=Z[$];return Z},Yc=function(S,L,I,B,Z){return j(S)?S.call(L,I,B,Z):te(S)&&~S.indexOf("random(")?Uh(S):S},ev=ue+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase",ad=(ev+",id,stagger,delay,duration,paused,scrollTrigger").split(","),Ts=function(xe){u(S,xe);function S(I,B,Z,$){var ee;typeof B=="number"&&(Z.duration=B,B=Z,Z=null),ee=xe.call(this,$?B:zs(B))||this;var we=ee.vars,Ie=we.duration,Ae=we.delay,Et=we.immediateRender,ut=we.stagger,qe=we.overwrite,mn=we.keyframes,tt=we.defaults,gn=we.scrollTrigger,Mn=we.yoyoEase,ii=B.parent||ft,Zn=(dt(I)||Gt(I)?W(I[0]):"length"in B)?[I]:la(I),gi,Yn,Jn,hi,xi,si,Cr,ls;if(ee._targets=Zn.length?oe(Zn):Fe("GSAP target "+I+" not found. https://greensock.com",!g.nullTargetWarn)||[],ee._ptLookup=[],ee._overwrite=qe,mn||ut||$e(Ie)||$e(Ae)){if(B=ee.vars,gi=ee.timeline=new Oa({data:"nested",defaults:tt||{}}),gi.kill(),gi.parent=gi._dp=p(ee),gi._start=0,mn)zs(hn(gi.vars.defaults,{ease:"none"})),ut?Zn.forEach(function(Ns,ra){return mn.forEach(function(Hs,xr){return gi.to(Ns,Hs,xr?">":ra*ut)})}):mn.forEach(function(Ns){return gi.to(Zn,Ns,">")});else{if(hi=Zn.length,Cr=ut?Ug(ut):Le,Re(ut))for(xi in ut)~ev.indexOf(xi)&&(ls||(ls={}),ls[xi]=ut[xi]);for(Yn=0;Yn<hi;Yn++){Jn={};for(xi in B)ad.indexOf(xi)<0&&(Jn[xi]=B[xi]);Jn.stagger=0,Mn&&(Jn.yoyoEase=Mn),ls&&er(Jn,ls),si=Zn[Yn],Jn.duration=+Yc(Ie,p(ee),Yn,si,Zn),Jn.delay=(+Yc(Ae,p(ee),Yn,si,Zn)||0)-ee._delay,!ut&&hi===1&&Jn.delay&&(ee._delay=Ae=Jn.delay,ee._start+=Ae,Jn.delay=0),gi.to(si,Jn,Cr(Yn,si,Zn))}gi.duration()?Ie=Ae=0:ee.timeline=0}Ie||ee.duration(Ie=gi.duration())}else ee.timeline=0;return qe===!0&&!M&&(oc=p(ee),ft.killTweensOf(Zn),oc=0),Dt(ii,p(ee),Z),B.reversed&&ee.reverse(),B.paused&&ee.paused(!0),(Et||!Ie&&!mn&&ee._start===Kt(ii._time)&&Ne(Et)&&no(p(ee))&&ii.data!=="nested")&&(ee._tTime=-C,ee.render(Math.max(0,-Ae))),gn&&Rt(p(ee),gn),ee}var L=S.prototype;return L.render=function(B,Z,$){var ee=this._time,we=this._tDur,Ie=this._dur,Ae=B>we-C&&B>=0?we:B<C?0:B,Et,ut,qe,mn,tt,gn,Mn,ii,Zn;if(!Ie)dr(this,B,Z,$);else if(Ae!==this._tTime||!B||$||!this._initted&&this._tTime||this._startAt&&this._zTime<0!=B<0){if(Et=Ae,ii=this.timeline,this._repeat){if(mn=Ie+this._rDelay,this._repeat<-1&&B<0)return this.totalTime(mn*100+B,Z,$);if(Et=Kt(Ae%mn),Ae===we?(qe=this._repeat,Et=Ie):(qe=~~(Ae/mn),qe&&qe===Ae/mn&&(Et=Ie,qe--),Et>Ie&&(Et=Ie)),gn=this._yoyo&&qe&1,gn&&(Zn=this._yEase,Et=Ie-Et),tt=ta(this._tTime,mn),Et===ee&&!$&&this._initted)return this;qe!==tt&&(ii&&this._yEase&&Vh(ii,gn),this.vars.repeatRefresh&&!gn&&!this._lock&&(this._lock=$=1,this.render(Kt(mn*qe),!0).invalidate()._lock=0))}if(!this._initted){if(rn(this,B<0?B:Et,$,Z))return this._tTime=0,this;if(Ie!==this._dur)return this.render(B,Z,$)}if(this._tTime=Ae,this._time=Et,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=Mn=(Zn||this._ease)(Et/Ie),this._from&&(this.ratio=Mn=1-Mn),Et&&!ee&&!Z&&(wo(this,"onStart"),this._tTime!==Ae))return this;for(ut=this._pt;ut;)ut.r(Mn,ut.d),ut=ut._next;ii&&ii.render(B<0?B:!Et&&gn?-C:ii._dur*Mn,Z,$)||this._startAt&&(this._zTime=B),this._onUpdate&&!Z&&(B<0&&this._startAt&&this._startAt.render(B,!0,$),wo(this,"onUpdate")),this._repeat&&qe!==tt&&this.vars.onRepeat&&!Z&&this.parent&&wo(this,"onRepeat"),(Ae===this._tDur||!Ae)&&this._tTime===Ae&&(B<0&&this._startAt&&!this._onUpdate&&this._startAt.render(B,!0,!0),(B||!Ie)&&(Ae===this._tDur&&this._ts>0||!Ae&&this._ts<0)&&Ds(this,1),!Z&&!(B<0&&!ee)&&(Ae||ee)&&(wo(this,Ae===we?"onComplete":"onReverseComplete",!0),this._prom&&!(Ae<we&&this.timeScale()>0)&&this._prom()))}return this},L.targets=function(){return this._targets},L.invalidate=function(){return this._pt=this._op=this._startAt=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(),xe.prototype.invalidate.call(this)},L.kill=function(B,Z){if(Z===void 0&&(Z="all"),!B&&(!Z||Z==="all"))return this._lazy=this._pt=0,this.parent?Hh(this):this;if(this.timeline){var $=this.timeline.totalDuration();return this.timeline.killTweensOf(B,Z,oc&&oc.vars.overwrite!==!0)._first||Hh(this),this.parent&&$!==this.timeline.totalDuration()&&tr(this,this._dur*this.timeline._tDur/$,0,1),this}var ee=this._targets,we=B?la(B):ee,Ie=this._ptLookup,Ae=this._pt,Et,ut,qe,mn,tt,gn,Mn;if((!Z||Z==="all")&&Ra(ee,we))return Z==="all"&&(this._pt=0),Hh(this);for(Et=this._op=this._op||[],Z!=="all"&&(te(Z)&&(tt={},Ce(Z,function(ii){return tt[ii]=1}),Z=tt),Z=j0(ee,Z)),Mn=ee.length;Mn--;)if(~we.indexOf(ee[Mn])){ut=Ie[Mn],Z==="all"?(Et[Mn]=Z,mn=ut,qe={}):(qe=Et[Mn]=Et[Mn]||{},mn=Z);for(tt in mn)gn=ut&&ut[tt],gn&&((!("kill"in gn.d)||gn.d.kill(tt)===!0)&&to(this,gn,"_pt"),delete ut[tt]),qe!=="all"&&(qe[tt]=1)}return this._initted&&!this._pt&&Ae&&Hh(this),this},S.to=function(B,Z){return new S(B,Z,arguments[2])},S.from=function(B,Z){return Vr(1,arguments)},S.delayedCall=function(B,Z,$,ee){return new S(Z,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:B,onComplete:Z,onReverseComplete:Z,onCompleteParams:$,onReverseCompleteParams:$,callbackScope:ee})},S.fromTo=function(B,Z,$){return Vr(2,arguments)},S.set=function(B,Z){return Z.duration=0,Z.repeatDelay||(Z.repeat=0),new S(B,Z)},S.killTweensOf=function(B,Z,$){return ft.killTweensOf(B,Z,$)},S}(jc);hn(Ts.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0}),Ce("staggerTo,staggerFrom,staggerFromTo",function(xe){Ts[xe]=function(){var S=new Oa,L=tc.call(arguments,0);return L.splice(xe==="staggerFromTo"?5:4,0,0),S[xe].apply(S,L)}});var od=function(S,L,I){return S[L]=I},il=function(S,L,I){return S[L](I)},Ia=function(S,L,I,B){return S[L](B.fp,I)},ld=function(S,L,I){return S.setAttribute(L,I)},Wh=function(S,L){return j(S[L])?il:Pe(S[L])&&S.setAttribute?ld:od},nr=function(S,L){return L.set(L.t,L.p,Math.round((L.s+L.c*S)*1e6)/1e6,L)},Y0=function(S,L){return L.set(L.t,L.p,!!(L.s+L.c*S),L)},cd=function(S,L){var I=L._pt,B="";if(!S&&L.b)B=L.b;else if(S===1&&L.e)B=L.e;else{for(;I;)B=I.p+(I.m?I.m(I.s+I.c*S):Math.round((I.s+I.c*S)*1e4)/1e4)+B,I=I._next;B+=L.c}L.set(L.t,L.p,B,L)},Li=function(S,L){for(var I=L._pt;I;)I.r(S,I.d),I=I._next},Xh=function(S,L,I,B){for(var Z=this._pt,$;Z;)$=Z._next,Z.p===B&&Z.modifier(S,L,I),Z=$},bn=function(S){for(var L=this._pt,I,B;L;)B=L._next,L.p===S&&!L.op||L.op===S?to(this,L,"_pt"):L.dep||(I=1),L=B;return!I},qa=function(S,L,I,B){B.mSet(S,L,B.m.call(B.tween,I,B.mt),B)},Gu=function(S){for(var L=S._pt,I,B,Z,$;L;){for(I=L._next,B=Z;B&&B.pr>L.pr;)B=B._next;(L._prev=B?B._prev:$)?L._prev._next=L:Z=L,(L._next=B)?B._prev=L:$=L,L=I}S._pt=Z},na=function(){function xe(L,I,B,Z,$,ee,we,Ie,Ae){this.t=I,this.s=Z,this.c=$,this.p=B,this.r=ee||nr,this.d=we||this,this.set=Ie||od,this.pr=Ae||0,this._next=L,L&&(L._prev=this)}var S=xe.prototype;return S.modifier=function(I,B,Z){this.mSet=this.mSet||this.set,this.set=qa,this.m=I,this.mt=Z,this.tween=B},xe}();Ce(ue+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(xe){return Be[xe]=1}),Dn.TweenMax=Dn.TweenLite=Ts,Dn.TimelineLite=Dn.TimelineMax=Oa,ft=new Oa({sortChildren:!1,defaults:b,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0}),g.stringFilter=Zg;var Wp={registerPlugin:function(){for(var S=arguments.length,L=new Array(S),I=0;I<S;I++)L[I]=arguments[I];L.forEach(function(B){return W0(B)})},timeline:function(S){return new Oa(S)},getTweensOf:function(S,L){return ft.getTweensOf(S,L)},getProperty:function(S,L,I,B){te(S)&&(S=la(S)[0]);var Z=lt(S||{}).get,$=I?Kn:Ht;return I==="native"&&(I=""),S&&(L?$((Je[L]&&Je[L].get||Z)(S,L,I,B)):function(ee,we,Ie){return $((Je[ee]&&Je[ee].get||Z)(S,ee,we,Ie))})},quickSetter:function(S,L,I){if(S=la(S),S.length>1){var B=S.map(function(Ae){return ko.quickSetter(Ae,L,I)}),Z=B.length;return function(Ae){for(var Et=Z;Et--;)B[Et](Ae)}}S=S[0]||{};var $=Je[L],ee=lt(S),we=ee.harness&&(ee.harness.aliases||{})[L]||L,Ie=$?function(Ae){var Et=new $;Bu._pt=0,Et.init(S,I?Ae+I:Ae,Bu,0,[S]),Et.render(1,Et),Bu._pt&&Li(1,Bu)}:ee.set(S,we);return $?Ie:function(Ae){return Ie(S,we,I?Ae+I:Ae,ee,1)}},isTweening:function(S){return ft.getTweensOf(S,!0).length>0},defaults:function(S){return S&&S.ease&&(S.ease=sc(S.ease,b.ease)),ts(b,S||{})},config:function(S){return ts(g,S||{})},registerEffect:function(S){var L=S.name,I=S.effect,B=S.plugins,Z=S.defaults,$=S.extendTimeline;(B||"").split(",").forEach(function(ee){return ee&&!Je[ee]&&!Dn[ee]&&Fe(L+" effect requires "+ee+" plugin.")}),ot[L]=function(ee,we,Ie){return I(la(ee),hn(we||{},Z),Ie)},$&&(Oa.prototype[L]=function(ee,we,Ie){return this.add(ot[L](ee,Re(we)?we:(Ie=we)&&{},this),Ie)})},registerEase:function(S,L){kr[S]=sc(L)},parseEase:function(S,L){return arguments.length?sc(S,L):kr},getById:function(S){return ft.getById(S)},exportRoot:function(S,L){S===void 0&&(S={});var I=new Oa(S),B,Z;for(I.smoothChildTiming=Ne(S.smoothChildTiming),ft.remove(I),I._dp=0,I._time=I._tTime=ft._time,B=ft._first;B;)Z=B._next,(L||!(!B._dur&&B instanceof Ts&&B.vars.onComplete===B._targets[0]))&&Dt(I,B,B._start-B._delay),B=Z;return Dt(ft,I,0),I},utils:{wrap:H0,wrapYoyo:G0,distribute:Ug,random:Gg,snap:Hg,normalize:U0,getUnit:Us,clamp:Zs,splitColor:qg,toArray:la,selector:ic,mapRange:Wg,pipe:k0,unitize:z0,interpolate:V0,shuffle:Up},install:he,effects:ot,ticker:Mo,updateRoot:Oa.updateRoot,plugins:Je,globalTimeline:ft,core:{PropTween:na,globals:me,Tween:Ts,Timeline:Oa,Animation:jc,getCache:lt,_removeLinkedListItem:to,suppressOverwrites:function(S){return M=S}}};Ce("to,from,fromTo,delayedCall,set,killTweensOf",function(xe){return Wp[xe]=Ts[xe]}),Mo.add(Oa.updateRoot),Bu=Wp.to({},{duration:0});var ds=function(S,L){for(var I=S._pt;I&&I.p!==L&&I.op!==L&&I.fp!==L;)I=I._next;return I},ps=function(S,L){var I=S._targets,B,Z,$;for(B in L)for(Z=I.length;Z--;)$=S._ptLookup[Z][B],$&&($=$.d)&&($._pt&&($=ds($,B)),$&&$.modifier&&$.modifier(L[B],S,I[Z],B))},ja=function(S,L){return{name:S,rawVars:1,init:function(B,Z,$){$._onInit=function(ee){var we,Ie;if(te(Z)&&(we={},Ce(Z,function(Ae){return we[Ae]=1}),Z=we),L){we={};for(Ie in Z)we[Ie]=L(Z[Ie]);Z=we}ps(ee,Z)}}}},ko=Wp.registerPlugin({name:"attr",init:function(S,L,I,B,Z){var $,ee;for($ in L)ee=this.add(S,"setAttribute",(S.getAttribute($)||0)+"",L[$],B,Z,0,0,$),ee&&(ee.op=$),this._props.push($)}},{name:"endArray",init:function(S,L){for(var I=L.length;I--;)this.add(S,I,S[I]||0,L[I])}},ja("roundProps",Hp),ja("modifiers"),ja("snap",Hg))||Wp;Ts.version=Oa.version=ko.version="3.8.0",vi=1,de()&&ku();var ka=kr.Power0,pe=kr.Power1,tv=kr.Power2,Z0=kr.Power3,Tl=kr.Power4,nv=kr.Linear,lc=kr.Quad,ud=kr.Cubic,iv=kr.Quart,qh=kr.Quint,jh=kr.Strong,Yh=kr.Elastic,Zc=kr.Back,Jc=kr.SteppedEase,Vu=kr.Bounce,hd=kr.Sine,Xp=kr.Expo,qp=kr.Circ,$c,Kc,ro,rl,cc,fd,Qc=function(){return typeof window<"u"},Al={},Ll=180/Math.PI,eu=Math.PI/180,sl=Math.atan2,wr=1e8,Wu=/([A-Z])/g,al=/(?:left|right|width|margin|padding|x)/i,Vw=/[\s,\(]\S/,tu={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},uc=function(S,L){return L.set(L.t,L.p,Math.round((L.s+L.c*S)*1e4)/1e4+L.u,L)},jp=function(S,L){return L.set(L.t,L.p,S===1?L.e:Math.round((L.s+L.c*S)*1e4)/1e4+L.u,L)},So=function(S,L){return L.set(L.t,L.p,S?Math.round((L.s+L.c*S)*1e4)/1e4+L.u:L.b,L)},Yp=function(S,L){var I=L.s+L.c*S;L.set(L.t,L.p,~~(I+(I<0?-.5:.5))+L.u,L)},rv=function(S,L){return L.set(L.t,L.p,S?L.e:L.b,L)},sv=function(S,L){return L.set(L.t,L.p,S!==1?L.b:L.e,L)},av=function(S,L,I){return S.style[L]=I},Ww=function(S,L,I){return S.style.setProperty(L,I)},J0=function(S,L,I){return S._gsap[L]=I},Zh=function(S,L,I){return S._gsap.scaleX=S._gsap.scaleY=I},hc=function(S,L,I,B,Z){var $=S._gsap;$.scaleX=$.scaleY=I,$.renderTransform(Z,$)},Zp=function(S,L,I,B,Z){var $=S._gsap;$[L]=I,$.renderTransform(Z,$)},ia="transform",nu=ia+"Origin",$0,Jp=function(S,L){var I=Kc.createElementNS?Kc.createElementNS((L||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),S):Kc.createElement(S);return I.style?I:Kc.createElement(S)},Cl=function xe(S,L,I){var B=getComputedStyle(S);return B[L]||B.getPropertyValue(L.replace(Wu,"-$1").toLowerCase())||B.getPropertyValue(L)||!I&&xe(S,Jh(L)||L,1)||""},ov="O,Moz,ms,Ms,Webkit".split(","),Jh=function(S,L,I){var B=L||cc,Z=B.style,$=5;if(S in Z&&!I)return S;for(S=S.charAt(0).toUpperCase()+S.substr(1);$--&&!(ov[$]+S in Z););return $<0?null:($===3?"ms":$>=0?ov[$]:"")+S},lv=function(){Qc()&&window.document&&($c=window,Kc=$c.document,ro=Kc.documentElement,cc=Jp("div")||{style:{}},Jp("div"),ia=Jh(ia),nu=ia+"Origin",cc.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",$0=!!Jh("perspective"),rl=1)},Ei=function xe(S){var L=Jp("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),I=this.parentNode,B=this.nextSibling,Z=this.style.cssText,$;if(ro.appendChild(L),L.appendChild(this),this.style.display="block",S)try{$=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=xe}catch{}else this._gsapBBox&&($=this._gsapBBox());return I&&(B?I.insertBefore(this,B):I.appendChild(this)),ro.removeChild(L),this.style.cssText=Z,$},$p=function(S,L){for(var I=L.length;I--;)if(S.hasAttribute(L[I]))return S.getAttribute(L[I])},K0=function(S){var L;try{L=S.getBBox()}catch{L=Ei.call(S,!0)}return L&&(L.width||L.height)||S.getBBox===Ei||(L=Ei.call(S,!0)),L&&!L.width&&!L.x&&!L.y?{x:+$p(S,["x","cx","x1"])||0,y:+$p(S,["y","cy","y1"])||0,width:0,height:0}:L},Q0=function(S){return!!(S.getCTM&&(!S.parentNode||S.ownerSVGElement)&&K0(S))},so=function(S,L){if(L){var I=S.style;L in Al&&L!==nu&&(L=ia),I.removeProperty?((L.substr(0,2)==="ms"||L.substr(0,6)==="webkit")&&(L="-"+L),I.removeProperty(L.replace(Wu,"-$1").toLowerCase())):I.removeAttribute(L)}},Ma=function(S,L,I,B,Z,$){var ee=new na(S._pt,L,I,0,1,$?sv:rv);return S._pt=ee,ee.b=B,ee.e=Z,S._props.push(I),ee},Pl={deg:1,rad:1,turn:1},Rl=function xe(S,L,I,B){var Z=parseFloat(I)||0,$=(I+"").trim().substr((Z+"").length)||"px",ee=cc.style,we=al.test(L),Ie=S.tagName.toLowerCase()==="svg",Ae=(Ie?"client":"offset")+(we?"Width":"Height"),Et=100,ut=B==="px",qe=B==="%",mn,tt,gn,Mn;return B===$||!Z||Pl[B]||Pl[$]?Z:($!=="px"&&!ut&&(Z=xe(S,L,I,"px")),Mn=S.getCTM&&Q0(S),(qe||$==="%")&&(Al[L]||~L.indexOf("adius"))?(mn=Mn?S.getBBox()[we?"width":"height"]:S[Ae],Pt(qe?Z/mn*Et:Z/100*mn)):(ee[we?"width":"height"]=Et+(ut?$:B),tt=~L.indexOf("adius")||B==="em"&&S.appendChild&&!Ie?S:S.parentNode,Mn&&(tt=(S.ownerSVGElement||{}).parentNode),(!tt||tt===Kc||!tt.appendChild)&&(tt=Kc.body),gn=tt._gsap,gn&&qe&&gn.width&&we&&gn.time===Mo.time?Pt(Z/gn.width*Et):((qe||$==="%")&&(ee.position=Cl(S,"position")),tt===S&&(ee.position="static"),tt.appendChild(cc),mn=cc[Ae],tt.removeChild(cc),ee.position="absolute",we&&qe&&(gn=lt(tt),gn.time=Mo.time,gn.width=tt[Ae]),Pt(ut?mn*Z/Et:mn&&Z?Et/mn*Z:0))))},ao=function(S,L,I,B){var Z;return rl||lv(),L in tu&&L!=="transform"&&(L=tu[L],~L.indexOf(",")&&(L=L.split(",")[0])),Al[L]&&L!=="transform"?(Z=ju(S,B),Z=L!=="transformOrigin"?Z[L]:Z.svg?Z.origin:ef(Cl(S,nu))+" "+Z.zOrigin+"px"):(Z=S.style[L],(!Z||Z==="auto"||B||~(Z+"").indexOf("calc("))&&(Z=Kh[L]&&Kh[L](S,L,I)||Cl(S,L)||yt(S,L)||(L==="opacity"?1:0))),I&&!~(Z+"").trim().indexOf(" ")?Rl(S,L,Z,I)+I:Z},$h=function(S,L,I,B){if(!I||I==="none"){var Z=Jh(L,S,1),$=Z&&Cl(S,Z,1);$&&$!==I?(L=Z,I=$):L==="borderColor"&&(I=Cl(S,"borderTopColor"))}var ee=new na(this._pt,S.style,L,0,1,cd),we=0,Ie=0,Ae,Et,ut,qe,mn,tt,gn,Mn,ii,Zn,gi,Yn,Jn;if(ee.b=I,ee.e=B,I+="",B+="",B==="auto"&&(S.style[L]=B,B=Cl(S,L)||B,S.style[L]=I),Ae=[I,B],Zg(Ae),I=Ae[0],B=Ae[1],ut=I.match(et)||[],Jn=B.match(et)||[],Jn.length){for(;Et=et.exec(B);)gn=Et[0],ii=B.substring(we,Et.index),mn?mn=(mn+1)%5:(ii.substr(-5)==="rgba("||ii.substr(-5)==="hsla(")&&(mn=1),gn!==(tt=ut[Ie++]||"")&&(qe=parseFloat(tt)||0,gi=tt.substr((qe+"").length),Yn=gn.charAt(1)==="="?+(gn.charAt(0)+"1"):0,Yn&&(gn=gn.substr(2)),Mn=parseFloat(gn),Zn=gn.substr((Mn+"").length),we=et.lastIndex-Zn.length,Zn||(Zn=Zn||g.units[L]||gi,we===B.length&&(B+=Zn,ee.e+=Zn)),gi!==Zn&&(qe=Rl(S,L,tt,Zn)||0),ee._pt={_next:ee._pt,p:ii||Ie===1?ii:",",s:qe,c:Yn?Yn*Mn:Mn-qe,m:mn&&mn<4||L==="zIndex"?Math.round:0});ee.c=we<B.length?B.substring(we,B.length):""}else ee.r=L==="display"&&B==="none"?sv:rv;return je.test(B)&&(ee.e=0),this._pt=ee,ee},Xu={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},ex=function(S){var L=S.split(" "),I=L[0],B=L[1]||"50%";return(I==="top"||I==="bottom"||B==="left"||B==="right")&&(S=I,I=B,B=S),L[0]=Xu[I]||I,L[1]=Xu[B]||B,L.join(" ")},cv=function(S,L){if(L.tween&&L.tween._time===L.tween._dur){var I=L.t,B=I.style,Z=L.u,$=I._gsap,ee,we,Ie;if(Z==="all"||Z===!0)B.cssText="",we=1;else for(Z=Z.split(","),Ie=Z.length;--Ie>-1;)ee=Z[Ie],Al[ee]&&(we=1,ee=ee==="transformOrigin"?nu:ia),so(I,ee);we&&(so(I,ia),$&&($.svg&&I.removeAttribute("transform"),ju(I,1),$.uncache=1))}},Kh={clearProps:function(S,L,I,B,Z){if(Z.data!=="isFromStart"){var $=S._pt=new na(S._pt,L,I,0,0,cv);return $.u=B,$.pr=-10,$.tween=Z,S._props.push(I),1}}},qu=[1,0,0,1,0,0],zo={},uv=function(S){return S==="matrix(1, 0, 0, 1, 0, 0)"||S==="none"||!S},Uo=function(S){var L=Cl(S,ia);return uv(L)?qu:L.substr(7).match(_t).map(Pt)},Qh=function(S,L){var I=S._gsap||lt(S),B=S.style,Z=Uo(S),$,ee,we,Ie;return I.svg&&S.getAttribute("transform")?(we=S.transform.baseVal.consolidate().matrix,Z=[we.a,we.b,we.c,we.d,we.e,we.f],Z.join(",")==="1,0,0,1,0,0"?qu:Z):(Z===qu&&!S.offsetParent&&S!==ro&&!I.svg&&(we=B.display,B.display="block",$=S.parentNode,(!$||!S.offsetParent)&&(Ie=1,ee=S.nextSibling,ro.appendChild(S)),Z=Uo(S),we?B.display=we:so(S,"display"),Ie&&(ee?$.insertBefore(S,ee):$?$.appendChild(S):ro.removeChild(S))),L&&Z.length>6?[Z[0],Z[1],Z[4],Z[5],Z[12],Z[13]]:Z)},dd=function(S,L,I,B,Z,$){var ee=S._gsap,we=Z||Qh(S,!0),Ie=ee.xOrigin||0,Ae=ee.yOrigin||0,Et=ee.xOffset||0,ut=ee.yOffset||0,qe=we[0],mn=we[1],tt=we[2],gn=we[3],Mn=we[4],ii=we[5],Zn=L.split(" "),gi=parseFloat(Zn[0])||0,Yn=parseFloat(Zn[1])||0,Jn,hi,xi,si;I?we!==qu&&(hi=qe*gn-mn*tt)&&(xi=gi*(gn/hi)+Yn*(-tt/hi)+(tt*ii-gn*Mn)/hi,si=gi*(-mn/hi)+Yn*(qe/hi)-(qe*ii-mn*Mn)/hi,gi=xi,Yn=si):(Jn=K0(S),gi=Jn.x+(~Zn[0].indexOf("%")?gi/100*Jn.width:gi),Yn=Jn.y+(~(Zn[1]||Zn[0]).indexOf("%")?Yn/100*Jn.height:Yn)),B||B!==!1&&ee.smooth?(Mn=gi-Ie,ii=Yn-Ae,ee.xOffset=Et+(Mn*qe+ii*tt)-Mn,ee.yOffset=ut+(Mn*mn+ii*gn)-ii):ee.xOffset=ee.yOffset=0,ee.xOrigin=gi,ee.yOrigin=Yn,ee.smooth=!!B,ee.origin=L,ee.originIsAbsolute=!!I,S.style[nu]="0px 0px",$&&(Ma($,ee,"xOrigin",Ie,gi),Ma($,ee,"yOrigin",Ae,Yn),Ma($,ee,"xOffset",Et,ee.xOffset),Ma($,ee,"yOffset",ut,ee.yOffset)),S.setAttribute("data-svg-origin",gi+" "+Yn)},ju=function(S,L){var I=S._gsap||new rd(S);if("x"in I&&!L&&!I.uncache)return I;var B=S.style,Z=I.scaleX<0,$="px",ee="deg",we=Cl(S,nu)||"0",Ie,Ae,Et,ut,qe,mn,tt,gn,Mn,ii,Zn,gi,Yn,Jn,hi,xi,si,Cr,ls,Ns,ra,Hs,xr,Ea,Ya,ol,Ho,ca,iu,za,Ta,Ms;return Ie=Ae=Et=mn=tt=gn=Mn=ii=Zn=0,ut=qe=1,I.svg=!!(S.getCTM&&Q0(S)),Jn=Qh(S,I.svg),I.svg&&(Ea=(!I.uncache||we==="0px 0px")&&!L&&S.getAttribute("data-svg-origin"),dd(S,Ea||we,!!Ea||I.originIsAbsolute,I.smooth!==!1,Jn)),gi=I.xOrigin||0,Yn=I.yOrigin||0,Jn!==qu&&(Cr=Jn[0],ls=Jn[1],Ns=Jn[2],ra=Jn[3],Ie=Hs=Jn[4],Ae=xr=Jn[5],Jn.length===6?(ut=Math.sqrt(Cr*Cr+ls*ls),qe=Math.sqrt(ra*ra+Ns*Ns),mn=Cr||ls?sl(ls,Cr)*Ll:0,Mn=Ns||ra?sl(Ns,ra)*Ll+mn:0,Mn&&(qe*=Math.abs(Math.cos(Mn*eu))),I.svg&&(Ie-=gi-(gi*Cr+Yn*Ns),Ae-=Yn-(gi*ls+Yn*ra))):(Ms=Jn[6],za=Jn[7],Ho=Jn[8],ca=Jn[9],iu=Jn[10],Ta=Jn[11],Ie=Jn[12],Ae=Jn[13],Et=Jn[14],hi=sl(Ms,iu),tt=hi*Ll,hi&&(xi=Math.cos(-hi),si=Math.sin(-hi),Ea=Hs*xi+Ho*si,Ya=xr*xi+ca*si,ol=Ms*xi+iu*si,Ho=Hs*-si+Ho*xi,ca=xr*-si+ca*xi,iu=Ms*-si+iu*xi,Ta=za*-si+Ta*xi,Hs=Ea,xr=Ya,Ms=ol),hi=sl(-Ns,iu),gn=hi*Ll,hi&&(xi=Math.cos(-hi),si=Math.sin(-hi),Ea=Cr*xi-Ho*si,Ya=ls*xi-ca*si,ol=Ns*xi-iu*si,Ta=ra*si+Ta*xi,Cr=Ea,ls=Ya,Ns=ol),hi=sl(ls,Cr),mn=hi*Ll,hi&&(xi=Math.cos(hi),si=Math.sin(hi),Ea=Cr*xi+ls*si,Ya=Hs*xi+xr*si,ls=ls*xi-Cr*si,xr=xr*xi-Hs*si,Cr=Ea,Hs=Ya),tt&&Math.abs(tt)+Math.abs(mn)>359.9&&(tt=mn=0,gn=180-gn),ut=Pt(Math.sqrt(Cr*Cr+ls*ls+Ns*Ns)),qe=Pt(Math.sqrt(xr*xr+Ms*Ms)),hi=sl(Hs,xr),Mn=Math.abs(hi)>2e-4?hi*Ll:0,Zn=Ta?1/(Ta<0?-Ta:Ta):0),I.svg&&(Ea=S.getAttribute("transform"),I.forceCSS=S.setAttribute("transform","")||!uv(Cl(S,ia)),Ea&&S.setAttribute("transform",Ea))),Math.abs(Mn)>90&&Math.abs(Mn)<270&&(Z?(ut*=-1,Mn+=mn<=0?180:-180,mn+=mn<=0?180:-180):(qe*=-1,Mn+=Mn<=0?180:-180)),I.x=Ie-((I.xPercent=Ie&&(I.xPercent||(Math.round(S.offsetWidth/2)===Math.round(-Ie)?-50:0)))?S.offsetWidth*I.xPercent/100:0)+$,I.y=Ae-((I.yPercent=Ae&&(I.yPercent||(Math.round(S.offsetHeight/2)===Math.round(-Ae)?-50:0)))?S.offsetHeight*I.yPercent/100:0)+$,I.z=Et+$,I.scaleX=Pt(ut),I.scaleY=Pt(qe),I.rotation=Pt(mn)+ee,I.rotationX=Pt(tt)+ee,I.rotationY=Pt(gn)+ee,I.skewX=Mn+ee,I.skewY=ii+ee,I.transformPerspective=Zn+$,(I.zOrigin=parseFloat(we.split(" ")[2])||0)&&(B[nu]=ef(we)),I.xOffset=I.yOffset=0,I.force3D=g.force3D,I.renderTransform=I.svg?Kp:$0?_s:pd,I.uncache=0,I},ef=function(S){return(S=S.split(" "))[0]+" "+S[1]},mi=function(S,L,I){var B=Us(L);return Pt(parseFloat(L)+parseFloat(Rl(S,"x",I+"px",B)))+B},pd=function(S,L){L.z="0px",L.rotationY=L.rotationX="0deg",L.force3D=0,_s(S,L)},Yu="0deg",zi="0px",Sa=") ",_s=function(S,L){var I=L||this,B=I.xPercent,Z=I.yPercent,$=I.x,ee=I.y,we=I.z,Ie=I.rotation,Ae=I.rotationY,Et=I.rotationX,ut=I.skewX,qe=I.skewY,mn=I.scaleX,tt=I.scaleY,gn=I.transformPerspective,Mn=I.force3D,ii=I.target,Zn=I.zOrigin,gi="",Yn=Mn==="auto"&&S&&S!==1||Mn===!0;if(Zn&&(Et!==Yu||Ae!==Yu)){var Jn=parseFloat(Ae)*eu,hi=Math.sin(Jn),xi=Math.cos(Jn),si;Jn=parseFloat(Et)*eu,si=Math.cos(Jn),$=mi(ii,$,hi*si*-Zn),ee=mi(ii,ee,-Math.sin(Jn)*-Zn),we=mi(ii,we,xi*si*-Zn+Zn)}gn!==zi&&(gi+="perspective("+gn+Sa),(B||Z)&&(gi+="translate("+B+"%, "+Z+"%) "),(Yn||$!==zi||ee!==zi||we!==zi)&&(gi+=we!==zi||Yn?"translate3d("+$+", "+ee+", "+we+") ":"translate("+$+", "+ee+Sa),Ie!==Yu&&(gi+="rotate("+Ie+Sa),Ae!==Yu&&(gi+="rotateY("+Ae+Sa),Et!==Yu&&(gi+="rotateX("+Et+Sa),(ut!==Yu||qe!==Yu)&&(gi+="skew("+ut+", "+qe+Sa),(mn!==1||tt!==1)&&(gi+="scale("+mn+", "+tt+Sa),ii.style[ia]=gi||"translate(0, 0)"},Kp=function(S,L){var I=L||this,B=I.xPercent,Z=I.yPercent,$=I.x,ee=I.y,we=I.rotation,Ie=I.skewX,Ae=I.skewY,Et=I.scaleX,ut=I.scaleY,qe=I.target,mn=I.xOrigin,tt=I.yOrigin,gn=I.xOffset,Mn=I.yOffset,ii=I.forceCSS,Zn=parseFloat($),gi=parseFloat(ee),Yn,Jn,hi,xi,si;we=parseFloat(we),Ie=parseFloat(Ie),Ae=parseFloat(Ae),Ae&&(Ae=parseFloat(Ae),Ie+=Ae,we+=Ae),we||Ie?(we*=eu,Ie*=eu,Yn=Math.cos(we)*Et,Jn=Math.sin(we)*Et,hi=Math.sin(we-Ie)*-ut,xi=Math.cos(we-Ie)*ut,Ie&&(Ae*=eu,si=Math.tan(Ie-Ae),si=Math.sqrt(1+si*si),hi*=si,xi*=si,Ae&&(si=Math.tan(Ae),si=Math.sqrt(1+si*si),Yn*=si,Jn*=si)),Yn=Pt(Yn),Jn=Pt(Jn),hi=Pt(hi),xi=Pt(xi)):(Yn=Et,xi=ut,Jn=hi=0),(Zn&&!~($+"").indexOf("px")||gi&&!~(ee+"").indexOf("px"))&&(Zn=Rl(qe,"x",$,"px"),gi=Rl(qe,"y",ee,"px")),(mn||tt||gn||Mn)&&(Zn=Pt(Zn+mn-(mn*Yn+tt*hi)+gn),gi=Pt(gi+tt-(mn*Jn+tt*xi)+Mn)),(B||Z)&&(si=qe.getBBox(),Zn=Pt(Zn+B/100*si.width),gi=Pt(gi+Z/100*si.height)),si="matrix("+Yn+","+Jn+","+hi+","+xi+","+Zn+","+gi+")",qe.setAttribute("transform",si),ii&&(qe.style[ia]=si)},qi=function(S,L,I,B,Z,$){var ee=360,we=te(Z),Ie=parseFloat(Z)*(we&&~Z.indexOf("rad")?Ll:1),Ae=$?Ie*$:Ie-B,Et=B+Ae+"deg",ut,qe;return we&&(ut=Z.split("_")[1],ut==="short"&&(Ae%=ee,Ae!==Ae%(ee/2)&&(Ae+=Ae<0?ee:-ee)),ut==="cw"&&Ae<0?Ae=(Ae+ee*wr)%ee-~~(Ae/ee)*ee:ut==="ccw"&&Ae>0&&(Ae=(Ae-ee*wr)%ee-~~(Ae/ee)*ee)),S._pt=qe=new na(S._pt,L,I,B,Ae,jp),qe.e=Et,qe.u="deg",S._props.push(I),qe},tf=function(S,L){for(var I in L)S[I]=L[I];return S},md=function(S,L,I){var B=tf({},I._gsap),Z="perspective,force3D,transformOrigin,svgOrigin",$=I.style,ee,we,Ie,Ae,Et,ut,qe,mn;B.svg?(Ie=I.getAttribute("transform"),I.setAttribute("transform",""),$[ia]=L,ee=ju(I,1),so(I,ia),I.setAttribute("transform",Ie)):(Ie=getComputedStyle(I)[ia],$[ia]=L,ee=ju(I,1),$[ia]=Ie);for(we in Al)Ie=B[we],Ae=ee[we],Ie!==Ae&&Z.indexOf(we)<0&&(qe=Us(Ie),mn=Us(Ae),Et=qe!==mn?Rl(I,we,Ie,mn):parseFloat(Ie),ut=parseFloat(Ae),S._pt=new na(S._pt,ee,we,Et,ut-Et,uc),S._pt.u=mn||0,S._props.push(we));tf(ee,B)};Ce("padding,margin,Width,Radius",function(xe,S){var L="Top",I="Right",B="Bottom",Z="Left",$=(S<3?[L,I,B,Z]:[L+Z,L+I,B+I,B+Z]).map(function(ee){return S<2?xe+ee:"border"+ee+xe});Kh[S>1?"border"+xe:xe]=function(ee,we,Ie,Ae,Et){var ut,qe;if(arguments.length<4)return ut=$.map(function(mn){return ao(ee,mn,Ie)}),qe=ut.join(" "),qe.split(ut[0]).length===5?ut[0]:qe;ut=(Ae+"").split(" "),qe={},$.forEach(function(mn,tt){return qe[mn]=ut[tt]=ut[tt]||ut[(tt-1)/2|0]}),ee.init(we,qe,Et)}});var Zu={name:"css",register:lv,targetTest:function(S){return S.style&&S.nodeType},init:function(S,L,I,B,Z){var $=this._props,ee=S.style,we=I.vars.startAt,Ie,Ae,Et,ut,qe,mn,tt,gn,Mn,ii,Zn,gi,Yn,Jn,hi;rl||lv();for(tt in L)if(tt!=="autoRound"&&(Ae=L[tt],!(Je[tt]&&Qg(tt,L,I,B,S,Z)))){if(qe=typeof Ae,mn=Kh[tt],qe==="function"&&(Ae=Ae.call(I,B,S,Z),qe=typeof Ae),qe==="string"&&~Ae.indexOf("random(")&&(Ae=Uh(Ae)),mn)mn(this,S,tt,Ae,I)&&(hi=1);else if(tt.substr(0,2)==="--")Ie=(getComputedStyle(S).getPropertyValue(tt)+"").trim(),Ae+="",rc.lastIndex=0,rc.test(Ie)||(gn=Us(Ie),Mn=Us(Ae)),Mn?gn!==Mn&&(Ie=Rl(S,tt,Ie,Mn)+Mn):gn&&(Ae+=gn),this.add(ee,"setProperty",Ie,Ae,B,Z,0,0,tt),$.push(tt);else if(qe!=="undefined"){if(we&&tt in we?(Ie=typeof we[tt]=="function"?we[tt].call(I,B,S,Z):we[tt],tt in g.units&&!Us(Ie)&&(Ie+=g.units[tt]),te(Ie)&&~Ie.indexOf("random(")&&(Ie=Uh(Ie)),(Ie+"").charAt(1)==="="&&(Ie=ao(S,tt))):Ie=ao(S,tt),ut=parseFloat(Ie),ii=qe==="string"&&Ae.charAt(1)==="="?+(Ae.charAt(0)+"1"):0,ii&&(Ae=Ae.substr(2)),Et=parseFloat(Ae),tt in tu&&(tt==="autoAlpha"&&(ut===1&&ao(S,"visibility")==="hidden"&&Et&&(ut=0),Ma(this,ee,"visibility",ut?"inherit":"hidden",Et?"inherit":"hidden",!Et)),tt!=="scale"&&tt!=="transform"&&(tt=tu[tt],~tt.indexOf(",")&&(tt=tt.split(",")[0]))),Zn=tt in Al,Zn){if(gi||(Yn=S._gsap,Yn.renderTransform&&!L.parseTransform||ju(S,L.parseTransform),Jn=L.smoothOrigin!==!1&&Yn.smooth,gi=this._pt=new na(this._pt,ee,ia,0,1,Yn.renderTransform,Yn,0,-1),gi.dep=1),tt==="scale")this._pt=new na(this._pt,Yn,"scaleY",Yn.scaleY,(ii?ii*Et:Et-Yn.scaleY)||0),$.push("scaleY",tt),tt+="X";else if(tt==="transformOrigin"){Ae=ex(Ae),Yn.svg?dd(S,Ae,0,Jn,0,this):(Mn=parseFloat(Ae.split(" ")[2])||0,Mn!==Yn.zOrigin&&Ma(this,Yn,"zOrigin",Yn.zOrigin,Mn),Ma(this,ee,tt,ef(Ie),ef(Ae)));continue}else if(tt==="svgOrigin"){dd(S,Ae,1,Jn,0,this);continue}else if(tt in zo){qi(this,Yn,tt,ut,Ae,ii);continue}else if(tt==="smoothOrigin"){Ma(this,Yn,"smooth",Yn.smooth,Ae);continue}else if(tt==="force3D"){Yn[tt]=Ae;continue}else if(tt==="transform"){md(this,Ae,S);continue}}else tt in ee||(tt=Jh(tt)||tt);if(Zn||(Et||Et===0)&&(ut||ut===0)&&!Vw.test(Ae)&&tt in ee)gn=(Ie+"").substr((ut+"").length),Et||(Et=0),Mn=Us(Ae)||(tt in g.units?g.units[tt]:gn),gn!==Mn&&(ut=Rl(S,tt,Ie,Mn)),this._pt=new na(this._pt,Zn?Yn:ee,tt,ut,ii?ii*Et:Et-ut,!Zn&&(Mn==="px"||tt==="zIndex")&&L.autoRound!==!1?Yp:uc),this._pt.u=Mn||0,gn!==Mn&&Mn!=="%"&&(this._pt.b=Ie,this._pt.r=So);else if(tt in ee)$h.call(this,S,tt,Ie,Ae);else if(tt in S)this.add(S,tt,Ie||S[tt],Ae,B,Z);else{K(tt,Ae);continue}$.push(tt)}}hi&&Gu(this)},get:ao,aliases:tu,getSetter:function(S,L,I){var B=tu[L];return B&&B.indexOf(",")<0&&(L=B),L in Al&&L!==nu&&(S._gsap.x||ao(S,"x"))?I&&fd===I?L==="scale"?Zh:J0:(fd=I||{})&&(L==="scale"?hc:Zp):S.style&&!Pe(S.style[L])?av:~L.indexOf("-")?Ww:Wh(S,L)},core:{_removeProperty:so,_getMatrix:Qh}};ko.utils.checkPrefix=Jh,function(xe,S,L,I){var B=Ce(xe+","+S+","+L,function(Z){Al[Z]=1});Ce(S,function(Z){g.units[Z]="deg",zo[Z]=1}),tu[B[13]]=xe+","+S,Ce(I,function(Z){var $=Z.split(":");tu[$[1]]=B[$[0]]})}("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY"),Ce("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(xe){g.units[xe]="px"}),ko.registerPlugin(Zu);var Ju=ko.registerPlugin(Zu)||ko,$u=Ju.core.Tween;n.Back=Zc,n.Bounce=Vu,n.CSSPlugin=Zu,n.Circ=qp,n.Cubic=ud,n.Elastic=Yh,n.Expo=Xp,n.Linear=nv,n.Power0=ka,n.Power1=pe,n.Power2=tv,n.Power3=Z0,n.Power4=Tl,n.Quad=lc,n.Quart=iv,n.Quint=qh,n.Sine=hd,n.SteppedEase=Jc,n.Strong=jh,n.TimelineLite=Oa,n.TimelineMax=Oa,n.TweenLite=Ts,n.TweenMax=$u,n.default=Ju,n.gsap=Ju,typeof window>"u"||window!==n?Object.defineProperty(n,"__esModule",{value:!0}):delete window.default})});Rn(In);var Hn=In.TweenMax,Un=ri(function(r,i){(function(n,u){u(i)})(Fn,function(n){Number.EPSILON===void 0&&(Number.EPSILON=Math.pow(2,-52)),Number.isInteger===void 0&&(Number.isInteger=function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e}),Math.sign===void 0&&(Math.sign=function(e){return e<0?-1:e>0?1:+e}),"name"in Function.prototype||Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),Object.assign===void 0&&(Object.assign=function(e){if(e==null)throw new TypeError("Cannot convert undefined or null to object");for(var a=Object(e),t=1;t<arguments.length;t++){var s=arguments[t];if(s!=null)for(var l in s)Object.prototype.hasOwnProperty.call(s,l)&&(a[l]=s[l])}return a});var u="121",p=0,g=1,b=2,M=1,A=2,C=3,F=0,O=1,k=2,N=1,X=0,ne=1,te=2,j=3,W=4,Pe=5,Re=100,Ne=101,de=102,$e=103,Gt=104,dt=200,an=201,_t=202,et=203,rt=204,je=205,Ve=206,ht=207,ft=208,Wt=209,An=210,Vt=0,Dn=1,Ci=2,vi=3,he=4,K=5,Fe=6,me=7,Le=0,Be=1,Ye=2,ke=0,He=1,Je=2,ot=3,bt=4,Mt=5,ue=300,oe=301,lt=302,yt=303,Ce=304,Pt=306,Kt=307,qn=1e3,xn=1001,Oe=1002,Ht=1003,Kn=1004,hn=1005,jn=1006,er=1007,ts=1008,wa=1009,zs=1010,Ra=1011,ec=1012,to=1013,Ds=1014,xs=1015,tl=1016,no=1017,El=1018,ta=1019,io=1020,bo=1021,nl=1022,ye=1023,Dt=1024,Rt=1025,rn=ye,Qn=1026,ar=1027,dr=1028,Mr=1029,tr=1030,Os=1031,Is=1032,Ii=1033,Vr=33776,oa=33777,Wr=33778,Us=33779,Zs=35840,tc=35841,ma=35842,nc=35843,la=36196,ic=37492,Up=37496,Ug=37808,Hp=37809,Hg=37810,Gg=37811,k0=37812,z0=37813,U0=37814,Vg=37815,H0=37816,G0=37817,Uh=37818,Wg=37819,V0=37820,Xg=37821,wo=36492,Hh=37840,Bu=37841,W0=37842,fs=37843,Gh=37844,Gp=37845,qg=37846,jg=37847,Yg=37848,rc=37849,X0=37850,Zg=37851,td=37852,Mo=37853,ku=2200,kr=2201,q0=2202,nd=2300,id=2301,Vp=2302,zu=2400,qc=2401,Vh=2402,sc=2500,ac=2501,Jg=0,Da=3e3,Uu=3001,rd=3007,jc=3002,Oa=3003,$g=3004,sd=3005,Kg=3006,Qg=3200,oc=3201,Hu=0,j0=1,Yc=7680,ev=519,ad=35044,Ts=35048,od="300 es";function il(){}Object.assign(il.prototype,{addEventListener:function(e,a){this._listeners===void 0&&(this._listeners={});var t=this._listeners;t[e]===void 0&&(t[e]=[]),t[e].indexOf(a)===-1&&t[e].push(a)},hasEventListener:function(e,a){if(this._listeners===void 0)return!1;var t=this._listeners;return t[e]!==void 0&&t[e].indexOf(a)!==-1},removeEventListener:function(e,a){if(this._listeners!==void 0){var t=this._listeners,s=t[e];if(s!==void 0){var l=s.indexOf(a);l!==-1&&s.splice(l,1)}}},dispatchEvent:function(e){if(this._listeners!==void 0){var a=this._listeners,t=a[e.type];if(t!==void 0){e.target=this;for(var s=t.slice(0),l=0,f=s.length;l<f;l++)s[l].call(this,e)}}}});for(var Ia=[],ld=0;ld<256;ld++)Ia[ld]=(ld<16?"0":"")+ld.toString(16);var Wh=1234567,nr={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var e=Math.random()*4294967295|0,a=Math.random()*4294967295|0,t=Math.random()*4294967295|0,s=Math.random()*4294967295|0,l=Ia[e&255]+Ia[e>>8&255]+Ia[e>>16&255]+Ia[e>>24&255]+"-"+Ia[a&255]+Ia[a>>8&255]+"-"+Ia[a>>16&15|64]+Ia[a>>24&255]+"-"+Ia[t&63|128]+Ia[t>>8&255]+"-"+Ia[t>>16&255]+Ia[t>>24&255]+Ia[s&255]+Ia[s>>8&255]+Ia[s>>16&255]+Ia[s>>24&255];return l.toUpperCase()},clamp:function(e,a,t){return Math.max(a,Math.min(t,e))},euclideanModulo:function(e,a){return(e%a+a)%a},mapLinear:function(e,a,t,s,l){return s+(e-a)*(l-s)/(t-a)},lerp:function(e,a,t){return(1-t)*e+t*a},smoothstep:function(e,a,t){return e<=a?0:e>=t?1:(e=(e-a)/(t-a),e*e*(3-2*e))},smootherstep:function(e,a,t){return e<=a?0:e>=t?1:(e=(e-a)/(t-a),e*e*e*(e*(e*6-15)+10))},randInt:function(e,a){return e+Math.floor(Math.random()*(a-e+1))},randFloat:function(e,a){return e+Math.random()*(a-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){return e!==void 0&&(Wh=e%2147483647),Wh=Wh*16807%2147483647,(Wh-1)/2147483646},degToRad:function(e){return e*nr.DEG2RAD},radToDeg:function(e){return e*nr.RAD2DEG},isPowerOfTwo:function(e){return(e&e-1)===0&&e!==0},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(e,a,t,s,l){var f=Math.cos,v=Math.sin,x=f(t/2),w=v(t/2),E=f((a+s)/2),P=v((a+s)/2),R=f((a-s)/2),V=v((a-s)/2),H=f((s-a)/2),q=v((s-a)/2);switch(l){case"XYX":e.set(x*P,w*R,w*V,x*E);break;case"YZY":e.set(w*V,x*P,w*R,x*E);break;case"ZXZ":e.set(w*R,w*V,x*P,x*E);break;case"XZX":e.set(x*P,w*q,w*H,x*E);break;case"YXY":e.set(w*H,x*P,w*q,x*E);break;case"ZYZ":e.set(w*q,w*H,x*P,x*E);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+l)}}};function Y0(e,a){for(var t=0;t<a.length;t++){var s=a[t];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function cd(e,a,t){return a&&Y0(e.prototype,a),t&&Y0(e,t),e}function Li(e,a){e.prototype=Object.create(a.prototype),e.prototype.constructor=e,e.__proto__=a}function Xh(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var bn=function(){function e(t,s){t===void 0&&(t=0),s===void 0&&(s=0),Object.defineProperty(this,"isVector2",{value:!0}),this.x=t,this.y=s}var a=e.prototype;return a.set=function(t,s){return this.x=t,this.y=s,this},a.setScalar=function(t){return this.x=t,this.y=t,this},a.setX=function(t){return this.x=t,this},a.setY=function(t){return this.y=t,this},a.setComponent=function(t,s){switch(t){case 0:this.x=s;break;case 1:this.y=s;break;default:throw new Error("index is out of range: "+t)}return this},a.getComponent=function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},a.clone=function(){return new this.constructor(this.x,this.y)},a.copy=function(t){return this.x=t.x,this.y=t.y,this},a.add=function(t,s){return s!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,s)):(this.x+=t.x,this.y+=t.y,this)},a.addScalar=function(t){return this.x+=t,this.y+=t,this},a.addVectors=function(t,s){return this.x=t.x+s.x,this.y=t.y+s.y,this},a.addScaledVector=function(t,s){return this.x+=t.x*s,this.y+=t.y*s,this},a.sub=function(t,s){return s!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,s)):(this.x-=t.x,this.y-=t.y,this)},a.subScalar=function(t){return this.x-=t,this.y-=t,this},a.subVectors=function(t,s){return this.x=t.x-s.x,this.y=t.y-s.y,this},a.multiply=function(t){return this.x*=t.x,this.y*=t.y,this},a.multiplyScalar=function(t){return this.x*=t,this.y*=t,this},a.divide=function(t){return this.x/=t.x,this.y/=t.y,this},a.divideScalar=function(t){return this.multiplyScalar(1/t)},a.applyMatrix3=function(t){var s=this.x,l=this.y,f=t.elements;return this.x=f[0]*s+f[3]*l+f[6],this.y=f[1]*s+f[4]*l+f[7],this},a.min=function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},a.max=function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},a.clamp=function(t,s){return this.x=Math.max(t.x,Math.min(s.x,this.x)),this.y=Math.max(t.y,Math.min(s.y,this.y)),this},a.clampScalar=function(t,s){return this.x=Math.max(t,Math.min(s,this.x)),this.y=Math.max(t,Math.min(s,this.y)),this},a.clampLength=function(t,s){var l=this.length();return this.divideScalar(l||1).multiplyScalar(Math.max(t,Math.min(s,l)))},a.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},a.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},a.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},a.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},a.negate=function(){return this.x=-this.x,this.y=-this.y,this},a.dot=function(t){return this.x*t.x+this.y*t.y},a.cross=function(t){return this.x*t.y-this.y*t.x},a.lengthSq=function(){return this.x*this.x+this.y*this.y},a.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},a.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)},a.normalize=function(){return this.divideScalar(this.length()||1)},a.angle=function(){var s=Math.atan2(-this.y,-this.x)+Math.PI;return s},a.distanceTo=function(t){return Math.sqrt(this.distanceToSquared(t))},a.distanceToSquared=function(t){var s=this.x-t.x,l=this.y-t.y;return s*s+l*l},a.manhattanDistanceTo=function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},a.setLength=function(t){return this.normalize().multiplyScalar(t)},a.lerp=function(t,s){return this.x+=(t.x-this.x)*s,this.y+=(t.y-this.y)*s,this},a.lerpVectors=function(t,s,l){return this.x=t.x+(s.x-t.x)*l,this.y=t.y+(s.y-t.y)*l,this},a.equals=function(t){return t.x===this.x&&t.y===this.y},a.fromArray=function(t,s){return s===void 0&&(s=0),this.x=t[s],this.y=t[s+1],this},a.toArray=function(t,s){return t===void 0&&(t=[]),s===void 0&&(s=0),t[s]=this.x,t[s+1]=this.y,t},a.fromBufferAttribute=function(t,s,l){return l!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(s),this.y=t.getY(s),this},a.rotateAround=function(t,s){var l=Math.cos(s),f=Math.sin(s),v=this.x-t.x,x=this.y-t.y;return this.x=v*l-x*f+t.x,this.y=v*f+x*l+t.y,this},a.random=function(){return this.x=Math.random(),this.y=Math.random(),this},cd(e,[{key:"width",get:function(){return this.x},set:function(t){this.x=t}},{key:"height",get:function(){return this.y},set:function(t){this.y=t}}]),e}(),qa=function(){function e(){Object.defineProperty(this,"isMatrix3",{value:!0}),this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}var a=e.prototype;return a.set=function(t,s,l,f,v,x,w,E,P){var R=this.elements;return R[0]=t,R[1]=f,R[2]=w,R[3]=s,R[4]=v,R[5]=E,R[6]=l,R[7]=x,R[8]=P,this},a.identity=function(){return this.set(1,0,0,0,1,0,0,0,1),this},a.clone=function(){return new this.constructor().fromArray(this.elements)},a.copy=function(t){var s=this.elements,l=t.elements;return s[0]=l[0],s[1]=l[1],s[2]=l[2],s[3]=l[3],s[4]=l[4],s[5]=l[5],s[6]=l[6],s[7]=l[7],s[8]=l[8],this},a.extractBasis=function(t,s,l){return t.setFromMatrix3Column(this,0),s.setFromMatrix3Column(this,1),l.setFromMatrix3Column(this,2),this},a.setFromMatrix4=function(t){var s=t.elements;return this.set(s[0],s[4],s[8],s[1],s[5],s[9],s[2],s[6],s[10]),this},a.multiply=function(t){return this.multiplyMatrices(this,t)},a.premultiply=function(t){return this.multiplyMatrices(t,this)},a.multiplyMatrices=function(t,s){var l=t.elements,f=s.elements,v=this.elements,x=l[0],w=l[3],E=l[6],P=l[1],R=l[4],V=l[7],H=l[2],q=l[5],z=l[8],G=f[0],ie=f[3],le=f[6],ae=f[1],J=f[4],se=f[7],ge=f[2],_e=f[5],We=f[8];return v[0]=x*G+w*ae+E*ge,v[3]=x*ie+w*J+E*_e,v[6]=x*le+w*se+E*We,v[1]=P*G+R*ae+V*ge,v[4]=P*ie+R*J+V*_e,v[7]=P*le+R*se+V*We,v[2]=H*G+q*ae+z*ge,v[5]=H*ie+q*J+z*_e,v[8]=H*le+q*se+z*We,this},a.multiplyScalar=function(t){var s=this.elements;return s[0]*=t,s[3]*=t,s[6]*=t,s[1]*=t,s[4]*=t,s[7]*=t,s[2]*=t,s[5]*=t,s[8]*=t,this},a.determinant=function(){var t=this.elements,s=t[0],l=t[1],f=t[2],v=t[3],x=t[4],w=t[5],E=t[6],P=t[7],R=t[8];return s*x*R-s*w*P-l*v*R+l*w*E+f*v*P-f*x*E},a.getInverse=function(t,s){s!==void 0&&console.warn("THREE.Matrix3: .getInverse() can no longer be configured to throw on degenerate.");var l=t.elements,f=this.elements,v=l[0],x=l[1],w=l[2],E=l[3],P=l[4],R=l[5],V=l[6],H=l[7],q=l[8],z=q*P-R*H,G=R*V-q*E,ie=H*E-P*V,le=v*z+x*G+w*ie;if(le===0)return this.set(0,0,0,0,0,0,0,0,0);var ae=1/le;return f[0]=z*ae,f[1]=(w*H-q*x)*ae,f[2]=(R*x-w*P)*ae,f[3]=G*ae,f[4]=(q*v-w*V)*ae,f[5]=(w*E-R*v)*ae,f[6]=ie*ae,f[7]=(x*V-H*v)*ae,f[8]=(P*v-x*E)*ae,this},a.transpose=function(){var t,s=this.elements;return t=s[1],s[1]=s[3],s[3]=t,t=s[2],s[2]=s[6],s[6]=t,t=s[5],s[5]=s[7],s[7]=t,this},a.getNormalMatrix=function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},a.transposeIntoArray=function(t){var s=this.elements;return t[0]=s[0],t[1]=s[3],t[2]=s[6],t[3]=s[1],t[4]=s[4],t[5]=s[7],t[6]=s[2],t[7]=s[5],t[8]=s[8],this},a.setUvTransform=function(t,s,l,f,v,x,w){var E=Math.cos(v),P=Math.sin(v);this.set(l*E,l*P,-l*(E*x+P*w)+x+t,-f*P,f*E,-f*(-P*x+E*w)+w+s,0,0,1)},a.scale=function(t,s){var l=this.elements;return l[0]*=t,l[3]*=t,l[6]*=t,l[1]*=s,l[4]*=s,l[7]*=s,this},a.rotate=function(t){var s=Math.cos(t),l=Math.sin(t),f=this.elements,v=f[0],x=f[3],w=f[6],E=f[1],P=f[4],R=f[7];return f[0]=s*v+l*E,f[3]=s*x+l*P,f[6]=s*w+l*R,f[1]=-l*v+s*E,f[4]=-l*x+s*P,f[7]=-l*w+s*R,this},a.translate=function(t,s){var l=this.elements;return l[0]+=t*l[2],l[3]+=t*l[5],l[6]+=t*l[8],l[1]+=s*l[2],l[4]+=s*l[5],l[7]+=s*l[8],this},a.equals=function(t){for(var s=this.elements,l=t.elements,f=0;f<9;f++)if(s[f]!==l[f])return!1;return!0},a.fromArray=function(t,s){s===void 0&&(s=0);for(var l=0;l<9;l++)this.elements[l]=t[l+s];return this},a.toArray=function(t,s){t===void 0&&(t=[]),s===void 0&&(s=0);var l=this.elements;return t[s]=l[0],t[s+1]=l[1],t[s+2]=l[2],t[s+3]=l[3],t[s+4]=l[4],t[s+5]=l[5],t[s+6]=l[6],t[s+7]=l[7],t[s+8]=l[8],t},e}(),Gu,na={getDataURL:function(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;var a;if(e instanceof HTMLCanvasElement)a=e;else{Gu===void 0&&(Gu=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),Gu.width=e.width,Gu.height=e.height;var t=Gu.getContext("2d");e instanceof ImageData?t.putImageData(e,0,0):t.drawImage(e,0,0,e.width,e.height),a=Gu}return a.width>2048||a.height>2048?a.toDataURL("image/jpeg",.6):a.toDataURL("image/png")}},Wp=0;function ds(e,a,t,s,l,f,v,x,w,E){Object.defineProperty(this,"id",{value:Wp++}),this.uuid=nr.generateUUID(),this.name="",this.image=e!==void 0?e:ds.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=a!==void 0?a:ds.DEFAULT_MAPPING,this.wrapS=t!==void 0?t:xn,this.wrapT=s!==void 0?s:xn,this.magFilter=l!==void 0?l:jn,this.minFilter=f!==void 0?f:ts,this.anisotropy=w!==void 0?w:1,this.format=v!==void 0?v:ye,this.internalFormat=null,this.type=x!==void 0?x:wa,this.offset=new bn(0,0),this.repeat=new bn(1,1),this.center=new bn(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new qa,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=E!==void 0?E:Da,this.version=0,this.onUpdate=null}ds.DEFAULT_IMAGE=void 0,ds.DEFAULT_MAPPING=ue,ds.prototype=Object.assign(Object.create(il.prototype),{constructor:ds,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function(e){var a=e===void 0||typeof e=="string";if(!a&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];var t={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(this.image!==void 0){var s=this.image;if(s.uuid===void 0&&(s.uuid=nr.generateUUID()),!a&&e.images[s.uuid]===void 0){var l;if(Array.isArray(s)){l=[];for(var f=0,v=s.length;f<v;f++)l.push(na.getDataURL(s[f]))}else l=na.getDataURL(s);e.images[s.uuid]={uuid:s.uuid,url:l}}t.image=s.uuid}return a||(e.textures[this.uuid]=t),t},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(this.mapping!==ue)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case qn:e.x=e.x-Math.floor(e.x);break;case xn:e.x=e.x<0?0:1;break;case Oe:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case qn:e.y=e.y-Math.floor(e.y);break;case xn:e.y=e.y<0?0:1;break;case Oe:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}}),Object.defineProperty(ds.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}});var ps=function(){function e(t,s,l,f){t===void 0&&(t=0),s===void 0&&(s=0),l===void 0&&(l=0),f===void 0&&(f=1),Object.defineProperty(this,"isVector4",{value:!0}),this.x=t,this.y=s,this.z=l,this.w=f}var a=e.prototype;return a.set=function(t,s,l,f){return this.x=t,this.y=s,this.z=l,this.w=f,this},a.setScalar=function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},a.setX=function(t){return this.x=t,this},a.setY=function(t){return this.y=t,this},a.setZ=function(t){return this.z=t,this},a.setW=function(t){return this.w=t,this},a.setComponent=function(t,s){switch(t){case 0:this.x=s;break;case 1:this.y=s;break;case 2:this.z=s;break;case 3:this.w=s;break;default:throw new Error("index is out of range: "+t)}return this},a.getComponent=function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},a.clone=function(){return new this.constructor(this.x,this.y,this.z,this.w)},a.copy=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w!==void 0?t.w:1,this},a.add=function(t,s){return s!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,s)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},a.addScalar=function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},a.addVectors=function(t,s){return this.x=t.x+s.x,this.y=t.y+s.y,this.z=t.z+s.z,this.w=t.w+s.w,this},a.addScaledVector=function(t,s){return this.x+=t.x*s,this.y+=t.y*s,this.z+=t.z*s,this.w+=t.w*s,this},a.sub=function(t,s){return s!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,s)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},a.subScalar=function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},a.subVectors=function(t,s){return this.x=t.x-s.x,this.y=t.y-s.y,this.z=t.z-s.z,this.w=t.w-s.w,this},a.multiplyScalar=function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},a.applyMatrix4=function(t){var s=this.x,l=this.y,f=this.z,v=this.w,x=t.elements;return this.x=x[0]*s+x[4]*l+x[8]*f+x[12]*v,this.y=x[1]*s+x[5]*l+x[9]*f+x[13]*v,this.z=x[2]*s+x[6]*l+x[10]*f+x[14]*v,this.w=x[3]*s+x[7]*l+x[11]*f+x[15]*v,this},a.divideScalar=function(t){return this.multiplyScalar(1/t)},a.setAxisAngleFromQuaternion=function(t){this.w=2*Math.acos(t.w);var s=Math.sqrt(1-t.w*t.w);return s<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/s,this.y=t.y/s,this.z=t.z/s),this},a.setAxisAngleFromRotationMatrix=function(t){var s,l,f,v,x=.01,w=.1,E=t.elements,P=E[0],R=E[4],V=E[8],H=E[1],q=E[5],z=E[9],G=E[2],ie=E[6],le=E[10];if(Math.abs(R-H)<x&&Math.abs(V-G)<x&&Math.abs(z-ie)<x){if(Math.abs(R+H)<w&&Math.abs(V+G)<w&&Math.abs(z+ie)<w&&Math.abs(P+q+le-3)<w)return this.set(1,0,0,0),this;s=Math.PI;var ae=(P+1)/2,J=(q+1)/2,se=(le+1)/2,ge=(R+H)/4,_e=(V+G)/4,We=(z+ie)/4;return ae>J&&ae>se?ae<x?(l=0,f=.707106781,v=.707106781):(l=Math.sqrt(ae),f=ge/l,v=_e/l):J>se?J<x?(l=.707106781,f=0,v=.707106781):(f=Math.sqrt(J),l=ge/f,v=We/f):se<x?(l=.707106781,f=.707106781,v=0):(v=Math.sqrt(se),l=_e/v,f=We/v),this.set(l,f,v,s),this}var nt=Math.sqrt((ie-z)*(ie-z)+(V-G)*(V-G)+(H-R)*(H-R));return Math.abs(nt)<.001&&(nt=1),this.x=(ie-z)/nt,this.y=(V-G)/nt,this.z=(H-R)/nt,this.w=Math.acos((P+q+le-1)/2),this},a.min=function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},a.max=function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},a.clamp=function(t,s){return this.x=Math.max(t.x,Math.min(s.x,this.x)),this.y=Math.max(t.y,Math.min(s.y,this.y)),this.z=Math.max(t.z,Math.min(s.z,this.z)),this.w=Math.max(t.w,Math.min(s.w,this.w)),this},a.clampScalar=function(t,s){return this.x=Math.max(t,Math.min(s,this.x)),this.y=Math.max(t,Math.min(s,this.y)),this.z=Math.max(t,Math.min(s,this.z)),this.w=Math.max(t,Math.min(s,this.w)),this},a.clampLength=function(t,s){var l=this.length();return this.divideScalar(l||1).multiplyScalar(Math.max(t,Math.min(s,l)))},a.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},a.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},a.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},a.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},a.negate=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},a.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},a.lengthSq=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},a.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},a.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},a.normalize=function(){return this.divideScalar(this.length()||1)},a.setLength=function(t){return this.normalize().multiplyScalar(t)},a.lerp=function(t,s){return this.x+=(t.x-this.x)*s,this.y+=(t.y-this.y)*s,this.z+=(t.z-this.z)*s,this.w+=(t.w-this.w)*s,this},a.lerpVectors=function(t,s,l){return this.x=t.x+(s.x-t.x)*l,this.y=t.y+(s.y-t.y)*l,this.z=t.z+(s.z-t.z)*l,this.w=t.w+(s.w-t.w)*l,this},a.equals=function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},a.fromArray=function(t,s){return s===void 0&&(s=0),this.x=t[s],this.y=t[s+1],this.z=t[s+2],this.w=t[s+3],this},a.toArray=function(t,s){return t===void 0&&(t=[]),s===void 0&&(s=0),t[s]=this.x,t[s+1]=this.y,t[s+2]=this.z,t[s+3]=this.w,t},a.fromBufferAttribute=function(t,s,l){return l!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(s),this.y=t.getY(s),this.z=t.getZ(s),this.w=t.getW(s),this},a.random=function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this},cd(e,[{key:"width",get:function(){return this.z},set:function(t){this.z=t}},{key:"height",get:function(){return this.w},set:function(t){this.w=t}}]),e}();function ja(e,a,t){this.width=e,this.height=a,this.scissor=new ps(0,0,e,a),this.scissorTest=!1,this.viewport=new ps(0,0,e,a),t=t||{},this.texture=new ds(void 0,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.image={},this.texture.image.width=e,this.texture.image.height=a,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:jn,this.depthBuffer=t.depthBuffer!==void 0?t.depthBuffer:!0,this.stencilBuffer=t.stencilBuffer!==void 0?t.stencilBuffer:!1,this.depthTexture=t.depthTexture!==void 0?t.depthTexture:null}ja.prototype=Object.assign(Object.create(il.prototype),{constructor:ja,isWebGLRenderTarget:!0,setSize:function(e,a){(this.width!==e||this.height!==a)&&(this.width=e,this.height=a,this.texture.image.width=e,this.texture.image.height=a,this.dispose()),this.viewport.set(0,0,e,a),this.scissor.set(0,0,e,a)},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});function ko(e,a,t){ja.call(this,e,a,t),this.samples=4}ko.prototype=Object.assign(Object.create(ja.prototype),{constructor:ko,isWebGLMultisampleRenderTarget:!0,copy:function(e){return ja.prototype.copy.call(this,e),this.samples=e.samples,this}});var ka=function(){function e(t,s,l,f){t===void 0&&(t=0),s===void 0&&(s=0),l===void 0&&(l=0),f===void 0&&(f=1),Object.defineProperty(this,"isQuaternion",{value:!0}),this._x=t,this._y=s,this._z=l,this._w=f}e.slerp=function(t,s,l,f){return l.copy(t).slerp(s,f)},e.slerpFlat=function(t,s,l,f,v,x,w){var E=l[f+0],P=l[f+1],R=l[f+2],V=l[f+3],H=v[x+0],q=v[x+1],z=v[x+2],G=v[x+3];if(V!==G||E!==H||P!==q||R!==z){var ie=1-w,le=E*H+P*q+R*z+V*G,ae=le>=0?1:-1,J=1-le*le;if(J>Number.EPSILON){var se=Math.sqrt(J),ge=Math.atan2(se,le*ae);ie=Math.sin(ie*ge)/se,w=Math.sin(w*ge)/se}var _e=w*ae;if(E=E*ie+H*_e,P=P*ie+q*_e,R=R*ie+z*_e,V=V*ie+G*_e,ie===1-w){var We=1/Math.sqrt(E*E+P*P+R*R+V*V);E*=We,P*=We,R*=We,V*=We}}t[s]=E,t[s+1]=P,t[s+2]=R,t[s+3]=V},e.multiplyQuaternionsFlat=function(t,s,l,f,v,x){var w=l[f],E=l[f+1],P=l[f+2],R=l[f+3],V=v[x],H=v[x+1],q=v[x+2],z=v[x+3];return t[s]=w*z+R*V+E*q-P*H,t[s+1]=E*z+R*H+P*V-w*q,t[s+2]=P*z+R*q+w*H-E*V,t[s+3]=R*z-w*V-E*H-P*q,t};var a=e.prototype;return a.set=function(t,s,l,f){return this._x=t,this._y=s,this._z=l,this._w=f,this._onChangeCallback(),this},a.clone=function(){return new this.constructor(this._x,this._y,this._z,this._w)},a.copy=function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this},a.setFromEuler=function(t,s){if(!(t&&t.isEuler))throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var l=t._x,f=t._y,v=t._z,x=t._order,w=Math.cos,E=Math.sin,P=w(l/2),R=w(f/2),V=w(v/2),H=E(l/2),q=E(f/2),z=E(v/2);switch(x){case"XYZ":this._x=H*R*V+P*q*z,this._y=P*q*V-H*R*z,this._z=P*R*z+H*q*V,this._w=P*R*V-H*q*z;break;case"YXZ":this._x=H*R*V+P*q*z,this._y=P*q*V-H*R*z,this._z=P*R*z-H*q*V,this._w=P*R*V+H*q*z;break;case"ZXY":this._x=H*R*V-P*q*z,this._y=P*q*V+H*R*z,this._z=P*R*z+H*q*V,this._w=P*R*V-H*q*z;break;case"ZYX":this._x=H*R*V-P*q*z,this._y=P*q*V+H*R*z,this._z=P*R*z-H*q*V,this._w=P*R*V+H*q*z;break;case"YZX":this._x=H*R*V+P*q*z,this._y=P*q*V+H*R*z,this._z=P*R*z-H*q*V,this._w=P*R*V-H*q*z;break;case"XZY":this._x=H*R*V-P*q*z,this._y=P*q*V-H*R*z,this._z=P*R*z+H*q*V,this._w=P*R*V+H*q*z;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+x)}return s!==!1&&this._onChangeCallback(),this},a.setFromAxisAngle=function(t,s){var l=s/2,f=Math.sin(l);return this._x=t.x*f,this._y=t.y*f,this._z=t.z*f,this._w=Math.cos(l),this._onChangeCallback(),this},a.setFromRotationMatrix=function(t){var s=t.elements,l=s[0],f=s[4],v=s[8],x=s[1],w=s[5],E=s[9],P=s[2],R=s[6],V=s[10],H=l+w+V;if(H>0){var q=.5/Math.sqrt(H+1);this._w=.25/q,this._x=(R-E)*q,this._y=(v-P)*q,this._z=(x-f)*q}else if(l>w&&l>V){var z=2*Math.sqrt(1+l-w-V);this._w=(R-E)/z,this._x=.25*z,this._y=(f+x)/z,this._z=(v+P)/z}else if(w>V){var G=2*Math.sqrt(1+w-l-V);this._w=(v-P)/G,this._x=(f+x)/G,this._y=.25*G,this._z=(E+R)/G}else{var ie=2*Math.sqrt(1+V-l-w);this._w=(x-f)/ie,this._x=(v+P)/ie,this._y=(E+R)/ie,this._z=.25*ie}return this._onChangeCallback(),this},a.setFromUnitVectors=function(t,s){var l=t.dot(s)+1;return l<1e-6?(l=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=l):(this._x=0,this._y=-t.z,this._z=t.y,this._w=l)):(this._x=t.y*s.z-t.z*s.y,this._y=t.z*s.x-t.x*s.z,this._z=t.x*s.y-t.y*s.x,this._w=l),this.normalize()},a.angleTo=function(t){return 2*Math.acos(Math.abs(nr.clamp(this.dot(t),-1,1)))},a.rotateTowards=function(t,s){var l=this.angleTo(t);if(l===0)return this;var f=Math.min(1,s/l);return this.slerp(t,f),this},a.identity=function(){return this.set(0,0,0,1)},a.inverse=function(){return this.conjugate()},a.conjugate=function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},a.dot=function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},a.lengthSq=function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},a.length=function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},a.normalize=function(){var t=this.length();return t===0?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this},a.multiply=function(t,s){return s!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,s)):this.multiplyQuaternions(this,t)},a.premultiply=function(t){return this.multiplyQuaternions(t,this)},a.multiplyQuaternions=function(t,s){var l=t._x,f=t._y,v=t._z,x=t._w,w=s._x,E=s._y,P=s._z,R=s._w;return this._x=l*R+x*w+f*P-v*E,this._y=f*R+x*E+v*w-l*P,this._z=v*R+x*P+l*E-f*w,this._w=x*R-l*w-f*E-v*P,this._onChangeCallback(),this},a.slerp=function(t,s){if(s===0)return this;if(s===1)return this.copy(t);var l=this._x,f=this._y,v=this._z,x=this._w,w=x*t._w+l*t._x+f*t._y+v*t._z;if(w<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,w=-w):this.copy(t),w>=1)return this._w=x,this._x=l,this._y=f,this._z=v,this;var E=1-w*w;if(E<=Number.EPSILON){var P=1-s;return this._w=P*x+s*this._w,this._x=P*l+s*this._x,this._y=P*f+s*this._y,this._z=P*v+s*this._z,this.normalize(),this._onChangeCallback(),this}var R=Math.sqrt(E),V=Math.atan2(R,w),H=Math.sin((1-s)*V)/R,q=Math.sin(s*V)/R;return this._w=x*H+this._w*q,this._x=l*H+this._x*q,this._y=f*H+this._y*q,this._z=v*H+this._z*q,this._onChangeCallback(),this},a.equals=function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},a.fromArray=function(t,s){return s===void 0&&(s=0),this._x=t[s],this._y=t[s+1],this._z=t[s+2],this._w=t[s+3],this._onChangeCallback(),this},a.toArray=function(t,s){return t===void 0&&(t=[]),s===void 0&&(s=0),t[s]=this._x,t[s+1]=this._y,t[s+2]=this._z,t[s+3]=this._w,t},a.fromBufferAttribute=function(t,s){return this._x=t.getX(s),this._y=t.getY(s),this._z=t.getZ(s),this._w=t.getW(s),this},a._onChange=function(t){return this._onChangeCallback=t,this},a._onChangeCallback=function(){},cd(e,[{key:"x",get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},{key:"w",get:function(){return this._w},set:function(t){this._w=t,this._onChangeCallback()}}]),e}(),pe=function(){function e(t,s,l){t===void 0&&(t=0),s===void 0&&(s=0),l===void 0&&(l=0),Object.defineProperty(this,"isVector3",{value:!0}),this.x=t,this.y=s,this.z=l}var a=e.prototype;return a.set=function(t,s,l){return l===void 0&&(l=this.z),this.x=t,this.y=s,this.z=l,this},a.setScalar=function(t){return this.x=t,this.y=t,this.z=t,this},a.setX=function(t){return this.x=t,this},a.setY=function(t){return this.y=t,this},a.setZ=function(t){return this.z=t,this},a.setComponent=function(t,s){switch(t){case 0:this.x=s;break;case 1:this.y=s;break;case 2:this.z=s;break;default:throw new Error("index is out of range: "+t)}return this},a.getComponent=function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},a.clone=function(){return new this.constructor(this.x,this.y,this.z)},a.copy=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},a.add=function(t,s){return s!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,s)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},a.addScalar=function(t){return this.x+=t,this.y+=t,this.z+=t,this},a.addVectors=function(t,s){return this.x=t.x+s.x,this.y=t.y+s.y,this.z=t.z+s.z,this},a.addScaledVector=function(t,s){return this.x+=t.x*s,this.y+=t.y*s,this.z+=t.z*s,this},a.sub=function(t,s){return s!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,s)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},a.subScalar=function(t){return this.x-=t,this.y-=t,this.z-=t,this},a.subVectors=function(t,s){return this.x=t.x-s.x,this.y=t.y-s.y,this.z=t.z-s.z,this},a.multiply=function(t,s){return s!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,s)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},a.multiplyScalar=function(t){return this.x*=t,this.y*=t,this.z*=t,this},a.multiplyVectors=function(t,s){return this.x=t.x*s.x,this.y=t.y*s.y,this.z=t.z*s.z,this},a.applyEuler=function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Z0.setFromEuler(t))},a.applyAxisAngle=function(t,s){return this.applyQuaternion(Z0.setFromAxisAngle(t,s))},a.applyMatrix3=function(t){var s=this.x,l=this.y,f=this.z,v=t.elements;return this.x=v[0]*s+v[3]*l+v[6]*f,this.y=v[1]*s+v[4]*l+v[7]*f,this.z=v[2]*s+v[5]*l+v[8]*f,this},a.applyNormalMatrix=function(t){return this.applyMatrix3(t).normalize()},a.applyMatrix4=function(t){var s=this.x,l=this.y,f=this.z,v=t.elements,x=1/(v[3]*s+v[7]*l+v[11]*f+v[15]);return this.x=(v[0]*s+v[4]*l+v[8]*f+v[12])*x,this.y=(v[1]*s+v[5]*l+v[9]*f+v[13])*x,this.z=(v[2]*s+v[6]*l+v[10]*f+v[14])*x,this},a.applyQuaternion=function(t){var s=this.x,l=this.y,f=this.z,v=t.x,x=t.y,w=t.z,E=t.w,P=E*s+x*f-w*l,R=E*l+w*s-v*f,V=E*f+v*l-x*s,H=-v*s-x*l-w*f;return this.x=P*E+H*-v+R*-w-V*-x,this.y=R*E+H*-x+V*-v-P*-w,this.z=V*E+H*-w+P*-x-R*-v,this},a.project=function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},a.unproject=function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},a.transformDirection=function(t){var s=this.x,l=this.y,f=this.z,v=t.elements;return this.x=v[0]*s+v[4]*l+v[8]*f,this.y=v[1]*s+v[5]*l+v[9]*f,this.z=v[2]*s+v[6]*l+v[10]*f,this.normalize()},a.divide=function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},a.divideScalar=function(t){return this.multiplyScalar(1/t)},a.min=function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},a.max=function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},a.clamp=function(t,s){return this.x=Math.max(t.x,Math.min(s.x,this.x)),this.y=Math.max(t.y,Math.min(s.y,this.y)),this.z=Math.max(t.z,Math.min(s.z,this.z)),this},a.clampScalar=function(t,s){return this.x=Math.max(t,Math.min(s,this.x)),this.y=Math.max(t,Math.min(s,this.y)),this.z=Math.max(t,Math.min(s,this.z)),this},a.clampLength=function(t,s){var l=this.length();return this.divideScalar(l||1).multiplyScalar(Math.max(t,Math.min(s,l)))},a.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},a.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},a.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},a.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},a.negate=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},a.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},a.lengthSq=function(){return this.x*this.x+this.y*this.y+this.z*this.z},a.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},a.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},a.normalize=function(){return this.divideScalar(this.length()||1)},a.setLength=function(t){return this.normalize().multiplyScalar(t)},a.lerp=function(t,s){return this.x+=(t.x-this.x)*s,this.y+=(t.y-this.y)*s,this.z+=(t.z-this.z)*s,this},a.lerpVectors=function(t,s,l){return this.x=t.x+(s.x-t.x)*l,this.y=t.y+(s.y-t.y)*l,this.z=t.z+(s.z-t.z)*l,this},a.cross=function(t,s){return s!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,s)):this.crossVectors(this,t)},a.crossVectors=function(t,s){var l=t.x,f=t.y,v=t.z,x=s.x,w=s.y,E=s.z;return this.x=f*E-v*w,this.y=v*x-l*E,this.z=l*w-f*x,this},a.projectOnVector=function(t){var s=t.lengthSq();if(s===0)return this.set(0,0,0);var l=t.dot(this)/s;return this.copy(t).multiplyScalar(l)},a.projectOnPlane=function(t){return tv.copy(this).projectOnVector(t),this.sub(tv)},a.reflect=function(t){return this.sub(tv.copy(t).multiplyScalar(2*this.dot(t)))},a.angleTo=function(t){var s=Math.sqrt(this.lengthSq()*t.lengthSq());if(s===0)return Math.PI/2;var l=this.dot(t)/s;return Math.acos(nr.clamp(l,-1,1))},a.distanceTo=function(t){return Math.sqrt(this.distanceToSquared(t))},a.distanceToSquared=function(t){var s=this.x-t.x,l=this.y-t.y,f=this.z-t.z;return s*s+l*l+f*f},a.manhattanDistanceTo=function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},a.setFromSpherical=function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},a.setFromSphericalCoords=function(t,s,l){var f=Math.sin(s)*t;return this.x=f*Math.sin(l),this.y=Math.cos(s)*t,this.z=f*Math.cos(l),this},a.setFromCylindrical=function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},a.setFromCylindricalCoords=function(t,s,l){return this.x=t*Math.sin(s),this.y=l,this.z=t*Math.cos(s),this},a.setFromMatrixPosition=function(t){var s=t.elements;return this.x=s[12],this.y=s[13],this.z=s[14],this},a.setFromMatrixScale=function(t){var s=this.setFromMatrixColumn(t,0).length(),l=this.setFromMatrixColumn(t,1).length(),f=this.setFromMatrixColumn(t,2).length();return this.x=s,this.y=l,this.z=f,this},a.setFromMatrixColumn=function(t,s){return this.fromArray(t.elements,s*4)},a.setFromMatrix3Column=function(t,s){return this.fromArray(t.elements,s*3)},a.equals=function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},a.fromArray=function(t,s){return s===void 0&&(s=0),this.x=t[s],this.y=t[s+1],this.z=t[s+2],this},a.toArray=function(t,s){return t===void 0&&(t=[]),s===void 0&&(s=0),t[s]=this.x,t[s+1]=this.y,t[s+2]=this.z,t},a.fromBufferAttribute=function(t,s,l){return l!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(s),this.y=t.getY(s),this.z=t.getZ(s),this},a.random=function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this},e}(),tv=new pe,Z0=new ka,Tl=function(){function e(t,s){Object.defineProperty(this,"isBox3",{value:!0}),this.min=t!==void 0?t:new pe(1/0,1/0,1/0),this.max=s!==void 0?s:new pe(-1/0,-1/0,-1/0)}var a=e.prototype;return a.set=function(t,s){return this.min.copy(t),this.max.copy(s),this},a.setFromArray=function(t){for(var s=1/0,l=1/0,f=1/0,v=-1/0,x=-1/0,w=-1/0,E=0,P=t.length;E<P;E+=3){var R=t[E],V=t[E+1],H=t[E+2];R<s&&(s=R),V<l&&(l=V),H<f&&(f=H),R>v&&(v=R),V>x&&(x=V),H>w&&(w=H)}return this.min.set(s,l,f),this.max.set(v,x,w),this},a.setFromBufferAttribute=function(t){for(var s=1/0,l=1/0,f=1/0,v=-1/0,x=-1/0,w=-1/0,E=0,P=t.count;E<P;E++){var R=t.getX(E),V=t.getY(E),H=t.getZ(E);R<s&&(s=R),V<l&&(l=V),H<f&&(f=H),R>v&&(v=R),V>x&&(x=V),H>w&&(w=H)}return this.min.set(s,l,f),this.max.set(v,x,w),this},a.setFromPoints=function(t){this.makeEmpty();for(var s=0,l=t.length;s<l;s++)this.expandByPoint(t[s]);return this},a.setFromCenterAndSize=function(t,s){var l=ud.copy(s).multiplyScalar(.5);return this.min.copy(t).sub(l),this.max.copy(t).add(l),this},a.setFromObject=function(t){return this.makeEmpty(),this.expandByObject(t)},a.clone=function(){return new this.constructor().copy(this)},a.copy=function(t){return this.min.copy(t.min),this.max.copy(t.max),this},a.makeEmpty=function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},a.isEmpty=function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},a.getCenter=function(t){return t===void 0&&(console.warn("THREE.Box3: .getCenter() target is now required"),t=new pe),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},a.getSize=function(t){return t===void 0&&(console.warn("THREE.Box3: .getSize() target is now required"),t=new pe),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},a.expandByPoint=function(t){return this.min.min(t),this.max.max(t),this},a.expandByVector=function(t){return this.min.sub(t),this.max.add(t),this},a.expandByScalar=function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},a.expandByObject=function(t){t.updateWorldMatrix(!1,!1);var s=t.geometry;s!==void 0&&(s.boundingBox===null&&s.computeBoundingBox(),iv.copy(s.boundingBox),iv.applyMatrix4(t.matrixWorld),this.union(iv));for(var l=t.children,f=0,v=l.length;f<v;f++)this.expandByObject(l[f]);return this},a.containsPoint=function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},a.containsBox=function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},a.getParameter=function(t,s){return s===void 0&&(console.warn("THREE.Box3: .getParameter() target is now required"),s=new pe),s.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},a.intersectsBox=function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},a.intersectsSphere=function(t){return this.clampPoint(t.center,ud),ud.distanceToSquared(t.center)<=t.radius*t.radius},a.intersectsPlane=function(t){var s,l;return t.normal.x>0?(s=t.normal.x*this.min.x,l=t.normal.x*this.max.x):(s=t.normal.x*this.max.x,l=t.normal.x*this.min.x),t.normal.y>0?(s+=t.normal.y*this.min.y,l+=t.normal.y*this.max.y):(s+=t.normal.y*this.max.y,l+=t.normal.y*this.min.y),t.normal.z>0?(s+=t.normal.z*this.min.z,l+=t.normal.z*this.max.z):(s+=t.normal.z*this.max.z,l+=t.normal.z*this.min.z),s<=-t.constant&&l>=-t.constant},a.intersectsTriangle=function(t){if(this.isEmpty())return!1;this.getCenter(hd),Xp.subVectors(this.max,hd),qh.subVectors(t.a,hd),jh.subVectors(t.b,hd),Yh.subVectors(t.c,hd),Zc.subVectors(jh,qh),Jc.subVectors(Yh,jh),Vu.subVectors(qh,Yh);var s=[0,-Zc.z,Zc.y,0,-Jc.z,Jc.y,0,-Vu.z,Vu.y,Zc.z,0,-Zc.x,Jc.z,0,-Jc.x,Vu.z,0,-Vu.x,-Zc.y,Zc.x,0,-Jc.y,Jc.x,0,-Vu.y,Vu.x,0];return!nv(s,qh,jh,Yh,Xp)||(s=[1,0,0,0,1,0,0,0,1],!nv(s,qh,jh,Yh,Xp))?!1:(qp.crossVectors(Zc,Jc),s=[qp.x,qp.y,qp.z],nv(s,qh,jh,Yh,Xp))},a.clampPoint=function(t,s){return s===void 0&&(console.warn("THREE.Box3: .clampPoint() target is now required"),s=new pe),s.copy(t).clamp(this.min,this.max)},a.distanceToPoint=function(t){var s=ud.copy(t).clamp(this.min,this.max);return s.sub(t).length()},a.getBoundingSphere=function(t){return t===void 0&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(t.center),t.radius=this.getSize(ud).length()*.5,t},a.intersect=function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},a.union=function(t){return this.min.min(t.min),this.max.max(t.max),this},a.applyMatrix4=function(t){return this.isEmpty()?this:(lc[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),lc[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),lc[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),lc[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),lc[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),lc[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),lc[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),lc[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(lc),this)},a.translate=function(t){return this.min.add(t),this.max.add(t),this},a.equals=function(t){return t.min.equals(this.min)&&t.max.equals(this.max)},e}();function nv(e,a,t,s,l){for(var f=0,v=e.length-3;f<=v;f+=3){$c.fromArray(e,f);var x=l.x*Math.abs($c.x)+l.y*Math.abs($c.y)+l.z*Math.abs($c.z),w=a.dot($c),E=t.dot($c),P=s.dot($c);if(Math.max(-Math.max(w,E,P),Math.min(w,E,P))>x)return!1}return!0}var lc=[new pe,new pe,new pe,new pe,new pe,new pe,new pe,new pe],ud=new pe,iv=new Tl,qh=new pe,jh=new pe,Yh=new pe,Zc=new pe,Jc=new pe,Vu=new pe,hd=new pe,Xp=new pe,qp=new pe,$c=new pe,Kc=new Tl,ro=function(){function e(t,s){this.center=t!==void 0?t:new pe,this.radius=s!==void 0?s:-1}var a=e.prototype;return a.set=function(t,s){return this.center.copy(t),this.radius=s,this},a.setFromPoints=function(t,s){var l=this.center;s!==void 0?l.copy(s):Kc.setFromPoints(t).getCenter(l);for(var f=0,v=0,x=t.length;v<x;v++)f=Math.max(f,l.distanceToSquared(t[v]));return this.radius=Math.sqrt(f),this},a.clone=function(){return new this.constructor().copy(this)},a.copy=function(t){return this.center.copy(t.center),this.radius=t.radius,this},a.isEmpty=function(){return this.radius<0},a.makeEmpty=function(){return this.center.set(0,0,0),this.radius=-1,this},a.containsPoint=function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},a.distanceToPoint=function(t){return t.distanceTo(this.center)-this.radius},a.intersectsSphere=function(t){var s=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=s*s},a.intersectsBox=function(t){return t.intersectsSphere(this)},a.intersectsPlane=function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},a.clampPoint=function(t,s){var l=this.center.distanceToSquared(t);return s===void 0&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),s=new pe),s.copy(t),l>this.radius*this.radius&&(s.sub(this.center).normalize(),s.multiplyScalar(this.radius).add(this.center)),s},a.getBoundingBox=function(t){return t===void 0&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),t=new Tl),this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)},a.applyMatrix4=function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},a.translate=function(t){return this.center.add(t),this},a.equals=function(t){return t.center.equals(this.center)&&t.radius===this.radius},e}(),rl=new pe,cc=new pe,fd=new pe,Qc=new pe,Al=new pe,Ll=new pe,eu=new pe,sl=function(){function e(t,s){this.origin=t!==void 0?t:new pe,this.direction=s!==void 0?s:new pe(0,0,-1)}var a=e.prototype;return a.set=function(t,s){return this.origin.copy(t),this.direction.copy(s),this},a.clone=function(){return new this.constructor().copy(this)},a.copy=function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},a.at=function(t,s){return s===void 0&&(console.warn("THREE.Ray: .at() target is now required"),s=new pe),s.copy(this.direction).multiplyScalar(t).add(this.origin)},a.lookAt=function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},a.recast=function(t){return this.origin.copy(this.at(t,rl)),this},a.closestPointToPoint=function(t,s){s===void 0&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),s=new pe),s.subVectors(t,this.origin);var l=s.dot(this.direction);return l<0?s.copy(this.origin):s.copy(this.direction).multiplyScalar(l).add(this.origin)},a.distanceToPoint=function(t){return Math.sqrt(this.distanceSqToPoint(t))},a.distanceSqToPoint=function(t){var s=rl.subVectors(t,this.origin).dot(this.direction);return s<0?this.origin.distanceToSquared(t):(rl.copy(this.direction).multiplyScalar(s).add(this.origin),rl.distanceToSquared(t))},a.distanceSqToSegment=function(t,s,l,f){cc.copy(t).add(s).multiplyScalar(.5),fd.copy(s).sub(t).normalize(),Qc.copy(this.origin).sub(cc);var v=t.distanceTo(s)*.5,x=-this.direction.dot(fd),w=Qc.dot(this.direction),E=-Qc.dot(fd),P=Qc.lengthSq(),R=Math.abs(1-x*x),V,H,q,z;if(R>0)if(V=x*E-w,H=x*w-E,z=v*R,V>=0)if(H>=-z)if(H<=z){var G=1/R;V*=G,H*=G,q=V*(V+x*H+2*w)+H*(x*V+H+2*E)+P}else H=v,V=Math.max(0,-(x*H+w)),q=-V*V+H*(H+2*E)+P;else H=-v,V=Math.max(0,-(x*H+w)),q=-V*V+H*(H+2*E)+P;else H<=-z?(V=Math.max(0,-(-x*v+w)),H=V>0?-v:Math.min(Math.max(-v,-E),v),q=-V*V+H*(H+2*E)+P):H<=z?(V=0,H=Math.min(Math.max(-v,-E),v),q=H*(H+2*E)+P):(V=Math.max(0,-(x*v+w)),H=V>0?v:Math.min(Math.max(-v,-E),v),q=-V*V+H*(H+2*E)+P);else H=x>0?-v:v,V=Math.max(0,-(x*H+w)),q=-V*V+H*(H+2*E)+P;return l&&l.copy(this.direction).multiplyScalar(V).add(this.origin),f&&f.copy(fd).multiplyScalar(H).add(cc),q},a.intersectSphere=function(t,s){rl.subVectors(t.center,this.origin);var l=rl.dot(this.direction),f=rl.dot(rl)-l*l,v=t.radius*t.radius;if(f>v)return null;var x=Math.sqrt(v-f),w=l-x,E=l+x;return w<0&&E<0?null:w<0?this.at(E,s):this.at(w,s)},a.intersectsSphere=function(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius},a.distanceToPlane=function(t){var s=t.normal.dot(this.direction);if(s===0)return t.distanceToPoint(this.origin)===0?0:null;var l=-(this.origin.dot(t.normal)+t.constant)/s;return l>=0?l:null},a.intersectPlane=function(t,s){var l=this.distanceToPlane(t);return l===null?null:this.at(l,s)},a.intersectsPlane=function(t){var s=t.distanceToPoint(this.origin);if(s===0)return!0;var l=t.normal.dot(this.direction);return l*s<0},a.intersectBox=function(t,s){var l,f,v,x,w,E,P=1/this.direction.x,R=1/this.direction.y,V=1/this.direction.z,H=this.origin;return P>=0?(l=(t.min.x-H.x)*P,f=(t.max.x-H.x)*P):(l=(t.max.x-H.x)*P,f=(t.min.x-H.x)*P),R>=0?(v=(t.min.y-H.y)*R,x=(t.max.y-H.y)*R):(v=(t.max.y-H.y)*R,x=(t.min.y-H.y)*R),l>x||v>f||((v>l||l!==l)&&(l=v),(x<f||f!==f)&&(f=x),V>=0?(w=(t.min.z-H.z)*V,E=(t.max.z-H.z)*V):(w=(t.max.z-H.z)*V,E=(t.min.z-H.z)*V),l>E||w>f)||((w>l||l!==l)&&(l=w),(E<f||f!==f)&&(f=E),f<0)?null:this.at(l>=0?l:f,s)},a.intersectsBox=function(t){return this.intersectBox(t,rl)!==null},a.intersectTriangle=function(t,s,l,f,v){Al.subVectors(s,t),Ll.subVectors(l,t),eu.crossVectors(Al,Ll);var x=this.direction.dot(eu),w;if(x>0){if(f)return null;w=1}else if(x<0)w=-1,x=-x;else return null;Qc.subVectors(this.origin,t);var E=w*this.direction.dot(Ll.crossVectors(Qc,Ll));if(E<0)return null;var P=w*this.direction.dot(Al.cross(Qc));if(P<0||E+P>x)return null;var R=-w*Qc.dot(eu);return R<0?null:this.at(R/x,v)},a.applyMatrix4=function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},a.equals=function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)},e}(),wr=function(){function e(){Object.defineProperty(this,"isMatrix4",{value:!0}),this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}var a=e.prototype;return a.set=function(t,s,l,f,v,x,w,E,P,R,V,H,q,z,G,ie){var le=this.elements;return le[0]=t,le[4]=s,le[8]=l,le[12]=f,le[1]=v,le[5]=x,le[9]=w,le[13]=E,le[2]=P,le[6]=R,le[10]=V,le[14]=H,le[3]=q,le[7]=z,le[11]=G,le[15]=ie,this},a.identity=function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},a.clone=function(){return new e().fromArray(this.elements)},a.copy=function(t){var s=this.elements,l=t.elements;return s[0]=l[0],s[1]=l[1],s[2]=l[2],s[3]=l[3],s[4]=l[4],s[5]=l[5],s[6]=l[6],s[7]=l[7],s[8]=l[8],s[9]=l[9],s[10]=l[10],s[11]=l[11],s[12]=l[12],s[13]=l[13],s[14]=l[14],s[15]=l[15],this},a.copyPosition=function(t){var s=this.elements,l=t.elements;return s[12]=l[12],s[13]=l[13],s[14]=l[14],this},a.extractBasis=function(t,s,l){return t.setFromMatrixColumn(this,0),s.setFromMatrixColumn(this,1),l.setFromMatrixColumn(this,2),this},a.makeBasis=function(t,s,l){return this.set(t.x,s.x,l.x,0,t.y,s.y,l.y,0,t.z,s.z,l.z,0,0,0,0,1),this},a.extractRotation=function(t){var s=this.elements,l=t.elements,f=1/Wu.setFromMatrixColumn(t,0).length(),v=1/Wu.setFromMatrixColumn(t,1).length(),x=1/Wu.setFromMatrixColumn(t,2).length();return s[0]=l[0]*f,s[1]=l[1]*f,s[2]=l[2]*f,s[3]=0,s[4]=l[4]*v,s[5]=l[5]*v,s[6]=l[6]*v,s[7]=0,s[8]=l[8]*x,s[9]=l[9]*x,s[10]=l[10]*x,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,this},a.makeRotationFromEuler=function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var s=this.elements,l=t.x,f=t.y,v=t.z,x=Math.cos(l),w=Math.sin(l),E=Math.cos(f),P=Math.sin(f),R=Math.cos(v),V=Math.sin(v);if(t.order==="XYZ"){var H=x*R,q=x*V,z=w*R,G=w*V;s[0]=E*R,s[4]=-E*V,s[8]=P,s[1]=q+z*P,s[5]=H-G*P,s[9]=-w*E,s[2]=G-H*P,s[6]=z+q*P,s[10]=x*E}else if(t.order==="YXZ"){var ie=E*R,le=E*V,ae=P*R,J=P*V;s[0]=ie+J*w,s[4]=ae*w-le,s[8]=x*P,s[1]=x*V,s[5]=x*R,s[9]=-w,s[2]=le*w-ae,s[6]=J+ie*w,s[10]=x*E}else if(t.order==="ZXY"){var se=E*R,ge=E*V,_e=P*R,We=P*V;s[0]=se-We*w,s[4]=-x*V,s[8]=_e+ge*w,s[1]=ge+_e*w,s[5]=x*R,s[9]=We-se*w,s[2]=-x*P,s[6]=w,s[10]=x*E}else if(t.order==="ZYX"){var nt=x*R,Me=x*V,be=w*R,ve=w*V;s[0]=E*R,s[4]=be*P-Me,s[8]=nt*P+ve,s[1]=E*V,s[5]=ve*P+nt,s[9]=Me*P-be,s[2]=-P,s[6]=w*E,s[10]=x*E}else if(t.order==="YZX"){var Ze=x*E,Ke=x*P,Qe=w*E,Bt=w*P;s[0]=E*R,s[4]=Bt-Ze*V,s[8]=Qe*V+Ke,s[1]=V,s[5]=x*R,s[9]=-w*R,s[2]=-P*R,s[6]=Ke*V+Qe,s[10]=Ze-Bt*V}else if(t.order==="XZY"){var fn=x*E,un=x*P,Qt=w*E,Sn=w*P;s[0]=E*R,s[4]=-V,s[8]=P*R,s[1]=fn*V+Sn,s[5]=x*R,s[9]=un*V-Qt,s[2]=Qt*V-un,s[6]=w*R,s[10]=Sn*V+fn}return s[3]=0,s[7]=0,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,this},a.makeRotationFromQuaternion=function(t){return this.compose(Vw,t,tu)},a.lookAt=function(t,s,l){var f=this.elements;return So.subVectors(t,s),So.lengthSq()===0&&(So.z=1),So.normalize(),uc.crossVectors(l,So),uc.lengthSq()===0&&(Math.abs(l.z)===1?So.x+=1e-4:So.z+=1e-4,So.normalize(),uc.crossVectors(l,So)),uc.normalize(),jp.crossVectors(So,uc),f[0]=uc.x,f[4]=jp.x,f[8]=So.x,f[1]=uc.y,f[5]=jp.y,f[9]=So.y,f[2]=uc.z,f[6]=jp.z,f[10]=So.z,this},a.multiply=function(t,s){return s!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,s)):this.multiplyMatrices(this,t)},a.premultiply=function(t){return this.multiplyMatrices(t,this)},a.multiplyMatrices=function(t,s){var l=t.elements,f=s.elements,v=this.elements,x=l[0],w=l[4],E=l[8],P=l[12],R=l[1],V=l[5],H=l[9],q=l[13],z=l[2],G=l[6],ie=l[10],le=l[14],ae=l[3],J=l[7],se=l[11],ge=l[15],_e=f[0],We=f[4],nt=f[8],Me=f[12],be=f[1],ve=f[5],Ze=f[9],Ke=f[13],Qe=f[2],Bt=f[6],fn=f[10],un=f[14],Qt=f[3],Sn=f[7],ai=f[11],ei=f[15];return v[0]=x*_e+w*be+E*Qe+P*Qt,v[4]=x*We+w*ve+E*Bt+P*Sn,v[8]=x*nt+w*Ze+E*fn+P*ai,v[12]=x*Me+w*Ke+E*un+P*ei,v[1]=R*_e+V*be+H*Qe+q*Qt,v[5]=R*We+V*ve+H*Bt+q*Sn,v[9]=R*nt+V*Ze+H*fn+q*ai,v[13]=R*Me+V*Ke+H*un+q*ei,v[2]=z*_e+G*be+ie*Qe+le*Qt,v[6]=z*We+G*ve+ie*Bt+le*Sn,v[10]=z*nt+G*Ze+ie*fn+le*ai,v[14]=z*Me+G*Ke+ie*un+le*ei,v[3]=ae*_e+J*be+se*Qe+ge*Qt,v[7]=ae*We+J*ve+se*Bt+ge*Sn,v[11]=ae*nt+J*Ze+se*fn+ge*ai,v[15]=ae*Me+J*Ke+se*un+ge*ei,this},a.multiplyScalar=function(t){var s=this.elements;return s[0]*=t,s[4]*=t,s[8]*=t,s[12]*=t,s[1]*=t,s[5]*=t,s[9]*=t,s[13]*=t,s[2]*=t,s[6]*=t,s[10]*=t,s[14]*=t,s[3]*=t,s[7]*=t,s[11]*=t,s[15]*=t,this},a.determinant=function(){var t=this.elements,s=t[0],l=t[4],f=t[8],v=t[12],x=t[1],w=t[5],E=t[9],P=t[13],R=t[2],V=t[6],H=t[10],q=t[14],z=t[3],G=t[7],ie=t[11],le=t[15];return z*(+v*E*V-f*P*V-v*w*H+l*P*H+f*w*q-l*E*q)+G*(+s*E*q-s*P*H+v*x*H-f*x*q+f*P*R-v*E*R)+ie*(+s*P*V-s*w*q-v*x*V+l*x*q+v*w*R-l*P*R)+le*(-f*w*R-s*E*V+s*w*H+f*x*V-l*x*H+l*E*R)},a.transpose=function(){var t=this.elements,s=t[1];return t[1]=t[4],t[4]=s,s=t[2],t[2]=t[8],t[8]=s,s=t[6],t[6]=t[9],t[9]=s,s=t[3],t[3]=t[12],t[12]=s,s=t[7],t[7]=t[13],t[13]=s,s=t[11],t[11]=t[14],t[14]=s,this},a.setPosition=function(t,s,l){var f=this.elements;return t.isVector3?(f[12]=t.x,f[13]=t.y,f[14]=t.z):(f[12]=t,f[13]=s,f[14]=l),this},a.getInverse=function(t,s){s!==void 0&&console.warn("THREE.Matrix4: .getInverse() can no longer be configured to throw on degenerate.");var l=this.elements,f=t.elements,v=f[0],x=f[1],w=f[2],E=f[3],P=f[4],R=f[5],V=f[6],H=f[7],q=f[8],z=f[9],G=f[10],ie=f[11],le=f[12],ae=f[13],J=f[14],se=f[15],ge=z*J*H-ae*G*H+ae*V*ie-R*J*ie-z*V*se+R*G*se,_e=le*G*H-q*J*H-le*V*ie+P*J*ie+q*V*se-P*G*se,We=q*ae*H-le*z*H+le*R*ie-P*ae*ie-q*R*se+P*z*se,nt=le*z*V-q*ae*V-le*R*G+P*ae*G+q*R*J-P*z*J,Me=v*ge+x*_e+w*We+E*nt;if(Me===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);var be=1/Me;return l[0]=ge*be,l[1]=(ae*G*E-z*J*E-ae*w*ie+x*J*ie+z*w*se-x*G*se)*be,l[2]=(R*J*E-ae*V*E+ae*w*H-x*J*H-R*w*se+x*V*se)*be,l[3]=(z*V*E-R*G*E-z*w*H+x*G*H+R*w*ie-x*V*ie)*be,l[4]=_e*be,l[5]=(q*J*E-le*G*E+le*w*ie-v*J*ie-q*w*se+v*G*se)*be,l[6]=(le*V*E-P*J*E-le*w*H+v*J*H+P*w*se-v*V*se)*be,l[7]=(P*G*E-q*V*E+q*w*H-v*G*H-P*w*ie+v*V*ie)*be,l[8]=We*be,l[9]=(le*z*E-q*ae*E-le*x*ie+v*ae*ie+q*x*se-v*z*se)*be,l[10]=(P*ae*E-le*R*E+le*x*H-v*ae*H-P*x*se+v*R*se)*be,l[11]=(q*R*E-P*z*E-q*x*H+v*z*H+P*x*ie-v*R*ie)*be,l[12]=nt*be,l[13]=(q*ae*w-le*z*w+le*x*G-v*ae*G-q*x*J+v*z*J)*be,l[14]=(le*R*w-P*ae*w-le*x*V+v*ae*V+P*x*J-v*R*J)*be,l[15]=(P*z*w-q*R*w+q*x*V-v*z*V-P*x*G+v*R*G)*be,this},a.scale=function(t){var s=this.elements,l=t.x,f=t.y,v=t.z;return s[0]*=l,s[4]*=f,s[8]*=v,s[1]*=l,s[5]*=f,s[9]*=v,s[2]*=l,s[6]*=f,s[10]*=v,s[3]*=l,s[7]*=f,s[11]*=v,this},a.getMaxScaleOnAxis=function(){var t=this.elements,s=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],l=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],f=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(s,l,f))},a.makeTranslation=function(t,s,l){return this.set(1,0,0,t,0,1,0,s,0,0,1,l,0,0,0,1),this},a.makeRotationX=function(t){var s=Math.cos(t),l=Math.sin(t);return this.set(1,0,0,0,0,s,-l,0,0,l,s,0,0,0,0,1),this},a.makeRotationY=function(t){var s=Math.cos(t),l=Math.sin(t);return this.set(s,0,l,0,0,1,0,0,-l,0,s,0,0,0,0,1),this},a.makeRotationZ=function(t){var s=Math.cos(t),l=Math.sin(t);return this.set(s,-l,0,0,l,s,0,0,0,0,1,0,0,0,0,1),this},a.makeRotationAxis=function(t,s){var l=Math.cos(s),f=Math.sin(s),v=1-l,x=t.x,w=t.y,E=t.z,P=v*x,R=v*w;return this.set(P*x+l,P*w-f*E,P*E+f*w,0,P*w+f*E,R*w+l,R*E-f*x,0,P*E-f*w,R*E+f*x,v*E*E+l,0,0,0,0,1),this},a.makeScale=function(t,s,l){return this.set(t,0,0,0,0,s,0,0,0,0,l,0,0,0,0,1),this},a.makeShear=function(t,s,l){return this.set(1,s,l,0,t,1,l,0,t,s,1,0,0,0,0,1),this},a.compose=function(t,s,l){var f=this.elements,v=s._x,x=s._y,w=s._z,E=s._w,P=v+v,R=x+x,V=w+w,H=v*P,q=v*R,z=v*V,G=x*R,ie=x*V,le=w*V,ae=E*P,J=E*R,se=E*V,ge=l.x,_e=l.y,We=l.z;return f[0]=(1-(G+le))*ge,f[1]=(q+se)*ge,f[2]=(z-J)*ge,f[3]=0,f[4]=(q-se)*_e,f[5]=(1-(H+le))*_e,f[6]=(ie+ae)*_e,f[7]=0,f[8]=(z+J)*We,f[9]=(ie-ae)*We,f[10]=(1-(H+G))*We,f[11]=0,f[12]=t.x,f[13]=t.y,f[14]=t.z,f[15]=1,this},a.decompose=function(t,s,l){var f=this.elements,v=Wu.set(f[0],f[1],f[2]).length(),x=Wu.set(f[4],f[5],f[6]).length(),w=Wu.set(f[8],f[9],f[10]).length(),E=this.determinant();E<0&&(v=-v),t.x=f[12],t.y=f[13],t.z=f[14],al.copy(this);var P=1/v,R=1/x,V=1/w;return al.elements[0]*=P,al.elements[1]*=P,al.elements[2]*=P,al.elements[4]*=R,al.elements[5]*=R,al.elements[6]*=R,al.elements[8]*=V,al.elements[9]*=V,al.elements[10]*=V,s.setFromRotationMatrix(al),l.x=v,l.y=x,l.z=w,this},a.makePerspective=function(t,s,l,f,v,x){x===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var w=this.elements;return w[0]=2*v/(s-t),w[4]=0,w[8]=(s+t)/(s-t),w[12]=0,w[1]=0,w[5]=2*v/(l-f),w[9]=(l+f)/(l-f),w[13]=0,w[2]=0,w[6]=0,w[10]=-(x+v)/(x-v),w[14]=-2*x*v/(x-v),w[3]=0,w[7]=0,w[11]=-1,w[15]=0,this},a.makeOrthographic=function(t,s,l,f,v,x){var w=this.elements,E=1/(s-t),P=1/(l-f),R=1/(x-v);return w[0]=2*E,w[4]=0,w[8]=0,w[12]=-((s+t)*E),w[1]=0,w[5]=2*P,w[9]=0,w[13]=-((l+f)*P),w[2]=0,w[6]=0,w[10]=-2*R,w[14]=-((x+v)*R),w[3]=0,w[7]=0,w[11]=0,w[15]=1,this},a.equals=function(t){for(var s=this.elements,l=t.elements,f=0;f<16;f++)if(s[f]!==l[f])return!1;return!0},a.fromArray=function(t,s){s===void 0&&(s=0);for(var l=0;l<16;l++)this.elements[l]=t[l+s];return this},a.toArray=function(t,s){t===void 0&&(t=[]),s===void 0&&(s=0);var l=this.elements;return t[s]=l[0],t[s+1]=l[1],t[s+2]=l[2],t[s+3]=l[3],t[s+4]=l[4],t[s+5]=l[5],t[s+6]=l[6],t[s+7]=l[7],t[s+8]=l[8],t[s+9]=l[9],t[s+10]=l[10],t[s+11]=l[11],t[s+12]=l[12],t[s+13]=l[13],t[s+14]=l[14],t[s+15]=l[15],t},e}(),Wu=new pe,al=new wr,Vw=new pe(0,0,0),tu=new pe(1,1,1),uc=new pe,jp=new pe,So=new pe,Yp=function(){function e(t,s,l,f){t===void 0&&(t=0),s===void 0&&(s=0),l===void 0&&(l=0),f===void 0&&(f=e.DefaultOrder),Object.defineProperty(this,"isEuler",{value:!0}),this._x=t,this._y=s,this._z=l,this._order=f}var a=e.prototype;return a.set=function(t,s,l,f){return this._x=t,this._y=s,this._z=l,this._order=f||this._order,this._onChangeCallback(),this},a.clone=function(){return new this.constructor(this._x,this._y,this._z,this._order)},a.copy=function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this},a.setFromRotationMatrix=function(t,s,l){var f=nr.clamp,v=t.elements,x=v[0],w=v[4],E=v[8],P=v[1],R=v[5],V=v[9],H=v[2],q=v[6],z=v[10];switch(s=s||this._order,s){case"XYZ":this._y=Math.asin(f(E,-1,1)),Math.abs(E)<.9999999?(this._x=Math.atan2(-V,z),this._z=Math.atan2(-w,x)):(this._x=Math.atan2(q,R),this._z=0);break;case"YXZ":this._x=Math.asin(-f(V,-1,1)),Math.abs(V)<.9999999?(this._y=Math.atan2(E,z),this._z=Math.atan2(P,R)):(this._y=Math.atan2(-H,x),this._z=0);break;case"ZXY":this._x=Math.asin(f(q,-1,1)),Math.abs(q)<.9999999?(this._y=Math.atan2(-H,z),this._z=Math.atan2(-w,R)):(this._y=0,this._z=Math.atan2(P,x));break;case"ZYX":this._y=Math.asin(-f(H,-1,1)),Math.abs(H)<.9999999?(this._x=Math.atan2(q,z),this._z=Math.atan2(P,x)):(this._x=0,this._z=Math.atan2(-w,R));break;case"YZX":this._z=Math.asin(f(P,-1,1)),Math.abs(P)<.9999999?(this._x=Math.atan2(-V,R),this._y=Math.atan2(-H,x)):(this._x=0,this._y=Math.atan2(E,z));break;case"XZY":this._z=Math.asin(-f(w,-1,1)),Math.abs(w)<.9999999?(this._x=Math.atan2(q,R),this._y=Math.atan2(E,x)):(this._x=Math.atan2(-V,z),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+s)}return this._order=s,l!==!1&&this._onChangeCallback(),this},a.setFromQuaternion=function(t,s,l){return rv.makeRotationFromQuaternion(t),this.setFromRotationMatrix(rv,s,l)},a.setFromVector3=function(t,s){return this.set(t.x,t.y,t.z,s||this._order)},a.reorder=function(t){return sv.setFromEuler(this),this.setFromQuaternion(sv,t)},a.equals=function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},a.fromArray=function(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this},a.toArray=function(t,s){return t===void 0&&(t=[]),s===void 0&&(s=0),t[s]=this._x,t[s+1]=this._y,t[s+2]=this._z,t[s+3]=this._order,t},a.toVector3=function(t){return t?t.set(this._x,this._y,this._z):new pe(this._x,this._y,this._z)},a._onChange=function(t){return this._onChangeCallback=t,this},a._onChangeCallback=function(){},cd(e,[{key:"x",get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},{key:"order",get:function(){return this._order},set:function(t){this._order=t,this._onChangeCallback()}}]),e}();Yp.DefaultOrder="XYZ",Yp.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];var rv=new wr,sv=new ka,av=function(){function e(){this.mask=1}var a=e.prototype;return a.set=function(t){this.mask=1<<t|0},a.enable=function(t){this.mask|=1<<t|0},a.enableAll=function(){this.mask=-1},a.toggle=function(t){this.mask^=1<<t|0},a.disable=function(t){this.mask&=~(1<<t|0)},a.disableAll=function(){this.mask=0},a.test=function(t){return(this.mask&t.mask)!==0},e}(),Ww=0,J0=new pe,Zh=new ka,hc=new wr,Zp=new pe,ia=new pe,nu=new pe,$0=new ka,Jp=new pe(1,0,0),Cl=new pe(0,1,0),ov=new pe(0,0,1),Jh={type:"added"},lv={type:"removed"};function Ei(){Object.defineProperty(this,"id",{value:Ww++}),this.uuid=nr.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Ei.DefaultUp.clone();var e=new pe,a=new Yp,t=new ka,s=new pe(1,1,1);a._onChange(function(){t.setFromEuler(a,!1)}),t._onChange(function(){a.setFromQuaternion(t,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:a},quaternion:{configurable:!0,enumerable:!0,value:t},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new wr},normalMatrix:{value:new qa}}),this.matrix=new wr,this.matrixWorld=new wr,this.matrixAutoUpdate=Ei.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new av,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}Ei.DefaultUp=new pe(0,1,0),Ei.DefaultMatrixAutoUpdate=!0,Ei.prototype=Object.assign(Object.create(il.prototype),{constructor:Ei,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,a){this.quaternion.setFromAxisAngle(e,a)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(e,a){return Zh.setFromAxisAngle(e,a),this.quaternion.multiply(Zh),this},rotateOnWorldAxis:function(e,a){return Zh.setFromAxisAngle(e,a),this.quaternion.premultiply(Zh),this},rotateX:function(e){return this.rotateOnAxis(Jp,e)},rotateY:function(e){return this.rotateOnAxis(Cl,e)},rotateZ:function(e){return this.rotateOnAxis(ov,e)},translateOnAxis:function(e,a){return J0.copy(e).applyQuaternion(this.quaternion),this.position.add(J0.multiplyScalar(a)),this},translateX:function(e){return this.translateOnAxis(Jp,e)},translateY:function(e){return this.translateOnAxis(Cl,e)},translateZ:function(e){return this.translateOnAxis(ov,e)},localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(e){return e.applyMatrix4(hc.getInverse(this.matrixWorld))},lookAt:function(e,a,t){e.isVector3?Zp.copy(e):Zp.set(e,a,t);var s=this.parent;this.updateWorldMatrix(!0,!1),ia.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?hc.lookAt(ia,Zp,this.up):hc.lookAt(Zp,ia,this.up),this.quaternion.setFromRotationMatrix(hc),s&&(hc.extractRotation(s.matrixWorld),Zh.setFromRotationMatrix(hc),this.quaternion.premultiply(Zh.inverse()))},add:function(e){if(arguments.length>1){for(var a=0;a<arguments.length;a++)this.add(arguments[a]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(Jh)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)},remove:function(e){if(arguments.length>1){for(var a=0;a<arguments.length;a++)this.remove(arguments[a]);return this}var t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(lv)),this},attach:function(e){return this.updateWorldMatrix(!0,!1),hc.getInverse(this.matrixWorld),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),hc.multiply(e.parent.matrixWorld)),e.applyMatrix4(hc),e.updateWorldMatrix(!1,!1),this.add(e),this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,a){if(this[e]===a)return this;for(var t=0,s=this.children.length;t<s;t++){var l=this.children[t],f=l.getObjectByProperty(e,a);if(f!==void 0)return f}},getWorldPosition:function(e){return e===void 0&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),e=new pe),this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(e){return e===void 0&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),e=new ka),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ia,e,nu),e},getWorldScale:function(e){return e===void 0&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),e=new pe),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ia,$0,e),e},getWorldDirection:function(e){e===void 0&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),e=new pe),this.updateWorldMatrix(!0,!1);var a=this.matrixWorld.elements;return e.set(a[8],a[9],a[10]).normalize()},raycast:function(){},traverse:function(e){e(this);for(var a=this.children,t=0,s=a.length;t<s;t++)a[t].traverse(e)},traverseVisible:function(e){if(this.visible!==!1){e(this);for(var a=this.children,t=0,s=a.length;t<s;t++)a[t].traverseVisible(e)}},traverseAncestors:function(e){var a=this.parent;a!==null&&(e(a),a.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var a=this.children,t=0,s=a.length;t<s;t++)a[t].updateMatrixWorld(e)},updateWorldMatrix:function(e,a){var t=this.parent;if(e===!0&&t!==null&&t.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),a===!0)for(var s=this.children,l=0,f=s.length;l<f;l++)s[l].updateWorldMatrix(!1,!0)},toJSON:function(e){var a=e===void 0||typeof e=="string",t={};a&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{}},t.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var s={};s.uuid=this.uuid,s.type=this.type,this.name!==""&&(s.name=this.name),this.castShadow===!0&&(s.castShadow=!0),this.receiveShadow===!0&&(s.receiveShadow=!0),this.visible===!1&&(s.visible=!1),this.frustumCulled===!1&&(s.frustumCulled=!1),this.renderOrder!==0&&(s.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON());function l(J,se){return J[se.uuid]===void 0&&(J[se.uuid]=se.toJSON(e)),se.uuid}if(this.isMesh||this.isLine||this.isPoints){s.geometry=l(e.geometries,this.geometry);var f=this.geometry.parameters;if(f!==void 0&&f.shapes!==void 0){var v=f.shapes;if(Array.isArray(v))for(var x=0,w=v.length;x<w;x++){var E=v[x];l(e.shapes,E)}else l(e.shapes,v)}}if(this.material!==void 0)if(Array.isArray(this.material)){for(var P=[],R=0,V=this.material.length;R<V;R++)P.push(l(e.materials,this.material[R]));s.material=P}else s.material=l(e.materials,this.material);if(this.children.length>0){s.children=[];for(var H=0;H<this.children.length;H++)s.children.push(this.children[H].toJSON(e).object)}if(a){var q=ae(e.geometries),z=ae(e.materials),G=ae(e.textures),ie=ae(e.images),le=ae(e.shapes);q.length>0&&(t.geometries=q),z.length>0&&(t.materials=z),G.length>0&&(t.textures=G),ie.length>0&&(t.images=ie),le.length>0&&(t.shapes=le)}return t.object=s,t;function ae(J){var se=[];for(var ge in J){var _e=J[ge];delete _e.metadata,se.push(_e)}return se}},clone:function(e){return new this.constructor().copy(this,e)},copy:function(e,a){if(a===void 0&&(a=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),a===!0)for(var t=0;t<e.children.length;t++){var s=e.children[t];this.add(s.clone())}return this}});var $p=new pe,K0=new pe,Q0=new qa,so=function(){function e(t,s){Object.defineProperty(this,"isPlane",{value:!0}),this.normal=t!==void 0?t:new pe(1,0,0),this.constant=s!==void 0?s:0}var a=e.prototype;return a.set=function(t,s){return this.normal.copy(t),this.constant=s,this},a.setComponents=function(t,s,l,f){return this.normal.set(t,s,l),this.constant=f,this},a.setFromNormalAndCoplanarPoint=function(t,s){return this.normal.copy(t),this.constant=-s.dot(this.normal),this},a.setFromCoplanarPoints=function(t,s,l){var f=$p.subVectors(l,s).cross(K0.subVectors(t,s)).normalize();return this.setFromNormalAndCoplanarPoint(f,t),this},a.clone=function(){return new this.constructor().copy(this)},a.copy=function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},a.normalize=function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},a.negate=function(){return this.constant*=-1,this.normal.negate(),this},a.distanceToPoint=function(t){return this.normal.dot(t)+this.constant},a.distanceToSphere=function(t){return this.distanceToPoint(t.center)-t.radius},a.projectPoint=function(t,s){return s===void 0&&(console.warn("THREE.Plane: .projectPoint() target is now required"),s=new pe),s.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},a.intersectLine=function(t,s){s===void 0&&(console.warn("THREE.Plane: .intersectLine() target is now required"),s=new pe);var l=t.delta($p),f=this.normal.dot(l);if(f===0)return this.distanceToPoint(t.start)===0?s.copy(t.start):void 0;var v=-(t.start.dot(this.normal)+this.constant)/f;if(!(v<0||v>1))return s.copy(l).multiplyScalar(v).add(t.start)},a.intersectsLine=function(t){var s=this.distanceToPoint(t.start),l=this.distanceToPoint(t.end);return s<0&&l>0||l<0&&s>0},a.intersectsBox=function(t){return t.intersectsPlane(this)},a.intersectsSphere=function(t){return t.intersectsPlane(this)},a.coplanarPoint=function(t){return t===void 0&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),t=new pe),t.copy(this.normal).multiplyScalar(-this.constant)},a.applyMatrix4=function(t,s){var l=s||Q0.getNormalMatrix(t),f=this.coplanarPoint($p).applyMatrix4(t),v=this.normal.applyMatrix3(l).normalize();return this.constant=-f.dot(v),this},a.translate=function(t){return this.constant-=t.dot(this.normal),this},a.equals=function(t){return t.normal.equals(this.normal)&&t.constant===this.constant},e}(),Ma=new pe,Pl=new pe,Rl=new pe,ao=new pe,$h=new pe,Xu=new pe,ex=new pe,cv=new pe,Kh=new pe,qu=new pe,zo=function(){function e(t,s,l){this.a=t!==void 0?t:new pe,this.b=s!==void 0?s:new pe,this.c=l!==void 0?l:new pe}e.getNormal=function(t,s,l,f){f===void 0&&(console.warn("THREE.Triangle: .getNormal() target is now required"),f=new pe),f.subVectors(l,s),Ma.subVectors(t,s),f.cross(Ma);var v=f.lengthSq();return v>0?f.multiplyScalar(1/Math.sqrt(v)):f.set(0,0,0)},e.getBarycoord=function(t,s,l,f,v){Ma.subVectors(f,s),Pl.subVectors(l,s),Rl.subVectors(t,s);var x=Ma.dot(Ma),w=Ma.dot(Pl),E=Ma.dot(Rl),P=Pl.dot(Pl),R=Pl.dot(Rl),V=x*P-w*w;if(v===void 0&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),v=new pe),V===0)return v.set(-2,-1,-1);var H=1/V,q=(P*E-w*R)*H,z=(x*R-w*E)*H;return v.set(1-q-z,z,q)},e.containsPoint=function(t,s,l,f){return this.getBarycoord(t,s,l,f,ao),ao.x>=0&&ao.y>=0&&ao.x+ao.y<=1},e.getUV=function(t,s,l,f,v,x,w,E){return this.getBarycoord(t,s,l,f,ao),E.set(0,0),E.addScaledVector(v,ao.x),E.addScaledVector(x,ao.y),E.addScaledVector(w,ao.z),E},e.isFrontFacing=function(t,s,l,f){return Ma.subVectors(l,s),Pl.subVectors(t,s),Ma.cross(Pl).dot(f)<0};var a=e.prototype;return a.set=function(t,s,l){return this.a.copy(t),this.b.copy(s),this.c.copy(l),this},a.setFromPointsAndIndices=function(t,s,l,f){return this.a.copy(t[s]),this.b.copy(t[l]),this.c.copy(t[f]),this},a.clone=function(){return new this.constructor().copy(this)},a.copy=function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},a.getArea=function(){return Ma.subVectors(this.c,this.b),Pl.subVectors(this.a,this.b),Ma.cross(Pl).length()*.5},a.getMidpoint=function(t){return t===void 0&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),t=new pe),t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},a.getNormal=function(t){return e.getNormal(this.a,this.b,this.c,t)},a.getPlane=function(t){return t===void 0&&(console.warn("THREE.Triangle: .getPlane() target is now required"),t=new so),t.setFromCoplanarPoints(this.a,this.b,this.c)},a.getBarycoord=function(t,s){return e.getBarycoord(t,this.a,this.b,this.c,s)},a.getUV=function(t,s,l,f,v){return e.getUV(t,this.a,this.b,this.c,s,l,f,v)},a.containsPoint=function(t){return e.containsPoint(t,this.a,this.b,this.c)},a.isFrontFacing=function(t){return e.isFrontFacing(this.a,this.b,this.c,t)},a.intersectsBox=function(t){return t.intersectsTriangle(this)},a.closestPointToPoint=function(t,s){s===void 0&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),s=new pe);var l=this.a,f=this.b,v=this.c,x,w;$h.subVectors(f,l),Xu.subVectors(v,l),cv.subVectors(t,l);var E=$h.dot(cv),P=Xu.dot(cv);if(E<=0&&P<=0)return s.copy(l);Kh.subVectors(t,f);var R=$h.dot(Kh),V=Xu.dot(Kh);if(R>=0&&V<=R)return s.copy(f);var H=E*V-R*P;if(H<=0&&E>=0&&R<=0)return x=E/(E-R),s.copy(l).addScaledVector($h,x);qu.subVectors(t,v);var q=$h.dot(qu),z=Xu.dot(qu);if(z>=0&&q<=z)return s.copy(v);var G=q*P-E*z;if(G<=0&&P>=0&&z<=0)return w=P/(P-z),s.copy(l).addScaledVector(Xu,w);var ie=R*z-q*V;if(ie<=0&&V-R>=0&&q-z>=0)return ex.subVectors(v,f),w=(V-R)/(V-R+(q-z)),s.copy(f).addScaledVector(ex,w);var le=1/(ie+G+H);return x=G*le,w=H*le,s.copy(l).addScaledVector($h,x).addScaledVector(Xu,w)},a.equals=function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)},e}(),uv={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Uo={h:0,s:0,l:0},Qh={h:0,s:0,l:0};function dd(e,a,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?e+(a-e)*6*t:t<1/2?a:t<2/3?e+(a-e)*6*(2/3-t):e}function ju(e){return e<.04045?e*.0773993808:Math.pow(e*.9478672986+.0521327014,2.4)}function ef(e){return e<.0031308?e*12.92:1.055*Math.pow(e,.41666)-.055}var mi=function(){function e(t,s,l){return Object.defineProperty(this,"isColor",{value:!0}),s===void 0&&l===void 0?this.set(t):this.setRGB(t,s,l)}var a=e.prototype;return a.set=function(t){return t&&t.isColor?this.copy(t):typeof t=="number"?this.setHex(t):typeof t=="string"&&this.setStyle(t),this},a.setScalar=function(t){return this.r=t,this.g=t,this.b=t,this},a.setHex=function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(t&255)/255,this},a.setRGB=function(t,s,l){return this.r=t,this.g=s,this.b=l,this},a.setHSL=function(t,s,l){if(t=nr.euclideanModulo(t,1),s=nr.clamp(s,0,1),l=nr.clamp(l,0,1),s===0)this.r=this.g=this.b=l;else{var f=l<=.5?l*(1+s):l+s-l*s,v=2*l-f;this.r=dd(v,f,t+1/3),this.g=dd(v,f,t),this.b=dd(v,f,t-1/3)}return this},a.setStyle=function(t){function s(H){H!==void 0&&parseFloat(H)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}var l;if(l=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var f,v=l[1],x=l[2];switch(v){case"rgb":case"rgba":if(f=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(x))return this.r=Math.min(255,parseInt(f[1],10))/255,this.g=Math.min(255,parseInt(f[2],10))/255,this.b=Math.min(255,parseInt(f[3],10))/255,s(f[5]),this;if(f=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(x))return this.r=Math.min(100,parseInt(f[1],10))/100,this.g=Math.min(100,parseInt(f[2],10))/100,this.b=Math.min(100,parseInt(f[3],10))/100,s(f[5]),this;break;case"hsl":case"hsla":if(f=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(x)){var w=parseFloat(f[1])/360,E=parseInt(f[2],10)/100,P=parseInt(f[3],10)/100;return s(f[5]),this.setHSL(w,E,P)}break}}else if(l=/^\#([A-Fa-f0-9]+)$/.exec(t)){var R=l[1],V=R.length;if(V===3)return this.r=parseInt(R.charAt(0)+R.charAt(0),16)/255,this.g=parseInt(R.charAt(1)+R.charAt(1),16)/255,this.b=parseInt(R.charAt(2)+R.charAt(2),16)/255,this;if(V===6)return this.r=parseInt(R.charAt(0)+R.charAt(1),16)/255,this.g=parseInt(R.charAt(2)+R.charAt(3),16)/255,this.b=parseInt(R.charAt(4)+R.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this},a.setColorName=function(t){var s=uv[t];return s!==void 0?this.setHex(s):console.warn("THREE.Color: Unknown color "+t),this},a.clone=function(){return new this.constructor(this.r,this.g,this.b)},a.copy=function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},a.copyGammaToLinear=function(t,s){return s===void 0&&(s=2),this.r=Math.pow(t.r,s),this.g=Math.pow(t.g,s),this.b=Math.pow(t.b,s),this},a.copyLinearToGamma=function(t,s){s===void 0&&(s=2);var l=s>0?1/s:1;return this.r=Math.pow(t.r,l),this.g=Math.pow(t.g,l),this.b=Math.pow(t.b,l),this},a.convertGammaToLinear=function(t){return this.copyGammaToLinear(this,t),this},a.convertLinearToGamma=function(t){return this.copyLinearToGamma(this,t),this},a.copySRGBToLinear=function(t){return this.r=ju(t.r),this.g=ju(t.g),this.b=ju(t.b),this},a.copyLinearToSRGB=function(t){return this.r=ef(t.r),this.g=ef(t.g),this.b=ef(t.b),this},a.convertSRGBToLinear=function(){return this.copySRGBToLinear(this),this},a.convertLinearToSRGB=function(){return this.copyLinearToSRGB(this),this},a.getHex=function(){return this.r*255<<16^this.g*255<<8^this.b*255<<0},a.getHexString=function(){return("000000"+this.getHex().toString(16)).slice(-6)},a.getHSL=function(t){t===void 0&&(console.warn("THREE.Color: .getHSL() target is now required"),t={h:0,s:0,l:0});var s=this.r,l=this.g,f=this.b,v=Math.max(s,l,f),x=Math.min(s,l,f),w,E,P=(x+v)/2;if(x===v)w=0,E=0;else{var R=v-x;switch(E=P<=.5?R/(v+x):R/(2-v-x),v){case s:w=(l-f)/R+(l<f?6:0);break;case l:w=(f-s)/R+2;break;case f:w=(s-l)/R+4;break}w/=6}return t.h=w,t.s=E,t.l=P,t},a.getStyle=function(){return"rgb("+(this.r*255|0)+","+(this.g*255|0)+","+(this.b*255|0)+")"},a.offsetHSL=function(t,s,l){return this.getHSL(Uo),Uo.h+=t,Uo.s+=s,Uo.l+=l,this.setHSL(Uo.h,Uo.s,Uo.l),this},a.add=function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},a.addColors=function(t,s){return this.r=t.r+s.r,this.g=t.g+s.g,this.b=t.b+s.b,this},a.addScalar=function(t){return this.r+=t,this.g+=t,this.b+=t,this},a.sub=function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},a.multiply=function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},a.multiplyScalar=function(t){return this.r*=t,this.g*=t,this.b*=t,this},a.lerp=function(t,s){return this.r+=(t.r-this.r)*s,this.g+=(t.g-this.g)*s,this.b+=(t.b-this.b)*s,this},a.lerpHSL=function(t,s){this.getHSL(Uo),t.getHSL(Qh);var l=nr.lerp(Uo.h,Qh.h,s),f=nr.lerp(Uo.s,Qh.s,s),v=nr.lerp(Uo.l,Qh.l,s);return this.setHSL(l,f,v),this},a.equals=function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},a.fromArray=function(t,s){return s===void 0&&(s=0),this.r=t[s],this.g=t[s+1],this.b=t[s+2],this},a.toArray=function(t,s){return t===void 0&&(t=[]),s===void 0&&(s=0),t[s]=this.r,t[s+1]=this.g,t[s+2]=this.b,t},a.fromBufferAttribute=function(t,s){return this.r=t.getX(s),this.g=t.getY(s),this.b=t.getZ(s),t.normalized===!0&&(this.r/=255,this.g/=255,this.b/=255),this},a.toJSON=function(){return this.getHex()},e}();mi.NAMES=uv,mi.prototype.r=1,mi.prototype.g=1,mi.prototype.b=1;var pd=function(){function e(t,s,l,f,v,x){this.a=t,this.b=s,this.c=l,this.normal=f&&f.isVector3?f:new pe,this.vertexNormals=Array.isArray(f)?f:[],this.color=v&&v.isColor?v:new mi,this.vertexColors=Array.isArray(v)?v:[],this.materialIndex=x!==void 0?x:0}var a=e.prototype;return a.clone=function(){return new this.constructor().copy(this)},a.copy=function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var s=0,l=t.vertexNormals.length;s<l;s++)this.vertexNormals[s]=t.vertexNormals[s].clone();for(var f=0,v=t.vertexColors.length;f<v;f++)this.vertexColors[f]=t.vertexColors[f].clone();return this},e}(),Yu=0;function zi(){Object.defineProperty(this,"id",{value:Yu++}),this.uuid=nr.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=ne,this.side=F,this.flatShading=!1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=rt,this.blendDst=je,this.blendEquation=Re,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=vi,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=ev,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Yc,this.stencilZFail=Yc,this.stencilZPass=Yc,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}zi.prototype=Object.assign(Object.create(il.prototype),{constructor:zi,isMaterial:!0,onBeforeCompile:function(){},customProgramCacheKey:function(){return this.onBeforeCompile.toString()},setValues:function(e){if(e!==void 0)for(var a in e){var t=e[a];if(t===void 0){console.warn("THREE.Material: '"+a+"' parameter is undefined.");continue}if(a==="shading"){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=t===N;continue}var s=this[a];if(s===void 0){console.warn("THREE."+this.type+": '"+a+"' is not a property of this material.");continue}s&&s.isColor?s.set(t):s&&s.isVector3&&t&&t.isVector3?s.copy(t):this[a]=t}},toJSON:function(e){var a=e===void 0||typeof e=="string";a&&(e={textures:{},images:{}});var t={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),this.color&&this.color.isColor&&(t.color=this.color.getHex()),this.roughness!==void 0&&(t.roughness=this.roughness),this.metalness!==void 0&&(t.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(t.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(t.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(t.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(t.specular=this.specular.getHex()),this.shininess!==void 0&&(t.shininess=this.shininess),this.clearcoat!==void 0&&(t.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(t.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(t.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(t.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(t.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,t.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(t.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(t.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(t.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(t.lightMap=this.lightMap.toJSON(e).uuid),this.aoMap&&this.aoMap.isTexture&&(t.aoMap=this.aoMap.toJSON(e).uuid,t.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(t.bumpMap=this.bumpMap.toJSON(e).uuid,t.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(t.normalMap=this.normalMap.toJSON(e).uuid,t.normalMapType=this.normalMapType,t.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(t.displacementMap=this.displacementMap.toJSON(e).uuid,t.displacementScale=this.displacementScale,t.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(t.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(t.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(t.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(t.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(t.envMap=this.envMap.toJSON(e).uuid,t.reflectivity=this.reflectivity,t.refractionRatio=this.refractionRatio,this.combine!==void 0&&(t.combine=this.combine),this.envMapIntensity!==void 0&&(t.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(t.gradientMap=this.gradientMap.toJSON(e).uuid),this.size!==void 0&&(t.size=this.size),this.sizeAttenuation!==void 0&&(t.sizeAttenuation=this.sizeAttenuation),this.blending!==ne&&(t.blending=this.blending),this.flatShading===!0&&(t.flatShading=this.flatShading),this.side!==F&&(t.side=this.side),this.vertexColors&&(t.vertexColors=!0),this.opacity<1&&(t.opacity=this.opacity),this.transparent===!0&&(t.transparent=this.transparent),t.depthFunc=this.depthFunc,t.depthTest=this.depthTest,t.depthWrite=this.depthWrite,t.stencilWrite=this.stencilWrite,t.stencilWriteMask=this.stencilWriteMask,t.stencilFunc=this.stencilFunc,t.stencilRef=this.stencilRef,t.stencilFuncMask=this.stencilFuncMask,t.stencilFail=this.stencilFail,t.stencilZFail=this.stencilZFail,t.stencilZPass=this.stencilZPass,this.rotation&&this.rotation!==0&&(t.rotation=this.rotation),this.polygonOffset===!0&&(t.polygonOffset=!0),this.polygonOffsetFactor!==0&&(t.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(t.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&this.linewidth!==1&&(t.linewidth=this.linewidth),this.dashSize!==void 0&&(t.dashSize=this.dashSize),this.gapSize!==void 0&&(t.gapSize=this.gapSize),this.scale!==void 0&&(t.scale=this.scale),this.dithering===!0&&(t.dithering=!0),this.alphaTest>0&&(t.alphaTest=this.alphaTest),this.premultipliedAlpha===!0&&(t.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(t.wireframe=this.wireframe),this.wireframeLinewidth>1&&(t.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(t.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(t.wireframeLinejoin=this.wireframeLinejoin),this.morphTargets===!0&&(t.morphTargets=!0),this.morphNormals===!0&&(t.morphNormals=!0),this.skinning===!0&&(t.skinning=!0),this.visible===!1&&(t.visible=!1),this.toneMapped===!1&&(t.toneMapped=!1),JSON.stringify(this.userData)!=="{}"&&(t.userData=this.userData);function s(v){var x=[];for(var w in v){var E=v[w];delete E.metadata,x.push(E)}return x}if(a){var l=s(e.textures),f=s(e.images);l.length>0&&(t.textures=l),f.length>0&&(t.images=f)}return t},clone:function(){return new this.constructor().copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.flatShading=e.flatShading,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;var a=e.clippingPlanes,t=null;if(a!==null){var s=a.length;t=new Array(s);for(var l=0;l!==s;++l)t[l]=a[l].clone()}return this.clippingPlanes=t,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(zi.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}});function Sa(e){zi.call(this),this.type="MeshBasicMaterial",this.color=new mi(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Le,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(e)}Sa.prototype=Object.create(zi.prototype),Sa.prototype.constructor=Sa,Sa.prototype.isMeshBasicMaterial=!0,Sa.prototype.copy=function(e){return zi.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this};var _s=new pe,Kp=new bn;function qi(e,a,t){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=a,this.count=e!==void 0?e.length/a:0,this.normalized=t===!0,this.usage=ad,this.updateRange={offset:0,count:-1},this.version=0}Object.defineProperty(qi.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}}),Object.assign(qi.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this},copyAt:function(e,a,t){e*=this.itemSize,t*=a.itemSize;for(var s=0,l=this.itemSize;s<l;s++)this.array[e+s]=a.array[t+s];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){for(var a=this.array,t=0,s=0,l=e.length;s<l;s++){var f=e[s];f===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",s),f=new mi),a[t++]=f.r,a[t++]=f.g,a[t++]=f.b}return this},copyVector2sArray:function(e){for(var a=this.array,t=0,s=0,l=e.length;s<l;s++){var f=e[s];f===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",s),f=new bn),a[t++]=f.x,a[t++]=f.y}return this},copyVector3sArray:function(e){for(var a=this.array,t=0,s=0,l=e.length;s<l;s++){var f=e[s];f===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",s),f=new pe),a[t++]=f.x,a[t++]=f.y,a[t++]=f.z}return this},copyVector4sArray:function(e){for(var a=this.array,t=0,s=0,l=e.length;s<l;s++){var f=e[s];f===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",s),f=new ps),a[t++]=f.x,a[t++]=f.y,a[t++]=f.z,a[t++]=f.w}return this},applyMatrix3:function(e){if(this.itemSize===2)for(var a=0,t=this.count;a<t;a++)Kp.fromBufferAttribute(this,a),Kp.applyMatrix3(e),this.setXY(a,Kp.x,Kp.y);else if(this.itemSize===3)for(var s=0,l=this.count;s<l;s++)_s.fromBufferAttribute(this,s),_s.applyMatrix3(e),this.setXYZ(s,_s.x,_s.y,_s.z);return this},applyMatrix4:function(e){for(var a=0,t=this.count;a<t;a++)_s.x=this.getX(a),_s.y=this.getY(a),_s.z=this.getZ(a),_s.applyMatrix4(e),this.setXYZ(a,_s.x,_s.y,_s.z);return this},applyNormalMatrix:function(e){for(var a=0,t=this.count;a<t;a++)_s.x=this.getX(a),_s.y=this.getY(a),_s.z=this.getZ(a),_s.applyNormalMatrix(e),this.setXYZ(a,_s.x,_s.y,_s.z);return this},transformDirection:function(e){for(var a=0,t=this.count;a<t;a++)_s.x=this.getX(a),_s.y=this.getY(a),_s.z=this.getZ(a),_s.transformDirection(e),this.setXYZ(a,_s.x,_s.y,_s.z);return this},set:function(e,a){return a===void 0&&(a=0),this.array.set(e,a),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,a){return this.array[e*this.itemSize]=a,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,a){return this.array[e*this.itemSize+1]=a,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,a){return this.array[e*this.itemSize+2]=a,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,a){return this.array[e*this.itemSize+3]=a,this},setXY:function(e,a,t){return e*=this.itemSize,this.array[e+0]=a,this.array[e+1]=t,this},setXYZ:function(e,a,t,s){return e*=this.itemSize,this.array[e+0]=a,this.array[e+1]=t,this.array[e+2]=s,this},setXYZW:function(e,a,t,s,l){return e*=this.itemSize,this.array[e+0]=a,this.array[e+1]=t,this.array[e+2]=s,this.array[e+3]=l,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}});function tf(e,a,t){qi.call(this,new Int8Array(e),a,t)}tf.prototype=Object.create(qi.prototype),tf.prototype.constructor=tf;function md(e,a,t){qi.call(this,new Uint8Array(e),a,t)}md.prototype=Object.create(qi.prototype),md.prototype.constructor=md;function Zu(e,a,t){qi.call(this,new Uint8ClampedArray(e),a,t)}Zu.prototype=Object.create(qi.prototype),Zu.prototype.constructor=Zu;function Ju(e,a,t){qi.call(this,new Int16Array(e),a,t)}Ju.prototype=Object.create(qi.prototype),Ju.prototype.constructor=Ju;function $u(e,a,t){qi.call(this,new Uint16Array(e),a,t)}$u.prototype=Object.create(qi.prototype),$u.prototype.constructor=$u;function xe(e,a,t){qi.call(this,new Int32Array(e),a,t)}xe.prototype=Object.create(qi.prototype),xe.prototype.constructor=xe;function S(e,a,t){qi.call(this,new Uint32Array(e),a,t)}S.prototype=Object.create(qi.prototype),S.prototype.constructor=S;function L(e,a,t){qi.call(this,new Float32Array(e),a,t)}L.prototype=Object.create(qi.prototype),L.prototype.constructor=L;function I(e,a,t){qi.call(this,new Float64Array(e),a,t)}I.prototype=Object.create(qi.prototype),I.prototype.constructor=I;var B=function(){function e(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}var a=e.prototype;return a.computeGroups=function(t){var s=[],l,f,v=void 0,x=t.faces;for(f=0;f<x.length;f++){var w=x[f];w.materialIndex!==v&&(v=w.materialIndex,l!==void 0&&(l.count=f*3-l.start,s.push(l)),l={start:f*3,materialIndex:v})}l!==void 0&&(l.count=f*3-l.start,s.push(l)),this.groups=s},a.fromGeometry=function(t){var s=t.faces,l=t.vertices,f=t.faceVertexUvs,v=f[0]&&f[0].length>0,x=f[1]&&f[1].length>0,w=t.morphTargets,E=w.length,P;if(E>0){P=[];for(var R=0;R<E;R++)P[R]={name:w[R].name,data:[]};this.morphTargets.position=P}var V=t.morphNormals,H=V.length,q;if(H>0){q=[];for(var z=0;z<H;z++)q[z]={name:V[z].name,data:[]};this.morphTargets.normal=q}var G=t.skinIndices,ie=t.skinWeights,le=G.length===l.length,ae=ie.length===l.length;l.length>0&&s.length===0&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(var J=0;J<s.length;J++){var se=s[J];this.vertices.push(l[se.a],l[se.b],l[se.c]);var ge=se.vertexNormals;if(ge.length===3)this.normals.push(ge[0],ge[1],ge[2]);else{var _e=se.normal;this.normals.push(_e,_e,_e)}var We=se.vertexColors;if(We.length===3)this.colors.push(We[0],We[1],We[2]);else{var nt=se.color;this.colors.push(nt,nt,nt)}if(v===!0){var Me=f[0][J];Me!==void 0?this.uvs.push(Me[0],Me[1],Me[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",J),this.uvs.push(new bn,new bn,new bn))}if(x===!0){var be=f[1][J];be!==void 0?this.uvs2.push(be[0],be[1],be[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",J),this.uvs2.push(new bn,new bn,new bn))}for(var ve=0;ve<E;ve++){var Ze=w[ve].vertices;P[ve].data.push(Ze[se.a],Ze[se.b],Ze[se.c])}for(var Ke=0;Ke<H;Ke++){var Qe=V[Ke].vertexNormals[J];q[Ke].data.push(Qe.a,Qe.b,Qe.c)}le&&this.skinIndices.push(G[se.a],G[se.b],G[se.c]),ae&&this.skinWeights.push(ie[se.a],ie[se.b],ie[se.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,t.boundingSphere!==null&&(this.boundingSphere=t.boundingSphere.clone()),t.boundingBox!==null&&(this.boundingBox=t.boundingBox.clone()),this},e}();function Z(e){if(e.length===0)return-1/0;for(var a=e[0],t=1,s=e.length;t<s;++t)e[t]>a&&(a=e[t]);return a}var $=1,ee=new wr,we=new Ei,Ie=new pe,Ae=new Tl,Et=new Tl,ut=new pe;function qe(){Object.defineProperty(this,"id",{value:$+=2}),this.uuid=nr.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}qe.prototype=Object.assign(Object.create(il.prototype),{constructor:qe,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){return Array.isArray(e)?this.index=new(Z(e)>65535?S:$u)(e,1):this.index=e,this},getAttribute:function(e){return this.attributes[e]},setAttribute:function(e,a){return this.attributes[e]=a,this},deleteAttribute:function(e){return delete this.attributes[e],this},addGroup:function(e,a,t){this.groups.push({start:e,count:a,materialIndex:t!==void 0?t:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,a){this.drawRange.start=e,this.drawRange.count=a},applyMatrix4:function(e){var a=this.attributes.position;a!==void 0&&(a.applyMatrix4(e),a.needsUpdate=!0);var t=this.attributes.normal;if(t!==void 0){var s=new qa().getNormalMatrix(e);t.applyNormalMatrix(s),t.needsUpdate=!0}var l=this.attributes.tangent;return l!==void 0&&(l.transformDirection(e),l.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this},rotateX:function(e){return ee.makeRotationX(e),this.applyMatrix4(ee),this},rotateY:function(e){return ee.makeRotationY(e),this.applyMatrix4(ee),this},rotateZ:function(e){return ee.makeRotationZ(e),this.applyMatrix4(ee),this},translate:function(e,a,t){return ee.makeTranslation(e,a,t),this.applyMatrix4(ee),this},scale:function(e,a,t){return ee.makeScale(e,a,t),this.applyMatrix4(ee),this},lookAt:function(e){return we.lookAt(e),we.updateMatrix(),this.applyMatrix4(we.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Ie).negate(),this.translate(Ie.x,Ie.y,Ie.z),this},setFromObject:function(e){var a=e.geometry;if(e.isPoints||e.isLine){var t=new L(a.vertices.length*3,3),s=new L(a.colors.length*3,3);if(this.setAttribute("position",t.copyVector3sArray(a.vertices)),this.setAttribute("color",s.copyColorsArray(a.colors)),a.lineDistances&&a.lineDistances.length===a.vertices.length){var l=new L(a.lineDistances.length,1);this.setAttribute("lineDistance",l.copyArray(a.lineDistances))}a.boundingSphere!==null&&(this.boundingSphere=a.boundingSphere.clone()),a.boundingBox!==null&&(this.boundingBox=a.boundingBox.clone())}else e.isMesh&&a&&a.isGeometry&&this.fromGeometry(a);return this},setFromPoints:function(e){for(var a=[],t=0,s=e.length;t<s;t++){var l=e[t];a.push(l.x,l.y,l.z||0)}return this.setAttribute("position",new L(a,3)),this},updateFromObject:function(e){var a=e.geometry;if(e.isMesh){var t=a.__directGeometry;if(a.elementsNeedUpdate===!0&&(t=void 0,a.elementsNeedUpdate=!1),t===void 0)return this.fromGeometry(a);t.verticesNeedUpdate=a.verticesNeedUpdate,t.normalsNeedUpdate=a.normalsNeedUpdate,t.colorsNeedUpdate=a.colorsNeedUpdate,t.uvsNeedUpdate=a.uvsNeedUpdate,t.groupsNeedUpdate=a.groupsNeedUpdate,a.verticesNeedUpdate=!1,a.normalsNeedUpdate=!1,a.colorsNeedUpdate=!1,a.uvsNeedUpdate=!1,a.groupsNeedUpdate=!1,a=t}if(a.verticesNeedUpdate===!0){var s=this.attributes.position;s!==void 0&&(s.copyVector3sArray(a.vertices),s.needsUpdate=!0),a.verticesNeedUpdate=!1}if(a.normalsNeedUpdate===!0){var l=this.attributes.normal;l!==void 0&&(l.copyVector3sArray(a.normals),l.needsUpdate=!0),a.normalsNeedUpdate=!1}if(a.colorsNeedUpdate===!0){var f=this.attributes.color;f!==void 0&&(f.copyColorsArray(a.colors),f.needsUpdate=!0),a.colorsNeedUpdate=!1}if(a.uvsNeedUpdate){var v=this.attributes.uv;v!==void 0&&(v.copyVector2sArray(a.uvs),v.needsUpdate=!0),a.uvsNeedUpdate=!1}if(a.lineDistancesNeedUpdate){var x=this.attributes.lineDistance;x!==void 0&&(x.copyArray(a.lineDistances),x.needsUpdate=!0),a.lineDistancesNeedUpdate=!1}return a.groupsNeedUpdate&&(a.computeGroups(e.geometry),this.groups=a.groups,a.groupsNeedUpdate=!1),this},fromGeometry:function(e){return e.__directGeometry=new B().fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){var a=new Float32Array(e.vertices.length*3);if(this.setAttribute("position",new qi(a,3).copyVector3sArray(e.vertices)),e.normals.length>0){var t=new Float32Array(e.normals.length*3);this.setAttribute("normal",new qi(t,3).copyVector3sArray(e.normals))}if(e.colors.length>0){var s=new Float32Array(e.colors.length*3);this.setAttribute("color",new qi(s,3).copyColorsArray(e.colors))}if(e.uvs.length>0){var l=new Float32Array(e.uvs.length*2);this.setAttribute("uv",new qi(l,2).copyVector2sArray(e.uvs))}if(e.uvs2.length>0){var f=new Float32Array(e.uvs2.length*2);this.setAttribute("uv2",new qi(f,2).copyVector2sArray(e.uvs2))}this.groups=e.groups;for(var v in e.morphTargets){for(var x=[],w=e.morphTargets[v],E=0,P=w.length;E<P;E++){var R=w[E],V=new L(R.data.length*3,3);V.name=R.name,x.push(V.copyVector3sArray(R.data))}this.morphAttributes[v]=x}if(e.skinIndices.length>0){var H=new L(e.skinIndices.length*4,4);this.setAttribute("skinIndex",H.copyVector4sArray(e.skinIndices))}if(e.skinWeights.length>0){var q=new L(e.skinWeights.length*4,4);this.setAttribute("skinWeight",q.copyVector4sArray(e.skinWeights))}return e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),this},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new Tl);var e=this.attributes.position,a=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new pe(-1/0,-1/0,-1/0),new pe(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),a)for(var t=0,s=a.length;t<s;t++){var l=a[t];Ae.setFromBufferAttribute(l),this.morphTargetsRelative?(ut.addVectors(this.boundingBox.min,Ae.min),this.boundingBox.expandByPoint(ut),ut.addVectors(this.boundingBox.max,Ae.max),this.boundingBox.expandByPoint(ut)):(this.boundingBox.expandByPoint(Ae.min),this.boundingBox.expandByPoint(Ae.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){this.boundingSphere===null&&(this.boundingSphere=new ro);var e=this.attributes.position,a=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new pe,1/0);return}if(e){var t=this.boundingSphere.center;if(Ae.setFromBufferAttribute(e),a)for(var s=0,l=a.length;s<l;s++){var f=a[s];Et.setFromBufferAttribute(f),this.morphTargetsRelative?(ut.addVectors(Ae.min,Et.min),Ae.expandByPoint(ut),ut.addVectors(Ae.max,Et.max),Ae.expandByPoint(ut)):(Ae.expandByPoint(Et.min),Ae.expandByPoint(Et.max))}Ae.getCenter(t);for(var v=0,x=0,w=e.count;x<w;x++)ut.fromBufferAttribute(e,x),v=Math.max(v,t.distanceToSquared(ut));if(a)for(var E=0,P=a.length;E<P;E++)for(var R=a[E],V=this.morphTargetsRelative,H=0,q=R.count;H<q;H++)ut.fromBufferAttribute(R,H),V&&(Ie.fromBufferAttribute(e,H),ut.add(Ie)),v=Math.max(v,t.distanceToSquared(ut));this.boundingSphere.radius=Math.sqrt(v),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.index,a=this.getAttribute("position");if(a!==void 0){var t=this.getAttribute("normal");if(t===void 0)t=new qi(new Float32Array(a.count*3),3),this.setAttribute("normal",t);else for(var s=0,l=t.count;s<l;s++)t.setXYZ(s,0,0,0);var f=new pe,v=new pe,x=new pe,w=new pe,E=new pe,P=new pe,R=new pe,V=new pe;if(e)for(var H=0,q=e.count;H<q;H+=3){var z=e.getX(H+0),G=e.getX(H+1),ie=e.getX(H+2);f.fromBufferAttribute(a,z),v.fromBufferAttribute(a,G),x.fromBufferAttribute(a,ie),R.subVectors(x,v),V.subVectors(f,v),R.cross(V),w.fromBufferAttribute(t,z),E.fromBufferAttribute(t,G),P.fromBufferAttribute(t,ie),w.add(R),E.add(R),P.add(R),t.setXYZ(z,w.x,w.y,w.z),t.setXYZ(G,E.x,E.y,E.z),t.setXYZ(ie,P.x,P.y,P.z)}else for(var le=0,ae=a.count;le<ae;le+=3)f.fromBufferAttribute(a,le+0),v.fromBufferAttribute(a,le+1),x.fromBufferAttribute(a,le+2),R.subVectors(x,v),V.subVectors(f,v),R.cross(V),t.setXYZ(le+0,R.x,R.y,R.z),t.setXYZ(le+1,R.x,R.y,R.z),t.setXYZ(le+2,R.x,R.y,R.z);this.normalizeNormals(),t.needsUpdate=!0}},merge:function(e,a){if(!(e&&e.isBufferGeometry)){console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);return}a===void 0&&(a=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var t=this.attributes;for(var s in t)if(e.attributes[s]!==void 0)for(var l=t[s],f=l.array,v=e.attributes[s],x=v.array,w=v.itemSize*a,E=Math.min(x.length,f.length-w),P=0,R=w;P<E;P++,R++)f[R]=x[P];return this},normalizeNormals:function(){for(var e=this.attributes.normal,a=0,t=e.count;a<t;a++)ut.fromBufferAttribute(e,a),ut.normalize(),e.setXYZ(a,ut.x,ut.y,ut.z)},toNonIndexed:function(){function e(ae,J){for(var se=ae.array,ge=ae.itemSize,_e=ae.normalized,We=new se.constructor(J.length*ge),nt=0,Me=0,be=0,ve=J.length;be<ve;be++){nt=J[be]*ge;for(var Ze=0;Ze<ge;Ze++)We[Me++]=se[nt++]}return new qi(We,ge,_e)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var a=new qe,t=this.index.array,s=this.attributes;for(var l in s){var f=s[l],v=e(f,t);a.setAttribute(l,v)}var x=this.morphAttributes;for(var w in x){for(var E=[],P=x[w],R=0,V=P.length;R<V;R++){var H=P[R],q=e(H,t);E.push(q)}a.morphAttributes[w]=E}a.morphTargetsRelative=this.morphTargetsRelative;for(var z=this.groups,G=0,ie=z.length;G<ie;G++){var le=z[G];a.addGroup(le.start,le.count,le.materialIndex)}return a},toJSON:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){var a=this.parameters;for(var t in a)a[t]!==void 0&&(e[t]=a[t]);return e}e.data={attributes:{}};var s=this.index;s!==null&&(e.data.index={type:s.array.constructor.name,array:Array.prototype.slice.call(s.array)});var l=this.attributes;for(var f in l){var v=l[f],x=v.toJSON(e.data);v.name!==""&&(x.name=v.name),e.data.attributes[f]=x}var w={},E=!1;for(var P in this.morphAttributes){for(var R=this.morphAttributes[P],V=[],H=0,q=R.length;H<q;H++){var z=R[H],G=z.toJSON(e.data);z.name!==""&&(G.name=z.name),V.push(G)}V.length>0&&(w[P]=V,E=!0)}E&&(e.data.morphAttributes=w,e.data.morphTargetsRelative=this.morphTargetsRelative);var ie=this.groups;ie.length>0&&(e.data.groups=JSON.parse(JSON.stringify(ie)));var le=this.boundingSphere;return le!==null&&(e.data.boundingSphere={center:le.center.toArray(),radius:le.radius}),e},clone:function(){return new qe().copy(this)},copy:function(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;var a={};this.name=e.name;var t=e.index;t!==null&&this.setIndex(t.clone(a));var s=e.attributes;for(var l in s){var f=s[l];this.setAttribute(l,f.clone(a))}var v=e.morphAttributes;for(var x in v){for(var w=[],E=v[x],P=0,R=E.length;P<R;P++)w.push(E[P].clone(a));this.morphAttributes[x]=w}this.morphTargetsRelative=e.morphTargetsRelative;for(var V=e.groups,H=0,q=V.length;H<q;H++){var z=V[H];this.addGroup(z.start,z.count,z.materialIndex)}var G=e.boundingBox;G!==null&&(this.boundingBox=G.clone());var ie=e.boundingSphere;return ie!==null&&(this.boundingSphere=ie.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var mn=new wr,tt=new sl,gn=new ro,Mn=new pe,ii=new pe,Zn=new pe,gi=new pe,Yn=new pe,Jn=new pe,hi=new pe,xi=new pe,si=new pe,Cr=new bn,ls=new bn,Ns=new bn,ra=new pe,Hs=new pe;function xr(e,a){Ei.call(this),this.type="Mesh",this.geometry=e!==void 0?e:new qe,this.material=a!==void 0?a:new Sa,this.updateMorphTargets()}xr.prototype=Object.assign(Object.create(Ei.prototype),{constructor:xr,isMesh:!0,copy:function(e){return Ei.prototype.copy.call(this,e),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this},updateMorphTargets:function(){var e=this.geometry;if(e.isBufferGeometry){var a=e.morphAttributes,t=Object.keys(a);if(t.length>0){var s=a[t[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var l=0,f=s.length;l<f;l++){var v=s[l].name||String(l);this.morphTargetInfluences.push(0),this.morphTargetDictionary[v]=l}}}}else{var x=e.morphTargets;x!==void 0&&x.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(e,a){var t=this.geometry,s=this.material,l=this.matrixWorld;if(s!==void 0&&(t.boundingSphere===null&&t.computeBoundingSphere(),gn.copy(t.boundingSphere),gn.applyMatrix4(l),e.ray.intersectsSphere(gn)!==!1&&(mn.getInverse(l),tt.copy(e.ray).applyMatrix4(mn),!(t.boundingBox!==null&&tt.intersectsBox(t.boundingBox)===!1)))){var f;if(t.isBufferGeometry){var v=t.index,x=t.attributes.position,w=t.morphAttributes.position,E=t.morphTargetsRelative,P=t.attributes.uv,R=t.attributes.uv2,V=t.groups,H=t.drawRange;if(v!==null)if(Array.isArray(s))for(var q=0,z=V.length;q<z;q++)for(var G=V[q],ie=s[G.materialIndex],le=Math.max(G.start,H.start),ae=Math.min(G.start+G.count,H.start+H.count),J=le;J<ae;J+=3){var se=v.getX(J),ge=v.getX(J+1),_e=v.getX(J+2);f=Ya(this,ie,e,tt,x,w,E,P,R,se,ge,_e),f&&(f.faceIndex=Math.floor(J/3),f.face.materialIndex=G.materialIndex,a.push(f))}else for(var We=Math.max(0,H.start),nt=Math.min(v.count,H.start+H.count),Me=We;Me<nt;Me+=3){var be=v.getX(Me),ve=v.getX(Me+1),Ze=v.getX(Me+2);f=Ya(this,s,e,tt,x,w,E,P,R,be,ve,Ze),f&&(f.faceIndex=Math.floor(Me/3),a.push(f))}else if(x!==void 0)if(Array.isArray(s))for(var Ke=0,Qe=V.length;Ke<Qe;Ke++)for(var Bt=V[Ke],fn=s[Bt.materialIndex],un=Math.max(Bt.start,H.start),Qt=Math.min(Bt.start+Bt.count,H.start+H.count),Sn=un;Sn<Qt;Sn+=3){var ai=Sn,ei=Sn+1,Pi=Sn+2;f=Ya(this,fn,e,tt,x,w,E,P,R,ai,ei,Pi),f&&(f.faceIndex=Math.floor(Sn/3),f.face.materialIndex=Bt.materialIndex,a.push(f))}else for(var Hi=Math.max(0,H.start),on=Math.min(x.count,H.start+H.count),_r=Hi;_r<on;_r+=3){var pr=_r,Zi=_r+1,Xr=_r+2;f=Ya(this,s,e,tt,x,w,E,P,R,pr,Zi,Xr),f&&(f.faceIndex=Math.floor(_r/3),a.push(f))}}else if(t.isGeometry){var Sr=Array.isArray(s),rs=t.vertices,zr=t.faces,As,ze=t.faceVertexUvs[0];ze.length>0&&(As=ze);for(var re=0,On=zr.length;re<On;re++){var Jt=zr[re],bi=Sr?s[Jt.materialIndex]:s;if(bi!==void 0){var kn=rs[Jt.a],Xi=rs[Jt.b],ji=rs[Jt.c];if(f=Ea(this,bi,e,tt,kn,Xi,ji,ra),f){if(As&&As[re]){var Di=As[re];Cr.copy(Di[0]),ls.copy(Di[1]),Ns.copy(Di[2]),f.uv=zo.getUV(ra,kn,Xi,ji,Cr,ls,Ns,new bn)}f.face=Jt,f.faceIndex=re,a.push(f)}}}}}}});function Ea(e,a,t,s,l,f,v,x){var w;if(a.side===O?w=s.intersectTriangle(v,f,l,!0,x):w=s.intersectTriangle(l,f,v,a.side!==k,x),w===null)return null;Hs.copy(x),Hs.applyMatrix4(e.matrixWorld);var E=t.ray.origin.distanceTo(Hs);return E<t.near||E>t.far?null:{distance:E,point:Hs.clone(),object:e}}function Ya(e,a,t,s,l,f,v,x,w,E,P,R){Mn.fromBufferAttribute(l,E),ii.fromBufferAttribute(l,P),Zn.fromBufferAttribute(l,R);var V=e.morphTargetInfluences;if(a.morphTargets&&f&&V){hi.set(0,0,0),xi.set(0,0,0),si.set(0,0,0);for(var H=0,q=f.length;H<q;H++){var z=V[H],G=f[H];z!==0&&(gi.fromBufferAttribute(G,E),Yn.fromBufferAttribute(G,P),Jn.fromBufferAttribute(G,R),v?(hi.addScaledVector(gi,z),xi.addScaledVector(Yn,z),si.addScaledVector(Jn,z)):(hi.addScaledVector(gi.sub(Mn),z),xi.addScaledVector(Yn.sub(ii),z),si.addScaledVector(Jn.sub(Zn),z)))}Mn.add(hi),ii.add(xi),Zn.add(si)}e.isSkinnedMesh&&(e.boneTransform(E,Mn),e.boneTransform(P,ii),e.boneTransform(R,Zn));var ie=Ea(e,a,t,s,Mn,ii,Zn,ra);if(ie){x&&(Cr.fromBufferAttribute(x,E),ls.fromBufferAttribute(x,P),Ns.fromBufferAttribute(x,R),ie.uv=zo.getUV(ra,Mn,ii,Zn,Cr,ls,Ns,new bn)),w&&(Cr.fromBufferAttribute(w,E),ls.fromBufferAttribute(w,P),Ns.fromBufferAttribute(w,R),ie.uv2=zo.getUV(ra,Mn,ii,Zn,Cr,ls,Ns,new bn));var le=new pd(E,P,R);zo.getNormal(Mn,ii,Zn,le.normal),ie.face=le}return ie}var ol=function(e){Li(a,e);function a(t,s,l,f,v,x){var w;t===void 0&&(t=1),s===void 0&&(s=1),l===void 0&&(l=1),f===void 0&&(f=1),v===void 0&&(v=1),x===void 0&&(x=1),w=e.call(this)||this,w.type="BoxBufferGeometry",w.parameters={width:t,height:s,depth:l,widthSegments:f,heightSegments:v,depthSegments:x};var E=Xh(w);f=Math.floor(f),v=Math.floor(v),x=Math.floor(x);var P=[],R=[],V=[],H=[],q=0,z=0;G("z","y","x",-1,-1,l,s,t,x,v,0),G("z","y","x",1,-1,l,s,-t,x,v,1),G("x","z","y",1,1,t,l,s,f,x,2),G("x","z","y",1,-1,t,l,-s,f,x,3),G("x","y","z",1,-1,t,s,l,f,v,4),G("x","y","z",-1,-1,t,s,-l,f,v,5),w.setIndex(P),w.setAttribute("position",new L(R,3)),w.setAttribute("normal",new L(V,3)),w.setAttribute("uv",new L(H,2));function G(ie,le,ae,J,se,ge,_e,We,nt,Me,be){for(var ve=nt+1,Ze=0,Ke=0,Qe=new pe,Bt=0;Bt<Me+1;Bt++)for(var fn=Bt*(_e/Me)-_e/2,un=0;un<ve;un++){var Qt=un*(ge/nt)-ge/2;Qe[ie]=Qt*J,Qe[le]=fn*se,Qe[ae]=We/2,R.push(Qe.x,Qe.y,Qe.z),Qe[ie]=0,Qe[le]=0,Qe[ae]=We>0?1:-1,V.push(Qe.x,Qe.y,Qe.z),H.push(un/nt),H.push(1-Bt/Me),Ze+=1}for(var Sn=0;Sn<Me;Sn++)for(var ai=0;ai<nt;ai++){var ei=q+ai+ve*Sn,Pi=q+ai+ve*(Sn+1),Hi=q+(ai+1)+ve*(Sn+1),on=q+(ai+1)+ve*Sn;P.push(ei,Pi,on),P.push(Pi,Hi,on),Ke+=6}E.addGroup(z,Ke,be),z+=Ke,q+=Ze}return w}return a}(qe);function Ho(e){var a={};for(var t in e){a[t]={};for(var s in e[t]){var l=e[t][s];l&&(l.isColor||l.isMatrix3||l.isMatrix4||l.isVector2||l.isVector3||l.isVector4||l.isTexture)?a[t][s]=l.clone():Array.isArray(l)?a[t][s]=l.slice():a[t][s]=l}}return a}function ca(e){for(var a={},t=0;t<e.length;t++){var s=Ho(e[t]);for(var l in s)a[l]=s[l]}return a}var iu={clone:Ho,merge:ca};function za(e){zi.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,this.fragmentShader=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&(e.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}za.prototype=Object.create(zi.prototype),za.prototype.constructor=za,za.prototype.isShaderMaterial=!0,za.prototype.copy=function(e){return zi.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Ho(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this},za.prototype.toJSON=function(e){var a=zi.prototype.toJSON.call(this,e);a.glslVersion=this.glslVersion,a.uniforms={};for(var t in this.uniforms){var s=this.uniforms[t],l=s.value;l&&l.isTexture?a.uniforms[t]={type:"t",value:l.toJSON(e).uuid}:l&&l.isColor?a.uniforms[t]={type:"c",value:l.getHex()}:l&&l.isVector2?a.uniforms[t]={type:"v2",value:l.toArray()}:l&&l.isVector3?a.uniforms[t]={type:"v3",value:l.toArray()}:l&&l.isVector4?a.uniforms[t]={type:"v4",value:l.toArray()}:l&&l.isMatrix3?a.uniforms[t]={type:"m3",value:l.toArray()}:l&&l.isMatrix4?a.uniforms[t]={type:"m4",value:l.toArray()}:a.uniforms[t]={value:l}}Object.keys(this.defines).length>0&&(a.defines=this.defines),a.vertexShader=this.vertexShader,a.fragmentShader=this.fragmentShader;var f={};for(var v in this.extensions)this.extensions[v]===!0&&(f[v]=!0);return Object.keys(f).length>0&&(a.extensions=f),a};function Ta(){Ei.call(this),this.type="Camera",this.matrixWorldInverse=new wr,this.projectionMatrix=new wr,this.projectionMatrixInverse=new wr}Ta.prototype=Object.assign(Object.create(Ei.prototype),{constructor:Ta,isCamera:!0,copy:function(e,a){return Ei.prototype.copy.call(this,e,a),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this},getWorldDirection:function(e){e===void 0&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),e=new pe),this.updateMatrixWorld(!0);var a=this.matrixWorld.elements;return e.set(-a[8],-a[9],-a[10]).normalize()},updateMatrixWorld:function(e){Ei.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},updateWorldMatrix:function(e,a){Ei.prototype.updateWorldMatrix.call(this,e,a),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return new this.constructor().copy(this)}});function Ms(e,a,t,s){Ta.call(this),this.type="PerspectiveCamera",this.fov=e!==void 0?e:50,this.zoom=1,this.near=t!==void 0?t:.1,this.far=s!==void 0?s:2e3,this.focus=10,this.aspect=a!==void 0?a:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}Ms.prototype=Object.assign(Object.create(Ta.prototype),{constructor:Ms,isPerspectiveCamera:!0,copy:function(e,a){return Ta.prototype.copy.call(this,e,a),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){var a=.5*this.getFilmHeight()/e;this.fov=nr.RAD2DEG*2*Math.atan(a),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(nr.DEG2RAD*.5*this.fov);return .5*this.getFilmHeight()/e},getEffectiveFOV:function(){return nr.RAD2DEG*2*Math.atan(Math.tan(nr.DEG2RAD*.5*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,a,t,s,l,f){this.aspect=e/a,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=a,this.view.offsetX=t,this.view.offsetY=s,this.view.width=l,this.view.height=f,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=this.near,a=e*Math.tan(nr.DEG2RAD*.5*this.fov)/this.zoom,t=2*a,s=this.aspect*t,l=-.5*s,f=this.view;if(this.view!==null&&this.view.enabled){var v=f.fullWidth,x=f.fullHeight;l+=f.offsetX*s/v,a-=f.offsetY*t/x,s*=f.width/v,t*=f.height/x}var w=this.filmOffset;w!==0&&(l+=e*w/this.getFilmWidth()),this.projectionMatrix.makePerspective(l,l+s,a,a-t,e,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){var a=Ei.prototype.toJSON.call(this,e);return a.object.fov=this.fov,a.object.zoom=this.zoom,a.object.near=this.near,a.object.far=this.far,a.object.focus=this.focus,a.object.aspect=this.aspect,this.view!==null&&(a.object.view=Object.assign({},this.view)),a.object.filmGauge=this.filmGauge,a.object.filmOffset=this.filmOffset,a}});var Qp=90,em=1;function tm(e,a,t){if(Ei.call(this),this.type="CubeCamera",t.isWebGLCubeRenderTarget!==!0){console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");return}this.renderTarget=t;var s=new Ms(Qp,em,e,a);s.layers=this.layers,s.up.set(0,-1,0),s.lookAt(new pe(1,0,0)),this.add(s);var l=new Ms(Qp,em,e,a);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new pe(-1,0,0)),this.add(l);var f=new Ms(Qp,em,e,a);f.layers=this.layers,f.up.set(0,0,1),f.lookAt(new pe(0,1,0)),this.add(f);var v=new Ms(Qp,em,e,a);v.layers=this.layers,v.up.set(0,0,-1),v.lookAt(new pe(0,-1,0)),this.add(v);var x=new Ms(Qp,em,e,a);x.layers=this.layers,x.up.set(0,-1,0),x.lookAt(new pe(0,0,1)),this.add(x);var w=new Ms(Qp,em,e,a);w.layers=this.layers,w.up.set(0,-1,0),w.lookAt(new pe(0,0,-1)),this.add(w),this.update=function(E,P){this.parent===null&&this.updateMatrixWorld();var R=E.xr.enabled,V=E.getRenderTarget();E.xr.enabled=!1;var H=t.texture.generateMipmaps;t.texture.generateMipmaps=!1,E.setRenderTarget(t,0),E.render(P,s),E.setRenderTarget(t,1),E.render(P,l),E.setRenderTarget(t,2),E.render(P,f),E.setRenderTarget(t,3),E.render(P,v),E.setRenderTarget(t,4),E.render(P,x),t.texture.generateMipmaps=H,E.setRenderTarget(t,5),E.render(P,w),E.setRenderTarget(V),E.xr.enabled=R},this.clear=function(E,P,R,V){for(var H=E.getRenderTarget(),q=0;q<6;q++)E.setRenderTarget(t,q),E.clear(P,R,V);E.setRenderTarget(H)}}tm.prototype=Object.create(Ei.prototype),tm.prototype.constructor=tm;function ru(e,a,t,s,l,f,v,x,w,E){e=e!==void 0?e:[],a=a!==void 0?a:oe,v=v!==void 0?v:nl,ds.call(this,e,a,t,s,l,f,v,x,w,E),this.flipY=!1,this._needsFlipEnvMap=!0}ru.prototype=Object.create(ds.prototype),ru.prototype.constructor=ru,ru.prototype.isCubeTexture=!0,Object.defineProperty(ru.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}});function nf(e,a,t){Number.isInteger(a)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),a=t),ja.call(this,e,e,a),a=a||{},this.texture=new ru(void 0,a.mapping,a.wrapS,a.wrapT,a.magFilter,a.minFilter,a.format,a.type,a.anisotropy,a.encoding),this.texture._needsFlipEnvMap=!1}nf.prototype=Object.create(ja.prototype),nf.prototype.constructor=nf,nf.prototype.isWebGLCubeRenderTarget=!0,nf.prototype.fromEquirectangularTexture=function(e,a){this.texture.type=a.type,this.texture.format=ye,this.texture.encoding=a.encoding,this.texture.generateMipmaps=a.generateMipmaps,this.texture.minFilter=a.minFilter,this.texture.magFilter=a.magFilter;var t={uniforms:{tEquirect:{value:null}},vertexShader:`

			varying vec3 vWorldDirection;

			vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

				return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

			}

			void main() {

				vWorldDirection = transformDirection( position, modelMatrix );

				#include <begin_vertex>
				#include <project_vertex>

			}
		`,fragmentShader:`

			uniform sampler2D tEquirect;

			varying vec3 vWorldDirection;

			#include <common>

			void main() {

				vec3 direction = normalize( vWorldDirection );

				vec2 sampleUV = equirectUv( direction );

				gl_FragColor = texture2D( tEquirect, sampleUV );

			}
		`},s=new ol(5,5,5),l=new za({name:"CubemapFromEquirect",uniforms:Ho(t.uniforms),vertexShader:t.vertexShader,fragmentShader:t.fragmentShader,side:O,blending:X});l.uniforms.tEquirect.value=a;var f=new xr(s,l),v=a.minFilter;a.minFilter===ts&&(a.minFilter=jn);var x=new tm(1,10,this);return x.update(e,f),a.minFilter=v,f.geometry.dispose(),f.material.dispose(),this};function gd(e,a,t,s,l,f,v,x,w,E,P,R){ds.call(this,null,f,v,x,w,E,s,l,P,R),this.image={data:e||null,width:a||1,height:t||1},this.magFilter=w!==void 0?w:Ht,this.minFilter=E!==void 0?E:Ht,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}gd.prototype=Object.create(ds.prototype),gd.prototype.constructor=gd,gd.prototype.isDataTexture=!0;var nm=new ro,tx=new pe,hv=function(){function e(t,s,l,f,v,x){this.planes=[t!==void 0?t:new so,s!==void 0?s:new so,l!==void 0?l:new so,f!==void 0?f:new so,v!==void 0?v:new so,x!==void 0?x:new so]}var a=e.prototype;return a.set=function(t,s,l,f,v,x){var w=this.planes;return w[0].copy(t),w[1].copy(s),w[2].copy(l),w[3].copy(f),w[4].copy(v),w[5].copy(x),this},a.clone=function(){return new this.constructor().copy(this)},a.copy=function(t){for(var s=this.planes,l=0;l<6;l++)s[l].copy(t.planes[l]);return this},a.setFromProjectionMatrix=function(t){var s=this.planes,l=t.elements,f=l[0],v=l[1],x=l[2],w=l[3],E=l[4],P=l[5],R=l[6],V=l[7],H=l[8],q=l[9],z=l[10],G=l[11],ie=l[12],le=l[13],ae=l[14],J=l[15];return s[0].setComponents(w-f,V-E,G-H,J-ie).normalize(),s[1].setComponents(w+f,V+E,G+H,J+ie).normalize(),s[2].setComponents(w+v,V+P,G+q,J+le).normalize(),s[3].setComponents(w-v,V-P,G-q,J-le).normalize(),s[4].setComponents(w-x,V-R,G-z,J-ae).normalize(),s[5].setComponents(w+x,V+R,G+z,J+ae).normalize(),this},a.intersectsObject=function(t){var s=t.geometry;return s.boundingSphere===null&&s.computeBoundingSphere(),nm.copy(s.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(nm)},a.intersectsSprite=function(t){return nm.center.set(0,0,0),nm.radius=.7071067811865476,nm.applyMatrix4(t.matrixWorld),this.intersectsSphere(nm)},a.intersectsSphere=function(t){for(var s=this.planes,l=t.center,f=-t.radius,v=0;v<6;v++){var x=s[v].distanceToPoint(l);if(x<f)return!1}return!0},a.intersectsBox=function(t){for(var s=this.planes,l=0;l<6;l++){var f=s[l];if(tx.x=f.normal.x>0?t.max.x:t.min.x,tx.y=f.normal.y>0?t.max.y:t.min.y,tx.z=f.normal.z>0?t.max.z:t.min.z,f.distanceToPoint(tx)<0)return!1}return!0},a.containsPoint=function(t){for(var s=this.planes,l=0;l<6;l++)if(s[l].distanceToPoint(t)<0)return!1;return!0},e}();function t1(){var e=null,a=!1,t=null,s=null;function l(f,v){t(f,v),s=e.requestAnimationFrame(l)}return{start:function(){a!==!0&&t!==null&&(s=e.requestAnimationFrame(l),a=!0)},stop:function(){e.cancelAnimationFrame(s),a=!1},setAnimationLoop:function(f){t=f},setContext:function(f){e=f}}}function mA(e,a){var t=a.isWebGL2,s=new WeakMap;function l(v,x){var w=v.array,E=v.usage,P=e.createBuffer();e.bindBuffer(x,P),e.bufferData(x,w,E),v.onUploadCallback();var R=5126;return w instanceof Float32Array?R=5126:w instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):w instanceof Uint16Array?R=5123:w instanceof Int16Array?R=5122:w instanceof Uint32Array?R=5125:w instanceof Int32Array?R=5124:w instanceof Int8Array?R=5120:w instanceof Uint8Array&&(R=5121),{buffer:P,type:R,bytesPerElement:w.BYTES_PER_ELEMENT,version:v.version}}function f(v,x,w){var E=x.array,P=x.updateRange;e.bindBuffer(w,v),P.count===-1?e.bufferSubData(w,0,E):(t?e.bufferSubData(w,P.offset*E.BYTES_PER_ELEMENT,E,P.offset,P.count):e.bufferSubData(w,P.offset*E.BYTES_PER_ELEMENT,E.subarray(P.offset,P.offset+P.count)),P.count=-1)}return{get:function(v){return v.isInterleavedBufferAttribute&&(v=v.data),s.get(v)},remove:function(v){v.isInterleavedBufferAttribute&&(v=v.data);var x=s.get(v);x&&(e.deleteBuffer(x.buffer),s.delete(v))},update:function(v,x){if(v.isGLBufferAttribute){var w=s.get(v);(!w||w.version<v.version)&&s.set(v,{buffer:v.buffer,type:v.type,bytesPerElement:v.elementSize,version:v.version});return}v.isInterleavedBufferAttribute&&(v=v.data);var E=s.get(v);E===void 0?s.set(v,l(v,x)):E.version<v.version&&(f(E.buffer,v,x),E.version=v.version)}}}var nx=function(e){Li(a,e);function a(t,s,l,f){var v=e.call(this)||this;v.type="PlaneBufferGeometry",v.parameters={width:t,height:s,widthSegments:l,heightSegments:f},t=t||1,s=s||1;for(var x=t/2,w=s/2,E=Math.floor(l)||1,P=Math.floor(f)||1,R=E+1,V=t/E,H=s/P,q=[],z=[],G=[],ie=[],le=0;le<P+1;le++)for(var ae=le*H-w,J=0;J<R;J++){var se=J*V-x;z.push(se,-ae,0),G.push(0,0,1),ie.push(J/E),ie.push(1-le/P)}for(var ge=0;ge<P;ge++)for(var _e=0;_e<E;_e++){var We=_e+R*ge,nt=_e+R*(ge+1),Me=_e+1+R*(ge+1),be=_e+1+R*ge;q.push(We,nt,be),q.push(nt,Me,be)}return v.setIndex(q),v.setAttribute("position",new L(z,3)),v.setAttribute("normal",new L(G,3)),v.setAttribute("uv",new L(ie,2)),v}return a}(qe),Nr={alphamap_fragment:`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,alphamap_pars_fragment:`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,alphatest_fragment:`#ifdef ALPHATEST
	if ( diffuseColor.a < ALPHATEST ) discard;
#endif`,aomap_fragment:`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );
	#endif
#endif`,aomap_pars_fragment:`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,bsdfs:`vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	return vec2( -1.04, 1.04 ) * a004 + r.zw;
}
float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
#if defined ( PHYSICALLY_CORRECT_LIGHTS )
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
#else
	if( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
		return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );
	}
	return 1.0;
#endif
}
vec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {
	float fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );
	return ( 1.0 - specularColor ) * fresnel + specularColor;
}
vec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {
	float fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );
	vec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;
	return Fr * fresnel + F0;
}
float G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	float gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	return 1.0 / ( gl * gv );
}
float G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( incidentLight.direction + viewDir );
	float dotNL = saturate( dot( normal, incidentLight.direction ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( G * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
vec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	return specularColor * brdf.x + brdf.y;
}
void BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
	float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
	vec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	vec3 FssEss = F * brdf.x + brdf.y;
	float Ess = brdf.x + brdf.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );
	float dotNH = saturate( dot( geometry.normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
float GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {
	return ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );
}
float BlinnExponentToGGXRoughness( const in float blinnExponent ) {
	return sqrt( 2.0 / ( blinnExponent + 2.0 ) );
}
#if defined( USE_SHEEN )
float D_Charlie(float roughness, float NoH) {
	float invAlpha = 1.0 / roughness;
	float cos2h = NoH * NoH;
	float sin2h = max(1.0 - cos2h, 0.0078125);	return (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);
}
float V_Neubelt(float NoV, float NoL) {
	return saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));
}
vec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {
	vec3 N = geometry.normal;
	vec3 V = geometry.viewDir;
	vec3 H = normalize( V + L );
	float dotNH = saturate( dot( N, H ) );
	return specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );
}
#endif`,bumpmap_pars_fragment:`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 );
		fDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,clipping_planes_fragment:`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,clipping_planes_pars_fragment:`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,clipping_planes_pars_vertex:`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,clipping_planes_vertex:`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,color_fragment:`#ifdef USE_COLOR
	diffuseColor.rgb *= vColor;
#endif`,color_pars_fragment:`#ifdef USE_COLOR
	varying vec3 vColor;
#endif`,color_pars_vertex:`#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,color_vertex:`#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor.xyz *= color.xyz;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,common:`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement(a) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract(sin(sn) * c);
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
vec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	float distance = dot( planeNormal, point - pointOnPlane );
	return - distance * planeNormal + point;
}
float sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return sign( dot( point - pointOnPlane, planeNormal ) );
}
vec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,cube_uv_reflection_fragment:`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_maxMipLevel 8.0
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_maxTileSize 256.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		float texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );
		vec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );
		vec2 f = fract( uv );
		uv += 0.5 - f;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		if ( mipInt < cubeUV_maxMipLevel ) {
			uv.y += 2.0 * cubeUV_maxTileSize;
		}
		uv.y += filterInt * 2.0 * cubeUV_minTileSize;
		uv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );
		uv *= texelSize;
		vec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.x += texelSize;
		vec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.y += texelSize;
		vec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.x -= texelSize;
		vec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		vec3 tm = mix( tl, tr, f.x );
		vec3 bm = mix( bl, br, f.x );
		return mix( tm, bm, f.y );
	}
	#define r0 1.0
	#define v0 0.339
	#define m0 - 2.0
	#define r1 0.8
	#define v1 0.276
	#define m1 - 1.0
	#define r4 0.4
	#define v4 0.046
	#define m4 2.0
	#define r5 0.305
	#define v5 0.016
	#define m5 3.0
	#define r6 0.21
	#define v6 0.0038
	#define m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= r1 ) {
			mip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;
		} else if ( roughness >= r4 ) {
			mip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;
		} else if ( roughness >= r5 ) {
			mip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;
		} else if ( roughness >= r6 ) {
			mip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,defaultnormal_vertex:`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,displacementmap_pars_vertex:`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,displacementmap_vertex:`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,emissivemap_fragment:`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,emissivemap_pars_fragment:`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:`
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 GammaToLinear( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );
}
vec4 LinearToGamma( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );
}
vec4 sRGBToLinear( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 RGBEToLinear( in vec4 value ) {
	return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );
}
vec4 LinearToRGBE( in vec4 value ) {
	float maxComponent = max( max( value.r, value.g ), value.b );
	float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );
	return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );
}
vec4 RGBMToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * value.a * maxRange, 1.0 );
}
vec4 LinearToRGBM( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float M = clamp( maxRGB / maxRange, 0.0, 1.0 );
	M = ceil( M * 255.0 ) / 255.0;
	return vec4( value.rgb / ( M * maxRange ), M );
}
vec4 RGBDToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );
}
vec4 LinearToRGBD( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float D = max( maxRange / maxRGB, 1.0 );
	D = clamp( floor( D ) / 255.0, 0.0, 1.0 );
	return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );
}
const mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );
vec4 LinearToLogLuv( in vec4 value ) {
	vec3 Xp_Y_XYZp = cLogLuvM * value.rgb;
	Xp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );
	vec4 vResult;
	vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;
	float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;
	vResult.w = fract( Le );
	vResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;
	return vResult;
}
const mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );
vec4 LogLuvToLinear( in vec4 value ) {
	float Le = value.z * 255.0 + value.w;
	vec3 Xp_Y_XYZp;
	Xp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );
	Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;
	Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;
	vec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;
	return vec4( max( vRGB, 0.0 ), 1.0 );
}`,envmap_fragment:`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifndef ENVMAP_TYPE_CUBE_UV
		envColor = envMapTexelToLinear( envColor );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,envmap_common_pars_fragment:`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform int maxMipLevel;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,envmap_pars_fragment:`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,envmap_pars_vertex:`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,envmap_physical_pars_fragment:`#if defined( USE_ENVMAP )
	#ifdef ENVMAP_MODE_REFRACTION
		uniform float refractionRatio;
	#endif
	vec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {
		vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );
			#else
				vec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
		#else
			vec4 envMapColor = vec4( 0.0 );
		#endif
		return PI * envMapColor.rgb * envMapIntensity;
	}
	float getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {
		float maxMIPLevelScalar = float( maxMIPLevel );
		float sigma = PI * roughness * roughness / ( 1.0 + roughness );
		float desiredMIPLevel = maxMIPLevelScalar + log2( sigma );
		return clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );
	}
	vec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( -viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
		#else
			vec3 reflectVec = refract( -viewDir, normal, refractionRatio );
		#endif
		reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
		float specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );
			#else
				vec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
		#endif
		return envMapColor.rgb * envMapIntensity;
	}
#endif`,envmap_vertex:`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,fog_vertex:`#ifdef USE_FOG
	fogDepth = - mvPosition.z;
#endif`,fog_pars_vertex:`#ifdef USE_FOG
	varying float fogDepth;
#endif`,fog_fragment:`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, fogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,fog_pars_fragment:`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float fogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,gradientmap_pars_fragment:`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return texture2D( gradientMap, coord ).rgb;
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,lightmap_fragment:`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel= texture2D( lightMap, vUv2 );
	reflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
#endif`,lightmap_pars_fragment:`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,lights_lambert_vertex:`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
vIndirectFront += getLightProbeIrradiance( lightProbe, geometry );
#ifdef DOUBLE_SIDED
	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );
#endif
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );
		#endif
	}
	#pragma unroll_loop_end
#endif`,lights_pars_begin:`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {
	vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	return irradiance;
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		directLight.color = directionalLight.color;
		directLight.direction = directionalLight.direction;
		directLight.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = pointLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		directLight.color = pointLight.color;
		directLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );
		directLight.visible = ( directLight.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = spotLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		float angleCos = dot( directLight.direction, spotLight.direction );
		if ( angleCos > spotLight.coneCos ) {
			float spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );
			directLight.color = spotLight.color;
			directLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );
			directLight.visible = true;
		} else {
			directLight.color = vec3( 0.0 );
			directLight.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {
		float dotNL = dot( geometry.normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			irradiance *= PI;
		#endif
		return irradiance;
	}
#endif`,lights_toon_fragment:`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,lights_toon_pars_fragment:`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,lights_phong_fragment:`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,lights_phong_pars_fragment:`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,lights_physical_fragment:`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;
material.specularRoughness = min( material.specularRoughness, 1.0 );
#ifdef REFLECTIVITY
	material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );
#endif
#ifdef CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheen;
#endif`,lights_physical_pars_fragment:`struct PhysicalMaterial {
	vec3 diffuseColor;
	float specularRoughness;
	vec3 specularColor;
#ifdef CLEARCOAT
	float clearcoat;
	float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	vec3 sheenColor;
#endif
};
#define MAXIMUM_SPECULAR_COEFFICIENT 0.16
#define DEFAULT_SPECULAR_COEFFICIENT 0.04
float clearcoatDHRApprox( const in float roughness, const in float dotNL ) {
	return DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.specularRoughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(		0, 1,		0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	#ifdef CLEARCOAT
		float ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = ccDotNL * directLight.color;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			ccIrradiance *= PI;
		#endif
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
		reflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
	#else
		float clearcoatDHR = 0.0;
	#endif
	#ifdef USE_SHEEN
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(
			material.specularRoughness,
			directLight.direction,
			geometry,
			material.sheenColor
		);
	#else
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);
	#endif
	reflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef CLEARCOAT
		float ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		reflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
		float ccDotNL = ccDotNV;
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
	#else
		float clearcoatDHR = 0.0;
	#endif
	float clearcoatInv = 1.0 - clearcoatDHR;
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	BRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );
	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );
	reflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,lights_fragment_begin:`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointDirectLightIrradiance( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotDirectLightIrradiance( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,lights_fragment_maps:`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			lightMapIrradiance *= PI;
		#endif
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );
	#ifdef CLEARCOAT
		clearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );
	#endif
#endif`,lights_fragment_end:`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,logdepthbuf_fragment:`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,logdepthbuf_pars_fragment:`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,logdepthbuf_pars_vertex:`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,logdepthbuf_vertex:`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,map_fragment:`#ifdef USE_MAP
	vec4 texelColor = texture2D( map, vUv );
	texelColor = mapTexelToLinear( texelColor );
	diffuseColor *= texelColor;
#endif`,map_pars_fragment:`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,map_particle_fragment:`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	vec4 mapTexel = texture2D( map, uv );
	diffuseColor *= mapTexelToLinear( mapTexel );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,map_particle_pars_fragment:`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,metalnessmap_fragment:`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,metalnessmap_pars_fragment:`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,morphnormal_vertex:`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
	objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
	objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
	objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
#endif`,morphtarget_pars_vertex:`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifndef USE_MORPHNORMALS
		uniform float morphTargetInfluences[ 8 ];
	#else
		uniform float morphTargetInfluences[ 4 ];
	#endif
#endif`,morphtarget_vertex:`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	transformed += morphTarget0 * morphTargetInfluences[ 0 ];
	transformed += morphTarget1 * morphTargetInfluences[ 1 ];
	transformed += morphTarget2 * morphTargetInfluences[ 2 ];
	transformed += morphTarget3 * morphTargetInfluences[ 3 ];
	#ifndef USE_MORPHNORMALS
		transformed += morphTarget4 * morphTargetInfluences[ 4 ];
		transformed += morphTarget5 * morphTargetInfluences[ 5 ];
		transformed += morphTarget6 * morphTargetInfluences[ 6 ];
		transformed += morphTarget7 * morphTargetInfluences[ 7 ];
	#endif
#endif`,normal_fragment_begin:`#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
			bitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,normal_fragment_maps:`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( -vViewPosition, normal, mapN );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );
#endif`,normalmap_pars_fragment:`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		float scale = sign( st1.t * st0.s - st0.t * st1.s );
		vec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );
		vec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );
		vec3 N = normalize( surf_norm );
		mat3 tsn = mat3( S, T, N );
		mapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		return normalize( tsn * mapN );
	}
#endif`,clearcoat_normal_fragment_begin:`#ifdef CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,clearcoat_normal_fragment_maps:`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );
	#endif
#endif`,clearcoat_pars_fragment:`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,packing:`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return (( near + viewZ ) * far ) / (( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,premultiplied_alpha_fragment:`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,project_vertex:`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,dithering_fragment:`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,dithering_pars_fragment:`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,roughnessmap_fragment:`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,roughnessmap_pars_fragment:`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,shadowmap_pars_fragment:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
							texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
							f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
							texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
							f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,shadowmap_pars_vertex:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,shadowmap_vertex:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;
	#endif
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,shadowmask_pars_fragment:`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,skinbase_vertex:`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,skinning_pars_vertex:`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	#ifdef BONE_TEXTURE
		uniform highp sampler2D boneTexture;
		uniform int boneTextureSize;
		mat4 getBoneMatrix( const in float i ) {
			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );
			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );
			y = dy * ( y + 0.5 );
			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
			mat4 bone = mat4( v1, v2, v3, v4 );
			return bone;
		}
	#else
		uniform mat4 boneMatrices[ MAX_BONES ];
		mat4 getBoneMatrix( const in float i ) {
			mat4 bone = boneMatrices[ int(i) ];
			return bone;
		}
	#endif
#endif`,skinning_vertex:`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,skinnormal_vertex:`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,specularmap_fragment:`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,specularmap_pars_fragment:`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,tonemapping_fragment:`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,tonemapping_pars_fragment:`#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(	1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,	1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,	1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,transmissionmap_fragment:`#ifdef USE_TRANSMISSIONMAP
	totalTransmission *= texture2D( transmissionMap, vUv ).r;
#endif`,transmissionmap_pars_fragment:`#ifdef USE_TRANSMISSIONMAP
	uniform sampler2D transmissionMap;
#endif`,uv_pars_fragment:`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,uv_pars_vertex:`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,uv_vertex:`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,uv2_pars_fragment:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,uv2_pars_vertex:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,uv2_vertex:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,worldpos_vertex:`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,background_frag:`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,background_vert:`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,cube_frag:`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,cube_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,depth_frag:`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,depth_vert:`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,distanceRGBA_frag:`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,distanceRGBA_vert:`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,equirect_frag:`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	vec4 texColor = texture2D( tEquirect, sampleUV );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,equirect_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,linedashed_frag:`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,linedashed_vert:`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,meshbasic_frag:`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
	
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshbasic_vert:`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <skinbase_vertex>
	#ifdef USE_ENVMAP
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,meshlambert_frag:`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshlambert_vert:`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshmatcap_frag:`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
		matcapColor = matcapTexelToLinear( matcapColor );
	#else
		vec4 matcapColor = vec4( 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshmatcap_vert:`#define MATCAP
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#ifndef FLAT_SHADED
		vNormal = normalize( transformedNormal );
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,meshtoon_frag:`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshtoon_vert:`#define TOON
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphong_frag:`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphong_vert:`#define PHONG
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphysical_frag:`#define STANDARD
#ifdef PHYSICAL
	#define REFLECTIVITY
	#define CLEARCOAT
	#define TRANSMISSION
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef TRANSMISSION
	uniform float transmission;
#endif
#ifdef REFLECTIVITY
	uniform float reflectivity;
#endif
#ifdef CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheen;
#endif
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <transmissionmap_pars_fragment>
#include <bsdfs>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <lights_physical_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#ifdef TRANSMISSION
		float totalTransmission = transmission;
	#endif
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <transmissionmap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#ifdef TRANSMISSION
		diffuseColor.a *= mix( saturate( 1. - totalTransmission + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) ), 1.0, metalness );
	#endif
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphysical_vert:`#define STANDARD
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,normal_frag:`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <packing>
#include <uv_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
}`,normal_vert:`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,points_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,points_vert:`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,shadow_frag:`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,shadow_vert:`#include <common>
#include <fog_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <begin_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,sprite_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,sprite_vert:`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`},fi={common:{diffuse:{value:new mi(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new qa},uv2Transform:{value:new qa},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new bn(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new mi(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new mi(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new qa}},sprite:{diffuse:{value:new mi(15658734)},opacity:{value:1},center:{value:new bn(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new qa}}},fc={basic:{uniforms:ca([fi.common,fi.specularmap,fi.envmap,fi.aomap,fi.lightmap,fi.fog]),vertexShader:Nr.meshbasic_vert,fragmentShader:Nr.meshbasic_frag},lambert:{uniforms:ca([fi.common,fi.specularmap,fi.envmap,fi.aomap,fi.lightmap,fi.emissivemap,fi.fog,fi.lights,{emissive:{value:new mi(0)}}]),vertexShader:Nr.meshlambert_vert,fragmentShader:Nr.meshlambert_frag},phong:{uniforms:ca([fi.common,fi.specularmap,fi.envmap,fi.aomap,fi.lightmap,fi.emissivemap,fi.bumpmap,fi.normalmap,fi.displacementmap,fi.fog,fi.lights,{emissive:{value:new mi(0)},specular:{value:new mi(1118481)},shininess:{value:30}}]),vertexShader:Nr.meshphong_vert,fragmentShader:Nr.meshphong_frag},standard:{uniforms:ca([fi.common,fi.envmap,fi.aomap,fi.lightmap,fi.emissivemap,fi.bumpmap,fi.normalmap,fi.displacementmap,fi.roughnessmap,fi.metalnessmap,fi.fog,fi.lights,{emissive:{value:new mi(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Nr.meshphysical_vert,fragmentShader:Nr.meshphysical_frag},toon:{uniforms:ca([fi.common,fi.aomap,fi.lightmap,fi.emissivemap,fi.bumpmap,fi.normalmap,fi.displacementmap,fi.gradientmap,fi.fog,fi.lights,{emissive:{value:new mi(0)}}]),vertexShader:Nr.meshtoon_vert,fragmentShader:Nr.meshtoon_frag},matcap:{uniforms:ca([fi.common,fi.bumpmap,fi.normalmap,fi.displacementmap,fi.fog,{matcap:{value:null}}]),vertexShader:Nr.meshmatcap_vert,fragmentShader:Nr.meshmatcap_frag},points:{uniforms:ca([fi.points,fi.fog]),vertexShader:Nr.points_vert,fragmentShader:Nr.points_frag},dashed:{uniforms:ca([fi.common,fi.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Nr.linedashed_vert,fragmentShader:Nr.linedashed_frag},depth:{uniforms:ca([fi.common,fi.displacementmap]),vertexShader:Nr.depth_vert,fragmentShader:Nr.depth_frag},normal:{uniforms:ca([fi.common,fi.bumpmap,fi.normalmap,fi.displacementmap,{opacity:{value:1}}]),vertexShader:Nr.normal_vert,fragmentShader:Nr.normal_frag},sprite:{uniforms:ca([fi.sprite,fi.fog]),vertexShader:Nr.sprite_vert,fragmentShader:Nr.sprite_frag},background:{uniforms:{uvTransform:{value:new qa},t2D:{value:null}},vertexShader:Nr.background_vert,fragmentShader:Nr.background_frag},cube:{uniforms:ca([fi.envmap,{opacity:{value:1}}]),vertexShader:Nr.cube_vert,fragmentShader:Nr.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Nr.equirect_vert,fragmentShader:Nr.equirect_frag},distanceRGBA:{uniforms:ca([fi.common,fi.displacementmap,{referencePosition:{value:new pe},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Nr.distanceRGBA_vert,fragmentShader:Nr.distanceRGBA_frag},shadow:{uniforms:ca([fi.lights,fi.fog,{color:{value:new mi(0)},opacity:{value:1}}]),vertexShader:Nr.shadow_vert,fragmentShader:Nr.shadow_frag}};fc.physical={uniforms:ca([fc.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new bn(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new mi(0)},transmission:{value:0},transmissionMap:{value:null}}]),vertexShader:Nr.meshphysical_vert,fragmentShader:Nr.meshphysical_frag};function gA(e,a,t,s,l){var f=new mi(0),v=0,x,w,E=null,P=0,R=null;function V(q,z,G,ie){var le=z.isScene===!0?z.background:null;le&&le.isTexture&&(le=a.get(le));var ae=e.xr,J=ae.getSession&&ae.getSession();J&&J.environmentBlendMode==="additive"&&(le=null),le===null?H(f,v):le&&le.isColor&&(H(le,1),ie=!0),(e.autoClear||ie)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),le&&(le.isCubeTexture||le.isWebGLCubeRenderTarget||le.mapping===Pt)?(w===void 0&&(w=new xr(new ol(1,1,1),new za({name:"BackgroundCubeMaterial",uniforms:Ho(fc.cube.uniforms),vertexShader:fc.cube.vertexShader,fragmentShader:fc.cube.fragmentShader,side:O,depthTest:!1,depthWrite:!1,fog:!1})),w.geometry.deleteAttribute("normal"),w.geometry.deleteAttribute("uv"),w.onBeforeRender=function(se,ge,_e){this.matrixWorld.copyPosition(_e.matrixWorld)},Object.defineProperty(w.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),s.update(w)),le.isWebGLCubeRenderTarget&&(le=le.texture),w.material.uniforms.envMap.value=le,w.material.uniforms.flipEnvMap.value=le.isCubeTexture&&le._needsFlipEnvMap?-1:1,(E!==le||P!==le.version||R!==e.toneMapping)&&(w.material.needsUpdate=!0,E=le,P=le.version,R=e.toneMapping),q.unshift(w,w.geometry,w.material,0,0,null)):le&&le.isTexture&&(x===void 0&&(x=new xr(new nx(2,2),new za({name:"BackgroundMaterial",uniforms:Ho(fc.background.uniforms),vertexShader:fc.background.vertexShader,fragmentShader:fc.background.fragmentShader,side:F,depthTest:!1,depthWrite:!1,fog:!1})),x.geometry.deleteAttribute("normal"),Object.defineProperty(x.material,"map",{get:function(){return this.uniforms.t2D.value}}),s.update(x)),x.material.uniforms.t2D.value=le,le.matrixAutoUpdate===!0&&le.updateMatrix(),x.material.uniforms.uvTransform.value.copy(le.matrix),(E!==le||P!==le.version||R!==e.toneMapping)&&(x.material.needsUpdate=!0,E=le,P=le.version,R=e.toneMapping),q.unshift(x,x.geometry,x.material,0,0,null))}function H(q,z){t.buffers.color.setClear(q.r,q.g,q.b,z,l)}return{getClearColor:function(){return f},setClearColor:function(q,z){f.set(q),v=z!==void 0?z:1,H(f,v)},getClearAlpha:function(){return v},setClearAlpha:function(q){v=q,H(f,v)},render:V}}function vA(e,a,t,s){var l=e.getParameter(34921),f=s.isWebGL2?null:a.get("OES_vertex_array_object"),v=s.isWebGL2||f!==null,x={},w=z(null),E=w;function P(Me,be,ve,Ze,Ke){var Qe=!1;if(v){var Bt=q(Ze,ve,be);E!==Bt&&(E=Bt,V(E.object)),Qe=G(Ze,Ke),Qe&&ie(Ze,Ke)}else{var fn=be.wireframe===!0;(E.geometry!==Ze.id||E.program!==ve.id||E.wireframe!==fn)&&(E.geometry=Ze.id,E.program=ve.id,E.wireframe=fn,Qe=!0)}Me.isInstancedMesh===!0&&(Qe=!0),Ke!==null&&t.update(Ke,34963),Qe&&(_e(Me,be,ve,Ze),Ke!==null&&e.bindBuffer(34963,t.get(Ke).buffer))}function R(){return s.isWebGL2?e.createVertexArray():f.createVertexArrayOES()}function V(Me){return s.isWebGL2?e.bindVertexArray(Me):f.bindVertexArrayOES(Me)}function H(Me){return s.isWebGL2?e.deleteVertexArray(Me):f.deleteVertexArrayOES(Me)}function q(Me,be,ve){var Ze=ve.wireframe===!0,Ke=x[Me.id];Ke===void 0&&(Ke={},x[Me.id]=Ke);var Qe=Ke[be.id];Qe===void 0&&(Qe={},Ke[be.id]=Qe);var Bt=Qe[Ze];return Bt===void 0&&(Bt=z(R()),Qe[Ze]=Bt),Bt}function z(Me){for(var be=[],ve=[],Ze=[],Ke=0;Ke<l;Ke++)be[Ke]=0,ve[Ke]=0,Ze[Ke]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:be,enabledAttributes:ve,attributeDivisors:Ze,object:Me,attributes:{},index:null}}function G(Me,be){var ve=E.attributes,Ze=Me.attributes;if(Object.keys(ve).length!==Object.keys(Ze).length)return!0;for(var Ke in Ze){var Qe=ve[Ke],Bt=Ze[Ke];if(Qe===void 0||Qe.attribute!==Bt||Qe.data!==Bt.data)return!0}return E.index!==be}function ie(Me,be){var ve={},Ze=Me.attributes;for(var Ke in Ze){var Qe=Ze[Ke],Bt={};Bt.attribute=Qe,Qe.data&&(Bt.data=Qe.data),ve[Ke]=Bt}E.attributes=ve,E.index=be}function le(){for(var Me=E.newAttributes,be=0,ve=Me.length;be<ve;be++)Me[be]=0}function ae(Me){J(Me,0)}function J(Me,be){var ve=E.newAttributes,Ze=E.enabledAttributes,Ke=E.attributeDivisors;if(ve[Me]=1,Ze[Me]===0&&(e.enableVertexAttribArray(Me),Ze[Me]=1),Ke[Me]!==be){var Qe=s.isWebGL2?e:a.get("ANGLE_instanced_arrays");Qe[s.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](Me,be),Ke[Me]=be}}function se(){for(var Me=E.newAttributes,be=E.enabledAttributes,ve=0,Ze=be.length;ve<Ze;ve++)be[ve]!==Me[ve]&&(e.disableVertexAttribArray(ve),be[ve]=0)}function ge(Me,be,ve,Ze,Ke,Qe){s.isWebGL2===!0&&(ve===5124||ve===5125)?e.vertexAttribIPointer(Me,be,ve,Ke,Qe):e.vertexAttribPointer(Me,be,ve,Ze,Ke,Qe)}function _e(Me,be,ve,Ze){if(!(s.isWebGL2===!1&&(Me.isInstancedMesh||Ze.isInstancedBufferGeometry)&&a.get("ANGLE_instanced_arrays")===null)){le();var Ke=Ze.attributes,Qe=ve.getAttributes(),Bt=be.defaultAttributeValues;for(var fn in Qe){var un=Qe[fn];if(un>=0){var Qt=Ke[fn];if(Qt!==void 0){var Sn=Qt.normalized,ai=Qt.itemSize,ei=t.get(Qt);if(ei===void 0)continue;var Pi=ei.buffer,Hi=ei.type,on=ei.bytesPerElement;if(Qt.isInterleavedBufferAttribute){var _r=Qt.data,pr=_r.stride,Zi=Qt.offset;_r&&_r.isInstancedInterleavedBuffer?(J(un,_r.meshPerAttribute),Ze._maxInstanceCount===void 0&&(Ze._maxInstanceCount=_r.meshPerAttribute*_r.count)):ae(un),e.bindBuffer(34962,Pi),ge(un,ai,Hi,Sn,pr*on,Zi*on)}else Qt.isInstancedBufferAttribute?(J(un,Qt.meshPerAttribute),Ze._maxInstanceCount===void 0&&(Ze._maxInstanceCount=Qt.meshPerAttribute*Qt.count)):ae(un),e.bindBuffer(34962,Pi),ge(un,ai,Hi,Sn,0,0)}else if(fn==="instanceMatrix"){var Xr=t.get(Me.instanceMatrix);if(Xr===void 0)continue;var Sr=Xr.buffer,rs=Xr.type;J(un+0,1),J(un+1,1),J(un+2,1),J(un+3,1),e.bindBuffer(34962,Sr),e.vertexAttribPointer(un+0,4,rs,!1,64,0),e.vertexAttribPointer(un+1,4,rs,!1,64,16),e.vertexAttribPointer(un+2,4,rs,!1,64,32),e.vertexAttribPointer(un+3,4,rs,!1,64,48)}else if(fn==="instanceColor"){var zr=t.get(Me.instanceColor);if(zr===void 0)continue;var As=zr.buffer,ze=zr.type;J(un,1),e.bindBuffer(34962,As),e.vertexAttribPointer(un,3,ze,!1,12,0)}else if(Bt!==void 0){var re=Bt[fn];if(re!==void 0)switch(re.length){case 2:e.vertexAttrib2fv(un,re);break;case 3:e.vertexAttrib3fv(un,re);break;case 4:e.vertexAttrib4fv(un,re);break;default:e.vertexAttrib1fv(un,re)}}}}se()}}function We(){nt(),E!==w&&(E=w,V(E.object))}function nt(){w.geometry=null,w.program=null,w.wireframe=!1}return{setup:P,reset:We,resetDefaultState:nt,dispose:function(){We();for(var Me in x){var be=x[Me];for(var ve in be){var Ze=be[ve];for(var Ke in Ze)H(Ze[Ke].object),delete Ze[Ke];delete be[ve]}delete x[Me]}},releaseStatesOfGeometry:function(Me){if(x[Me.id]!==void 0){var be=x[Me.id];for(var ve in be){var Ze=be[ve];for(var Ke in Ze)H(Ze[Ke].object),delete Ze[Ke];delete be[ve]}delete x[Me.id]}},releaseStatesOfProgram:function(Me){for(var be in x){var ve=x[be];if(ve[Me.id]!==void 0){var Ze=ve[Me.id];for(var Ke in Ze)H(Ze[Ke].object),delete Ze[Ke];delete ve[Me.id]}}},initAttributes:le,enableAttribute:ae,disableUnusedAttributes:se}}function yA(e,a,t,s){var l=s.isWebGL2,f;function v(w,E){e.drawArrays(f,w,E),t.update(E,f,1)}function x(w,E,P){if(P!==0){var R,V;if(l)R=e,V="drawArraysInstanced";else if(R=a.get("ANGLE_instanced_arrays"),V="drawArraysInstancedANGLE",R===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}R[V](f,w,E,P),t.update(E,f,P)}}this.setMode=function(w){f=w},this.render=v,this.renderInstances=x}function xA(e,a,t){var s;function l(){if(s!==void 0)return s;var se=a.get("EXT_texture_filter_anisotropic");return se!==null?s=e.getParameter(se.MAX_TEXTURE_MAX_ANISOTROPY_EXT):s=0,s}function f(se){if(se==="highp"){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";se="mediump"}return se==="mediump"&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}var v=typeof WebGL2RenderingContext<"u"&&e instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&e instanceof WebGL2ComputeRenderingContext,x=t.precision!==void 0?t.precision:"highp",w=f(x);w!==x&&(console.warn("THREE.WebGLRenderer:",x,"not supported, using",w,"instead."),x=w);var E=t.logarithmicDepthBuffer===!0,P=e.getParameter(34930),R=e.getParameter(35660),V=e.getParameter(3379),H=e.getParameter(34076),q=e.getParameter(34921),z=e.getParameter(36347),G=e.getParameter(36348),ie=e.getParameter(36349),le=R>0,ae=v||!!a.get("OES_texture_float"),J=v?e.getParameter(36183):0;return{isWebGL2:v,getMaxAnisotropy:l,getMaxPrecision:f,precision:x,logarithmicDepthBuffer:E,maxTextures:P,maxVertexTextures:R,maxTextureSize:V,maxCubemapSize:H,maxAttributes:q,maxVertexUniforms:z,maxVaryings:G,maxFragmentUniforms:ie,vertexTextures:le,floatFragmentTextures:ae,floatVertexTextures:le&&ae,maxSamples:J}}function _A(e){var a=this,t=null,s=0,l=!1,f=!1,v=new so,x=new qa,w={value:null,needsUpdate:!1};this.uniform=w,this.numPlanes=0,this.numIntersection=0,this.init=function(R,V,H){var q=R.length!==0||V||s!==0||l;return l=V,t=P(R,H,0),s=R.length,q},this.beginShadows=function(){f=!0,P(null)},this.endShadows=function(){f=!1,E()},this.setState=function(R,V,H){var q=R.clippingPlanes,z=R.clipIntersection,G=R.clipShadows,ie=e.get(R);if(!l||q===null||q.length===0||f&&!G)f?P(null):E();else{var le=f?0:s,ae=le*4,J=ie.clippingState||null;w.value=J,J=P(q,V,ae,H);for(var se=0;se!==ae;++se)J[se]=t[se];ie.clippingState=J,this.numIntersection=z?this.numPlanes:0,this.numPlanes+=le}};function E(){w.value!==t&&(w.value=t,w.needsUpdate=s>0),a.numPlanes=s,a.numIntersection=0}function P(R,V,H,q){var z=R!==null?R.length:0,G=null;if(z!==0){if(G=w.value,q!==!0||G===null){var ie=H+z*4,le=V.matrixWorldInverse;x.getNormalMatrix(le),(G===null||G.length<ie)&&(G=new Float32Array(ie));for(var ae=0,J=H;ae!==z;++ae,J+=4)v.copy(R[ae]).applyMatrix4(le,x),v.normal.toArray(G,J),G[J+3]=v.constant}w.value=G,w.needsUpdate=!0}return a.numPlanes=z,a.numIntersection=0,G}}function bA(e){var a=new WeakMap;function t(l,f){return f===yt?l.mapping=oe:f===Ce&&(l.mapping=lt),l}function s(l){if(l&&l.isTexture){var f=l.mapping;if(f===yt||f===Ce)if(a.has(l)){var v=a.get(l).texture;return t(v,l.mapping)}else{var x=l.image;if(x&&x.height>0){var w=e.getRenderList(),E=e.getRenderTarget(),P=e.getRenderState(),R=new nf(x.height/2);return R.fromEquirectangularTexture(e,l),a.set(l,R),e.setRenderTarget(E),e.setRenderList(w),e.setRenderState(P),t(R.texture,l.mapping)}else return null}}return l}return{get:s,dispose:function(){a=new WeakMap}}}function wA(e){var a={};return{has:function(t){if(a[t]!==void 0)return a[t]!==null;var s;switch(t){case"WEBGL_depth_texture":s=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":s=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":s=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":s=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:s=e.getExtension(t)}return a[t]=s,s!==null},get:function(t){return this.has(t)||console.warn("THREE.WebGLRenderer: "+t+" extension not supported."),a[t]}}}function MA(e,a,t,s){var l=new WeakMap,f=new WeakMap;function v(E){var P=E.target,R=l.get(P);R.index!==null&&a.remove(R.index);for(var V in R.attributes)a.remove(R.attributes[V]);P.removeEventListener("dispose",v),l.delete(P);var H=f.get(R);H&&(a.remove(H),f.delete(R)),s.releaseStatesOfGeometry(P),P.isInstancedBufferGeometry===!0&&delete P._maxInstanceCount,t.memory.geometries--}function x(E){var P=E.attributes;for(var R in P)a.update(P[R],34962);var V=E.morphAttributes;for(var H in V)for(var q=V[H],z=0,G=q.length;z<G;z++)a.update(q[z],34962)}function w(E){var P=[],R=E.index,V=E.attributes.position,H=0;if(R!==null){var q=R.array;H=R.version;for(var z=0,G=q.length;z<G;z+=3){var ie=q[z+0],le=q[z+1],ae=q[z+2];P.push(ie,le,le,ae,ae,ie)}}else{var J=V.array;H=V.version;for(var se=0,ge=J.length/3-1;se<ge;se+=3){var _e=se+0,We=se+1,nt=se+2;P.push(_e,We,We,nt,nt,_e)}}var Me=new(Z(P)>65535?S:$u)(P,1);Me.version=H;var be=f.get(E);be&&a.remove(be),f.set(E,Me)}return{get:function(E,P){var R=l.get(P);return R||(P.addEventListener("dispose",v),P.isBufferGeometry?R=P:P.isGeometry&&(P._bufferGeometry===void 0&&(P._bufferGeometry=new qe().setFromObject(E)),R=P._bufferGeometry),l.set(P,R),t.memory.geometries++,R)},update:x,getWireframeAttribute:function(E){var P=f.get(E);if(P){var R=E.index;R!==null&&P.version<R.version&&w(E)}else w(E);return f.get(E)}}}function SA(e,a,t,s){var l=s.isWebGL2,f,v,x;function w(P,R){e.drawElements(f,R,v,P*x),t.update(R,f,1)}function E(P,R,V){if(V!==0){var H,q;if(l)H=e,q="drawElementsInstanced";else if(H=a.get("ANGLE_instanced_arrays"),q="drawElementsInstancedANGLE",H===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}H[q](f,R,v,P*x,V),t.update(R,f,V)}}this.setMode=function(P){f=P},this.setIndex=function(P){v=P.type,x=P.bytesPerElement},this.render=w,this.renderInstances=E}function EA(){var e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function(){e.frame++,e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function(a,t,s){switch(e.calls++,t){case 4:e.triangles+=s*(a/3);break;case 1:e.lines+=s*(a/2);break;case 3:e.lines+=s*(a-1);break;case 2:e.lines+=s*a;break;case 0:e.points+=s*a;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",t);break}}}}function TA(e,a){return e[0]-a[0]}function AA(e,a){return Math.abs(a[1])-Math.abs(e[1])}function LA(e){for(var a={},t=new Float32Array(8),s=[],l=0;l<8;l++)s[l]=[l,0];return{update:function(f,v,x,w){var E=f.morphTargetInfluences,P=E===void 0?0:E.length,R=a[v.id];if(R===void 0){R=[];for(var V=0;V<P;V++)R[V]=[V,0];a[v.id]=R}for(var H=0;H<P;H++){var q=R[H];q[0]=H,q[1]=E[H]}R.sort(AA);for(var z=0;z<8;z++)z<P&&R[z][1]?(s[z][0]=R[z][0],s[z][1]=R[z][1]):(s[z][0]=Number.MAX_SAFE_INTEGER,s[z][1]=0);s.sort(TA);for(var G=x.morphTargets&&v.morphAttributes.position,ie=x.morphNormals&&v.morphAttributes.normal,le=0,ae=0;ae<8;ae++){var J=s[ae],se=J[0],ge=J[1];se!==Number.MAX_SAFE_INTEGER&&ge?(G&&v.getAttribute("morphTarget"+ae)!==G[se]&&v.setAttribute("morphTarget"+ae,G[se]),ie&&v.getAttribute("morphNormal"+ae)!==ie[se]&&v.setAttribute("morphNormal"+ae,ie[se]),t[ae]=ge,le+=ge):(G&&v.getAttribute("morphTarget"+ae)!==void 0&&v.deleteAttribute("morphTarget"+ae),ie&&v.getAttribute("morphNormal"+ae)!==void 0&&v.deleteAttribute("morphNormal"+ae),t[ae]=0)}var _e=v.morphTargetsRelative?1:1-le;w.getUniforms().setValue(e,"morphTargetBaseInfluence",_e),w.getUniforms().setValue(e,"morphTargetInfluences",t)}}}function CA(e,a,t,s){var l=new WeakMap;function f(v){var x=s.render.frame,w=v.geometry,E=a.get(v,w);return l.get(E)!==x&&(w.isGeometry&&E.updateFromObject(v),a.update(E),l.set(E,x)),v.isInstancedMesh&&(t.update(v.instanceMatrix,34962),v.instanceColor!==null&&t.update(v.instanceColor,34962)),E}return{update:f,dispose:function(){l=new WeakMap}}}function im(e,a,t,s){ds.call(this,null),this.image={data:e||null,width:a||1,height:t||1,depth:s||1},this.magFilter=Ht,this.minFilter=Ht,this.wrapR=xn,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}im.prototype=Object.create(ds.prototype),im.prototype.constructor=im,im.prototype.isDataTexture2DArray=!0;function rm(e,a,t,s){ds.call(this,null),this.image={data:e||null,width:a||1,height:t||1,depth:s||1},this.magFilter=Ht,this.minFilter=Ht,this.wrapR=xn,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}rm.prototype=Object.create(ds.prototype),rm.prototype.constructor=rm,rm.prototype.isDataTexture3D=!0;var n1=new ds,PA=new im,RA=new rm,i1=new ru,r1=[],s1=[],a1=new Float32Array(16),o1=new Float32Array(9),l1=new Float32Array(4);function sm(e,a,t){var s=e[0];if(s<=0||s>0)return e;var l=a*t,f=r1[l];if(f===void 0&&(f=new Float32Array(l),r1[l]=f),a!==0){s.toArray(f,0);for(var v=1,x=0;v!==a;++v)x+=t,e[v].toArray(f,x)}return f}function Dl(e,a){if(e.length!==a.length)return!1;for(var t=0,s=e.length;t<s;t++)if(e[t]!==a[t])return!1;return!0}function ll(e,a){for(var t=0,s=a.length;t<s;t++)e[t]=a[t]}function c1(e,a){var t=s1[a];t===void 0&&(t=new Int32Array(a),s1[a]=t);for(var s=0;s!==a;++s)t[s]=e.allocateTextureUnit();return t}function DA(e,a){var t=this.cache;t[0]!==a&&(e.uniform1f(this.addr,a),t[0]=a)}function OA(e,a){var t=this.cache;if(a.x!==void 0)(t[0]!==a.x||t[1]!==a.y)&&(e.uniform2f(this.addr,a.x,a.y),t[0]=a.x,t[1]=a.y);else{if(Dl(t,a))return;e.uniform2fv(this.addr,a),ll(t,a)}}function IA(e,a){var t=this.cache;if(a.x!==void 0)(t[0]!==a.x||t[1]!==a.y||t[2]!==a.z)&&(e.uniform3f(this.addr,a.x,a.y,a.z),t[0]=a.x,t[1]=a.y,t[2]=a.z);else if(a.r!==void 0)(t[0]!==a.r||t[1]!==a.g||t[2]!==a.b)&&(e.uniform3f(this.addr,a.r,a.g,a.b),t[0]=a.r,t[1]=a.g,t[2]=a.b);else{if(Dl(t,a))return;e.uniform3fv(this.addr,a),ll(t,a)}}function NA(e,a){var t=this.cache;if(a.x!==void 0)(t[0]!==a.x||t[1]!==a.y||t[2]!==a.z||t[3]!==a.w)&&(e.uniform4f(this.addr,a.x,a.y,a.z,a.w),t[0]=a.x,t[1]=a.y,t[2]=a.z,t[3]=a.w);else{if(Dl(t,a))return;e.uniform4fv(this.addr,a),ll(t,a)}}function FA(e,a){var t=this.cache,s=a.elements;if(s===void 0){if(Dl(t,a))return;e.uniformMatrix2fv(this.addr,!1,a),ll(t,a)}else{if(Dl(t,s))return;l1.set(s),e.uniformMatrix2fv(this.addr,!1,l1),ll(t,s)}}function BA(e,a){var t=this.cache,s=a.elements;if(s===void 0){if(Dl(t,a))return;e.uniformMatrix3fv(this.addr,!1,a),ll(t,a)}else{if(Dl(t,s))return;o1.set(s),e.uniformMatrix3fv(this.addr,!1,o1),ll(t,s)}}function kA(e,a){var t=this.cache,s=a.elements;if(s===void 0){if(Dl(t,a))return;e.uniformMatrix4fv(this.addr,!1,a),ll(t,a)}else{if(Dl(t,s))return;a1.set(s),e.uniformMatrix4fv(this.addr,!1,a1),ll(t,s)}}function zA(e,a,t){var s=this.cache,l=t.allocateTextureUnit();s[0]!==l&&(e.uniform1i(this.addr,l),s[0]=l),t.safeSetTexture2D(a||n1,l)}function UA(e,a,t){var s=this.cache,l=t.allocateTextureUnit();s[0]!==l&&(e.uniform1i(this.addr,l),s[0]=l),t.setTexture2DArray(a||PA,l)}function HA(e,a,t){var s=this.cache,l=t.allocateTextureUnit();s[0]!==l&&(e.uniform1i(this.addr,l),s[0]=l),t.setTexture3D(a||RA,l)}function GA(e,a,t){var s=this.cache,l=t.allocateTextureUnit();s[0]!==l&&(e.uniform1i(this.addr,l),s[0]=l),t.safeSetTextureCube(a||i1,l)}function VA(e,a){var t=this.cache;t[0]!==a&&(e.uniform1i(this.addr,a),t[0]=a)}function WA(e,a){var t=this.cache;Dl(t,a)||(e.uniform2iv(this.addr,a),ll(t,a))}function XA(e,a){var t=this.cache;Dl(t,a)||(e.uniform3iv(this.addr,a),ll(t,a))}function qA(e,a){var t=this.cache;Dl(t,a)||(e.uniform4iv(this.addr,a),ll(t,a))}function jA(e,a){var t=this.cache;t[0]!==a&&(e.uniform1ui(this.addr,a),t[0]=a)}function YA(e){switch(e){case 5126:return DA;case 35664:return OA;case 35665:return IA;case 35666:return NA;case 35674:return FA;case 35675:return BA;case 35676:return kA;case 5124:case 35670:return VA;case 35667:case 35671:return WA;case 35668:case 35672:return XA;case 35669:case 35673:return qA;case 5125:return jA;case 35678:case 36198:case 36298:case 36306:case 35682:return zA;case 35679:case 36299:case 36307:return HA;case 35680:case 36300:case 36308:case 36293:return GA;case 36289:case 36303:case 36311:case 36292:return UA}}function ZA(e,a){e.uniform1fv(this.addr,a)}function JA(e,a){e.uniform1iv(this.addr,a)}function $A(e,a){e.uniform2iv(this.addr,a)}function KA(e,a){e.uniform3iv(this.addr,a)}function QA(e,a){e.uniform4iv(this.addr,a)}function eL(e,a){var t=sm(a,this.size,2);e.uniform2fv(this.addr,t)}function tL(e,a){var t=sm(a,this.size,3);e.uniform3fv(this.addr,t)}function nL(e,a){var t=sm(a,this.size,4);e.uniform4fv(this.addr,t)}function iL(e,a){var t=sm(a,this.size,4);e.uniformMatrix2fv(this.addr,!1,t)}function rL(e,a){var t=sm(a,this.size,9);e.uniformMatrix3fv(this.addr,!1,t)}function sL(e,a){var t=sm(a,this.size,16);e.uniformMatrix4fv(this.addr,!1,t)}function aL(e,a,t){var s=a.length,l=c1(t,s);e.uniform1iv(this.addr,l);for(var f=0;f!==s;++f)t.safeSetTexture2D(a[f]||n1,l[f])}function oL(e,a,t){var s=a.length,l=c1(t,s);e.uniform1iv(this.addr,l);for(var f=0;f!==s;++f)t.safeSetTextureCube(a[f]||i1,l[f])}function lL(e){switch(e){case 5126:return ZA;case 35664:return eL;case 35665:return tL;case 35666:return nL;case 35674:return iL;case 35675:return rL;case 35676:return sL;case 5124:case 35670:return JA;case 35667:case 35671:return $A;case 35668:case 35672:return KA;case 35669:case 35673:return QA;case 35678:case 36198:case 36298:case 36306:case 35682:return aL;case 35680:case 36300:case 36308:case 36293:return oL}}function cL(e,a,t){this.id=e,this.addr=t,this.cache=[],this.setValue=YA(a.type)}function u1(e,a,t){this.id=e,this.addr=t,this.cache=[],this.size=a.size,this.setValue=lL(a.type)}u1.prototype.updateCache=function(e){var a=this.cache;e instanceof Float32Array&&a.length!==e.length&&(this.cache=new Float32Array(e.length)),ll(a,e)};function h1(e){this.id=e,this.seq=[],this.map={}}h1.prototype.setValue=function(e,a,t){for(var s=this.seq,l=0,f=s.length;l!==f;++l){var v=s[l];v.setValue(e,a[v.id],t)}};var Xw=/([\w\d_]+)(\])?(\[|\.)?/g;function f1(e,a){e.seq.push(a),e.map[a.id]=a}function uL(e,a,t){var s=e.name,l=s.length;for(Xw.lastIndex=0;;){var f=Xw.exec(s),v=Xw.lastIndex,x=f[1],w=f[2]==="]",E=f[3];if(w&&(x=x|0),E===void 0||E==="["&&v+2===l){f1(t,E===void 0?new cL(x,e,a):new u1(x,e,a));break}else{var P=t.map,R=P[x];R===void 0&&(R=new h1(x),f1(t,R)),t=R}}}function rf(e,a){this.seq=[],this.map={};for(var t=e.getProgramParameter(a,35718),s=0;s<t;++s){var l=e.getActiveUniform(a,s),f=e.getUniformLocation(a,l.name);uL(l,f,this)}}rf.prototype.setValue=function(e,a,t,s){var l=this.map[a];l!==void 0&&l.setValue(e,t,s)},rf.prototype.setOptional=function(e,a,t){var s=a[t];s!==void 0&&this.setValue(e,t,s)},rf.upload=function(e,a,t,s){for(var l=0,f=a.length;l!==f;++l){var v=a[l],x=t[v.id];x.needsUpdate!==!1&&v.setValue(e,x.value,s)}},rf.seqWithValue=function(e,a){for(var t=[],s=0,l=e.length;s!==l;++s){var f=e[s];f.id in a&&t.push(f)}return t};function d1(e,a,t){var s=e.createShader(a);return e.shaderSource(s,t),e.compileShader(s),s}var hL=0;function fL(e){for(var a=e.split(`
`),t=0;t<a.length;t++)a[t]=t+1+": "+a[t];return a.join(`
`)}function p1(e){switch(e){case Da:return["Linear","( value )"];case Uu:return["sRGB","( value )"];case jc:return["RGBE","( value )"];case $g:return["RGBM","( value, 7.0 )"];case sd:return["RGBM","( value, 16.0 )"];case Kg:return["RGBD","( value, 256.0 )"];case rd:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case Oa:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",e),["Linear","( value )"]}}function m1(e,a,t){var s=e.getShaderParameter(a,35713),l=e.getShaderInfoLog(a).trim();if(s&&l==="")return"";var f=e.getShaderSource(a);return"THREE.WebGLShader: gl.getShaderInfoLog() "+t+`
`+l+fL(f)}function fv(e,a){var t=p1(a);return"vec4 "+e+"( vec4 value ) { return "+t[0]+"ToLinear"+t[1]+"; }"}function dL(e,a){var t=p1(a);return"vec4 "+e+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function pL(e,a){var t;switch(a){case He:t="Linear";break;case Je:t="Reinhard";break;case ot:t="OptimizedCineon";break;case bt:t="ACESFilmic";break;case Mt:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",a),t="Linear"}return"vec3 "+e+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function mL(e){var a=[e.extensionDerivatives||e.envMapCubeUV||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||e.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""];return a.filter(dv).join(`
`)}function gL(e){var a=[];for(var t in e){var s=e[t];s!==!1&&a.push("#define "+t+" "+s)}return a.join(`
`)}function vL(e,a){for(var t={},s=e.getProgramParameter(a,35721),l=0;l<s;l++){var f=e.getActiveAttrib(a,l),v=f.name;t[v]=e.getAttribLocation(a,v)}return t}function dv(e){return e!==""}function g1(e,a){return e.replace(/NUM_DIR_LIGHTS/g,a.numDirLights).replace(/NUM_SPOT_LIGHTS/g,a.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,a.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,a.numPointLights).replace(/NUM_HEMI_LIGHTS/g,a.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,a.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,a.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,a.numPointLightShadows)}function v1(e,a){return e.replace(/NUM_CLIPPING_PLANES/g,a.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,a.numClippingPlanes-a.numClipIntersection)}function qw(e){return e.replace(/^[ \t]*#include +<([\w\d./]+)>/gm,yL)}function yL(e,a){var t=Nr[a];if(t===void 0)throw new Error("Can not resolve #include <"+a+">");return qw(t)}function y1(e){return e.replace(/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g,x1).replace(/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,xL)}function xL(e,a,t,s){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),x1(e,a,t,s)}function x1(e,a,t,s){for(var l="",f=parseInt(a);f<parseInt(t);f++)l+=s.replace(/\[\s*i\s*\]/g,"[ "+f+" ]").replace(/UNROLLED_LOOP_INDEX/g,f);return l}function _1(e){var a="precision "+e.precision+` float;
precision `+e.precision+" int;";return e.precision==="highp"?a+=`
#define HIGH_PRECISION`:e.precision==="mediump"?a+=`
#define MEDIUM_PRECISION`:e.precision==="lowp"&&(a+=`
#define LOW_PRECISION`),a}function _L(e){var a="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===M?a="SHADOWMAP_TYPE_PCF":e.shadowMapType===A?a="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===C&&(a="SHADOWMAP_TYPE_VSM"),a}function bL(e){var a="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case oe:case lt:a="ENVMAP_TYPE_CUBE";break;case Pt:case Kt:a="ENVMAP_TYPE_CUBE_UV";break}return a}function wL(e){var a="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case lt:case Kt:a="ENVMAP_MODE_REFRACTION";break}return a}function ML(e){var a="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case Le:a="ENVMAP_BLENDING_MULTIPLY";break;case Be:a="ENVMAP_BLENDING_MIX";break;case Ye:a="ENVMAP_BLENDING_ADD";break}return a}function SL(e,a,t,s){var l=e.getContext(),f=t.defines,v=t.vertexShader,x=t.fragmentShader,w=_L(t),E=bL(t),P=wL(t),R=ML(t),V=e.gammaFactor>0?e.gammaFactor:1,H=t.isWebGL2?"":mL(t),q=gL(f),z=l.createProgram(),G,ie,le=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(G=[q].filter(dv).join(`
`),G.length>0&&(G+=`
`),ie=[H,q].filter(dv).join(`
`),ie.length>0&&(ie+=`
`)):(G=[_1(t),"#define SHADER_NAME "+t.shaderName,q,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+V,"#define MAX_BONES "+t.maxBones,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+P:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.useVertexTexture?"#define BONE_TEXTURE":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+w:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#ifdef USE_COLOR","	attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(dv).join(`
`),ie=[H,_1(t),"#define SHADER_NAME "+t.shaderName,q,t.alphaTest?"#define ALPHATEST "+t.alphaTest+(t.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+V,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+E:"",t.envMap?"#define "+P:"",t.envMap?"#define "+R:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.sheen?"#define USE_SHEEN":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+w:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(t.extensionShaderTextureLOD||t.envMap)&&t.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==ke?"#define TONE_MAPPING":"",t.toneMapping!==ke?Nr.tonemapping_pars_fragment:"",t.toneMapping!==ke?pL("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",Nr.encodings_pars_fragment,t.map?fv("mapTexelToLinear",t.mapEncoding):"",t.matcap?fv("matcapTexelToLinear",t.matcapEncoding):"",t.envMap?fv("envMapTexelToLinear",t.envMapEncoding):"",t.emissiveMap?fv("emissiveMapTexelToLinear",t.emissiveMapEncoding):"",t.lightMap?fv("lightMapTexelToLinear",t.lightMapEncoding):"",dL("linearToOutputTexel",t.outputEncoding),t.depthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(dv).join(`
`)),v=qw(v),v=g1(v,t),v=v1(v,t),x=qw(x),x=g1(x,t),x=v1(x,t),v=y1(v),x=y1(x),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(le=`#version 300 es
`,G=["#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+G,ie=["#define varying in",t.glslVersion===od?"":"out highp vec4 pc_fragColor;",t.glslVersion===od?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+ie);var ae=le+G+v,J=le+ie+x,se=d1(l,35633,ae),ge=d1(l,35632,J);if(l.attachShader(z,se),l.attachShader(z,ge),t.index0AttributeName!==void 0?l.bindAttribLocation(z,0,t.index0AttributeName):t.morphTargets===!0&&l.bindAttribLocation(z,0,"position"),l.linkProgram(z),e.debug.checkShaderErrors){var _e=l.getProgramInfoLog(z).trim(),We=l.getShaderInfoLog(se).trim(),nt=l.getShaderInfoLog(ge).trim(),Me=!0,be=!0;if(l.getProgramParameter(z,35714)===!1){Me=!1;var ve=m1(l,se,"vertex"),Ze=m1(l,ge,"fragment");console.error("THREE.WebGLProgram: shader error: ",l.getError(),"35715",l.getProgramParameter(z,35715),"gl.getProgramInfoLog",_e,ve,Ze)}else _e!==""?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",_e):(We===""||nt==="")&&(be=!1);be&&(this.diagnostics={runnable:Me,programLog:_e,vertexShader:{log:We,prefix:G},fragmentShader:{log:nt,prefix:ie}})}l.deleteShader(se),l.deleteShader(ge);var Ke;this.getUniforms=function(){return Ke===void 0&&(Ke=new rf(l,z)),Ke};var Qe;return this.getAttributes=function(){return Qe===void 0&&(Qe=vL(l,z)),Qe},this.destroy=function(){s.releaseStatesOfProgram(this),l.deleteProgram(z),this.program=void 0},this.name=t.shaderName,this.id=hL++,this.cacheKey=a,this.usedTimes=1,this.program=z,this.vertexShader=se,this.fragmentShader=ge,this}function EL(e,a,t,s,l,f){var v=[],x=s.isWebGL2,w=s.logarithmicDepthBuffer,E=s.floatVertexTextures,P=s.maxVertexUniforms,R=s.vertexTextures,V=s.precision,H={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},q=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmissionMap"];function z(J){var se=J.skeleton,ge=se.bones;if(E)return 1024;var _e=Math.floor((P-20)/4),We=Math.min(_e,ge.length);return We<ge.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+ge.length+" bones. This GPU supports "+We+"."),0):We}function G(J){var se;return J?J.isTexture?se=J.encoding:J.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),se=J.texture.encoding):se=Da,se}function ie(J,se,ge,_e,We){var nt=_e.fog,Me=J.isMeshStandardMaterial?_e.environment:null,be=a.get(J.envMap||Me),ve=H[J.type],Ze=We.isSkinnedMesh?z(We):0;J.precision!==null&&(V=s.getMaxPrecision(J.precision),V!==J.precision&&console.warn("THREE.WebGLProgram.getParameters:",J.precision,"not supported, using",V,"instead."));var Ke,Qe;if(ve){var Bt=fc[ve];Ke=Bt.vertexShader,Qe=Bt.fragmentShader}else Ke=J.vertexShader,Qe=J.fragmentShader;var fn=e.getRenderTarget(),un={isWebGL2:x,shaderID:ve,shaderName:J.type,vertexShader:Ke,fragmentShader:Qe,defines:J.defines,isRawShaderMaterial:J.isRawShaderMaterial===!0,glslVersion:J.glslVersion,precision:V,instancing:We.isInstancedMesh===!0,instancingColor:We.isInstancedMesh===!0&&We.instanceColor!==null,supportsVertexTextures:R,outputEncoding:fn!==null?G(fn.texture):e.outputEncoding,map:!!J.map,mapEncoding:G(J.map),matcap:!!J.matcap,matcapEncoding:G(J.matcap),envMap:!!be,envMapMode:be&&be.mapping,envMapEncoding:G(be),envMapCubeUV:!!be&&(be.mapping===Pt||be.mapping===Kt),lightMap:!!J.lightMap,lightMapEncoding:G(J.lightMap),aoMap:!!J.aoMap,emissiveMap:!!J.emissiveMap,emissiveMapEncoding:G(J.emissiveMap),bumpMap:!!J.bumpMap,normalMap:!!J.normalMap,objectSpaceNormalMap:J.normalMapType===j0,tangentSpaceNormalMap:J.normalMapType===Hu,clearcoatMap:!!J.clearcoatMap,clearcoatRoughnessMap:!!J.clearcoatRoughnessMap,clearcoatNormalMap:!!J.clearcoatNormalMap,displacementMap:!!J.displacementMap,roughnessMap:!!J.roughnessMap,metalnessMap:!!J.metalnessMap,specularMap:!!J.specularMap,alphaMap:!!J.alphaMap,gradientMap:!!J.gradientMap,sheen:!!J.sheen,transmissionMap:!!J.transmissionMap,combine:J.combine,vertexTangents:J.normalMap&&J.vertexTangents,vertexColors:J.vertexColors,vertexUvs:!!J.map||!!J.bumpMap||!!J.normalMap||!!J.specularMap||!!J.alphaMap||!!J.emissiveMap||!!J.roughnessMap||!!J.metalnessMap||!!J.clearcoatMap||!!J.clearcoatRoughnessMap||!!J.clearcoatNormalMap||!!J.displacementMap||!!J.transmissionMap,uvsVertexOnly:!(!!J.map||!!J.bumpMap||!!J.normalMap||!!J.specularMap||!!J.alphaMap||!!J.emissiveMap||!!J.roughnessMap||!!J.metalnessMap||!!J.clearcoatNormalMap||!!J.transmissionMap)&&!!J.displacementMap,fog:!!nt,useFog:J.fog,fogExp2:nt&&nt.isFogExp2,flatShading:J.flatShading,sizeAttenuation:J.sizeAttenuation,logarithmicDepthBuffer:w,skinning:J.skinning&&Ze>0,maxBones:Ze,useVertexTexture:E,morphTargets:J.morphTargets,morphNormals:J.morphNormals,maxMorphTargets:e.maxMorphTargets,maxMorphNormals:e.maxMorphNormals,numDirLights:se.directional.length,numPointLights:se.point.length,numSpotLights:se.spot.length,numRectAreaLights:se.rectArea.length,numHemiLights:se.hemi.length,numDirLightShadows:se.directionalShadowMap.length,numPointLightShadows:se.pointShadowMap.length,numSpotLightShadows:se.spotShadowMap.length,numClippingPlanes:f.numPlanes,numClipIntersection:f.numIntersection,dithering:J.dithering,shadowMapEnabled:e.shadowMap.enabled&&ge.length>0,shadowMapType:e.shadowMap.type,toneMapping:J.toneMapped?e.toneMapping:ke,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:J.premultipliedAlpha,alphaTest:J.alphaTest,doubleSided:J.side===k,flipSided:J.side===O,depthPacking:J.depthPacking!==void 0?J.depthPacking:!1,index0AttributeName:J.index0AttributeName,extensionDerivatives:J.extensions&&J.extensions.derivatives,extensionFragDepth:J.extensions&&J.extensions.fragDepth,extensionDrawBuffers:J.extensions&&J.extensions.drawBuffers,extensionShaderTextureLOD:J.extensions&&J.extensions.shaderTextureLOD,rendererExtensionFragDepth:x||t.has("EXT_frag_depth"),rendererExtensionDrawBuffers:x||t.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:x||t.has("EXT_shader_texture_lod"),customProgramCacheKey:J.customProgramCacheKey()};return un}function le(J){var se=[];if(J.shaderID?se.push(J.shaderID):(se.push(J.fragmentShader),se.push(J.vertexShader)),J.defines!==void 0)for(var ge in J.defines)se.push(ge),se.push(J.defines[ge]);if(J.isRawShaderMaterial===!1){for(var _e=0;_e<q.length;_e++)se.push(J[q[_e]]);se.push(e.outputEncoding),se.push(e.gammaFactor)}return se.push(J.customProgramCacheKey),se.join()}function ae(J){if(--J.usedTimes===0){var se=v.indexOf(J);v[se]=v[v.length-1],v.pop(),J.destroy()}}return{getParameters:ie,getProgramCacheKey:le,getUniforms:function(J){var se=H[J.type],ge;if(se){var _e=fc[se];ge=iu.clone(_e.uniforms)}else ge=J.uniforms;return ge},acquireProgram:function(J,se){for(var ge,_e=0,We=v.length;_e<We;_e++){var nt=v[_e];if(nt.cacheKey===se){ge=nt,++ge.usedTimes;break}}return ge===void 0&&(ge=new SL(e,se,J,l),v.push(ge)),ge},releaseProgram:ae,programs:v}}function TL(){var e=new WeakMap;function a(l){var f=e.get(l);return f===void 0&&(f={},e.set(l,f)),f}function t(l){e.delete(l)}function s(l,f,v){e.get(l)[f]=v}return{get:a,remove:t,update:s,dispose:function(){e=new WeakMap}}}function AL(e,a){return e.groupOrder!==a.groupOrder?e.groupOrder-a.groupOrder:e.renderOrder!==a.renderOrder?e.renderOrder-a.renderOrder:e.program!==a.program?e.program.id-a.program.id:e.material.id!==a.material.id?e.material.id-a.material.id:e.z!==a.z?e.z-a.z:e.id-a.id}function LL(e,a){return e.groupOrder!==a.groupOrder?e.groupOrder-a.groupOrder:e.renderOrder!==a.renderOrder?e.renderOrder-a.renderOrder:e.z!==a.z?a.z-e.z:e.id-a.id}function b1(e){var a=[],t=0,s=[],l=[],f={id:-1};function v(w,E,P,R,V,H){var q=a[t],z=e.get(P);return q===void 0?(q={id:w.id,object:w,geometry:E,material:P,program:z.program||f,groupOrder:R,renderOrder:w.renderOrder,z:V,group:H},a[t]=q):(q.id=w.id,q.object=w,q.geometry=E,q.material=P,q.program=z.program||f,q.groupOrder=R,q.renderOrder=w.renderOrder,q.z=V,q.group=H),t++,q}function x(){for(var w=t,E=a.length;w<E;w++){var P=a[w];if(P.id===null)break;P.id=null,P.object=null,P.geometry=null,P.material=null,P.program=null,P.group=null}}return{opaque:s,transparent:l,init:function(){t=0,s.length=0,l.length=0},push:function(w,E,P,R,V,H){var q=v(w,E,P,R,V,H);(P.transparent===!0?l:s).push(q)},unshift:function(w,E,P,R,V,H){var q=v(w,E,P,R,V,H);(P.transparent===!0?l:s).unshift(q)},finish:x,sort:function(w,E){s.length>1&&s.sort(w||AL),l.length>1&&l.sort(E||LL)}}}function CL(e){var a=new WeakMap;function t(s,l){var f=a.get(s),v;return f===void 0?(v=new b1(e),a.set(s,new WeakMap),a.get(s).set(l,v)):(v=f.get(l),v===void 0&&(v=new b1(e),f.set(l,v))),v}return{get:t,dispose:function(){a=new WeakMap}}}function PL(){var e={};return{get:function(a){if(e[a.id]!==void 0)return e[a.id];var t;switch(a.type){case"DirectionalLight":t={direction:new pe,color:new mi};break;case"SpotLight":t={position:new pe,direction:new pe,color:new mi,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new pe,color:new mi,distance:0,decay:0};break;case"HemisphereLight":t={direction:new pe,skyColor:new mi,groundColor:new mi};break;case"RectAreaLight":t={color:new mi,position:new pe,halfWidth:new pe,halfHeight:new pe};break}return e[a.id]=t,t}}}function RL(){var e={};return{get:function(a){if(e[a.id]!==void 0)return e[a.id];var t;switch(a.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new bn};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new bn};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new bn,shadowCameraNear:1,shadowCameraFar:1e3};break}return e[a.id]=t,t}}}var DL=0;function OL(e,a){return(a.castShadow?1:0)-(e.castShadow?1:0)}function IL(){for(var e=new PL,a=RL(),t={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},s=0;s<9;s++)t.probe.push(new pe);var l=new pe,f=new wr,v=new wr;function x(w,E,P){for(var R=0,V=0,H=0,q=0;q<9;q++)t.probe[q].set(0,0,0);var z=0,G=0,ie=0,le=0,ae=0,J=0,se=0,ge=0,_e=P.matrixWorldInverse;w.sort(OL);for(var We=0,nt=w.length;We<nt;We++){var Me=w[We],be=Me.color,ve=Me.intensity,Ze=Me.distance,Ke=Me.shadow&&Me.shadow.map?Me.shadow.map.texture:null;if(Me.isAmbientLight)R+=be.r*ve,V+=be.g*ve,H+=be.b*ve;else if(Me.isLightProbe)for(var Qe=0;Qe<9;Qe++)t.probe[Qe].addScaledVector(Me.sh.coefficients[Qe],ve);else if(Me.isDirectionalLight){var Bt=e.get(Me);if(Bt.color.copy(Me.color).multiplyScalar(Me.intensity),Bt.direction.setFromMatrixPosition(Me.matrixWorld),l.setFromMatrixPosition(Me.target.matrixWorld),Bt.direction.sub(l),Bt.direction.transformDirection(_e),Me.castShadow){var fn=Me.shadow,un=a.get(Me);un.shadowBias=fn.bias,un.shadowNormalBias=fn.normalBias,un.shadowRadius=fn.radius,un.shadowMapSize=fn.mapSize,t.directionalShadow[z]=un,t.directionalShadowMap[z]=Ke,t.directionalShadowMatrix[z]=Me.shadow.matrix,J++}t.directional[z]=Bt,z++}else if(Me.isSpotLight){var Qt=e.get(Me);if(Qt.position.setFromMatrixPosition(Me.matrixWorld),Qt.position.applyMatrix4(_e),Qt.color.copy(be).multiplyScalar(ve),Qt.distance=Ze,Qt.direction.setFromMatrixPosition(Me.matrixWorld),l.setFromMatrixPosition(Me.target.matrixWorld),Qt.direction.sub(l),Qt.direction.transformDirection(_e),Qt.coneCos=Math.cos(Me.angle),Qt.penumbraCos=Math.cos(Me.angle*(1-Me.penumbra)),Qt.decay=Me.decay,Me.castShadow){var Sn=Me.shadow,ai=a.get(Me);ai.shadowBias=Sn.bias,ai.shadowNormalBias=Sn.normalBias,ai.shadowRadius=Sn.radius,ai.shadowMapSize=Sn.mapSize,t.spotShadow[ie]=ai,t.spotShadowMap[ie]=Ke,t.spotShadowMatrix[ie]=Me.shadow.matrix,ge++}t.spot[ie]=Qt,ie++}else if(Me.isRectAreaLight){var ei=e.get(Me);ei.color.copy(be).multiplyScalar(ve),ei.position.setFromMatrixPosition(Me.matrixWorld),ei.position.applyMatrix4(_e),v.identity(),f.copy(Me.matrixWorld),f.premultiply(_e),v.extractRotation(f),ei.halfWidth.set(Me.width*.5,0,0),ei.halfHeight.set(0,Me.height*.5,0),ei.halfWidth.applyMatrix4(v),ei.halfHeight.applyMatrix4(v),t.rectArea[le]=ei,le++}else if(Me.isPointLight){var Pi=e.get(Me);if(Pi.position.setFromMatrixPosition(Me.matrixWorld),Pi.position.applyMatrix4(_e),Pi.color.copy(Me.color).multiplyScalar(Me.intensity),Pi.distance=Me.distance,Pi.decay=Me.decay,Me.castShadow){var Hi=Me.shadow,on=a.get(Me);on.shadowBias=Hi.bias,on.shadowNormalBias=Hi.normalBias,on.shadowRadius=Hi.radius,on.shadowMapSize=Hi.mapSize,on.shadowCameraNear=Hi.camera.near,on.shadowCameraFar=Hi.camera.far,t.pointShadow[G]=on,t.pointShadowMap[G]=Ke,t.pointShadowMatrix[G]=Me.shadow.matrix,se++}t.point[G]=Pi,G++}else if(Me.isHemisphereLight){var _r=e.get(Me);_r.direction.setFromMatrixPosition(Me.matrixWorld),_r.direction.transformDirection(_e),_r.direction.normalize(),_r.skyColor.copy(Me.color).multiplyScalar(ve),_r.groundColor.copy(Me.groundColor).multiplyScalar(ve),t.hemi[ae]=_r,ae++}}le>0&&(t.rectAreaLTC1=fi.LTC_1,t.rectAreaLTC2=fi.LTC_2),t.ambient[0]=R,t.ambient[1]=V,t.ambient[2]=H;var pr=t.hash;(pr.directionalLength!==z||pr.pointLength!==G||pr.spotLength!==ie||pr.rectAreaLength!==le||pr.hemiLength!==ae||pr.numDirectionalShadows!==J||pr.numPointShadows!==se||pr.numSpotShadows!==ge)&&(t.directional.length=z,t.spot.length=ie,t.rectArea.length=le,t.point.length=G,t.hemi.length=ae,t.directionalShadow.length=J,t.directionalShadowMap.length=J,t.pointShadow.length=se,t.pointShadowMap.length=se,t.spotShadow.length=ge,t.spotShadowMap.length=ge,t.directionalShadowMatrix.length=J,t.pointShadowMatrix.length=se,t.spotShadowMatrix.length=ge,pr.directionalLength=z,pr.pointLength=G,pr.spotLength=ie,pr.rectAreaLength=le,pr.hemiLength=ae,pr.numDirectionalShadows=J,pr.numPointShadows=se,pr.numSpotShadows=ge,t.version=DL++)}return{setup:x,state:t}}function w1(){var e=new IL,a=[],t=[];return{init:function(){a.length=0,t.length=0},state:{lightsArray:a,shadowsArray:t,lights:e},setupLights:function(s){e.setup(a,t,s)},pushLight:function(s){a.push(s)},pushShadow:function(s){t.push(s)}}}function NL(){var e=new WeakMap;function a(t,s){var l;return e.has(t)===!1?(l=new w1,e.set(t,new WeakMap),e.get(t).set(s,l)):e.get(t).has(s)===!1?(l=new w1,e.get(t).set(s,l)):l=e.get(t).get(s),l}return{get:a,dispose:function(){e=new WeakMap}}}function sf(e){zi.call(this),this.type="MeshDepthMaterial",this.depthPacking=Qg,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}sf.prototype=Object.create(zi.prototype),sf.prototype.constructor=sf,sf.prototype.isMeshDepthMaterial=!0,sf.prototype.copy=function(e){return zi.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this};function af(e){zi.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new pe,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}af.prototype=Object.create(zi.prototype),af.prototype.constructor=af,af.prototype.isMeshDistanceMaterial=!0,af.prototype.copy=function(e){return zi.prototype.copy.call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this};function M1(e,a,t){var s=new hv,l=new bn,f=new bn,v=new ps,x=[],w=[],E={},P={0:O,1:F,2:k},R=new za({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new bn},radius:{value:4}},vertexShader:`void main() {
	gl_Position = vec4( position, 1.0 );
}`,fragmentShader:`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	float mean = 0.0;
	float squared_mean = 0.0;
	float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );
	for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {
		#ifdef HORIZONAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, i ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean * HALF_SAMPLE_RATE;
	squared_mean = squared_mean * HALF_SAMPLE_RATE;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`}),V=R.clone();V.defines.HORIZONAL_PASS=1;var H=new qe;H.setAttribute("position",new qi(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var q=new xr(H,R),z=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=M,this.render=function(se,ge,_e){if(z.enabled!==!1&&!(z.autoUpdate===!1&&z.needsUpdate===!1)&&se.length!==0){var We=e.getRenderTarget(),nt=e.getActiveCubeFace(),Me=e.getActiveMipmapLevel(),be=e.state;be.setBlending(X),be.buffers.color.setClear(1,1,1,1),be.buffers.depth.setTest(!0),be.setScissorTest(!1);for(var ve=0,Ze=se.length;ve<Ze;ve++){var Ke=se[ve],Qe=Ke.shadow;if(Qe===void 0){console.warn("THREE.WebGLShadowMap:",Ke,"has no shadow.");continue}if(!(Qe.autoUpdate===!1&&Qe.needsUpdate===!1)){l.copy(Qe.mapSize);var Bt=Qe.getFrameExtents();if(l.multiply(Bt),f.copy(Qe.mapSize),(l.x>t||l.y>t)&&(l.x>t&&(f.x=Math.floor(t/Bt.x),l.x=f.x*Bt.x,Qe.mapSize.x=f.x),l.y>t&&(f.y=Math.floor(t/Bt.y),l.y=f.y*Bt.y,Qe.mapSize.y=f.y)),Qe.map===null&&!Qe.isPointLightShadow&&this.type===C){var fn={minFilter:jn,magFilter:jn,format:ye};Qe.map=new ja(l.x,l.y,fn),Qe.map.texture.name=Ke.name+".shadowMap",Qe.mapPass=new ja(l.x,l.y,fn),Qe.camera.updateProjectionMatrix()}Qe.map===null&&(Qe.map=new ja(l.x,l.y,{minFilter:Ht,magFilter:Ht,format:ye}),Qe.map.texture.name=Ke.name+".shadowMap",Qe.camera.updateProjectionMatrix()),e.setRenderTarget(Qe.map),e.clear();for(var un=Qe.getViewportCount(),Qt=0;Qt<un;Qt++){var Sn=Qe.getViewport(Qt);v.set(f.x*Sn.x,f.y*Sn.y,f.x*Sn.z,f.y*Sn.w),be.viewport(v),Qe.updateMatrices(Ke,Qt),s=Qe.getFrustum(),J(ge,_e,Qe.camera,Ke,this.type)}!Qe.isPointLightShadow&&this.type===C&&G(Qe,_e),Qe.needsUpdate=!1}}z.needsUpdate=!1,e.setRenderTarget(We,nt,Me)}};function G(se,ge){var _e=a.update(q);R.uniforms.shadow_pass.value=se.map.texture,R.uniforms.resolution.value=se.mapSize,R.uniforms.radius.value=se.radius,e.setRenderTarget(se.mapPass),e.clear(),e.renderBufferDirect(ge,null,_e,R,q,null),V.uniforms.shadow_pass.value=se.mapPass.texture,V.uniforms.resolution.value=se.mapSize,V.uniforms.radius.value=se.radius,e.setRenderTarget(se.map),e.clear(),e.renderBufferDirect(ge,null,_e,V,q,null)}function ie(se,ge,_e){var We=se<<0|ge<<1|_e<<2,nt=x[We];return nt===void 0&&(nt=new sf({depthPacking:oc,morphTargets:se,skinning:ge}),x[We]=nt),nt}function le(se,ge,_e){var We=se<<0|ge<<1|_e<<2,nt=w[We];return nt===void 0&&(nt=new af({morphTargets:se,skinning:ge}),w[We]=nt),nt}function ae(se,ge,_e,We,nt,Me,be){var ve=null,Ze=ie,Ke=se.customDepthMaterial;if(We.isPointLight===!0&&(Ze=le,Ke=se.customDistanceMaterial),Ke===void 0){var Qe=!1;_e.morphTargets===!0&&(Qe=ge.morphAttributes&&ge.morphAttributes.position&&ge.morphAttributes.position.length>0);var Bt=!1;se.isSkinnedMesh===!0&&(_e.skinning===!0?Bt=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",se));var fn=se.isInstancedMesh===!0;ve=Ze(Qe,Bt,fn)}else ve=Ke;if(e.localClippingEnabled&&_e.clipShadows===!0&&_e.clippingPlanes.length!==0){var un=ve.uuid,Qt=_e.uuid,Sn=E[un];Sn===void 0&&(Sn={},E[un]=Sn);var ai=Sn[Qt];ai===void 0&&(ai=ve.clone(),Sn[Qt]=ai),ve=ai}return ve.visible=_e.visible,ve.wireframe=_e.wireframe,be===C?ve.side=_e.shadowSide!==null?_e.shadowSide:_e.side:ve.side=_e.shadowSide!==null?_e.shadowSide:P[_e.side],ve.clipShadows=_e.clipShadows,ve.clippingPlanes=_e.clippingPlanes,ve.clipIntersection=_e.clipIntersection,ve.wireframeLinewidth=_e.wireframeLinewidth,ve.linewidth=_e.linewidth,We.isPointLight===!0&&ve.isMeshDistanceMaterial===!0&&(ve.referencePosition.setFromMatrixPosition(We.matrixWorld),ve.nearDistance=nt,ve.farDistance=Me),ve}function J(se,ge,_e,We,nt){if(se.visible!==!1){var Me=se.layers.test(ge.layers);if(Me&&(se.isMesh||se.isLine||se.isPoints)&&(se.castShadow||se.receiveShadow&&nt===C)&&(!se.frustumCulled||s.intersectsObject(se))){se.modelViewMatrix.multiplyMatrices(_e.matrixWorldInverse,se.matrixWorld);var be=a.update(se),ve=se.material;if(Array.isArray(ve))for(var Ze=be.groups,Ke=0,Qe=Ze.length;Ke<Qe;Ke++){var Bt=Ze[Ke],fn=ve[Bt.materialIndex];if(fn&&fn.visible){var un=ae(se,be,fn,We,_e.near,_e.far,nt);e.renderBufferDirect(_e,null,be,un,se,Bt)}}else if(ve.visible){var Qt=ae(se,be,ve,We,_e.near,_e.far,nt);e.renderBufferDirect(_e,null,be,Qt,se,null)}}for(var Sn=se.children,ai=0,ei=Sn.length;ai<ei;ai++)J(Sn[ai],ge,_e,We,nt)}}}function FL(e,a,t){var s,l,f=t.isWebGL2,v=new function(){var re=!1,On=new ps,Jt=null,bi=new ps(0,0,0,0);return{setMask:function(kn){Jt!==kn&&!re&&(e.colorMask(kn,kn,kn,kn),Jt=kn)},setLocked:function(kn){re=kn},setClear:function(kn,Xi,ji,Di,Ji){Ji===!0&&(kn*=Di,Xi*=Di,ji*=Di),On.set(kn,Xi,ji,Di),bi.equals(On)===!1&&(e.clearColor(kn,Xi,ji,Di),bi.copy(On))},reset:function(){re=!1,Jt=null,bi.set(-1,0,0,0)}}},x=new function(){var re=!1,On=null,Jt=null,bi=null;return{setTest:function(kn){kn?Qt(2929):Sn(2929)},setMask:function(kn){On!==kn&&!re&&(e.depthMask(kn),On=kn)},setFunc:function(kn){if(Jt!==kn){if(kn)switch(kn){case Vt:e.depthFunc(512);break;case Dn:e.depthFunc(519);break;case Ci:e.depthFunc(513);break;case vi:e.depthFunc(515);break;case he:e.depthFunc(514);break;case K:e.depthFunc(518);break;case Fe:e.depthFunc(516);break;case me:e.depthFunc(517);break;default:e.depthFunc(515)}else e.depthFunc(515);Jt=kn}},setLocked:function(kn){re=kn},setClear:function(kn){bi!==kn&&(e.clearDepth(kn),bi=kn)},reset:function(){re=!1,On=null,Jt=null,bi=null}}},w=new function(){var re=!1,On=null,Jt=null,bi=null,kn=null,Xi=null,ji=null,Di=null,Ji=null;return{setTest:function($i){re||($i?Qt(2960):Sn(2960))},setMask:function($i){On!==$i&&!re&&(e.stencilMask($i),On=$i)},setFunc:function($i,Pr,ms){(Jt!==$i||bi!==Pr||kn!==ms)&&(e.stencilFunc($i,Pr,ms),Jt=$i,bi=Pr,kn=ms)},setOp:function($i,Pr,ms){(Xi!==$i||ji!==Pr||Di!==ms)&&(e.stencilOp($i,Pr,ms),Xi=$i,ji=Pr,Di=ms)},setLocked:function($i){re=$i},setClear:function($i){Ji!==$i&&(e.clearStencil($i),Ji=$i)},reset:function(){re=!1,On=null,Jt=null,bi=null,kn=null,Xi=null,ji=null,Di=null,Ji=null}}},E={},P=null,R=null,V=null,H=null,q=null,z=null,G=null,ie=null,le=null,ae=!1,J=null,se=null,ge=null,_e=null,We=null,nt=e.getParameter(35661),Me=!1,be=0,ve=e.getParameter(7938);ve.indexOf("WebGL")!==-1?(be=parseFloat(/^WebGL\ ([0-9])/.exec(ve)[1]),Me=be>=1):ve.indexOf("OpenGL ES")!==-1&&(be=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(ve)[1]),Me=be>=2);var Ze=null,Ke={},Qe=new ps,Bt=new ps;function fn(re,On,Jt){var bi=new Uint8Array(4),kn=e.createTexture();e.bindTexture(re,kn),e.texParameteri(re,10241,9728),e.texParameteri(re,10240,9728);for(var Xi=0;Xi<Jt;Xi++)e.texImage2D(On+Xi,0,6408,1,1,0,6408,5121,bi);return kn}var un={};un[3553]=fn(3553,3553,1),un[34067]=fn(34067,34069,6),v.setClear(0,0,0,1),x.setClear(1),w.setClear(0),Qt(2929),x.setFunc(vi),_r(!1),pr(g),Qt(2884),on(X);function Qt(re){E[re]!==!0&&(e.enable(re),E[re]=!0)}function Sn(re){E[re]!==!1&&(e.disable(re),E[re]=!1)}function ai(re){return P!==re?(e.useProgram(re),P=re,!0):!1}var ei=(s={},s[Re]=32774,s[Ne]=32778,s[de]=32779,s);if(f)ei[$e]=32775,ei[Gt]=32776;else{var Pi=a.get("EXT_blend_minmax");Pi!==null&&(ei[$e]=Pi.MIN_EXT,ei[Gt]=Pi.MAX_EXT)}var Hi=(l={},l[dt]=0,l[an]=1,l[_t]=768,l[rt]=770,l[An]=776,l[ft]=774,l[Ve]=772,l[et]=769,l[je]=771,l[Wt]=775,l[ht]=773,l);function on(re,On,Jt,bi,kn,Xi,ji,Di){if(re===X){R&&(Sn(3042),R=!1);return}if(R||(Qt(3042),R=!0),re!==Pe){if(re!==V||Di!==ae){if((H!==Re||G!==Re)&&(e.blendEquation(32774),H=Re,G=Re),Di)switch(re){case ne:e.blendFuncSeparate(1,771,1,771);break;case te:e.blendFunc(1,1);break;case j:e.blendFuncSeparate(0,0,769,771);break;case W:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",re);break}else switch(re){case ne:e.blendFuncSeparate(770,771,1,771);break;case te:e.blendFunc(770,1);break;case j:e.blendFunc(0,769);break;case W:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",re);break}q=null,z=null,ie=null,le=null,V=re,ae=Di}return}kn=kn||On,Xi=Xi||Jt,ji=ji||bi,(On!==H||kn!==G)&&(e.blendEquationSeparate(ei[On],ei[kn]),H=On,G=kn),(Jt!==q||bi!==z||Xi!==ie||ji!==le)&&(e.blendFuncSeparate(Hi[Jt],Hi[bi],Hi[Xi],Hi[ji]),q=Jt,z=bi,ie=Xi,le=ji),V=re,ae=null}function _r(re){J!==re&&(re?e.frontFace(2304):e.frontFace(2305),J=re)}function pr(re){re!==p?(Qt(2884),re!==se&&(re===g?e.cullFace(1029):re===b?e.cullFace(1028):e.cullFace(1032))):Sn(2884),se=re}function Zi(re){re!==ge&&(Me&&e.lineWidth(re),ge=re)}function Xr(re,On,Jt){re?(Qt(32823),(_e!==On||We!==Jt)&&(e.polygonOffset(On,Jt),_e=On,We=Jt)):Sn(32823)}function Sr(re){re===void 0&&(re=33984+nt-1),Ze!==re&&(e.activeTexture(re),Ze=re)}function rs(re,On){Ze===null&&Sr();var Jt=Ke[Ze];Jt===void 0&&(Jt={type:void 0,texture:void 0},Ke[Ze]=Jt),(Jt.type!==re||Jt.texture!==On)&&(e.bindTexture(re,On||un[re]),Jt.type=re,Jt.texture=On)}function zr(){var re=Ke[Ze];re!==void 0&&re.type!==void 0&&(e.bindTexture(re.type,null),re.type=void 0,re.texture=void 0)}function As(re){Qe.equals(re)===!1&&(e.scissor(re.x,re.y,re.z,re.w),Qe.copy(re))}function ze(re){Bt.equals(re)===!1&&(e.viewport(re.x,re.y,re.z,re.w),Bt.copy(re))}return{buffers:{color:v,depth:x,stencil:w},enable:Qt,disable:Sn,useProgram:ai,setBlending:on,setMaterial:function(re,On){re.side===k?Sn(2884):Qt(2884);var Jt=re.side===O;On&&(Jt=!Jt),_r(Jt),re.blending===ne&&re.transparent===!1?on(X):on(re.blending,re.blendEquation,re.blendSrc,re.blendDst,re.blendEquationAlpha,re.blendSrcAlpha,re.blendDstAlpha,re.premultipliedAlpha),x.setFunc(re.depthFunc),x.setTest(re.depthTest),x.setMask(re.depthWrite),v.setMask(re.colorWrite);var bi=re.stencilWrite;w.setTest(bi),bi&&(w.setMask(re.stencilWriteMask),w.setFunc(re.stencilFunc,re.stencilRef,re.stencilFuncMask),w.setOp(re.stencilFail,re.stencilZFail,re.stencilZPass)),Xr(re.polygonOffset,re.polygonOffsetFactor,re.polygonOffsetUnits)},setFlipSided:_r,setCullFace:pr,setLineWidth:Zi,setPolygonOffset:Xr,setScissorTest:function(re){re?Qt(3089):Sn(3089)},activeTexture:Sr,bindTexture:rs,unbindTexture:zr,compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(re){console.error("THREE.WebGLState:",re)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(re){console.error("THREE.WebGLState:",re)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(re){console.error("THREE.WebGLState:",re)}},scissor:As,viewport:ze,reset:function(){E={},Ze=null,Ke={},P=null,V=null,J=null,se=null,v.reset(),x.reset(),w.reset()}}}function BL(e,a,t,s,l,f,v){var x,w,E=l.isWebGL2,P=l.maxTextures,R=l.maxCubemapSize,V=l.maxTextureSize,H=l.maxSamples,q=new WeakMap,z,G=!1;try{G=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function ie(ze,re){return G?new OffscreenCanvas(ze,re):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function le(ze,re,On,Jt){var bi=1;if((ze.width>Jt||ze.height>Jt)&&(bi=Jt/Math.max(ze.width,ze.height)),bi<1||re===!0)if(typeof HTMLImageElement<"u"&&ze instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&ze instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&ze instanceof ImageBitmap){var kn=re?nr.floorPowerOfTwo:Math.floor,Xi=kn(bi*ze.width),ji=kn(bi*ze.height);z===void 0&&(z=ie(Xi,ji));var Di=On?ie(Xi,ji):z;Di.width=Xi,Di.height=ji;var Ji=Di.getContext("2d");return Ji.drawImage(ze,0,0,Xi,ji),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+ze.width+"x"+ze.height+") to ("+Xi+"x"+ji+")."),Di}else return"data"in ze&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+ze.width+"x"+ze.height+")."),ze;return ze}function ae(ze){return nr.isPowerOfTwo(ze.width)&&nr.isPowerOfTwo(ze.height)}function J(ze){return E?!1:ze.wrapS!==xn||ze.wrapT!==xn||ze.minFilter!==Ht&&ze.minFilter!==jn}function se(ze,re){return ze.generateMipmaps&&re&&ze.minFilter!==Ht&&ze.minFilter!==jn}function ge(ze,re,On,Jt){e.generateMipmap(ze);var bi=s.get(re);bi.__maxMipLevel=Math.log(Math.max(On,Jt))*Math.LOG2E}function _e(ze,re,On){if(E===!1)return re;if(ze!==null){if(e[ze]!==void 0)return e[ze];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+ze+"'")}var Jt=re;return re===6403&&(On===5126&&(Jt=33326),On===5131&&(Jt=33325),On===5121&&(Jt=33321)),re===6407&&(On===5126&&(Jt=34837),On===5131&&(Jt=34843),On===5121&&(Jt=32849)),re===6408&&(On===5126&&(Jt=34836),On===5131&&(Jt=34842),On===5121&&(Jt=32856)),(Jt===33325||Jt===33326||Jt===34842||Jt===34836)&&a.get("EXT_color_buffer_float"),Jt}function We(ze){return ze===Ht||ze===Kn||ze===hn?9728:9729}function nt(ze){var re=ze.target;re.removeEventListener("dispose",nt),be(re),re.isVideoTexture&&q.delete(re),v.memory.textures--}function Me(ze){var re=ze.target;re.removeEventListener("dispose",Me),ve(re),v.memory.textures--}function be(ze){var re=s.get(ze);re.__webglInit!==void 0&&(e.deleteTexture(re.__webglTexture),s.remove(ze))}function ve(ze){var re=s.get(ze),On=s.get(ze.texture);if(!!ze){if(On.__webglTexture!==void 0&&e.deleteTexture(On.__webglTexture),ze.depthTexture&&ze.depthTexture.dispose(),ze.isWebGLCubeRenderTarget)for(var Jt=0;Jt<6;Jt++)e.deleteFramebuffer(re.__webglFramebuffer[Jt]),re.__webglDepthbuffer&&e.deleteRenderbuffer(re.__webglDepthbuffer[Jt]);else e.deleteFramebuffer(re.__webglFramebuffer),re.__webglDepthbuffer&&e.deleteRenderbuffer(re.__webglDepthbuffer),re.__webglMultisampledFramebuffer&&e.deleteFramebuffer(re.__webglMultisampledFramebuffer),re.__webglColorRenderbuffer&&e.deleteRenderbuffer(re.__webglColorRenderbuffer),re.__webglDepthRenderbuffer&&e.deleteRenderbuffer(re.__webglDepthRenderbuffer);s.remove(ze.texture),s.remove(ze)}}var Ze=0;function Ke(){var ze=Ze;return ze>=P&&console.warn("THREE.WebGLTextures: Trying to use "+ze+" texture units while this GPU supports only "+P),Ze+=1,ze}function Qe(ze,re){var On=s.get(ze);if(ze.isVideoTexture&&Xr(ze),ze.version>0&&On.__version!==ze.version){var Jt=ze.image;if(Jt===void 0)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else if(Jt.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{ai(On,ze,re);return}}t.activeTexture(33984+re),t.bindTexture(3553,On.__webglTexture)}function Bt(ze,re){var On=s.get(ze);if(ze.version>0&&On.__version!==ze.version){ei(On,ze,re);return}t.activeTexture(33984+re),t.bindTexture(34067,On.__webglTexture)}var fn=(x={},x[qn]=10497,x[xn]=33071,x[Oe]=33648,x),un=(w={},w[Ht]=9728,w[Kn]=9984,w[hn]=9986,w[jn]=9729,w[er]=9985,w[ts]=9987,w);function Qt(ze,re,On){On?(e.texParameteri(ze,10242,fn[re.wrapS]),e.texParameteri(ze,10243,fn[re.wrapT]),(ze===32879||ze===35866)&&e.texParameteri(ze,32882,fn[re.wrapR]),e.texParameteri(ze,10240,un[re.magFilter]),e.texParameteri(ze,10241,un[re.minFilter])):(e.texParameteri(ze,10242,33071),e.texParameteri(ze,10243,33071),(ze===32879||ze===35866)&&e.texParameteri(ze,32882,33071),(re.wrapS!==xn||re.wrapT!==xn)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(ze,10240,We(re.magFilter)),e.texParameteri(ze,10241,We(re.minFilter)),re.minFilter!==Ht&&re.minFilter!==jn&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));var Jt=a.get("EXT_texture_filter_anisotropic");if(Jt){if(re.type===xs&&a.get("OES_texture_float_linear")===null||re.type===tl&&(E||a.get("OES_texture_half_float_linear"))===null)return;(re.anisotropy>1||s.get(re).__currentAnisotropy)&&(e.texParameterf(ze,Jt.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(re.anisotropy,l.getMaxAnisotropy())),s.get(re).__currentAnisotropy=re.anisotropy)}}function Sn(ze,re){ze.__webglInit===void 0&&(ze.__webglInit=!0,re.addEventListener("dispose",nt),ze.__webglTexture=e.createTexture(),v.memory.textures++)}function ai(ze,re,On){var Jt=3553;re.isDataTexture2DArray&&(Jt=35866),re.isDataTexture3D&&(Jt=32879),Sn(ze,re),t.activeTexture(33984+On),t.bindTexture(Jt,ze.__webglTexture),e.pixelStorei(37440,re.flipY),e.pixelStorei(37441,re.premultiplyAlpha),e.pixelStorei(3317,re.unpackAlignment);var bi=J(re)&&ae(re.image)===!1,kn=le(re.image,bi,!1,V),Xi=ae(kn)||E,ji=f.convert(re.format),Di=f.convert(re.type),Ji=_e(re.internalFormat,ji,Di);Qt(Jt,re,Xi);var $i,Pr=re.mipmaps;if(re.isDepthTexture)Ji=6402,E?re.type===xs?Ji=36012:re.type===Ds?Ji=33190:re.type===io?Ji=35056:Ji=33189:re.type===xs&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),re.format===Qn&&Ji===6402&&re.type!==ec&&re.type!==Ds&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),re.type=ec,Di=f.convert(re.type)),re.format===ar&&Ji===6402&&(Ji=34041,re.type!==io&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),re.type=io,Di=f.convert(re.type))),t.texImage2D(3553,0,Ji,kn.width,kn.height,0,ji,Di,null);else if(re.isDataTexture)if(Pr.length>0&&Xi){for(var ms=0,Aa=Pr.length;ms<Aa;ms++)$i=Pr[ms],t.texImage2D(3553,ms,Ji,$i.width,$i.height,0,ji,Di,$i.data);re.generateMipmaps=!1,ze.__maxMipLevel=Pr.length-1}else t.texImage2D(3553,0,Ji,kn.width,kn.height,0,ji,Di,kn.data),ze.__maxMipLevel=0;else if(re.isCompressedTexture){for(var Es=0,Vo=Pr.length;Es<Vo;Es++)$i=Pr[Es],re.format!==ye&&re.format!==nl?ji!==null?t.compressedTexImage2D(3553,Es,Ji,$i.width,$i.height,0,$i.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):t.texImage2D(3553,Es,Ji,$i.width,$i.height,0,ji,Di,$i.data);ze.__maxMipLevel=Pr.length-1}else if(re.isDataTexture2DArray)t.texImage3D(35866,0,Ji,kn.width,kn.height,kn.depth,0,ji,Di,kn.data),ze.__maxMipLevel=0;else if(re.isDataTexture3D)t.texImage3D(32879,0,Ji,kn.width,kn.height,kn.depth,0,ji,Di,kn.data),ze.__maxMipLevel=0;else if(Pr.length>0&&Xi){for(var cs=0,_c=Pr.length;cs<_c;cs++)$i=Pr[cs],t.texImage2D(3553,cs,Ji,ji,Di,$i);re.generateMipmaps=!1,ze.__maxMipLevel=Pr.length-1}else t.texImage2D(3553,0,Ji,ji,Di,kn),ze.__maxMipLevel=0;se(re,Xi)&&ge(Jt,re,kn.width,kn.height),ze.__version=re.version,re.onUpdate&&re.onUpdate(re)}function ei(ze,re,On){if(re.image.length===6){Sn(ze,re),t.activeTexture(33984+On),t.bindTexture(34067,ze.__webglTexture),e.pixelStorei(37440,re.flipY);for(var Jt=re&&(re.isCompressedTexture||re.image[0].isCompressedTexture),bi=re.image[0]&&re.image[0].isDataTexture,kn=[],Xi=0;Xi<6;Xi++)!Jt&&!bi?kn[Xi]=le(re.image[Xi],!1,!0,R):kn[Xi]=bi?re.image[Xi].image:re.image[Xi];var ji=kn[0],Di=ae(ji)||E,Ji=f.convert(re.format),$i=f.convert(re.type),Pr=_e(re.internalFormat,Ji,$i);Qt(34067,re,Di);var ms;if(Jt){for(var Aa=0;Aa<6;Aa++){ms=kn[Aa].mipmaps;for(var Es=0;Es<ms.length;Es++){var Vo=ms[Es];re.format!==ye&&re.format!==nl?Ji!==null?t.compressedTexImage2D(34069+Aa,Es,Pr,Vo.width,Vo.height,0,Vo.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):t.texImage2D(34069+Aa,Es,Pr,Vo.width,Vo.height,0,Ji,$i,Vo.data)}}ze.__maxMipLevel=ms.length-1}else{ms=re.mipmaps;for(var cs=0;cs<6;cs++)if(bi){t.texImage2D(34069+cs,0,Pr,kn[cs].width,kn[cs].height,0,Ji,$i,kn[cs].data);for(var _c=0;_c<ms.length;_c++){var Rd=ms[_c],bc=Rd.image[cs].image;t.texImage2D(34069+cs,_c+1,Pr,bc.width,bc.height,0,Ji,$i,bc.data)}}else{t.texImage2D(34069+cs,0,Pr,Ji,$i,kn[cs]);for(var ih=0;ih<ms.length;ih++){var Mm=ms[ih];t.texImage2D(34069+cs,ih+1,Pr,Ji,$i,Mm.image[cs])}}ze.__maxMipLevel=ms.length}se(re,Di)&&ge(34067,re,ji.width,ji.height),ze.__version=re.version,re.onUpdate&&re.onUpdate(re)}}function Pi(ze,re,On,Jt){var bi=f.convert(re.texture.format),kn=f.convert(re.texture.type),Xi=_e(re.texture.internalFormat,bi,kn);t.texImage2D(Jt,0,Xi,re.width,re.height,0,bi,kn,null),e.bindFramebuffer(36160,ze),e.framebufferTexture2D(36160,On,Jt,s.get(re.texture).__webglTexture,0),e.bindFramebuffer(36160,null)}function Hi(ze,re,On){if(e.bindRenderbuffer(36161,ze),re.depthBuffer&&!re.stencilBuffer){var Jt=33189;if(On){var bi=re.depthTexture;bi&&bi.isDepthTexture&&(bi.type===xs?Jt=36012:bi.type===Ds&&(Jt=33190));var kn=Zi(re);e.renderbufferStorageMultisample(36161,kn,Jt,re.width,re.height)}else e.renderbufferStorage(36161,Jt,re.width,re.height);e.framebufferRenderbuffer(36160,36096,36161,ze)}else if(re.depthBuffer&&re.stencilBuffer){if(On){var Xi=Zi(re);e.renderbufferStorageMultisample(36161,Xi,35056,re.width,re.height)}else e.renderbufferStorage(36161,34041,re.width,re.height);e.framebufferRenderbuffer(36160,33306,36161,ze)}else{var ji=f.convert(re.texture.format),Di=f.convert(re.texture.type),Ji=_e(re.texture.internalFormat,ji,Di);if(On){var $i=Zi(re);e.renderbufferStorageMultisample(36161,$i,Ji,re.width,re.height)}else e.renderbufferStorage(36161,Ji,re.width,re.height)}e.bindRenderbuffer(36161,null)}function on(ze,re){var On=re&&re.isWebGLCubeRenderTarget;if(On)throw new Error("Depth Texture with cube render targets is not supported");if(e.bindFramebuffer(36160,ze),!(re.depthTexture&&re.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!s.get(re.depthTexture).__webglTexture||re.depthTexture.image.width!==re.width||re.depthTexture.image.height!==re.height)&&(re.depthTexture.image.width=re.width,re.depthTexture.image.height=re.height,re.depthTexture.needsUpdate=!0),Qe(re.depthTexture,0);var Jt=s.get(re.depthTexture).__webglTexture;if(re.depthTexture.format===Qn)e.framebufferTexture2D(36160,36096,3553,Jt,0);else if(re.depthTexture.format===ar)e.framebufferTexture2D(36160,33306,3553,Jt,0);else throw new Error("Unknown depthTexture format")}function _r(ze){var re=s.get(ze),On=ze.isWebGLCubeRenderTarget===!0;if(ze.depthTexture){if(On)throw new Error("target.depthTexture not supported in Cube render targets");on(re.__webglFramebuffer,ze)}else if(On){re.__webglDepthbuffer=[];for(var Jt=0;Jt<6;Jt++)e.bindFramebuffer(36160,re.__webglFramebuffer[Jt]),re.__webglDepthbuffer[Jt]=e.createRenderbuffer(),Hi(re.__webglDepthbuffer[Jt],ze,!1)}else e.bindFramebuffer(36160,re.__webglFramebuffer),re.__webglDepthbuffer=e.createRenderbuffer(),Hi(re.__webglDepthbuffer,ze,!1);e.bindFramebuffer(36160,null)}function pr(ze){var re=s.get(ze),On=s.get(ze.texture);ze.addEventListener("dispose",Me),On.__webglTexture=e.createTexture(),v.memory.textures++;var Jt=ze.isWebGLCubeRenderTarget===!0,bi=ze.isWebGLMultisampleRenderTarget===!0,kn=ae(ze)||E;if(E&&ze.texture.format===nl&&(ze.texture.type===xs||ze.texture.type===tl)&&(ze.texture.format=ye,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),Jt){re.__webglFramebuffer=[];for(var Xi=0;Xi<6;Xi++)re.__webglFramebuffer[Xi]=e.createFramebuffer()}else if(re.__webglFramebuffer=e.createFramebuffer(),bi)if(E){re.__webglMultisampledFramebuffer=e.createFramebuffer(),re.__webglColorRenderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(36161,re.__webglColorRenderbuffer);var ji=f.convert(ze.texture.format),Di=f.convert(ze.texture.type),Ji=_e(ze.texture.internalFormat,ji,Di),$i=Zi(ze);e.renderbufferStorageMultisample(36161,$i,Ji,ze.width,ze.height),e.bindFramebuffer(36160,re.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064,36161,re.__webglColorRenderbuffer),e.bindRenderbuffer(36161,null),ze.depthBuffer&&(re.__webglDepthRenderbuffer=e.createRenderbuffer(),Hi(re.__webglDepthRenderbuffer,ze,!0)),e.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(Jt){t.bindTexture(34067,On.__webglTexture),Qt(34067,ze.texture,kn);for(var Pr=0;Pr<6;Pr++)Pi(re.__webglFramebuffer[Pr],ze,36064,34069+Pr);se(ze.texture,kn)&&ge(34067,ze.texture,ze.width,ze.height),t.bindTexture(34067,null)}else t.bindTexture(3553,On.__webglTexture),Qt(3553,ze.texture,kn),Pi(re.__webglFramebuffer,ze,36064,3553),se(ze.texture,kn)&&ge(3553,ze.texture,ze.width,ze.height),t.bindTexture(3553,null);ze.depthBuffer&&_r(ze)}function Zi(ze){return E&&ze.isWebGLMultisampleRenderTarget?Math.min(H,ze.samples):0}function Xr(ze){var re=v.render.frame;q.get(ze)!==re&&(q.set(ze,re),ze.update())}var Sr=!1,rs=!1;function zr(ze,re){ze&&ze.isWebGLRenderTarget&&(Sr===!1&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),Sr=!0),ze=ze.texture),Qe(ze,re)}function As(ze,re){ze&&ze.isWebGLCubeRenderTarget&&(rs===!1&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),rs=!0),ze=ze.texture),Bt(ze,re)}this.allocateTextureUnit=Ke,this.resetTextureUnits=function(){Ze=0},this.setTexture2D=Qe,this.setTexture2DArray=function(ze,re){var On=s.get(ze);if(ze.version>0&&On.__version!==ze.version){ai(On,ze,re);return}t.activeTexture(33984+re),t.bindTexture(35866,On.__webglTexture)},this.setTexture3D=function(ze,re){var On=s.get(ze);if(ze.version>0&&On.__version!==ze.version){ai(On,ze,re);return}t.activeTexture(33984+re),t.bindTexture(32879,On.__webglTexture)},this.setTextureCube=Bt,this.setupRenderTarget=pr,this.updateRenderTargetMipmap=function(ze){var re=ze.texture,On=ae(ze)||E;if(se(re,On)){var Jt=ze.isWebGLCubeRenderTarget?34067:3553,bi=s.get(re).__webglTexture;t.bindTexture(Jt,bi),ge(Jt,re,ze.width,ze.height),t.bindTexture(Jt,null)}},this.updateMultisampleRenderTarget=function(ze){if(ze.isWebGLMultisampleRenderTarget)if(E){var re=s.get(ze);e.bindFramebuffer(36008,re.__webglMultisampledFramebuffer),e.bindFramebuffer(36009,re.__webglFramebuffer);var On=ze.width,Jt=ze.height,bi=16384;ze.depthBuffer&&(bi|=256),ze.stencilBuffer&&(bi|=1024),e.blitFramebuffer(0,0,On,Jt,0,0,On,Jt,bi,9728),e.bindFramebuffer(36160,re.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=zr,this.safeSetTextureCube=As}function S1(e,a,t){var s=t.isWebGL2;return{convert:function(l){var f;if(l===wa)return 5121;if(l===no)return 32819;if(l===El)return 32820;if(l===ta)return 33635;if(l===zs)return 5120;if(l===Ra)return 5122;if(l===ec)return 5123;if(l===to)return 5124;if(l===Ds)return 5125;if(l===xs)return 5126;if(l===tl)return s?5131:(f=a.get("OES_texture_half_float"),f!==null?f.HALF_FLOAT_OES:null);if(l===bo)return 6406;if(l===nl)return 6407;if(l===ye)return 6408;if(l===Dt)return 6409;if(l===Rt)return 6410;if(l===Qn)return 6402;if(l===ar)return 34041;if(l===dr)return 6403;if(l===Mr)return 36244;if(l===tr)return 33319;if(l===Os)return 33320;if(l===Is)return 36248;if(l===Ii)return 36249;if(l===Vr||l===oa||l===Wr||l===Us)if(f=a.get("WEBGL_compressed_texture_s3tc"),f!==null){if(l===Vr)return f.COMPRESSED_RGB_S3TC_DXT1_EXT;if(l===oa)return f.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(l===Wr)return f.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(l===Us)return f.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(l===Zs||l===tc||l===ma||l===nc)if(f=a.get("WEBGL_compressed_texture_pvrtc"),f!==null){if(l===Zs)return f.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(l===tc)return f.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(l===ma)return f.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(l===nc)return f.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(l===la)return f=a.get("WEBGL_compressed_texture_etc1"),f!==null?f.COMPRESSED_RGB_ETC1_WEBGL:null;if((l===ic||l===Up)&&(f=a.get("WEBGL_compressed_texture_etc"),f!==null)){if(l===ic)return f.COMPRESSED_RGB8_ETC2;if(l===Up)return f.COMPRESSED_RGBA8_ETC2_EAC}if(l===Ug||l===Hp||l===Hg||l===Gg||l===k0||l===z0||l===U0||l===Vg||l===H0||l===G0||l===Uh||l===Wg||l===V0||l===Xg||l===Hh||l===Bu||l===W0||l===fs||l===Gh||l===Gp||l===qg||l===jg||l===Yg||l===rc||l===X0||l===Zg||l===td||l===Mo)return f=a.get("WEBGL_compressed_texture_astc"),f!==null?l:null;if(l===wo)return f=a.get("EXT_texture_compression_bptc"),f!==null?l:null;if(l===io)return s?34042:(f=a.get("WEBGL_depth_texture"),f!==null?f.UNSIGNED_INT_24_8_WEBGL:null)}}}function ix(e){Ms.call(this),this.cameras=e||[]}ix.prototype=Object.assign(Object.create(Ms.prototype),{constructor:ix,isArrayCamera:!0});function of(){Ei.call(this),this.type="Group"}of.prototype=Object.assign(Object.create(Ei.prototype),{constructor:of,isGroup:!0});function pv(){this._targetRay=null,this._grip=null,this._hand=null}Object.assign(pv.prototype,{constructor:pv,getHandSpace:function(){if(this._hand===null&&(this._hand=new of,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints=[],this._hand.inputState={pinching:!1},window.XRHand))for(var e=0;e<=window.XRHand.LITTLE_PHALANX_TIP;e++){var a=new of;a.matrixAutoUpdate=!1,a.visible=!1,this._hand.joints.push(a),this._hand.add(a)}return this._hand},getTargetRaySpace:function(){return this._targetRay===null&&(this._targetRay=new of,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return this._grip===null&&(this._grip=new of,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this},disconnect:function(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this},update:function(e,a,t){var s=null,l=null,f=null,v=this._targetRay,x=this._grip,w=this._hand;if(e)if(w&&e.hand){f=!0;for(var E=0;E<=window.XRHand.LITTLE_PHALANX_TIP;E++)if(e.hand[E]){var P=a.getJointPose(e.hand[E],t),R=w.joints[E];P!==null&&(R.matrix.fromArray(P.transform.matrix),R.matrix.decompose(R.position,R.rotation,R.scale),R.jointRadius=P.radius),R.visible=P!==null;var V=w.joints[window.XRHand.INDEX_PHALANX_TIP],H=w.joints[window.XRHand.THUMB_PHALANX_TIP],q=V.position.distanceTo(H.position),z=.02,G=.005;w.inputState.pinching&&q>z+G?(w.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!w.inputState.pinching&&q<=z-G&&(w.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}}else v!==null&&(s=a.getPose(e.targetRaySpace,t),s!==null&&(v.matrix.fromArray(s.transform.matrix),v.matrix.decompose(v.position,v.rotation,v.scale))),x!==null&&e.gripSpace&&(l=a.getPose(e.gripSpace,t),l!==null&&(x.matrix.fromArray(l.transform.matrix),x.matrix.decompose(x.position,x.rotation,x.scale)));return v!==null&&(v.visible=s!==null),x!==null&&(x.visible=l!==null),w!==null&&(w.visible=f!==null),this}});function E1(e,a){var t=this,s=null,l=1,f=null,v="local-floor",x=null,w=[],E=new Map,P=new Ms;P.layers.enable(1),P.viewport=new ps;var R=new Ms;R.layers.enable(2),R.viewport=new ps;var V=[P,R],H=new ix;H.layers.enable(1),H.layers.enable(2);var q=null,z=null;this.enabled=!1,this.isPresenting=!1,this.getController=function(be){var ve=w[be];return ve===void 0&&(ve=new pv,w[be]=ve),ve.getTargetRaySpace()},this.getControllerGrip=function(be){var ve=w[be];return ve===void 0&&(ve=new pv,w[be]=ve),ve.getGripSpace()},this.getHand=function(be){var ve=w[be];return ve===void 0&&(ve=new pv,w[be]=ve),ve.getHandSpace()};function G(be){var ve=E.get(be.inputSource);ve&&ve.dispatchEvent({type:be.type,data:be.inputSource})}function ie(){E.forEach(function(be,ve){be.disconnect(ve)}),E.clear(),e.setFramebuffer(null),e.setRenderTarget(e.getRenderTarget()),Me.stop(),t.isPresenting=!1,t.dispatchEvent({type:"sessionend"})}function le(be){f=be,Me.setContext(s),Me.start(),t.isPresenting=!0,t.dispatchEvent({type:"sessionstart"})}this.setFramebufferScaleFactor=function(be){l=be,t.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(be){v=be,t.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return f},this.getSession=function(){return s},this.setSession=function(be){if(s=be,s!==null){s.addEventListener("select",G),s.addEventListener("selectstart",G),s.addEventListener("selectend",G),s.addEventListener("squeeze",G),s.addEventListener("squeezestart",G),s.addEventListener("squeezeend",G),s.addEventListener("end",ie);var ve=a.getContextAttributes();ve.xrCompatible!==!0&&a.makeXRCompatible();var Ze={antialias:ve.antialias,alpha:ve.alpha,depth:ve.depth,stencil:ve.stencil,framebufferScaleFactor:l},Ke=new XRWebGLLayer(s,a,Ze);s.updateRenderState({baseLayer:Ke}),s.requestReferenceSpace(v).then(le),s.addEventListener("inputsourceschange",ae)}};function ae(be){for(var ve=s.inputSources,Ze=0;Ze<w.length;Ze++)E.set(ve[Ze],w[Ze]);for(var Ke=0;Ke<be.removed.length;Ke++){var Qe=be.removed[Ke],Bt=E.get(Qe);Bt&&(Bt.dispatchEvent({type:"disconnected",data:Qe}),E.delete(Qe))}for(var fn=0;fn<be.added.length;fn++){var un=be.added[fn],Qt=E.get(un);Qt&&Qt.dispatchEvent({type:"connected",data:un})}}var J=new pe,se=new pe;function ge(be,ve,Ze){J.setFromMatrixPosition(ve.matrixWorld),se.setFromMatrixPosition(Ze.matrixWorld);var Ke=J.distanceTo(se),Qe=ve.projectionMatrix.elements,Bt=Ze.projectionMatrix.elements,fn=Qe[14]/(Qe[10]-1),un=Qe[14]/(Qe[10]+1),Qt=(Qe[9]+1)/Qe[5],Sn=(Qe[9]-1)/Qe[5],ai=(Qe[8]-1)/Qe[0],ei=(Bt[8]+1)/Bt[0],Pi=Ke/(-ai+ei),Hi=Pi*-ai;ve.matrixWorld.decompose(be.position,be.quaternion,be.scale),be.translateX(Hi),be.translateZ(Pi),be.matrixWorld.compose(be.position,be.quaternion,be.scale),be.matrixWorldInverse.getInverse(be.matrixWorld);var on=fn+Pi,_r=un+Pi;be.projectionMatrix.makePerspective(fn*ai-Hi,fn*ei+(Ke-Hi),Qt*un/_r*on,Sn*un/_r*on,on,_r)}function _e(be,ve){ve===null?be.matrixWorld.copy(be.matrix):be.matrixWorld.multiplyMatrices(ve.matrixWorld,be.matrix),be.matrixWorldInverse.getInverse(be.matrixWorld)}this.getCamera=function(be){H.near=R.near=P.near=be.near,H.far=R.far=P.far=be.far,(q!==H.near||z!==H.far)&&(s.updateRenderState({depthNear:H.near,depthFar:H.far}),q=H.near,z=H.far);var ve=be.parent,Ze=H.cameras;_e(H,ve);for(var Ke=0;Ke<Ze.length;Ke++)_e(Ze[Ke],ve);be.matrixWorld.copy(H.matrixWorld);for(var Qe=be.children,Bt=0,fn=Qe.length;Bt<fn;Bt++)Qe[Bt].updateMatrixWorld(!0);return Ze.length===2?ge(H,P,R):H.projectionMatrix.copy(P.projectionMatrix),H};var We=null;function nt(be,ve){if(x=ve.getViewerPose(f),x!==null){var Ze=x.views,Ke=s.renderState.baseLayer;e.setFramebuffer(Ke.framebuffer);var Qe=!1;Ze.length!==H.cameras.length&&(H.cameras.length=0,Qe=!0);for(var Bt=0;Bt<Ze.length;Bt++){var fn=Ze[Bt],un=Ke.getViewport(fn),Qt=V[Bt];Qt.matrix.fromArray(fn.transform.matrix),Qt.projectionMatrix.fromArray(fn.projectionMatrix),Qt.viewport.set(un.x,un.y,un.width,un.height),Bt===0&&H.matrix.copy(Qt.matrix),Qe===!0&&H.cameras.push(Qt)}}for(var Sn=s.inputSources,ai=0;ai<w.length;ai++){var ei=w[ai],Pi=Sn[ai];ei.update(Pi,ve,f)}We&&We(be,ve)}var Me=new t1;Me.setAnimationLoop(nt),this.setAnimationLoop=function(be){We=be},this.dispose=function(){}}Object.assign(E1.prototype,il.prototype);function kL(e){function a(z,G){z.opacity.value=G.opacity,G.color&&z.diffuse.value.copy(G.color),G.emissive&&z.emissive.value.copy(G.emissive).multiplyScalar(G.emissiveIntensity),G.map&&(z.map.value=G.map),G.alphaMap&&(z.alphaMap.value=G.alphaMap),G.specularMap&&(z.specularMap.value=G.specularMap);var ie=e.get(G).envMap;if(ie){z.envMap.value=ie,z.flipEnvMap.value=ie.isCubeTexture&&ie._needsFlipEnvMap?-1:1,z.reflectivity.value=G.reflectivity,z.refractionRatio.value=G.refractionRatio;var le=e.get(ie).__maxMipLevel;le!==void 0&&(z.maxMipLevel.value=le)}G.lightMap&&(z.lightMap.value=G.lightMap,z.lightMapIntensity.value=G.lightMapIntensity),G.aoMap&&(z.aoMap.value=G.aoMap,z.aoMapIntensity.value=G.aoMapIntensity);var ae;G.map?ae=G.map:G.specularMap?ae=G.specularMap:G.displacementMap?ae=G.displacementMap:G.normalMap?ae=G.normalMap:G.bumpMap?ae=G.bumpMap:G.roughnessMap?ae=G.roughnessMap:G.metalnessMap?ae=G.metalnessMap:G.alphaMap?ae=G.alphaMap:G.emissiveMap?ae=G.emissiveMap:G.clearcoatMap?ae=G.clearcoatMap:G.clearcoatNormalMap?ae=G.clearcoatNormalMap:G.clearcoatRoughnessMap&&(ae=G.clearcoatRoughnessMap),ae!==void 0&&(ae.isWebGLRenderTarget&&(ae=ae.texture),ae.matrixAutoUpdate===!0&&ae.updateMatrix(),z.uvTransform.value.copy(ae.matrix));var J;G.aoMap?J=G.aoMap:G.lightMap&&(J=G.lightMap),J!==void 0&&(J.isWebGLRenderTarget&&(J=J.texture),J.matrixAutoUpdate===!0&&J.updateMatrix(),z.uv2Transform.value.copy(J.matrix))}function t(z,G){z.diffuse.value.copy(G.color),z.opacity.value=G.opacity}function s(z,G){z.dashSize.value=G.dashSize,z.totalSize.value=G.dashSize+G.gapSize,z.scale.value=G.scale}function l(z,G,ie,le){z.diffuse.value.copy(G.color),z.opacity.value=G.opacity,z.size.value=G.size*ie,z.scale.value=le*.5,G.map&&(z.map.value=G.map),G.alphaMap&&(z.alphaMap.value=G.alphaMap);var ae;G.map?ae=G.map:G.alphaMap&&(ae=G.alphaMap),ae!==void 0&&(ae.matrixAutoUpdate===!0&&ae.updateMatrix(),z.uvTransform.value.copy(ae.matrix))}function f(z,G){z.diffuse.value.copy(G.color),z.opacity.value=G.opacity,z.rotation.value=G.rotation,G.map&&(z.map.value=G.map),G.alphaMap&&(z.alphaMap.value=G.alphaMap);var ie;G.map?ie=G.map:G.alphaMap&&(ie=G.alphaMap),ie!==void 0&&(ie.matrixAutoUpdate===!0&&ie.updateMatrix(),z.uvTransform.value.copy(ie.matrix))}function v(z,G){G.emissiveMap&&(z.emissiveMap.value=G.emissiveMap)}function x(z,G){z.specular.value.copy(G.specular),z.shininess.value=Math.max(G.shininess,1e-4),G.emissiveMap&&(z.emissiveMap.value=G.emissiveMap),G.bumpMap&&(z.bumpMap.value=G.bumpMap,z.bumpScale.value=G.bumpScale,G.side===O&&(z.bumpScale.value*=-1)),G.normalMap&&(z.normalMap.value=G.normalMap,z.normalScale.value.copy(G.normalScale),G.side===O&&z.normalScale.value.negate()),G.displacementMap&&(z.displacementMap.value=G.displacementMap,z.displacementScale.value=G.displacementScale,z.displacementBias.value=G.displacementBias)}function w(z,G){G.gradientMap&&(z.gradientMap.value=G.gradientMap),G.emissiveMap&&(z.emissiveMap.value=G.emissiveMap),G.bumpMap&&(z.bumpMap.value=G.bumpMap,z.bumpScale.value=G.bumpScale,G.side===O&&(z.bumpScale.value*=-1)),G.normalMap&&(z.normalMap.value=G.normalMap,z.normalScale.value.copy(G.normalScale),G.side===O&&z.normalScale.value.negate()),G.displacementMap&&(z.displacementMap.value=G.displacementMap,z.displacementScale.value=G.displacementScale,z.displacementBias.value=G.displacementBias)}function E(z,G){z.roughness.value=G.roughness,z.metalness.value=G.metalness,G.roughnessMap&&(z.roughnessMap.value=G.roughnessMap),G.metalnessMap&&(z.metalnessMap.value=G.metalnessMap),G.emissiveMap&&(z.emissiveMap.value=G.emissiveMap),G.bumpMap&&(z.bumpMap.value=G.bumpMap,z.bumpScale.value=G.bumpScale,G.side===O&&(z.bumpScale.value*=-1)),G.normalMap&&(z.normalMap.value=G.normalMap,z.normalScale.value.copy(G.normalScale),G.side===O&&z.normalScale.value.negate()),G.displacementMap&&(z.displacementMap.value=G.displacementMap,z.displacementScale.value=G.displacementScale,z.displacementBias.value=G.displacementBias);var ie=e.get(G).envMap;ie&&(z.envMapIntensity.value=G.envMapIntensity)}function P(z,G){E(z,G),z.reflectivity.value=G.reflectivity,z.clearcoat.value=G.clearcoat,z.clearcoatRoughness.value=G.clearcoatRoughness,G.sheen&&z.sheen.value.copy(G.sheen),G.clearcoatMap&&(z.clearcoatMap.value=G.clearcoatMap),G.clearcoatRoughnessMap&&(z.clearcoatRoughnessMap.value=G.clearcoatRoughnessMap),G.clearcoatNormalMap&&(z.clearcoatNormalScale.value.copy(G.clearcoatNormalScale),z.clearcoatNormalMap.value=G.clearcoatNormalMap,G.side===O&&z.clearcoatNormalScale.value.negate()),z.transmission.value=G.transmission,G.transmissionMap&&(z.transmissionMap.value=G.transmissionMap)}function R(z,G){G.matcap&&(z.matcap.value=G.matcap),G.bumpMap&&(z.bumpMap.value=G.bumpMap,z.bumpScale.value=G.bumpScale,G.side===O&&(z.bumpScale.value*=-1)),G.normalMap&&(z.normalMap.value=G.normalMap,z.normalScale.value.copy(G.normalScale),G.side===O&&z.normalScale.value.negate()),G.displacementMap&&(z.displacementMap.value=G.displacementMap,z.displacementScale.value=G.displacementScale,z.displacementBias.value=G.displacementBias)}function V(z,G){G.displacementMap&&(z.displacementMap.value=G.displacementMap,z.displacementScale.value=G.displacementScale,z.displacementBias.value=G.displacementBias)}function H(z,G){G.displacementMap&&(z.displacementMap.value=G.displacementMap,z.displacementScale.value=G.displacementScale,z.displacementBias.value=G.displacementBias),z.referencePosition.value.copy(G.referencePosition),z.nearDistance.value=G.nearDistance,z.farDistance.value=G.farDistance}function q(z,G){G.bumpMap&&(z.bumpMap.value=G.bumpMap,z.bumpScale.value=G.bumpScale,G.side===O&&(z.bumpScale.value*=-1)),G.normalMap&&(z.normalMap.value=G.normalMap,z.normalScale.value.copy(G.normalScale),G.side===O&&z.normalScale.value.negate()),G.displacementMap&&(z.displacementMap.value=G.displacementMap,z.displacementScale.value=G.displacementScale,z.displacementBias.value=G.displacementBias)}return{refreshFogUniforms:function(z,G){z.fogColor.value.copy(G.color),G.isFog?(z.fogNear.value=G.near,z.fogFar.value=G.far):G.isFogExp2&&(z.fogDensity.value=G.density)},refreshMaterialUniforms:function(z,G,ie,le){G.isMeshBasicMaterial?a(z,G):G.isMeshLambertMaterial?(a(z,G),v(z,G)):G.isMeshToonMaterial?(a(z,G),w(z,G)):G.isMeshPhongMaterial?(a(z,G),x(z,G)):G.isMeshStandardMaterial?(a(z,G),G.isMeshPhysicalMaterial?P(z,G):E(z,G)):G.isMeshMatcapMaterial?(a(z,G),R(z,G)):G.isMeshDepthMaterial?(a(z,G),V(z,G)):G.isMeshDistanceMaterial?(a(z,G),H(z,G)):G.isMeshNormalMaterial?(a(z,G),q(z,G)):G.isLineBasicMaterial?(t(z,G),G.isLineDashedMaterial&&s(z,G)):G.isPointsMaterial?l(z,G,ie,le):G.isSpriteMaterial?f(z,G):G.isShadowMaterial?(z.color.value.copy(G.color),z.opacity.value=G.opacity):G.isShaderMaterial&&(G.uniformsNeedUpdate=!1)}}}function mv(e){e=e||{};var a=e.canvas!==void 0?e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),t=e.context!==void 0?e.context:null,s=e.alpha!==void 0?e.alpha:!1,l=e.depth!==void 0?e.depth:!0,f=e.stencil!==void 0?e.stencil:!0,v=e.antialias!==void 0?e.antialias:!1,x=e.premultipliedAlpha!==void 0?e.premultipliedAlpha:!0,w=e.preserveDrawingBuffer!==void 0?e.preserveDrawingBuffer:!1,E=e.powerPreference!==void 0?e.powerPreference:"default",P=e.failIfMajorPerformanceCaveat!==void 0?e.failIfMajorPerformanceCaveat:!1,R=null,V=null;this.domElement=a,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=Da,this.physicallyCorrectLights=!1,this.toneMapping=ke,this.toneMappingExposure=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var H=this,q=!1,z=null,G=0,ie=0,le=null,ae=null,J=-1,se=null,ge=null,_e=new ps,We=new ps,nt=null,Me=a.width,be=a.height,ve=1,Ze=null,Ke=null,Qe=new ps(0,0,Me,be),Bt=new ps(0,0,Me,be),fn=!1,un=new hv,Qt=!1,Sn=!1,ai=new wr,ei=new pe,Pi={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Hi(){return le===null?ve:1}var on=t;function _r(Se,Xt){for(var Ot=0;Ot<Se.length;Ot++){var dn=Se[Ot],oi=a.getContext(dn,Xt);if(oi!==null)return oi}return null}try{if(a.addEventListener("webglcontextlost",Rd,!1),a.addEventListener("webglcontextrestored",bc,!1),on===null){var pr=["webgl2","webgl","experimental-webgl"];if(H.isWebGL1Renderer===!0&&pr.shift(),on=_r(pr,{alpha:s,depth:l,stencil:f,antialias:v,premultipliedAlpha:x,preserveDrawingBuffer:w,powerPreference:E,failIfMajorPerformanceCaveat:P}),on===null)throw _r(pr)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}on.getShaderPrecisionFormat===void 0&&(on.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Se){throw console.error("THREE.WebGLRenderer: "+Se.message),Se}var Zi,Xr,Sr,rs,zr,As,ze,re,On,Jt,bi,kn,Xi,ji,Di,Ji,$i,Pr,ms,Aa,Es;function Vo(){Zi=new wA(on),Xr=new xA(on,Zi,e),Xr.isWebGL2===!1&&(Zi.get("WEBGL_depth_texture"),Zi.get("OES_texture_float"),Zi.get("OES_texture_half_float"),Zi.get("OES_texture_half_float_linear"),Zi.get("OES_standard_derivatives"),Zi.get("OES_element_index_uint"),Zi.get("OES_vertex_array_object"),Zi.get("ANGLE_instanced_arrays")),Zi.get("OES_texture_float_linear"),Aa=new S1(on,Zi,Xr),Sr=new FL(on,Zi,Xr),Sr.scissor(We.copy(Bt).multiplyScalar(ve).floor()),Sr.viewport(_e.copy(Qe).multiplyScalar(ve).floor()),rs=new EA(on),zr=new TL,As=new BL(on,Zi,Sr,zr,Xr,Aa,rs),ze=new bA(H),re=new mA(on,Xr),Es=new vA(on,Zi,re,Xr),On=new MA(on,re,rs,Es),Jt=new CA(on,On,re,rs),$i=new LA(on),Di=new _A(zr),bi=new EL(H,ze,Zi,Xr,Es,Di),kn=new kL(zr),Xi=new CL(zr),ji=new NL,Ji=new gA(H,ze,Sr,Jt,x),Pr=new yA(on,Zi,rs,Xr),ms=new SA(on,Zi,rs,Xr),rs.programs=bi.programs,H.capabilities=Xr,H.extensions=Zi,H.properties=zr,H.renderLists=Xi,H.state=Sr,H.info=rs}Vo();var cs=new E1(H,on);this.xr=cs;var _c=new M1(H,Jt,Xr.maxTextureSize);this.shadowMap=_c,this.getContext=function(){return on},this.getContextAttributes=function(){return on.getContextAttributes()},this.forceContextLoss=function(){var Se=Zi.get("WEBGL_lose_context");Se&&Se.loseContext()},this.forceContextRestore=function(){var Se=Zi.get("WEBGL_lose_context");Se&&Se.restoreContext()},this.getPixelRatio=function(){return ve},this.setPixelRatio=function(Se){Se!==void 0&&(ve=Se,this.setSize(Me,be,!1))},this.getSize=function(Se){return Se===void 0&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),Se=new bn),Se.set(Me,be)},this.setSize=function(Se,Xt,Ot){if(cs.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}Me=Se,be=Xt,a.width=Math.floor(Se*ve),a.height=Math.floor(Xt*ve),Ot!==!1&&(a.style.width=Se+"px",a.style.height=Xt+"px"),this.setViewport(0,0,Se,Xt)},this.getDrawingBufferSize=function(Se){return Se===void 0&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),Se=new bn),Se.set(Me*ve,be*ve).floor()},this.setDrawingBufferSize=function(Se,Xt,Ot){Me=Se,be=Xt,ve=Ot,a.width=Math.floor(Se*Ot),a.height=Math.floor(Xt*Ot),this.setViewport(0,0,Se,Xt)},this.getCurrentViewport=function(Se){return Se===void 0&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),Se=new ps),Se.copy(_e)},this.getViewport=function(Se){return Se.copy(Qe)},this.setViewport=function(Se,Xt,Ot,dn){Se.isVector4?Qe.set(Se.x,Se.y,Se.z,Se.w):Qe.set(Se,Xt,Ot,dn),Sr.viewport(_e.copy(Qe).multiplyScalar(ve).floor())},this.getScissor=function(Se){return Se.copy(Bt)},this.setScissor=function(Se,Xt,Ot,dn){Se.isVector4?Bt.set(Se.x,Se.y,Se.z,Se.w):Bt.set(Se,Xt,Ot,dn),Sr.scissor(We.copy(Bt).multiplyScalar(ve).floor())},this.getScissorTest=function(){return fn},this.setScissorTest=function(Se){Sr.setScissorTest(fn=Se)},this.setOpaqueSort=function(Se){Ze=Se},this.setTransparentSort=function(Se){Ke=Se},this.getClearColor=function(){return Ji.getClearColor()},this.setClearColor=function(){Ji.setClearColor.apply(Ji,arguments)},this.getClearAlpha=function(){return Ji.getClearAlpha()},this.setClearAlpha=function(){Ji.setClearAlpha.apply(Ji,arguments)},this.clear=function(Se,Xt,Ot){var dn=0;(Se===void 0||Se)&&(dn|=16384),(Xt===void 0||Xt)&&(dn|=256),(Ot===void 0||Ot)&&(dn|=1024),on.clear(dn)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){a.removeEventListener("webglcontextlost",Rd,!1),a.removeEventListener("webglcontextrestored",bc,!1),Xi.dispose(),ji.dispose(),zr.dispose(),ze.dispose(),Jt.dispose(),Es.dispose(),cs.dispose(),wc.stop()};function Rd(Se){Se.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),q=!0}function bc(){console.log("THREE.WebGLRenderer: Context Restored."),q=!1,Vo()}function ih(Se){var Xt=Se.target;Xt.removeEventListener("dispose",ih),Mm(Xt)}function Mm(Se){Dd(Se),zr.remove(Se)}function Dd(Se){var Xt=zr.get(Se).program;Xt!==void 0&&bi.releaseProgram(Xt)}function iS(Se,Xt){Se.render(function(Ot){H.renderBufferImmediate(Ot,Xt)})}this.renderBufferImmediate=function(Se,Xt){Es.initAttributes();var Ot=zr.get(Se);Se.hasPositions&&!Ot.position&&(Ot.position=on.createBuffer()),Se.hasNormals&&!Ot.normal&&(Ot.normal=on.createBuffer()),Se.hasUvs&&!Ot.uv&&(Ot.uv=on.createBuffer()),Se.hasColors&&!Ot.color&&(Ot.color=on.createBuffer());var dn=Xt.getAttributes();Se.hasPositions&&(on.bindBuffer(34962,Ot.position),on.bufferData(34962,Se.positionArray,35048),Es.enableAttribute(dn.position),on.vertexAttribPointer(dn.position,3,5126,!1,0,0)),Se.hasNormals&&(on.bindBuffer(34962,Ot.normal),on.bufferData(34962,Se.normalArray,35048),Es.enableAttribute(dn.normal),on.vertexAttribPointer(dn.normal,3,5126,!1,0,0)),Se.hasUvs&&(on.bindBuffer(34962,Ot.uv),on.bufferData(34962,Se.uvArray,35048),Es.enableAttribute(dn.uv),on.vertexAttribPointer(dn.uv,2,5126,!1,0,0)),Se.hasColors&&(on.bindBuffer(34962,Ot.color),on.bufferData(34962,Se.colorArray,35048),Es.enableAttribute(dn.color),on.vertexAttribPointer(dn.color,3,5126,!1,0,0)),Es.disableUnusedAttributes(),on.drawArrays(4,0,Se.count),Se.count=0},this.renderBufferDirect=function(Se,Xt,Ot,dn,oi,Zr){Xt===null&&(Xt=Pi);var Ur=oi.isMesh&&oi.matrixWorld.determinant()<0,Qr=Em(Se,Xt,dn,oi);Sr.setMaterial(dn,Ur);var br=Ot.index,$s=Ot.attributes.position;if(br===null){if($s===void 0||$s.count===0)return}else if(br.count===0)return;var Ks=1;dn.wireframe===!0&&(br=On.getWireframeAttribute(Ot),Ks=2),(dn.morphTargets||dn.morphNormals)&&$i.update(oi,Ot,dn,Qr),Es.setup(oi,dn,Qr,Ot,br);var va,Fi=Pr;br!==null&&(va=re.get(br),Fi=ms,Fi.setIndex(va));var Ua=br!==null?br.count:$s.count,Ha=Ot.drawRange.start*Ks,ss=Ot.drawRange.count*Ks,La=Zr!==null?Zr.start*Ks:0,Jr=Zr!==null?Zr.count*Ks:1/0,mr=Math.max(Ha,La),as=Math.min(Ua,Ha+ss,La+Jr)-1,Fr=Math.max(0,as-mr+1);if(Fr!==0){if(oi.isMesh)dn.wireframe===!0?(Sr.setLineWidth(dn.wireframeLinewidth*Hi()),Fi.setMode(1)):Fi.setMode(4);else if(oi.isLine){var qr=dn.linewidth;qr===void 0&&(qr=1),Sr.setLineWidth(qr*Hi()),oi.isLineSegments?Fi.setMode(1):oi.isLineLoop?Fi.setMode(2):Fi.setMode(3)}else oi.isPoints?Fi.setMode(0):oi.isSprite&&Fi.setMode(4);if(oi.isInstancedMesh)Fi.renderInstances(mr,Fr,oi.count);else if(Ot.isInstancedBufferGeometry){var Vs=Math.min(Ot.instanceCount,Ot._maxInstanceCount);Fi.renderInstances(mr,Fr,Vs)}else Fi.render(mr,Fr)}},this.compile=function(Se,Xt){V=ji.get(Se,Xt),V.init(),Se.traverse(function(dn){dn.isLight&&(V.pushLight(dn),dn.castShadow&&V.pushShadow(dn))}),V.setupLights(Xt);var Ot=new WeakMap;Se.traverse(function(dn){var oi=dn.material;if(oi)if(Array.isArray(oi))for(var Zr=0;Zr<oi.length;Zr++){var Ur=oi[Zr];Ot.has(Ur)===!1&&(Wo(Ur,Se,dn),Ot.set(Ur))}else Ot.has(oi)===!1&&(Wo(oi,Se,dn),Ot.set(oi))})};var Sm=null;function i_(Se){cs.isPresenting||Sm&&Sm(Se)}var wc=new t1;wc.setAnimationLoop(i_),typeof window<"u"&&wc.setContext(window),this.setAnimationLoop=function(Se){Sm=Se,cs.setAnimationLoop(Se),Se===null?wc.stop():wc.start()},this.render=function(Se,Xt){var Ot,dn;if(arguments[2]!==void 0&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),Ot=arguments[2]),arguments[3]!==void 0&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),dn=arguments[3]),Xt!==void 0&&Xt.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(q!==!0){Es.resetDefaultState(),J=-1,se=null,Se.autoUpdate===!0&&Se.updateMatrixWorld(),Xt.parent===null&&Xt.updateMatrixWorld(),cs.enabled===!0&&cs.isPresenting===!0&&(Xt=cs.getCamera(Xt)),Se.isScene===!0&&Se.onBeforeRender(H,Se,Xt,Ot||le),V=ji.get(Se,Xt),V.init(),ai.multiplyMatrices(Xt.projectionMatrix,Xt.matrixWorldInverse),un.setFromProjectionMatrix(ai),Sn=this.localClippingEnabled,Qt=Di.init(this.clippingPlanes,Sn,Xt),R=Xi.get(Se,Xt),R.init(),Od(Se,Xt,0,H.sortObjects),R.finish(),H.sortObjects===!0&&R.sort(Ze,Ke),Qt===!0&&Di.beginShadows();var oi=V.state.shadowsArray;_c.render(oi,Se,Xt),V.setupLights(Xt),Qt===!0&&Di.endShadows(),this.info.autoReset===!0&&this.info.reset(),Ot!==void 0&&this.setRenderTarget(Ot),Ji.render(R,Se,Xt,dn);var Zr=R.opaque,Ur=R.transparent;Zr.length>0&&rh(Zr,Se,Xt),Ur.length>0&&rh(Ur,Se,Xt),Se.isScene===!0&&Se.onAfterRender(H,Se,Xt),le!==null&&(As.updateRenderTargetMipmap(le),As.updateMultisampleRenderTarget(le)),Sr.buffers.depth.setTest(!0),Sr.buffers.depth.setMask(!0),Sr.buffers.color.setMask(!0),Sr.setPolygonOffset(!1),R=null,V=null}};function Od(Se,Xt,Ot,dn){if(Se.visible!==!1){var oi=Se.layers.test(Xt.layers);if(oi){if(Se.isGroup)Ot=Se.renderOrder;else if(Se.isLOD)Se.autoUpdate===!0&&Se.update(Xt);else if(Se.isLight)V.pushLight(Se),Se.castShadow&&V.pushShadow(Se);else if(Se.isSprite){if(!Se.frustumCulled||un.intersectsSprite(Se)){dn&&ei.setFromMatrixPosition(Se.matrixWorld).applyMatrix4(ai);var Zr=Jt.update(Se),Ur=Se.material;Ur.visible&&R.push(Se,Zr,Ur,Ot,ei.z,null)}}else if(Se.isImmediateRenderObject)dn&&ei.setFromMatrixPosition(Se.matrixWorld).applyMatrix4(ai),R.push(Se,null,Se.material,Ot,ei.z,null);else if((Se.isMesh||Se.isLine||Se.isPoints)&&(Se.isSkinnedMesh&&Se.skeleton.frame!==rs.render.frame&&(Se.skeleton.update(),Se.skeleton.frame=rs.render.frame),!Se.frustumCulled||un.intersectsObject(Se))){dn&&ei.setFromMatrixPosition(Se.matrixWorld).applyMatrix4(ai);var Qr=Jt.update(Se),br=Se.material;if(Array.isArray(br))for(var $s=Qr.groups,Ks=0,va=$s.length;Ks<va;Ks++){var Fi=$s[Ks],Ua=br[Fi.materialIndex];Ua&&Ua.visible&&R.push(Se,Qr,Ua,Ot,ei.z,Fi)}else br.visible&&R.push(Se,Qr,br,Ot,ei.z,null)}}for(var Ha=Se.children,ss=0,La=Ha.length;ss<La;ss++)Od(Ha[ss],Xt,Ot,dn)}}function rh(Se,Xt,Ot){for(var dn=Xt.isScene===!0?Xt.overrideMaterial:null,oi=0,Zr=Se.length;oi<Zr;oi++){var Ur=Se[oi],Qr=Ur.object,br=Ur.geometry,$s=dn===null?Ur.material:dn,Ks=Ur.group;if(Ot.isArrayCamera){ge=Ot;for(var va=Ot.cameras,Fi=0,Ua=va.length;Fi<Ua;Fi++){var Ha=va[Fi];Qr.layers.test(Ha.layers)&&(Sr.viewport(_e.copy(Ha.viewport)),V.setupLights(Ha),gf(Qr,Xt,Ha,br,$s,Ks))}}else ge=null,gf(Qr,Xt,Ot,br,$s,Ks)}}function gf(Se,Xt,Ot,dn,oi,Zr){if(Se.onBeforeRender(H,Xt,Ot,dn,oi,Zr),V=ji.get(Xt,ge||Ot),Se.modelViewMatrix.multiplyMatrices(Ot.matrixWorldInverse,Se.matrixWorld),Se.normalMatrix.getNormalMatrix(Se.modelViewMatrix),Se.isImmediateRenderObject){var Ur=Em(Ot,Xt,oi,Se);Sr.setMaterial(oi),Es.reset(),iS(Se,Ur)}else H.renderBufferDirect(Ot,Xt,dn,oi,Se,Zr);Se.onAfterRender(H,Xt,Ot,dn,oi,Zr),V=ji.get(Xt,ge||Ot)}function Wo(Se,Xt,Ot){Xt.isScene!==!0&&(Xt=Pi);var dn=zr.get(Se),oi=V.state.lights,Zr=V.state.shadowsArray,Ur=oi.state.version,Qr=bi.getParameters(Se,oi.state,Zr,Xt,Ot),br=bi.getProgramCacheKey(Qr),$s=dn.program,Ks=!0;if($s===void 0)Se.addEventListener("dispose",ih);else if($s.cacheKey!==br)Dd(Se);else if(dn.lightsStateVersion!==Ur)Ks=!1;else if(Qr.shaderID!==void 0){var va=Se.isMeshStandardMaterial?Xt.environment:null;dn.envMap=ze.get(Se.envMap||va);return}else Ks=!1;Ks&&(Qr.uniforms=bi.getUniforms(Se),Se.onBeforeCompile(Qr,H),$s=bi.acquireProgram(Qr,br),dn.program=$s,dn.uniforms=Qr.uniforms,dn.outputEncoding=Qr.outputEncoding);var Fi=dn.uniforms;(!Se.isShaderMaterial&&!Se.isRawShaderMaterial||Se.clipping===!0)&&(dn.numClippingPlanes=Di.numPlanes,dn.numIntersection=Di.numIntersection,Fi.clippingPlanes=Di.uniform),dn.environment=Se.isMeshStandardMaterial?Xt.environment:null,dn.fog=Xt.fog,dn.envMap=ze.get(Se.envMap||dn.environment),dn.needsLights=Bv(Se),dn.lightsStateVersion=Ur,dn.needsLights&&(Fi.ambientLightColor.value=oi.state.ambient,Fi.lightProbe.value=oi.state.probe,Fi.directionalLights.value=oi.state.directional,Fi.directionalLightShadows.value=oi.state.directionalShadow,Fi.spotLights.value=oi.state.spot,Fi.spotLightShadows.value=oi.state.spotShadow,Fi.rectAreaLights.value=oi.state.rectArea,Fi.ltc_1.value=oi.state.rectAreaLTC1,Fi.ltc_2.value=oi.state.rectAreaLTC2,Fi.pointLights.value=oi.state.point,Fi.pointLightShadows.value=oi.state.pointShadow,Fi.hemisphereLights.value=oi.state.hemi,Fi.directionalShadowMap.value=oi.state.directionalShadowMap,Fi.directionalShadowMatrix.value=oi.state.directionalShadowMatrix,Fi.spotShadowMap.value=oi.state.spotShadowMap,Fi.spotShadowMatrix.value=oi.state.spotShadowMatrix,Fi.pointShadowMap.value=oi.state.pointShadowMap,Fi.pointShadowMatrix.value=oi.state.pointShadowMatrix);var Ua=dn.program.getUniforms(),Ha=rf.seqWithValue(Ua.seq,Fi);dn.uniformsList=Ha}function Em(Se,Xt,Ot,dn){Xt.isScene!==!0&&(Xt=Pi),As.resetTextureUnits();var oi=Xt.fog,Zr=Ot.isMeshStandardMaterial?Xt.environment:null,Ur=le===null?H.outputEncoding:le.texture.encoding,Qr=ze.get(Ot.envMap||Zr),br=zr.get(Ot),$s=V.state.lights;if(Qt===!0&&(Sn===!0||Se!==se)){var Ks=Se===se&&Ot.id===J;Di.setState(Ot,Se,Ks)}Ot.version===br.__version?(Ot.fog&&br.fog!==oi||br.environment!==Zr||br.needsLights&&br.lightsStateVersion!==$s.state.version||br.numClippingPlanes!==void 0&&(br.numClippingPlanes!==Di.numPlanes||br.numIntersection!==Di.numIntersection)||br.outputEncoding!==Ur||br.envMap!==Qr)&&Wo(Ot,Xt,dn):(Wo(Ot,Xt,dn),br.__version=Ot.version);var va=!1,Fi=!1,Ua=!1,Ha=br.program,ss=Ha.getUniforms(),La=br.uniforms;if(Sr.useProgram(Ha.program)&&(va=!0,Fi=!0,Ua=!0),Ot.id!==J&&(J=Ot.id,Fi=!0),va||se!==Se){if(ss.setValue(on,"projectionMatrix",Se.projectionMatrix),Xr.logarithmicDepthBuffer&&ss.setValue(on,"logDepthBufFC",2/(Math.log(Se.far+1)/Math.LN2)),se!==Se&&(se=Se,Fi=!0,Ua=!0),Ot.isShaderMaterial||Ot.isMeshPhongMaterial||Ot.isMeshToonMaterial||Ot.isMeshStandardMaterial||Ot.envMap){var Jr=ss.map.cameraPosition;Jr!==void 0&&Jr.setValue(on,ei.setFromMatrixPosition(Se.matrixWorld))}(Ot.isMeshPhongMaterial||Ot.isMeshToonMaterial||Ot.isMeshLambertMaterial||Ot.isMeshBasicMaterial||Ot.isMeshStandardMaterial||Ot.isShaderMaterial)&&ss.setValue(on,"isOrthographic",Se.isOrthographicCamera===!0),(Ot.isMeshPhongMaterial||Ot.isMeshToonMaterial||Ot.isMeshLambertMaterial||Ot.isMeshBasicMaterial||Ot.isMeshStandardMaterial||Ot.isShaderMaterial||Ot.isShadowMaterial||Ot.skinning)&&ss.setValue(on,"viewMatrix",Se.matrixWorldInverse)}if(Ot.skinning){ss.setOptional(on,dn,"bindMatrix"),ss.setOptional(on,dn,"bindMatrixInverse");var mr=dn.skeleton;if(mr){var as=mr.bones;if(Xr.floatVertexTextures){if(mr.boneTexture===void 0){var Fr=Math.sqrt(as.length*4);Fr=nr.ceilPowerOfTwo(Fr),Fr=Math.max(Fr,4);var qr=new Float32Array(Fr*Fr*4);qr.set(mr.boneMatrices);var Vs=new gd(qr,Fr,Fr,ye,xs);mr.boneMatrices=qr,mr.boneTexture=Vs,mr.boneTextureSize=Fr}ss.setValue(on,"boneTexture",mr.boneTexture,As),ss.setValue(on,"boneTextureSize",mr.boneTextureSize)}else ss.setOptional(on,mr,"boneMatrices")}}return(Fi||br.receiveShadow!==dn.receiveShadow)&&(br.receiveShadow=dn.receiveShadow,ss.setValue(on,"receiveShadow",dn.receiveShadow)),Fi&&(ss.setValue(on,"toneMappingExposure",H.toneMappingExposure),br.needsLights&&r_(La,Ua),oi&&Ot.fog&&kn.refreshFogUniforms(La,oi),kn.refreshMaterialUniforms(La,Ot,ve,be),rf.upload(on,br.uniformsList,La,As)),Ot.isShaderMaterial&&Ot.uniformsNeedUpdate===!0&&(rf.upload(on,br.uniformsList,La,As),Ot.uniformsNeedUpdate=!1),Ot.isSpriteMaterial&&ss.setValue(on,"center",dn.center),ss.setValue(on,"modelViewMatrix",dn.modelViewMatrix),ss.setValue(on,"normalMatrix",dn.normalMatrix),ss.setValue(on,"modelMatrix",dn.matrixWorld),Ha}function r_(Se,Xt){Se.ambientLightColor.needsUpdate=Xt,Se.lightProbe.needsUpdate=Xt,Se.directionalLights.needsUpdate=Xt,Se.directionalLightShadows.needsUpdate=Xt,Se.pointLights.needsUpdate=Xt,Se.pointLightShadows.needsUpdate=Xt,Se.spotLights.needsUpdate=Xt,Se.spotLightShadows.needsUpdate=Xt,Se.rectAreaLights.needsUpdate=Xt,Se.hemisphereLights.needsUpdate=Xt}function Bv(Se){return Se.isMeshLambertMaterial||Se.isMeshToonMaterial||Se.isMeshPhongMaterial||Se.isMeshStandardMaterial||Se.isShadowMaterial||Se.isShaderMaterial&&Se.lights===!0}this.setFramebuffer=function(Se){z!==Se&&le===null&&on.bindFramebuffer(36160,Se),z=Se},this.getActiveCubeFace=function(){return G},this.getActiveMipmapLevel=function(){return ie},this.getRenderList=function(){return R},this.setRenderList=function(Se){R=Se},this.getRenderState=function(){return V},this.setRenderState=function(Se){V=Se},this.getRenderTarget=function(){return le},this.setRenderTarget=function(Se,Xt,Ot){Xt===void 0&&(Xt=0),Ot===void 0&&(Ot=0),le=Se,G=Xt,ie=Ot,Se&&zr.get(Se).__webglFramebuffer===void 0&&As.setupRenderTarget(Se);var dn=z,oi=!1;if(Se){var Zr=zr.get(Se).__webglFramebuffer;Se.isWebGLCubeRenderTarget?(dn=Zr[Xt],oi=!0):Se.isWebGLMultisampleRenderTarget?dn=zr.get(Se).__webglMultisampledFramebuffer:dn=Zr,_e.copy(Se.viewport),We.copy(Se.scissor),nt=Se.scissorTest}else _e.copy(Qe).multiplyScalar(ve).floor(),We.copy(Bt).multiplyScalar(ve).floor(),nt=fn;if(ae!==dn&&(on.bindFramebuffer(36160,dn),ae=dn),Sr.viewport(_e),Sr.scissor(We),Sr.setScissorTest(nt),oi){var Ur=zr.get(Se.texture);on.framebufferTexture2D(36160,36064,34069+Xt,Ur.__webglTexture,Ot)}},this.readRenderTargetPixels=function(Se,Xt,Ot,dn,oi,Zr,Ur){if(!(Se&&Se.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}var Qr=zr.get(Se).__webglFramebuffer;if(Se.isWebGLCubeRenderTarget&&Ur!==void 0&&(Qr=Qr[Ur]),Qr){var br=!1;Qr!==ae&&(on.bindFramebuffer(36160,Qr),br=!0);try{var $s=Se.texture,Ks=$s.format,va=$s.type;if(Ks!==ye&&Aa.convert(Ks)!==on.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(va!==wa&&Aa.convert(va)!==on.getParameter(35738)&&!(va===xs&&(Xr.isWebGL2||Zi.get("OES_texture_float")||Zi.get("WEBGL_color_buffer_float")))&&!(va===tl&&(Xr.isWebGL2?Zi.get("EXT_color_buffer_float"):Zi.get("EXT_color_buffer_half_float")))){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}on.checkFramebufferStatus(36160)===36053?Xt>=0&&Xt<=Se.width-dn&&Ot>=0&&Ot<=Se.height-oi&&on.readPixels(Xt,Ot,dn,oi,Aa.convert(Ks),Aa.convert(va),Zr):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{br&&on.bindFramebuffer(36160,ae)}}},this.copyFramebufferToTexture=function(Se,Xt,Ot){Ot===void 0&&(Ot=0);var dn=Math.pow(2,-Ot),oi=Math.floor(Xt.image.width*dn),Zr=Math.floor(Xt.image.height*dn),Ur=Aa.convert(Xt.format);As.setTexture2D(Xt,0),on.copyTexImage2D(3553,Ot,Ur,Se.x,Se.y,oi,Zr,0),Sr.unbindTexture()},this.copyTextureToTexture=function(Se,Xt,Ot,dn){dn===void 0&&(dn=0);var oi=Xt.image.width,Zr=Xt.image.height,Ur=Aa.convert(Ot.format),Qr=Aa.convert(Ot.type);As.setTexture2D(Ot,0),on.pixelStorei(37440,Ot.flipY),on.pixelStorei(37441,Ot.premultiplyAlpha),on.pixelStorei(3317,Ot.unpackAlignment),Xt.isDataTexture?on.texSubImage2D(3553,dn,Se.x,Se.y,oi,Zr,Ur,Qr,Xt.image.data):Xt.isCompressedTexture?on.compressedTexSubImage2D(3553,dn,Se.x,Se.y,Xt.mipmaps[0].width,Xt.mipmaps[0].height,Ur,Xt.mipmaps[0].data):on.texSubImage2D(3553,dn,Se.x,Se.y,Ur,Qr,Xt.image),dn===0&&Ot.generateMipmaps&&on.generateMipmap(3553),Sr.unbindTexture()},this.initTexture=function(Se){As.setTexture2D(Se,0),Sr.unbindTexture()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function jw(e){mv.call(this,e)}jw.prototype=Object.assign(Object.create(mv.prototype),{constructor:jw,isWebGL1Renderer:!0});var T1=function(){function e(t,s){Object.defineProperty(this,"isFogExp2",{value:!0}),this.name="",this.color=new mi(t),this.density=s!==void 0?s:25e-5}var a=e.prototype;return a.clone=function(){return new e(this.color,this.density)},a.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},e}(),A1=function(){function e(t,s,l){Object.defineProperty(this,"isFog",{value:!0}),this.name="",this.color=new mi(t),this.near=s!==void 0?s:1,this.far=l!==void 0?l:1e3}var a=e.prototype;return a.clone=function(){return new e(this.color,this.near,this.far)},a.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},e}(),Yw=function(e){Li(a,e);function a(){var s=e.call(this)||this;return Object.defineProperty(Xh(s),"isScene",{value:!0}),s.type="Scene",s.background=null,s.environment=null,s.fog=null,s.overrideMaterial=null,s.autoUpdate=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:Xh(s)})),s}var t=a.prototype;return t.copy=function(s,l){return e.prototype.copy.call(this,s,l),s.background!==null&&(this.background=s.background.clone()),s.environment!==null&&(this.environment=s.environment.clone()),s.fog!==null&&(this.fog=s.fog.clone()),s.overrideMaterial!==null&&(this.overrideMaterial=s.overrideMaterial.clone()),this.autoUpdate=s.autoUpdate,this.matrixAutoUpdate=s.matrixAutoUpdate,this},t.toJSON=function(s){var l=e.prototype.toJSON.call(this,s);return this.background!==null&&(l.object.background=this.background.toJSON(s)),this.environment!==null&&(l.object.environment=this.environment.toJSON(s)),this.fog!==null&&(l.object.fog=this.fog.toJSON()),l},a}(Ei);function cl(e,a){this.array=e,this.stride=a,this.count=e!==void 0?e.length/a:0,this.usage=ad,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=nr.generateUUID()}Object.defineProperty(cl.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}}),Object.assign(cl.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this},copyAt:function(e,a,t){e*=this.stride,t*=a.stride;for(var s=0,l=this.stride;s<l;s++)this.array[e+s]=a.array[t+s];return this},set:function(e,a){return a===void 0&&(a=0),this.array.set(e,a),this},clone:function(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=nr.generateUUID()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);var a=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),t=new cl(a,this.stride);return t.setUsage(this.usage),t},onUpload:function(e){return this.onUploadCallback=e,this},toJSON:function(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=nr.generateUUID()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}});var vd=new pe;function lf(e,a,t,s){this.name="",this.data=e,this.itemSize=a,this.offset=t,this.normalized=s===!0}Object.defineProperties(lf.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}},needsUpdate:{set:function(e){this.data.needsUpdate=e}}}),Object.assign(lf.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(e){for(var a=0,t=this.data.count;a<t;a++)vd.x=this.getX(a),vd.y=this.getY(a),vd.z=this.getZ(a),vd.applyMatrix4(e),this.setXYZ(a,vd.x,vd.y,vd.z);return this},setX:function(e,a){return this.data.array[e*this.data.stride+this.offset]=a,this},setY:function(e,a){return this.data.array[e*this.data.stride+this.offset+1]=a,this},setZ:function(e,a){return this.data.array[e*this.data.stride+this.offset+2]=a,this},setW:function(e,a){return this.data.array[e*this.data.stride+this.offset+3]=a,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,a,t){return e=e*this.data.stride+this.offset,this.data.array[e+0]=a,this.data.array[e+1]=t,this},setXYZ:function(e,a,t,s){return e=e*this.data.stride+this.offset,this.data.array[e+0]=a,this.data.array[e+1]=t,this.data.array[e+2]=s,this},setXYZW:function(e,a,t,s,l){return e=e*this.data.stride+this.offset,this.data.array[e+0]=a,this.data.array[e+1]=t,this.data.array[e+2]=s,this.data.array[e+3]=l,this},clone:function(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");for(var a=[],t=0;t<this.count;t++)for(var s=t*this.data.stride+this.offset,l=0;l<this.itemSize;l++)a.push(this.data.array[s+l]);return new qi(new this.array.constructor(a),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new lf(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)},toJSON:function(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");for(var a=[],t=0;t<this.count;t++)for(var s=t*this.data.stride+this.offset,l=0;l<this.itemSize;l++)a.push(this.data.array[s+l]);return{itemSize:this.itemSize,type:this.array.constructor.name,array:a,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}});function cf(e){zi.call(this),this.type="SpriteMaterial",this.color=new mi(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(e)}cf.prototype=Object.create(zi.prototype),cf.prototype.constructor=cf,cf.prototype.isSpriteMaterial=!0,cf.prototype.copy=function(e){return zi.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this};var am,gv=new pe,om=new pe,lm=new pe,cm=new bn,vv=new bn,L1=new wr,rx=new pe,yv=new pe,sx=new pe,C1=new bn,Zw=new bn,P1=new bn;function xv(e){if(Ei.call(this),this.type="Sprite",am===void 0){am=new qe;var a=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),t=new cl(a,5);am.setIndex([0,1,2,0,2,3]),am.setAttribute("position",new lf(t,3,0,!1)),am.setAttribute("uv",new lf(t,2,3,!1))}this.geometry=am,this.material=e!==void 0?e:new cf,this.center=new bn(.5,.5)}xv.prototype=Object.assign(Object.create(Ei.prototype),{constructor:xv,isSprite:!0,raycast:function(e,a){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),om.setFromMatrixScale(this.matrixWorld),L1.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),lm.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&om.multiplyScalar(-lm.z);var t=this.material.rotation,s,l;t!==0&&(l=Math.cos(t),s=Math.sin(t));var f=this.center;ax(rx.set(-.5,-.5,0),lm,f,om,s,l),ax(yv.set(.5,-.5,0),lm,f,om,s,l),ax(sx.set(.5,.5,0),lm,f,om,s,l),C1.set(0,0),Zw.set(1,0),P1.set(1,1);var v=e.ray.intersectTriangle(rx,yv,sx,!1,gv);if(!(v===null&&(ax(yv.set(-.5,.5,0),lm,f,om,s,l),Zw.set(0,1),v=e.ray.intersectTriangle(rx,sx,yv,!1,gv),v===null))){var x=e.ray.origin.distanceTo(gv);x<e.near||x>e.far||a.push({distance:x,point:gv.clone(),uv:zo.getUV(gv,rx,yv,sx,C1,Zw,P1,new bn),face:null,object:this})}},copy:function(e){return Ei.prototype.copy.call(this,e),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}});function ax(e,a,t,s,l,f){cm.subVectors(e,t).addScalar(.5).multiply(s),l!==void 0?(vv.x=f*cm.x-l*cm.y,vv.y=l*cm.x+f*cm.y):vv.copy(cm),e.copy(a),e.x+=vv.x,e.y+=vv.y,e.applyMatrix4(L1)}var ox=new pe,R1=new pe;function _v(){Ei.call(this),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}_v.prototype=Object.assign(Object.create(Ei.prototype),{constructor:_v,isLOD:!0,copy:function(e){Ei.prototype.copy.call(this,e,!1);for(var a=e.levels,t=0,s=a.length;t<s;t++){var l=a[t];this.addLevel(l.object.clone(),l.distance)}return this.autoUpdate=e.autoUpdate,this},addLevel:function(e,a){a===void 0&&(a=0),a=Math.abs(a);var t=this.levels,s;for(s=0;s<t.length&&!(a<t[s].distance);s++);return t.splice(s,0,{distance:a,object:e}),this.add(e),this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function(e){var a=this.levels;if(a.length>0){var t,s;for(t=1,s=a.length;t<s&&!(e<a[t].distance);t++);return a[t-1].object}return null},raycast:function(e,a){var t=this.levels;if(t.length>0){ox.setFromMatrixPosition(this.matrixWorld);var s=e.ray.origin.distanceTo(ox);this.getObjectForDistance(s).raycast(e,a)}},update:function(e){var a=this.levels;if(a.length>1){ox.setFromMatrixPosition(e.matrixWorld),R1.setFromMatrixPosition(this.matrixWorld);var t=ox.distanceTo(R1)/e.zoom;a[0].object.visible=!0;var s,l;for(s=1,l=a.length;s<l&&t>=a[s].distance;s++)a[s-1].object.visible=!1,a[s].object.visible=!0;for(this._currentLevel=s-1;s<l;s++)a[s].object.visible=!1}},toJSON:function(e){var a=Ei.prototype.toJSON.call(this,e);this.autoUpdate===!1&&(a.object.autoUpdate=!1),a.object.levels=[];for(var t=this.levels,s=0,l=t.length;s<l;s++){var f=t[s];a.object.levels.push({object:f.object.uuid,distance:f.distance})}return a}});function lx(e,a){e&&e.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),xr.call(this,e,a),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new wr,this.bindMatrixInverse=new wr}lx.prototype=Object.assign(Object.create(xr.prototype),{constructor:lx,isSkinnedMesh:!0,copy:function(e){return xr.prototype.copy.call(this,e),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this},bind:function(e,a){this.skeleton=e,a===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),a=this.matrixWorld),this.bindMatrix.copy(a),this.bindMatrixInverse.getInverse(a)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var e=new ps,a=this.geometry.attributes.skinWeight,t=0,s=a.count;t<s;t++){e.x=a.getX(t),e.y=a.getY(t),e.z=a.getZ(t),e.w=a.getW(t);var l=1/e.manhattanLength();l!==1/0?e.multiplyScalar(l):e.set(1,0,0,0),a.setXYZW(t,e.x,e.y,e.z,e.w)}},updateMatrixWorld:function(e){xr.prototype.updateMatrixWorld.call(this,e),this.bindMode==="attached"?this.bindMatrixInverse.getInverse(this.matrixWorld):this.bindMode==="detached"?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},boneTransform:function(){var e=new pe,a=new ps,t=new ps,s=new pe,l=new wr;return function(f,v){var x=this.skeleton,w=this.geometry;a.fromBufferAttribute(w.attributes.skinIndex,f),t.fromBufferAttribute(w.attributes.skinWeight,f),e.fromBufferAttribute(w.attributes.position,f).applyMatrix4(this.bindMatrix),v.set(0,0,0);for(var E=0;E<4;E++){var P=t.getComponent(E);if(P!==0){var R=a.getComponent(E);l.multiplyMatrices(x.bones[R].matrixWorld,x.boneInverses[R]),v.addScaledVector(s.copy(e).applyMatrix4(l),P)}}return v.applyMatrix4(this.bindMatrixInverse)}}()});var D1=new wr,zL=new wr;function cx(e,a){if(e=e||[],this.bones=e.slice(0),this.boneMatrices=new Float32Array(this.bones.length*16),this.frame=-1,a===void 0)this.calculateInverses();else if(this.bones.length===a.length)this.boneInverses=a.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var t=0,s=this.bones.length;t<s;t++)this.boneInverses.push(new wr)}}Object.assign(cx.prototype,{calculateInverses:function(){this.boneInverses=[];for(var e=0,a=this.bones.length;e<a;e++){var t=new wr;this.bones[e]&&t.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(t)}},pose:function(){for(var e=0,a=this.bones.length;e<a;e++){var t=this.bones[e];t&&t.matrixWorld.getInverse(this.boneInverses[e])}for(var s=0,l=this.bones.length;s<l;s++){var f=this.bones[s];f&&(f.parent&&f.parent.isBone?(f.matrix.getInverse(f.parent.matrixWorld),f.matrix.multiply(f.matrixWorld)):f.matrix.copy(f.matrixWorld),f.matrix.decompose(f.position,f.quaternion,f.scale))}},update:function(){for(var e=this.bones,a=this.boneInverses,t=this.boneMatrices,s=this.boneTexture,l=0,f=e.length;l<f;l++){var v=e[l]?e[l].matrixWorld:zL;D1.multiplyMatrices(v,a[l]),D1.toArray(t,l*16)}s!==void 0&&(s.needsUpdate=!0)},clone:function(){return new cx(this.bones,this.boneInverses)},getBoneByName:function(e){for(var a=0,t=this.bones.length;a<t;a++){var s=this.bones[a];if(s.name===e)return s}},dispose:function(){this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=void 0)}});function Jw(){Ei.call(this),this.type="Bone"}Jw.prototype=Object.assign(Object.create(Ei.prototype),{constructor:Jw,isBone:!0});var O1=new wr,I1=new wr,ux=[],bv=new xr;function hx(e,a,t){xr.call(this,e,a),this.instanceMatrix=new qi(new Float32Array(t*16),16),this.instanceColor=null,this.count=t,this.frustumCulled=!1}hx.prototype=Object.assign(Object.create(xr.prototype),{constructor:hx,isInstancedMesh:!0,copy:function(e){return xr.prototype.copy.call(this,e),this.instanceMatrix.copy(e.instanceMatrix),this.count=e.count,this},setColorAt:function(e,a){this.instanceColor===null&&(this.instanceColor=new qi(new Float32Array(this.count*3),3)),a.toArray(this.instanceColor.array,e*3)},getMatrixAt:function(e,a){a.fromArray(this.instanceMatrix.array,e*16)},raycast:function(e,a){var t=this.matrixWorld,s=this.count;if(bv.geometry=this.geometry,bv.material=this.material,bv.material!==void 0)for(var l=0;l<s;l++){this.getMatrixAt(l,O1),I1.multiplyMatrices(t,O1),bv.matrixWorld=I1,bv.raycast(e,ux);for(var f=0,v=ux.length;f<v;f++){var x=ux[f];x.instanceId=l,x.object=this,a.push(x)}ux.length=0}},setMatrixAt:function(e,a){a.toArray(this.instanceMatrix.array,e*16)},updateMorphTargets:function(){}});function Js(e){zi.call(this),this.type="LineBasicMaterial",this.color=new mi(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.morphTargets=!1,this.setValues(e)}Js.prototype=Object.create(zi.prototype),Js.prototype.constructor=Js,Js.prototype.isLineBasicMaterial=!0,Js.prototype.copy=function(e){return zi.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.morphTargets=e.morphTargets,this};var N1=new pe,F1=new pe,B1=new wr,fx=new sl,dx=new ro;function Ol(e,a,t){t===1&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),Ei.call(this),this.type="Line",this.geometry=e!==void 0?e:new qe,this.material=a!==void 0?a:new Js,this.updateMorphTargets()}Ol.prototype=Object.assign(Object.create(Ei.prototype),{constructor:Ol,isLine:!0,copy:function(e){return Ei.prototype.copy.call(this,e),this.material=e.material,this.geometry=e.geometry,this},computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry)if(e.index===null){for(var a=e.attributes.position,t=[0],s=1,l=a.count;s<l;s++)N1.fromBufferAttribute(a,s-1),F1.fromBufferAttribute(a,s),t[s]=t[s-1],t[s]+=N1.distanceTo(F1);e.setAttribute("lineDistance",new L(t,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry){var f=e.vertices,v=e.lineDistances;v[0]=0;for(var x=1,w=f.length;x<w;x++)v[x]=v[x-1],v[x]+=f[x-1].distanceTo(f[x])}return this},raycast:function(e,a){var t=this.geometry,s=this.matrixWorld,l=e.params.Line.threshold;if(t.boundingSphere===null&&t.computeBoundingSphere(),dx.copy(t.boundingSphere),dx.applyMatrix4(s),dx.radius+=l,e.ray.intersectsSphere(dx)!==!1){B1.getInverse(s),fx.copy(e.ray).applyMatrix4(B1);var f=l/((this.scale.x+this.scale.y+this.scale.z)/3),v=f*f,x=new pe,w=new pe,E=new pe,P=new pe,R=this.isLineSegments?2:1;if(t.isBufferGeometry){var V=t.index,H=t.attributes,q=H.position;if(V!==null)for(var z=V.array,G=0,ie=z.length-1;G<ie;G+=R){var le=z[G],ae=z[G+1];x.fromBufferAttribute(q,le),w.fromBufferAttribute(q,ae);var J=fx.distanceSqToSegment(x,w,P,E);if(!(J>v)){P.applyMatrix4(this.matrixWorld);var se=e.ray.origin.distanceTo(P);se<e.near||se>e.far||a.push({distance:se,point:E.clone().applyMatrix4(this.matrixWorld),index:G,face:null,faceIndex:null,object:this})}}else for(var ge=0,_e=q.count-1;ge<_e;ge+=R){x.fromBufferAttribute(q,ge),w.fromBufferAttribute(q,ge+1);var We=fx.distanceSqToSegment(x,w,P,E);if(!(We>v)){P.applyMatrix4(this.matrixWorld);var nt=e.ray.origin.distanceTo(P);nt<e.near||nt>e.far||a.push({distance:nt,point:E.clone().applyMatrix4(this.matrixWorld),index:ge,face:null,faceIndex:null,object:this})}}}else if(t.isGeometry)for(var Me=t.vertices,be=Me.length,ve=0;ve<be-1;ve+=R){var Ze=fx.distanceSqToSegment(Me[ve],Me[ve+1],P,E);if(!(Ze>v)){P.applyMatrix4(this.matrixWorld);var Ke=e.ray.origin.distanceTo(P);Ke<e.near||Ke>e.far||a.push({distance:Ke,point:E.clone().applyMatrix4(this.matrixWorld),index:ve,face:null,faceIndex:null,object:this})}}}},updateMorphTargets:function(){var e=this.geometry;if(e.isBufferGeometry){var a=e.morphAttributes,t=Object.keys(a);if(t.length>0){var s=a[t[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var l=0,f=s.length;l<f;l++){var v=s[l].name||String(l);this.morphTargetInfluences.push(0),this.morphTargetDictionary[v]=l}}}}else{var x=e.morphTargets;x!==void 0&&x.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});var px=new pe,mx=new pe;function Eo(e,a){Ol.call(this,e,a),this.type="LineSegments"}Eo.prototype=Object.assign(Object.create(Ol.prototype),{constructor:Eo,isLineSegments:!0,computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry)if(e.index===null){for(var a=e.attributes.position,t=[],s=0,l=a.count;s<l;s+=2)px.fromBufferAttribute(a,s),mx.fromBufferAttribute(a,s+1),t[s]=s===0?0:t[s-1],t[s+1]=t[s]+px.distanceTo(mx);e.setAttribute("lineDistance",new L(t,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry)for(var f=e.vertices,v=e.lineDistances,x=0,w=f.length;x<w;x+=2)px.copy(f[x]),mx.copy(f[x+1]),v[x]=x===0?0:v[x-1],v[x+1]=v[x]+px.distanceTo(mx);return this}});function gx(e,a){Ol.call(this,e,a),this.type="LineLoop"}gx.prototype=Object.assign(Object.create(Ol.prototype),{constructor:gx,isLineLoop:!0});function dc(e){zi.call(this),this.type="PointsMaterial",this.color=new mi(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(e)}dc.prototype=Object.create(zi.prototype),dc.prototype.constructor=dc,dc.prototype.isPointsMaterial=!0,dc.prototype.copy=function(e){return zi.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.morphTargets=e.morphTargets,this};var k1=new wr,$w=new sl,vx=new ro,yx=new pe;function um(e,a){Ei.call(this),this.type="Points",this.geometry=e!==void 0?e:new qe,this.material=a!==void 0?a:new dc,this.updateMorphTargets()}um.prototype=Object.assign(Object.create(Ei.prototype),{constructor:um,isPoints:!0,copy:function(e){return Ei.prototype.copy.call(this,e),this.material=e.material,this.geometry=e.geometry,this},raycast:function(e,a){var t=this.geometry,s=this.matrixWorld,l=e.params.Points.threshold;if(t.boundingSphere===null&&t.computeBoundingSphere(),vx.copy(t.boundingSphere),vx.applyMatrix4(s),vx.radius+=l,e.ray.intersectsSphere(vx)!==!1){k1.getInverse(s),$w.copy(e.ray).applyMatrix4(k1);var f=l/((this.scale.x+this.scale.y+this.scale.z)/3),v=f*f;if(t.isBufferGeometry){var x=t.index,w=t.attributes,E=w.position;if(x!==null)for(var P=x.array,R=0,V=P.length;R<V;R++){var H=P[R];yx.fromBufferAttribute(E,H),Kw(yx,H,v,s,e,a,this)}else for(var q=0,z=E.count;q<z;q++)yx.fromBufferAttribute(E,q),Kw(yx,q,v,s,e,a,this)}else for(var G=t.vertices,ie=0,le=G.length;ie<le;ie++)Kw(G[ie],ie,v,s,e,a,this)}},updateMorphTargets:function(){var e=this.geometry;if(e.isBufferGeometry){var a=e.morphAttributes,t=Object.keys(a);if(t.length>0){var s=a[t[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var l=0,f=s.length;l<f;l++){var v=s[l].name||String(l);this.morphTargetInfluences.push(0),this.morphTargetDictionary[v]=l}}}}else{var x=e.morphTargets;x!==void 0&&x.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});function Kw(e,a,t,s,l,f,v){var x=$w.distanceSqToPoint(e);if(x<t){var w=new pe;$w.closestPointToPoint(e,w),w.applyMatrix4(s);var E=l.ray.origin.distanceTo(w);if(E<l.near||E>l.far)return;f.push({distance:E,distanceToRay:Math.sqrt(x),point:w,index:a,face:null,object:v})}}function Qw(e,a,t,s,l,f,v,x,w){ds.call(this,e,a,t,s,l,f,v,x,w),this.format=v!==void 0?v:nl,this.minFilter=f!==void 0?f:jn,this.magFilter=l!==void 0?l:jn,this.generateMipmaps=!1;var E=this;function P(){E.needsUpdate=!0,e.requestVideoFrameCallback(P)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(P)}Qw.prototype=Object.assign(Object.create(ds.prototype),{constructor:Qw,isVideoTexture:!0,update:function(){var e=this.image,a="requestVideoFrameCallback"in e;a===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}});function hm(e,a,t,s,l,f,v,x,w,E,P,R){ds.call(this,null,f,v,x,w,E,s,l,P,R),this.image={width:a,height:t},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}hm.prototype=Object.create(ds.prototype),hm.prototype.constructor=hm,hm.prototype.isCompressedTexture=!0;function wv(e,a,t,s,l,f,v,x,w){ds.call(this,e,a,t,s,l,f,v,x,w),this.needsUpdate=!0}wv.prototype=Object.create(ds.prototype),wv.prototype.constructor=wv,wv.prototype.isCanvasTexture=!0;function Mv(e,a,t,s,l,f,v,x,w,E){if(E=E!==void 0?E:Qn,E!==Qn&&E!==ar)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");t===void 0&&E===Qn&&(t=ec),t===void 0&&E===ar&&(t=io),ds.call(this,null,s,l,f,v,x,E,t,w),this.image={width:e,height:a},this.magFilter=v!==void 0?v:Ht,this.minFilter=x!==void 0?x:Ht,this.flipY=!1,this.generateMipmaps=!1}Mv.prototype=Object.create(ds.prototype),Mv.prototype.constructor=Mv,Mv.prototype.isDepthTexture=!0;var UL=0,su=new wr,eM=new Ei,xx=new pe;function Ss(){Object.defineProperty(this,"id",{value:UL+=2}),this.uuid=nr.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}Ss.prototype=Object.assign(Object.create(il.prototype),{constructor:Ss,isGeometry:!0,applyMatrix4:function(e){for(var a=new qa().getNormalMatrix(e),t=0,s=this.vertices.length;t<s;t++){var l=this.vertices[t];l.applyMatrix4(e)}for(var f=0,v=this.faces.length;f<v;f++){var x=this.faces[f];x.normal.applyMatrix3(a).normalize();for(var w=0,E=x.vertexNormals.length;w<E;w++)x.vertexNormals[w].applyMatrix3(a).normalize()}return this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(e){return su.makeRotationX(e),this.applyMatrix4(su),this},rotateY:function(e){return su.makeRotationY(e),this.applyMatrix4(su),this},rotateZ:function(e){return su.makeRotationZ(e),this.applyMatrix4(su),this},translate:function(e,a,t){return su.makeTranslation(e,a,t),this.applyMatrix4(su),this},scale:function(e,a,t){return su.makeScale(e,a,t),this.applyMatrix4(su),this},lookAt:function(e){return eM.lookAt(e),eM.updateMatrix(),this.applyMatrix4(eM.matrix),this},fromBufferGeometry:function(e){var a=this,t=e.index!==null?e.index:void 0,s=e.attributes;if(s.position===void 0)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;var l=s.position,f=s.normal,v=s.color,x=s.uv,w=s.uv2;w!==void 0&&(this.faceVertexUvs[1]=[]);for(var E=0;E<l.count;E++)a.vertices.push(new pe().fromBufferAttribute(l,E)),v!==void 0&&a.colors.push(new mi().fromBufferAttribute(v,E));function P(ae,J,se,ge){var _e=v===void 0?[]:[a.colors[ae].clone(),a.colors[J].clone(),a.colors[se].clone()],We=f===void 0?[]:[new pe().fromBufferAttribute(f,ae),new pe().fromBufferAttribute(f,J),new pe().fromBufferAttribute(f,se)],nt=new pd(ae,J,se,We,_e,ge);a.faces.push(nt),x!==void 0&&a.faceVertexUvs[0].push([new bn().fromBufferAttribute(x,ae),new bn().fromBufferAttribute(x,J),new bn().fromBufferAttribute(x,se)]),w!==void 0&&a.faceVertexUvs[1].push([new bn().fromBufferAttribute(w,ae),new bn().fromBufferAttribute(w,J),new bn().fromBufferAttribute(w,se)])}var R=e.groups;if(R.length>0)for(var V=0;V<R.length;V++)for(var H=R[V],q=H.start,z=H.count,G=q;G<q+z;G+=3)t!==void 0?P(t.getX(G),t.getX(G+1),t.getX(G+2),H.materialIndex):P(G,G+1,G+2,H.materialIndex);else if(t!==void 0)for(var ie=0;ie<t.count;ie+=3)P(t.getX(ie),t.getX(ie+1),t.getX(ie+2));else for(var le=0;le<l.count;le+=3)P(le,le+1,le+2);return this.computeFaceNormals(),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(xx).negate(),this.translate(xx.x,xx.y,xx.z),this},normalize:function(){this.computeBoundingSphere();var e=this.boundingSphere.center,a=this.boundingSphere.radius,t=a===0?1:1/a,s=new wr;return s.set(t,0,0,-t*e.x,0,t,0,-t*e.y,0,0,t,-t*e.z,0,0,0,1),this.applyMatrix4(s),this},computeFaceNormals:function(){for(var e=new pe,a=new pe,t=0,s=this.faces.length;t<s;t++){var l=this.faces[t],f=this.vertices[l.a],v=this.vertices[l.b],x=this.vertices[l.c];e.subVectors(x,v),a.subVectors(f,v),e.cross(a),e.normalize(),l.normal.copy(e)}},computeVertexNormals:function(e){e===void 0&&(e=!0);for(var a=new Array(this.vertices.length),t=0,s=this.vertices.length;t<s;t++)a[t]=new pe;if(e)for(var l=new pe,f=new pe,v=0,x=this.faces.length;v<x;v++){var w=this.faces[v],E=this.vertices[w.a],P=this.vertices[w.b],R=this.vertices[w.c];l.subVectors(R,P),f.subVectors(E,P),l.cross(f),a[w.a].add(l),a[w.b].add(l),a[w.c].add(l)}else{this.computeFaceNormals();for(var V=0,H=this.faces.length;V<H;V++){var q=this.faces[V];a[q.a].add(q.normal),a[q.b].add(q.normal),a[q.c].add(q.normal)}}for(var z=0,G=this.vertices.length;z<G;z++)a[z].normalize();for(var ie=0,le=this.faces.length;ie<le;ie++){var ae=this.faces[ie],J=ae.vertexNormals;J.length===3?(J[0].copy(a[ae.a]),J[1].copy(a[ae.b]),J[2].copy(a[ae.c])):(J[0]=a[ae.a].clone(),J[1]=a[ae.b].clone(),J[2]=a[ae.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){this.computeFaceNormals();for(var e=0,a=this.faces.length;e<a;e++){var t=this.faces[e],s=t.vertexNormals;s.length===3?(s[0].copy(t.normal),s[1].copy(t.normal),s[2].copy(t.normal)):(s[0]=t.normal.clone(),s[1]=t.normal.clone(),s[2]=t.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){for(var e=0,a=this.faces.length;e<a;e++){var t=this.faces[e];t.__originalFaceNormal?t.__originalFaceNormal.copy(t.normal):t.__originalFaceNormal=t.normal.clone(),t.__originalVertexNormals||(t.__originalVertexNormals=[]);for(var s=0,l=t.vertexNormals.length;s<l;s++)t.__originalVertexNormals[s]?t.__originalVertexNormals[s].copy(t.vertexNormals[s]):t.__originalVertexNormals[s]=t.vertexNormals[s].clone()}var f=new Ss;f.faces=this.faces;for(var v=0,x=this.morphTargets.length;v<x;v++){if(!this.morphNormals[v]){this.morphNormals[v]={},this.morphNormals[v].faceNormals=[],this.morphNormals[v].vertexNormals=[];for(var w=this.morphNormals[v].faceNormals,E=this.morphNormals[v].vertexNormals,P=0,R=this.faces.length;P<R;P++){var V=new pe,H={a:new pe,b:new pe,c:new pe};w.push(V),E.push(H)}}var q=this.morphNormals[v];f.vertices=this.morphTargets[v].vertices,f.computeFaceNormals(),f.computeVertexNormals();for(var z=0,G=this.faces.length;z<G;z++){var ie=this.faces[z],le=q.faceNormals[z],ae=q.vertexNormals[z];le.copy(ie.normal),ae.a.copy(ie.vertexNormals[0]),ae.b.copy(ie.vertexNormals[1]),ae.c.copy(ie.vertexNormals[2])}}for(var J=0,se=this.faces.length;J<se;J++){var ge=this.faces[J];ge.normal=ge.__originalFaceNormal,ge.vertexNormals=ge.__originalVertexNormals}},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new Tl),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){this.boundingSphere===null&&(this.boundingSphere=new ro),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,a,t){if(!(e&&e.isGeometry)){console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e);return}var s,l=this.vertices.length,f=this.vertices,v=e.vertices,x=this.faces,w=e.faces,E=this.colors,P=e.colors;t===void 0&&(t=0),a!==void 0&&(s=new qa().getNormalMatrix(a));for(var R=0,V=v.length;R<V;R++){var H=v[R],q=H.clone();a!==void 0&&q.applyMatrix4(a),f.push(q)}for(var z=0,G=P.length;z<G;z++)E.push(P[z].clone());for(var ie=0,le=w.length;ie<le;ie++){var ae=w[ie],J=void 0,se=void 0,ge=ae.vertexNormals,_e=ae.vertexColors,We=new pd(ae.a+l,ae.b+l,ae.c+l);We.normal.copy(ae.normal),s!==void 0&&We.normal.applyMatrix3(s).normalize();for(var nt=0,Me=ge.length;nt<Me;nt++)J=ge[nt].clone(),s!==void 0&&J.applyMatrix3(s).normalize(),We.vertexNormals.push(J);We.color.copy(ae.color);for(var be=0,ve=_e.length;be<ve;be++)se=_e[be],We.vertexColors.push(se.clone());We.materialIndex=ae.materialIndex+t,x.push(We)}for(var Ze=0,Ke=e.faceVertexUvs.length;Ze<Ke;Ze++){var Qe=e.faceVertexUvs[Ze];this.faceVertexUvs[Ze]===void 0&&(this.faceVertexUvs[Ze]=[]);for(var Bt=0,fn=Qe.length;Bt<fn;Bt++){for(var un=Qe[Bt],Qt=[],Sn=0,ai=un.length;Sn<ai;Sn++)Qt.push(un[Sn].clone());this.faceVertexUvs[Ze].push(Qt)}}},mergeMesh:function(e){if(!(e&&e.isMesh)){console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e);return}e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)},mergeVertices:function(){for(var e={},a=[],t=[],s=Math.pow(10,4),l=0,f=this.vertices.length;l<f;l++){var v=this.vertices[l],x=Math.round(v.x*s)+"_"+Math.round(v.y*s)+"_"+Math.round(v.z*s);e[x]===void 0?(e[x]=l,a.push(this.vertices[l]),t[l]=a.length-1):t[l]=t[e[x]]}for(var w=[],E=0,P=this.faces.length;E<P;E++){var R=this.faces[E];R.a=t[R.a],R.b=t[R.b],R.c=t[R.c];for(var V=[R.a,R.b,R.c],H=0;H<3;H++)if(V[H]===V[(H+1)%3]){w.push(E);break}}for(var q=w.length-1;q>=0;q--){var z=w[q];this.faces.splice(z,1);for(var G=0,ie=this.faceVertexUvs.length;G<ie;G++)this.faceVertexUvs[G].splice(z,1)}var le=this.vertices.length-a.length;return this.vertices=a,le},setFromPoints:function(e){this.vertices=[];for(var a=0,t=e.length;a<t;a++){var s=e[a];this.vertices.push(new pe(s.x,s.y,s.z||0))}return this},sortFacesByMaterialIndex:function(){for(var e=this.faces,a=e.length,t=0;t<a;t++)e[t]._id=t;e.sort(function(E,P){return E.materialIndex-P.materialIndex});var s=this.faceVertexUvs[0],l=this.faceVertexUvs[1],f,v;s&&s.length===a&&(f=[]),l&&l.length===a&&(v=[]);for(var x=0;x<a;x++){var w=e[x]._id;f&&f.push(s[w]),v&&v.push(l[w])}f&&(this.faceVertexUvs[0]=f),v&&(this.faceVertexUvs[1]=v)},toJSON:function(){var e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),this.parameters!==void 0){var a=this.parameters;for(var t in a)a[t]!==void 0&&(e[t]=a[t]);return e}for(var s=[],l=0;l<this.vertices.length;l++){var f=this.vertices[l];s.push(f.x,f.y,f.z)}for(var v=[],x=[],w={},E=[],P={},R=[],V={},H=0;H<this.faces.length;H++){var q=this.faces[H],z=this.faceVertexUvs[0][H]!==void 0,G=q.normal.length()>0,ie=q.vertexNormals.length>0,le=q.color.r!==1||q.color.g!==1||q.color.b!==1,ae=q.vertexColors.length>0,J=0;if(J=We(J,0,0),J=We(J,1,!0),J=We(J,2,!1),J=We(J,3,z),J=We(J,4,G),J=We(J,5,ie),J=We(J,6,le),J=We(J,7,ae),v.push(J),v.push(q.a,q.b,q.c),v.push(q.materialIndex),z){var se=this.faceVertexUvs[0][H];v.push(be(se[0]),be(se[1]),be(se[2]))}if(G&&v.push(nt(q.normal)),ie){var ge=q.vertexNormals;v.push(nt(ge[0]),nt(ge[1]),nt(ge[2]))}if(le&&v.push(Me(q.color)),ae){var _e=q.vertexColors;v.push(Me(_e[0]),Me(_e[1]),Me(_e[2]))}}function We(ve,Ze,Ke){return Ke?ve|1<<Ze:ve&~(1<<Ze)}function nt(ve){var Ze=ve.x.toString()+ve.y.toString()+ve.z.toString();return w[Ze]!==void 0||(w[Ze]=x.length/3,x.push(ve.x,ve.y,ve.z)),w[Ze]}function Me(ve){var Ze=ve.r.toString()+ve.g.toString()+ve.b.toString();return P[Ze]!==void 0||(P[Ze]=E.length,E.push(ve.getHex())),P[Ze]}function be(ve){var Ze=ve.x.toString()+ve.y.toString();return V[Ze]!==void 0||(V[Ze]=R.length/2,R.push(ve.x,ve.y)),V[Ze]}return e.data={},e.data.vertices=s,e.data.normals=x,E.length>0&&(e.data.colors=E),R.length>0&&(e.data.uvs=[R]),e.data.faces=v,e},clone:function(){return new Ss().copy(this)},copy:function(e){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;for(var a=e.vertices,t=0,s=a.length;t<s;t++)this.vertices.push(a[t].clone());for(var l=e.colors,f=0,v=l.length;f<v;f++)this.colors.push(l[f].clone());for(var x=e.faces,w=0,E=x.length;w<E;w++)this.faces.push(x[w].clone());for(var P=0,R=e.faceVertexUvs.length;P<R;P++){var V=e.faceVertexUvs[P];this.faceVertexUvs[P]===void 0&&(this.faceVertexUvs[P]=[]);for(var H=0,q=V.length;H<q;H++){for(var z=V[H],G=[],ie=0,le=z.length;ie<le;ie++){var ae=z[ie];G.push(ae.clone())}this.faceVertexUvs[P].push(G)}}for(var J=e.morphTargets,se=0,ge=J.length;se<ge;se++){var _e={};if(_e.name=J[se].name,J[se].vertices!==void 0){_e.vertices=[];for(var We=0,nt=J[se].vertices.length;We<nt;We++)_e.vertices.push(J[se].vertices[We].clone())}if(J[se].normals!==void 0){_e.normals=[];for(var Me=0,be=J[se].normals.length;Me<be;Me++)_e.normals.push(J[se].normals[Me].clone())}this.morphTargets.push(_e)}for(var ve=e.morphNormals,Ze=0,Ke=ve.length;Ze<Ke;Ze++){var Qe={};if(ve[Ze].vertexNormals!==void 0){Qe.vertexNormals=[];for(var Bt=0,fn=ve[Ze].vertexNormals.length;Bt<fn;Bt++){var un=ve[Ze].vertexNormals[Bt],Qt={};Qt.a=un.a.clone(),Qt.b=un.b.clone(),Qt.c=un.c.clone(),Qe.vertexNormals.push(Qt)}}if(ve[Ze].faceNormals!==void 0){Qe.faceNormals=[];for(var Sn=0,ai=ve[Ze].faceNormals.length;Sn<ai;Sn++)Qe.faceNormals.push(ve[Ze].faceNormals[Sn].clone())}this.morphNormals.push(Qe)}for(var ei=e.skinWeights,Pi=0,Hi=ei.length;Pi<Hi;Pi++)this.skinWeights.push(ei[Pi].clone());for(var on=e.skinIndices,_r=0,pr=on.length;_r<pr;_r++)this.skinIndices.push(on[_r].clone());for(var Zi=e.lineDistances,Xr=0,Sr=Zi.length;Xr<Sr;Xr++)this.lineDistances.push(Zi[Xr]);var rs=e.boundingBox;rs!==null&&(this.boundingBox=rs.clone());var zr=e.boundingSphere;return zr!==null&&(this.boundingSphere=zr.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var tM=function(e){Li(a,e);function a(t,s,l,f,v,x){var w=e.call(this)||this;return w.type="BoxGeometry",w.parameters={width:t,height:s,depth:l,widthSegments:f,heightSegments:v,depthSegments:x},w.fromBufferGeometry(new ol(t,s,l,f,v,x)),w.mergeVertices(),w}return a}(Ss),nM=function(e){Li(a,e);function a(t,s,l,f){var v=e.call(this)||this;v.type="CircleBufferGeometry",v.parameters={radius:t,segments:s,thetaStart:l,thetaLength:f},t=t||1,s=s!==void 0?Math.max(3,s):8,l=l!==void 0?l:0,f=f!==void 0?f:Math.PI*2;var x=[],w=[],E=[],P=[],R=new pe,V=new bn;w.push(0,0,0),E.push(0,0,1),P.push(.5,.5);for(var H=0,q=3;H<=s;H++,q+=3){var z=l+H/s*f;R.x=t*Math.cos(z),R.y=t*Math.sin(z),w.push(R.x,R.y,R.z),E.push(0,0,1),V.x=(w[q]/t+1)/2,V.y=(w[q+1]/t+1)/2,P.push(V.x,V.y)}for(var G=1;G<=s;G++)x.push(G,G+1,0);return v.setIndex(x),v.setAttribute("position",new L(w,3)),v.setAttribute("normal",new L(E,3)),v.setAttribute("uv",new L(P,2)),v}return a}(qe),z1=function(e){Li(a,e);function a(t,s,l,f){var v=e.call(this)||this;return v.type="CircleGeometry",v.parameters={radius:t,segments:s,thetaStart:l,thetaLength:f},v.fromBufferGeometry(new nM(t,s,l,f)),v.mergeVertices(),v}return a}(Ss),Sv=function(e){Li(a,e);function a(t,s,l,f,v,x,w,E){var P=e.call(this)||this;P.type="CylinderBufferGeometry",P.parameters={radiusTop:t,radiusBottom:s,height:l,radialSegments:f,heightSegments:v,openEnded:x,thetaStart:w,thetaLength:E};var R=Xh(P);t=t!==void 0?t:1,s=s!==void 0?s:1,l=l||1,f=Math.floor(f)||8,v=Math.floor(v)||1,x=x!==void 0?x:!1,w=w!==void 0?w:0,E=E!==void 0?E:Math.PI*2;var V=[],H=[],q=[],z=[],G=0,ie=[],le=l/2,ae=0;J(),x===!1&&(t>0&&se(!0),s>0&&se(!1)),P.setIndex(V),P.setAttribute("position",new L(H,3)),P.setAttribute("normal",new L(q,3)),P.setAttribute("uv",new L(z,2));function J(){for(var ge=new pe,_e=new pe,We=0,nt=(s-t)/l,Me=0;Me<=v;Me++){for(var be=[],ve=Me/v,Ze=ve*(s-t)+t,Ke=0;Ke<=f;Ke++){var Qe=Ke/f,Bt=Qe*E+w,fn=Math.sin(Bt),un=Math.cos(Bt);_e.x=Ze*fn,_e.y=-ve*l+le,_e.z=Ze*un,H.push(_e.x,_e.y,_e.z),ge.set(fn,nt,un).normalize(),q.push(ge.x,ge.y,ge.z),z.push(Qe,1-ve),be.push(G++)}ie.push(be)}for(var Qt=0;Qt<f;Qt++)for(var Sn=0;Sn<v;Sn++){var ai=ie[Sn][Qt],ei=ie[Sn+1][Qt],Pi=ie[Sn+1][Qt+1],Hi=ie[Sn][Qt+1];V.push(ai,ei,Hi),V.push(ei,Pi,Hi),We+=6}R.addGroup(ae,We,0),ae+=We}function se(ge){for(var _e=G,We=new bn,nt=new pe,Me=0,be=ge===!0?t:s,ve=ge===!0?1:-1,Ze=1;Ze<=f;Ze++)H.push(0,le*ve,0),q.push(0,ve,0),z.push(.5,.5),G++;for(var Ke=G,Qe=0;Qe<=f;Qe++){var Bt=Qe/f,fn=Bt*E+w,un=Math.cos(fn),Qt=Math.sin(fn);nt.x=be*Qt,nt.y=le*ve,nt.z=be*un,H.push(nt.x,nt.y,nt.z),q.push(0,ve,0),We.x=un*.5+.5,We.y=Qt*.5*ve+.5,z.push(We.x,We.y),G++}for(var Sn=0;Sn<f;Sn++){var ai=_e+Sn,ei=Ke+Sn;ge===!0?V.push(ei,ei+1,ai):V.push(ei+1,ei,ai),Me+=3}R.addGroup(ae,Me,ge===!0?1:2),ae+=Me}return P}return a}(qe),iM=function(e){Li(a,e);function a(t,s,l,f,v,x,w,E){var P=e.call(this)||this;return P.type="CylinderGeometry",P.parameters={radiusTop:t,radiusBottom:s,height:l,radialSegments:f,heightSegments:v,openEnded:x,thetaStart:w,thetaLength:E},P.fromBufferGeometry(new Sv(t,s,l,f,v,x,w,E)),P.mergeVertices(),P}return a}(Ss),U1=function(e){Li(a,e);function a(t,s,l,f,v,x,w){var E=e.call(this,0,t,s,l,f,v,x,w)||this;return E.type="ConeGeometry",E.parameters={radius:t,height:s,radialSegments:l,heightSegments:f,openEnded:v,thetaStart:x,thetaLength:w},E}return a}(iM),H1=function(e){Li(a,e);function a(t,s,l,f,v,x,w){var E=e.call(this,0,t,s,l,f,v,x,w)||this;return E.type="ConeBufferGeometry",E.parameters={radius:t,height:s,radialSegments:l,heightSegments:f,openEnded:v,thetaStart:x,thetaLength:w},E}return a}(Sv),yd=function(e){Li(a,e);function a(t,s,l,f){var v=e.call(this)||this;v.type="PolyhedronBufferGeometry",v.parameters={vertices:t,indices:s,radius:l,detail:f},l=l||1,f=f||0;var x=[],w=[];E(f),R(l),V(),v.setAttribute("position",new L(x,3)),v.setAttribute("normal",new L(x.slice(),3)),v.setAttribute("uv",new L(w,2)),f===0?v.computeVertexNormals():v.normalizeNormals();function E(J){for(var se=new pe,ge=new pe,_e=new pe,We=0;We<s.length;We+=3)z(s[We+0],se),z(s[We+1],ge),z(s[We+2],_e),P(se,ge,_e,J)}function P(J,se,ge,_e){for(var We=_e+1,nt=[],Me=0;Me<=We;Me++){nt[Me]=[];for(var be=J.clone().lerp(ge,Me/We),ve=se.clone().lerp(ge,Me/We),Ze=We-Me,Ke=0;Ke<=Ze;Ke++)Ke===0&&Me===We?nt[Me][Ke]=be:nt[Me][Ke]=be.clone().lerp(ve,Ke/Ze)}for(var Qe=0;Qe<We;Qe++)for(var Bt=0;Bt<2*(We-Qe)-1;Bt++){var fn=Math.floor(Bt/2);Bt%2===0?(q(nt[Qe][fn+1]),q(nt[Qe+1][fn]),q(nt[Qe][fn])):(q(nt[Qe][fn+1]),q(nt[Qe+1][fn+1]),q(nt[Qe+1][fn]))}}function R(J){for(var se=new pe,ge=0;ge<x.length;ge+=3)se.x=x[ge+0],se.y=x[ge+1],se.z=x[ge+2],se.normalize().multiplyScalar(J),x[ge+0]=se.x,x[ge+1]=se.y,x[ge+2]=se.z}function V(){for(var J=new pe,se=0;se<x.length;se+=3){J.x=x[se+0],J.y=x[se+1],J.z=x[se+2];var ge=le(J)/2/Math.PI+.5,_e=ae(J)/Math.PI+.5;w.push(ge,1-_e)}G(),H()}function H(){for(var J=0;J<w.length;J+=6){var se=w[J+0],ge=w[J+2],_e=w[J+4],We=Math.max(se,ge,_e),nt=Math.min(se,ge,_e);We>.9&&nt<.1&&(se<.2&&(w[J+0]+=1),ge<.2&&(w[J+2]+=1),_e<.2&&(w[J+4]+=1))}}function q(J){x.push(J.x,J.y,J.z)}function z(J,se){var ge=J*3;se.x=t[ge+0],se.y=t[ge+1],se.z=t[ge+2]}function G(){for(var J=new pe,se=new pe,ge=new pe,_e=new pe,We=new bn,nt=new bn,Me=new bn,be=0,ve=0;be<x.length;be+=9,ve+=6){J.set(x[be+0],x[be+1],x[be+2]),se.set(x[be+3],x[be+4],x[be+5]),ge.set(x[be+6],x[be+7],x[be+8]),We.set(w[ve+0],w[ve+1]),nt.set(w[ve+2],w[ve+3]),Me.set(w[ve+4],w[ve+5]),_e.copy(J).add(se).add(ge).divideScalar(3);var Ze=le(_e);ie(We,ve+0,J,Ze),ie(nt,ve+2,se,Ze),ie(Me,ve+4,ge,Ze)}}function ie(J,se,ge,_e){_e<0&&J.x===1&&(w[se]=J.x-1),ge.x===0&&ge.z===0&&(w[se]=_e/2/Math.PI+.5)}function le(J){return Math.atan2(J.z,-J.x)}function ae(J){return Math.atan2(-J.y,Math.sqrt(J.x*J.x+J.z*J.z))}return v}return a}(qe),rM=function(e){Li(a,e);function a(t,s){var l,f=(1+Math.sqrt(5))/2,v=1/f;return l=e.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-v,-f,0,-v,f,0,v,-f,0,v,f,-v,-f,0,-v,f,0,v,-f,0,v,f,0,-f,0,-v,f,0,-v,-f,0,v,f,0,v],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,s)||this,l.type="DodecahedronBufferGeometry",l.parameters={radius:t,detail:s},l}return a}(yd),G1=function(e){Li(a,e);function a(t,s){var l=e.call(this)||this;return l.type="DodecahedronGeometry",l.parameters={radius:t,detail:s},l.fromBufferGeometry(new rM(t,s)),l.mergeVertices(),l}return a}(Ss),_x=new pe,bx=new pe,sM=new pe,fm=new zo,aM=function(e){Li(a,e);function a(t,s){var l=e.call(this)||this;l.type="EdgesGeometry",l.parameters={thresholdAngle:s},s=s!==void 0?s:1,t.isGeometry&&(t=new qe().fromGeometry(t));for(var f=Math.pow(10,4),v=Math.cos(nr.DEG2RAD*s),x=t.getIndex(),w=t.getAttribute("position"),E=x?x.count:w.count,P=[0,0,0],R=["a","b","c"],V=new Array(3),H={},q=[],z=0;z<E;z+=3){x?(P[0]=x.getX(z),P[1]=x.getX(z+1),P[2]=x.getX(z+2)):(P[0]=z,P[1]=z+1,P[2]=z+2);var G=fm.a,ie=fm.b,le=fm.c;if(G.fromBufferAttribute(w,P[0]),ie.fromBufferAttribute(w,P[1]),le.fromBufferAttribute(w,P[2]),fm.getNormal(sM),V[0]=Math.round(G.x*f)+","+Math.round(G.y*f)+","+Math.round(G.z*f),V[1]=Math.round(ie.x*f)+","+Math.round(ie.y*f)+","+Math.round(ie.z*f),V[2]=Math.round(le.x*f)+","+Math.round(le.y*f)+","+Math.round(le.z*f),!(V[0]===V[1]||V[1]===V[2]||V[2]===V[0]))for(var ae=0;ae<3;ae++){var J=(ae+1)%3,se=V[ae],ge=V[J],_e=fm[R[ae]],We=fm[R[J]],nt=se+"_"+ge,Me=ge+"_"+se;Me in H&&H[Me]?(sM.dot(H[Me].normal)<=v&&(q.push(_e.x,_e.y,_e.z),q.push(We.x,We.y,We.z)),H[Me]=null):nt in H||(H[nt]={index0:P[ae],index1:P[J],normal:sM.clone()})}}for(var be in H)if(H[be]){var ve=H[be],Ze=ve.index0,Ke=ve.index1;_x.fromBufferAttribute(w,Ze),bx.fromBufferAttribute(w,Ke),q.push(_x.x,_x.y,_x.z),q.push(bx.x,bx.y,bx.z)}return l.setAttribute("position",new L(q,3)),l}return a}(qe),HL={triangulate:function(e,a,t){t=t||2;var s=a&&a.length,l=s?a[0]*t:e.length,f=V1(e,0,l,t,!0),v=[];if(!f||f.next===f.prev)return v;var x,w,E,P,R,V,H;if(s&&(f=qL(e,a,f,t)),e.length>80*t){x=E=e[0],w=P=e[1];for(var q=t;q<l;q+=t)R=e[q],V=e[q+1],R<x&&(x=R),V<w&&(w=V),R>E&&(E=R),V>P&&(P=V);H=Math.max(E-x,P-w),H=H!==0?1/H:0}return Ev(f,v,t,x,w,H),v}};function V1(e,a,t,s,l){var f,v;if(l===iC(e,a,t,s)>0)for(f=a;f<t;f+=s)v=q1(f,e[f],e[f+1],v);else for(f=t-s;f>=a;f-=s)v=q1(f,e[f],e[f+1],v);return v&&wx(v,v.next)&&(Av(v),v=v.next),v}function uf(e,a){if(!e)return e;a||(a=e);var t=e,s;do if(s=!1,!t.steiner&&(wx(t,t.next)||sa(t.prev,t,t.next)===0)){if(Av(t),t=a=t.prev,t===t.next)break;s=!0}else t=t.next;while(s||t!==a);return a}function Ev(e,a,t,s,l,f,v){if(!!e){!v&&f&&$L(e,s,l,f);for(var x=e,w,E;e.prev!==e.next;){if(w=e.prev,E=e.next,f?VL(e,s,l,f):GL(e)){a.push(w.i/t),a.push(e.i/t),a.push(E.i/t),Av(e),e=E.next,x=E.next;continue}if(e=E,e===x){v?v===1?(e=WL(uf(e),a,t),Ev(e,a,t,s,l,f,2)):v===2&&XL(e,a,t,s,l,f):Ev(uf(e),a,t,s,l,f,1);break}}}}function GL(e){var a=e.prev,t=e,s=e.next;if(sa(a,t,s)>=0)return!1;for(var l=e.next.next;l!==e.prev;){if(dm(a.x,a.y,t.x,t.y,s.x,s.y,l.x,l.y)&&sa(l.prev,l,l.next)>=0)return!1;l=l.next}return!0}function VL(e,a,t,s){var l=e.prev,f=e,v=e.next;if(sa(l,f,v)>=0)return!1;for(var x=l.x<f.x?l.x<v.x?l.x:v.x:f.x<v.x?f.x:v.x,w=l.y<f.y?l.y<v.y?l.y:v.y:f.y<v.y?f.y:v.y,E=l.x>f.x?l.x>v.x?l.x:v.x:f.x>v.x?f.x:v.x,P=l.y>f.y?l.y>v.y?l.y:v.y:f.y>v.y?f.y:v.y,R=oM(x,w,a,t,s),V=oM(E,P,a,t,s),H=e.prevZ,q=e.nextZ;H&&H.z>=R&&q&&q.z<=V;){if(H!==e.prev&&H!==e.next&&dm(l.x,l.y,f.x,f.y,v.x,v.y,H.x,H.y)&&sa(H.prev,H,H.next)>=0||(H=H.prevZ,q!==e.prev&&q!==e.next&&dm(l.x,l.y,f.x,f.y,v.x,v.y,q.x,q.y)&&sa(q.prev,q,q.next)>=0))return!1;q=q.nextZ}for(;H&&H.z>=R;){if(H!==e.prev&&H!==e.next&&dm(l.x,l.y,f.x,f.y,v.x,v.y,H.x,H.y)&&sa(H.prev,H,H.next)>=0)return!1;H=H.prevZ}for(;q&&q.z<=V;){if(q!==e.prev&&q!==e.next&&dm(l.x,l.y,f.x,f.y,v.x,v.y,q.x,q.y)&&sa(q.prev,q,q.next)>=0)return!1;q=q.nextZ}return!0}function WL(e,a,t){var s=e;do{var l=s.prev,f=s.next.next;!wx(l,f)&&W1(l,s,s.next,f)&&Tv(l,f)&&Tv(f,l)&&(a.push(l.i/t),a.push(s.i/t),a.push(f.i/t),Av(s),Av(s.next),s=e=f),s=s.next}while(s!==e);return uf(s)}function XL(e,a,t,s,l,f){var v=e;do{for(var x=v.next.next;x!==v.prev;){if(v.i!==x.i&&eC(v,x)){var w=X1(v,x);v=uf(v,v.next),w=uf(w,w.next),Ev(v,a,t,s,l,f),Ev(w,a,t,s,l,f);return}x=x.next}v=v.next}while(v!==e)}function qL(e,a,t,s){var l=[],f,v,x,w,E;for(f=0,v=a.length;f<v;f++)x=a[f]*s,w=f<v-1?a[f+1]*s:e.length,E=V1(e,x,w,s,!1),E===E.next&&(E.steiner=!0),l.push(QL(E));for(l.sort(jL),f=0;f<l.length;f++)YL(l[f],t),t=uf(t,t.next);return t}function jL(e,a){return e.x-a.x}function YL(e,a){if(a=ZL(e,a),a){var t=X1(a,e);uf(a,a.next),uf(t,t.next)}}function ZL(e,a){var t=a,s=e.x,l=e.y,f=-1/0,v;do{if(l<=t.y&&l>=t.next.y&&t.next.y!==t.y){var x=t.x+(l-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(x<=s&&x>f){if(f=x,x===s){if(l===t.y)return t;if(l===t.next.y)return t.next}v=t.x<t.next.x?t:t.next}}t=t.next}while(t!==a);if(!v)return null;if(s===f)return v;var w=v,E=v.x,P=v.y,R=1/0,V;t=v;do s>=t.x&&t.x>=E&&s!==t.x&&dm(l<P?s:f,l,E,P,l<P?f:s,l,t.x,t.y)&&(V=Math.abs(l-t.y)/(s-t.x),Tv(t,e)&&(V<R||V===R&&(t.x>v.x||t.x===v.x&&JL(v,t)))&&(v=t,R=V)),t=t.next;while(t!==w);return v}function JL(e,a){return sa(e.prev,e,a.prev)<0&&sa(a.next,e,e.next)<0}function $L(e,a,t,s){var l=e;do l.z===null&&(l.z=oM(l.x,l.y,a,t,s)),l.prevZ=l.prev,l.nextZ=l.next,l=l.next;while(l!==e);l.prevZ.nextZ=null,l.prevZ=null,KL(l)}function KL(e){var a,t,s,l,f,v,x,w,E=1;do{for(t=e,e=null,f=null,v=0;t;){for(v++,s=t,x=0,a=0;a<E&&(x++,s=s.nextZ,!!s);a++);for(w=E;x>0||w>0&&s;)x!==0&&(w===0||!s||t.z<=s.z)?(l=t,t=t.nextZ,x--):(l=s,s=s.nextZ,w--),f?f.nextZ=l:e=l,l.prevZ=f,f=l;t=s}f.nextZ=null,E*=2}while(v>1);return e}function oM(e,a,t,s,l){return e=32767*(e-t)*l,a=32767*(a-s)*l,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,a=(a|a<<8)&16711935,a=(a|a<<4)&252645135,a=(a|a<<2)&858993459,a=(a|a<<1)&1431655765,e|a<<1}function QL(e){var a=e,t=e;do(a.x<t.x||a.x===t.x&&a.y<t.y)&&(t=a),a=a.next;while(a!==e);return t}function dm(e,a,t,s,l,f,v,x){return(l-v)*(a-x)-(e-v)*(f-x)>=0&&(e-v)*(s-x)-(t-v)*(a-x)>=0&&(t-v)*(f-x)-(l-v)*(s-x)>=0}function eC(e,a){return e.next.i!==a.i&&e.prev.i!==a.i&&!tC(e,a)&&(Tv(e,a)&&Tv(a,e)&&nC(e,a)&&(sa(e.prev,e,a.prev)||sa(e,a.prev,a))||wx(e,a)&&sa(e.prev,e,e.next)>0&&sa(a.prev,a,a.next)>0)}function sa(e,a,t){return(a.y-e.y)*(t.x-a.x)-(a.x-e.x)*(t.y-a.y)}function wx(e,a){return e.x===a.x&&e.y===a.y}function W1(e,a,t,s){var l=Sx(sa(e,a,t)),f=Sx(sa(e,a,s)),v=Sx(sa(t,s,e)),x=Sx(sa(t,s,a));return!!(l!==f&&v!==x||l===0&&Mx(e,t,a)||f===0&&Mx(e,s,a)||v===0&&Mx(t,e,s)||x===0&&Mx(t,a,s))}function Mx(e,a,t){return a.x<=Math.max(e.x,t.x)&&a.x>=Math.min(e.x,t.x)&&a.y<=Math.max(e.y,t.y)&&a.y>=Math.min(e.y,t.y)}function Sx(e){return e>0?1:e<0?-1:0}function tC(e,a){var t=e;do{if(t.i!==e.i&&t.next.i!==e.i&&t.i!==a.i&&t.next.i!==a.i&&W1(t,t.next,e,a))return!0;t=t.next}while(t!==e);return!1}function Tv(e,a){return sa(e.prev,e,e.next)<0?sa(e,a,e.next)>=0&&sa(e,e.prev,a)>=0:sa(e,a,e.prev)<0||sa(e,e.next,a)<0}function nC(e,a){var t=e,s=!1,l=(e.x+a.x)/2,f=(e.y+a.y)/2;do t.y>f!=t.next.y>f&&t.next.y!==t.y&&l<(t.next.x-t.x)*(f-t.y)/(t.next.y-t.y)+t.x&&(s=!s),t=t.next;while(t!==e);return s}function X1(e,a){var t=new lM(e.i,e.x,e.y),s=new lM(a.i,a.x,a.y),l=e.next,f=a.prev;return e.next=a,a.prev=e,t.next=l,l.prev=t,s.next=t,t.prev=s,f.next=s,s.prev=f,s}function q1(e,a,t,s){var l=new lM(e,a,t);return s?(l.next=s.next,l.prev=s,s.next.prev=l,s.next=l):(l.prev=l,l.next=l),l}function Av(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function lM(e,a,t){this.i=e,this.x=a,this.y=t,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function iC(e,a,t,s){for(var l=0,f=a,v=t-s;f<t;f+=s)l+=(e[v]-e[f])*(e[f+1]+e[v+1]),v=f;return l}var Ku={area:function(e){for(var a=e.length,t=0,s=a-1,l=0;l<a;s=l++)t+=e[s].x*e[l].y-e[l].x*e[s].y;return t*.5},isClockWise:function(e){return Ku.area(e)<0},triangulateShape:function(e,a){var t=[],s=[],l=[];j1(e),Y1(t,e);var f=e.length;a.forEach(j1);for(var v=0;v<a.length;v++)s.push(f),f+=a[v].length,Y1(t,a[v]);for(var x=HL.triangulate(t,s),w=0;w<x.length;w+=3)l.push(x.slice(w,w+3));return l}};function j1(e){var a=e.length;a>2&&e[a-1].equals(e[0])&&e.pop()}function Y1(e,a){for(var t=0;t<a.length;t++)e.push(a[t].x),e.push(a[t].y)}var Lv=function(e){Li(a,e);function a(s,l){var f=e.call(this)||this;f.type="ExtrudeBufferGeometry",f.parameters={shapes:s,options:l},s=Array.isArray(s)?s:[s];for(var v=Xh(f),x=[],w=[],E=0,P=s.length;E<P;E++){var R=s[E];V(R)}f.setAttribute("position",new L(x,3)),f.setAttribute("uv",new L(w,2)),f.computeVertexNormals();function V(H){var q=[],z=l.curveSegments!==void 0?l.curveSegments:12,G=l.steps!==void 0?l.steps:1,ie=l.depth!==void 0?l.depth:100,le=l.bevelEnabled!==void 0?l.bevelEnabled:!0,ae=l.bevelThickness!==void 0?l.bevelThickness:6,J=l.bevelSize!==void 0?l.bevelSize:ae-2,se=l.bevelOffset!==void 0?l.bevelOffset:0,ge=l.bevelSegments!==void 0?l.bevelSegments:3,_e=l.extrudePath,We=l.UVGenerator!==void 0?l.UVGenerator:rC;l.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),ie=l.amount);var nt,Me=!1,be,ve,Ze,Ke;_e&&(nt=_e.getSpacedPoints(G),Me=!0,le=!1,be=_e.computeFrenetFrames(G,!1),ve=new pe,Ze=new pe,Ke=new pe),le||(ge=0,ae=0,J=0,se=0);var Qe=H.extractPoints(z),Bt=Qe.shape,fn=Qe.holes,un=!Ku.isClockWise(Bt);if(un){Bt=Bt.reverse();for(var Qt=0,Sn=fn.length;Qt<Sn;Qt++){var ai=fn[Qt];Ku.isClockWise(ai)&&(fn[Qt]=ai.reverse())}}for(var ei=Ku.triangulateShape(Bt,fn),Pi=Bt,Hi=0,on=fn.length;Hi<on;Hi++){var _r=fn[Hi];Bt=Bt.concat(_r)}function pr(Jr,mr,as){return mr||console.error("THREE.ExtrudeGeometry: vec does not exist"),mr.clone().multiplyScalar(as).add(Jr)}var Zi=Bt.length,Xr=ei.length;function Sr(Jr,mr,as){var Fr,qr,Vs,co=Jr.x-mr.x,uo=Jr.y-mr.y,Ao=as.x-Jr.x,fl=as.y-Jr.y,sh=co*co+uo*uo;if(Math.abs(co*fl-uo*Ao)>Number.EPSILON){var jE=Math.sqrt(sh),YE=Math.sqrt(Ao*Ao+fl*fl),ZE=mr.x-uo/jE,JE=mr.y+co/jE,KC=as.x-fl/YE,QC=as.y+Ao/YE,$E=((KC-ZE)*fl-(QC-JE)*Ao)/(co*fl-uo*Ao);Fr=ZE+co*$E-Jr.x,qr=JE+uo*$E-Jr.y;var KE=Fr*Fr+qr*qr;if(KE<=2)return new bn(Fr,qr);Vs=Math.sqrt(KE/2)}else{var s_=!1;co>Number.EPSILON?Ao>Number.EPSILON&&(s_=!0):co<-Number.EPSILON?Ao<-Number.EPSILON&&(s_=!0):Math.sign(uo)===Math.sign(fl)&&(s_=!0),s_?(Fr=-uo,qr=co,Vs=Math.sqrt(sh)):(Fr=co,qr=uo,Vs=Math.sqrt(sh/2))}return new bn(Fr/Vs,qr/Vs)}for(var rs=[],zr=0,As=Pi.length,ze=As-1,re=zr+1;zr<As;zr++,ze++,re++)ze===As&&(ze=0),re===As&&(re=0),rs[zr]=Sr(Pi[zr],Pi[ze],Pi[re]);for(var On=[],Jt,bi=rs.concat(),kn=0,Xi=fn.length;kn<Xi;kn++){var ji=fn[kn];Jt=[];for(var Di=0,Ji=ji.length,$i=Ji-1,Pr=Di+1;Di<Ji;Di++,$i++,Pr++)$i===Ji&&($i=0),Pr===Ji&&(Pr=0),Jt[Di]=Sr(ji[Di],ji[$i],ji[Pr]);On.push(Jt),bi=bi.concat(Jt)}for(var ms=0;ms<ge;ms++){for(var Aa=ms/ge,Es=ae*Math.cos(Aa*Math.PI/2),Vo=J*Math.sin(Aa*Math.PI/2)+se,cs=0,_c=Pi.length;cs<_c;cs++){var Rd=pr(Pi[cs],rs[cs],Vo);Fi(Rd.x,Rd.y,-Es)}for(var bc=0,ih=fn.length;bc<ih;bc++){var Mm=fn[bc];Jt=On[bc];for(var Dd=0,iS=Mm.length;Dd<iS;Dd++){var Sm=pr(Mm[Dd],Jt[Dd],Vo);Fi(Sm.x,Sm.y,-Es)}}}for(var i_=J+se,wc=0;wc<Zi;wc++){var Od=le?pr(Bt[wc],bi[wc],i_):Bt[wc];Me?(Ze.copy(be.normals[0]).multiplyScalar(Od.x),ve.copy(be.binormals[0]).multiplyScalar(Od.y),Ke.copy(nt[0]).add(Ze).add(ve),Fi(Ke.x,Ke.y,Ke.z)):Fi(Od.x,Od.y,0)}for(var rh=1;rh<=G;rh++)for(var gf=0;gf<Zi;gf++){var Wo=le?pr(Bt[gf],bi[gf],i_):Bt[gf];Me?(Ze.copy(be.normals[rh]).multiplyScalar(Wo.x),ve.copy(be.binormals[rh]).multiplyScalar(Wo.y),Ke.copy(nt[rh]).add(Ze).add(ve),Fi(Ke.x,Ke.y,Ke.z)):Fi(Wo.x,Wo.y,ie/G*rh)}for(var Em=ge-1;Em>=0;Em--){for(var r_=Em/ge,Bv=ae*Math.cos(r_*Math.PI/2),Se=J*Math.sin(r_*Math.PI/2)+se,Xt=0,Ot=Pi.length;Xt<Ot;Xt++){var dn=pr(Pi[Xt],rs[Xt],Se);Fi(dn.x,dn.y,ie+Bv)}for(var oi=0,Zr=fn.length;oi<Zr;oi++){var Ur=fn[oi];Jt=On[oi];for(var Qr=0,br=Ur.length;Qr<br;Qr++){var $s=pr(Ur[Qr],Jt[Qr],Se);Me?Fi($s.x,$s.y+nt[G-1].y,nt[G-1].x+Bv):Fi($s.x,$s.y,ie+Bv)}}}Ks(),function(){var Jr=x.length/3,mr=0;va(Pi,mr),mr+=Pi.length;for(var as=0,Fr=fn.length;as<Fr;as++){var qr=fn[as];va(qr,mr),mr+=qr.length}v.addGroup(Jr,x.length/3-Jr,1)}();function Ks(){var Jr=x.length/3;if(le){for(var mr=0,as=Zi*mr,Fr=0;Fr<Xr;Fr++){var qr=ei[Fr];Ua(qr[2]+as,qr[1]+as,qr[0]+as)}mr=G+ge*2,as=Zi*mr;for(var Vs=0;Vs<Xr;Vs++){var co=ei[Vs];Ua(co[0]+as,co[1]+as,co[2]+as)}}else{for(var uo=0;uo<Xr;uo++){var Ao=ei[uo];Ua(Ao[2],Ao[1],Ao[0])}for(var fl=0;fl<Xr;fl++){var sh=ei[fl];Ua(sh[0]+Zi*G,sh[1]+Zi*G,sh[2]+Zi*G)}}v.addGroup(Jr,x.length/3-Jr,0)}function va(Jr,mr){for(var as=Jr.length;--as>=0;){var Fr=as,qr=as-1;qr<0&&(qr=Jr.length-1);for(var Vs=0,co=G+ge*2;Vs<co;Vs++){var uo=Zi*Vs,Ao=Zi*(Vs+1),fl=mr+qr+uo,sh=mr+qr+Ao;Ha(mr+Fr+uo,fl,sh,mr+Fr+Ao)}}}function Fi(Jr,mr,as){q.push(Jr),q.push(mr),q.push(as)}function Ua(Jr,mr,as){ss(Jr),ss(mr),ss(as);var Fr=x.length/3,qr=We.generateTopUV(v,x,Fr-3,Fr-2,Fr-1);La(qr[0]),La(qr[1]),La(qr[2])}function Ha(Jr,mr,as,Fr){ss(Jr),ss(mr),ss(Fr),ss(mr),ss(as),ss(Fr);var qr=x.length/3,Vs=We.generateSideWallUV(v,x,qr-6,qr-3,qr-2,qr-1);La(Vs[0]),La(Vs[1]),La(Vs[3]),La(Vs[1]),La(Vs[2]),La(Vs[3])}function ss(Jr){x.push(q[Jr*3+0]),x.push(q[Jr*3+1]),x.push(q[Jr*3+2])}function La(Jr){w.push(Jr.x),w.push(Jr.y)}}return f}var t=a.prototype;return t.toJSON=function(){var s=qe.prototype.toJSON.call(this),l=this.parameters.shapes,f=this.parameters.options;return sC(l,f,s)},a}(qe),rC={generateTopUV:function(e,a,t,s,l){var f=a[t*3],v=a[t*3+1],x=a[s*3],w=a[s*3+1],E=a[l*3],P=a[l*3+1];return[new bn(f,v),new bn(x,w),new bn(E,P)]},generateSideWallUV:function(e,a,t,s,l,f){var v=a[t*3],x=a[t*3+1],w=a[t*3+2],E=a[s*3],P=a[s*3+1],R=a[s*3+2],V=a[l*3],H=a[l*3+1],q=a[l*3+2],z=a[f*3],G=a[f*3+1],ie=a[f*3+2];return Math.abs(x-P)<.01?[new bn(v,1-w),new bn(E,1-R),new bn(V,1-q),new bn(z,1-ie)]:[new bn(x,1-w),new bn(P,1-R),new bn(H,1-q),new bn(G,1-ie)]}};function sC(e,a,t){if(t.shapes=[],Array.isArray(e))for(var s=0,l=e.length;s<l;s++){var f=e[s];t.shapes.push(f.uuid)}else t.shapes.push(e.uuid);return a.extrudePath!==void 0&&(t.options.extrudePath=a.extrudePath.toJSON()),t}var cM=function(e){Li(a,e);function a(s,l){var f=e.call(this)||this;return f.type="ExtrudeGeometry",f.parameters={shapes:s,options:l},f.fromBufferGeometry(new Lv(s,l)),f.mergeVertices(),f}var t=a.prototype;return t.toJSON=function(){var s=e.prototype.toJSON.call(this),l=this.parameters.shapes,f=this.parameters.options;return aC(l,f,s)},a}(Ss);function aC(e,a,t){if(t.shapes=[],Array.isArray(e))for(var s=0,l=e.length;s<l;s++){var f=e[s];t.shapes.push(f.uuid)}else t.shapes.push(e.uuid);return a.extrudePath!==void 0&&(t.options.extrudePath=a.extrudePath.toJSON()),t}var uM=function(e){Li(a,e);function a(t,s){var l,f=(1+Math.sqrt(5))/2;return l=e.call(this,[-1,f,0,1,f,0,-1,-f,0,1,-f,0,0,-1,f,0,1,f,0,-1,-f,0,1,-f,f,0,-1,f,0,1,-f,0,-1,-f,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,s)||this,l.type="IcosahedronBufferGeometry",l.parameters={radius:t,detail:s},l}return a}(yd),Z1=function(e){Li(a,e);function a(t,s){var l=e.call(this)||this;return l.type="IcosahedronGeometry",l.parameters={radius:t,detail:s},l.fromBufferGeometry(new uM(t,s)),l.mergeVertices(),l}return a}(Ss),hM=function(e){Li(a,e);function a(t,s,l,f){var v=e.call(this)||this;v.type="LatheBufferGeometry",v.parameters={points:t,segments:s,phiStart:l,phiLength:f},s=Math.floor(s)||12,l=l||0,f=f||Math.PI*2,f=nr.clamp(f,0,Math.PI*2);for(var x=[],w=[],E=[],P=1/s,R=new pe,V=new bn,H=0;H<=s;H++)for(var q=l+H*P*f,z=Math.sin(q),G=Math.cos(q),ie=0;ie<=t.length-1;ie++)R.x=t[ie].x*z,R.y=t[ie].y,R.z=t[ie].x*G,w.push(R.x,R.y,R.z),V.x=H/s,V.y=ie/(t.length-1),E.push(V.x,V.y);for(var le=0;le<s;le++)for(var ae=0;ae<t.length-1;ae++){var J=ae+le*t.length,se=J+t.length,ge=J+t.length+1,_e=J+1;x.push(J,se,_e),x.push(se,ge,_e)}if(v.setIndex(x),v.setAttribute("position",new L(w,3)),v.setAttribute("uv",new L(E,2)),v.computeVertexNormals(),f===Math.PI*2)for(var We=v.attributes.normal.array,nt=new pe,Me=new pe,be=new pe,ve=s*t.length*3,Ze=0,Ke=0;Ze<t.length;Ze++,Ke+=3)nt.x=We[Ke+0],nt.y=We[Ke+1],nt.z=We[Ke+2],Me.x=We[ve+Ke+0],Me.y=We[ve+Ke+1],Me.z=We[ve+Ke+2],be.addVectors(nt,Me).normalize(),We[Ke+0]=We[ve+Ke+0]=be.x,We[Ke+1]=We[ve+Ke+1]=be.y,We[Ke+2]=We[ve+Ke+2]=be.z;return v}return a}(qe),J1=function(e){Li(a,e);function a(t,s,l,f){var v=e.call(this)||this;return v.type="LatheGeometry",v.parameters={points:t,segments:s,phiStart:l,phiLength:f},v.fromBufferGeometry(new hM(t,s,l,f)),v.mergeVertices(),v}return a}(Ss),Ex=function(e){Li(a,e);function a(t,s){var l=e.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,s)||this;return l.type="OctahedronBufferGeometry",l.parameters={radius:t,detail:s},l}return a}(yd),$1=function(e){Li(a,e);function a(t,s){var l=e.call(this)||this;return l.type="OctahedronGeometry",l.parameters={radius:t,detail:s},l.fromBufferGeometry(new Ex(t,s)),l.mergeVertices(),l}return a}(Ss);function pm(e,a,t){qe.call(this),this.type="ParametricBufferGeometry",this.parameters={func:e,slices:a,stacks:t};var s=[],l=[],f=[],v=[],x=1e-5,w=new pe,E=new pe,P=new pe,R=new pe,V=new pe;e.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");for(var H=a+1,q=0;q<=t;q++)for(var z=q/t,G=0;G<=a;G++){var ie=G/a;e(ie,z,E),l.push(E.x,E.y,E.z),ie-x>=0?(e(ie-x,z,P),R.subVectors(E,P)):(e(ie+x,z,P),R.subVectors(P,E)),z-x>=0?(e(ie,z-x,P),V.subVectors(E,P)):(e(ie,z+x,P),V.subVectors(P,E)),w.crossVectors(R,V).normalize(),f.push(w.x,w.y,w.z),v.push(ie,z)}for(var le=0;le<t;le++)for(var ae=0;ae<a;ae++){var J=le*H+ae,se=le*H+ae+1,ge=(le+1)*H+ae+1,_e=(le+1)*H+ae;s.push(J,se,_e),s.push(se,ge,_e)}this.setIndex(s),this.setAttribute("position",new L(l,3)),this.setAttribute("normal",new L(f,3)),this.setAttribute("uv",new L(v,2))}pm.prototype=Object.create(qe.prototype),pm.prototype.constructor=pm;function Cv(e,a,t){Ss.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:a,stacks:t},this.fromBufferGeometry(new pm(e,a,t)),this.mergeVertices()}Cv.prototype=Object.create(Ss.prototype),Cv.prototype.constructor=Cv;var K1=function(e){Li(a,e);function a(t,s,l,f){var v=e.call(this)||this;return v.type="PlaneGeometry",v.parameters={width:t,height:s,widthSegments:l,heightSegments:f},v.fromBufferGeometry(new nx(t,s,l,f)),v.mergeVertices(),v}return a}(Ss),Q1=function(e){Li(a,e);function a(t,s,l,f){var v=e.call(this)||this;return v.type="PolyhedronGeometry",v.parameters={vertices:t,indices:s,radius:l,detail:f},v.fromBufferGeometry(new yd(t,s,l,f)),v.mergeVertices(),v}return a}(Ss),fM=function(e){Li(a,e);function a(t,s,l,f,v,x){var w=e.call(this)||this;w.type="RingBufferGeometry",w.parameters={innerRadius:t,outerRadius:s,thetaSegments:l,phiSegments:f,thetaStart:v,thetaLength:x},t=t||.5,s=s||1,v=v!==void 0?v:0,x=x!==void 0?x:Math.PI*2,l=l!==void 0?Math.max(3,l):8,f=f!==void 0?Math.max(1,f):1;for(var E=[],P=[],R=[],V=[],H=t,q=(s-t)/f,z=new pe,G=new bn,ie=0;ie<=f;ie++){for(var le=0;le<=l;le++){var ae=v+le/l*x;z.x=H*Math.cos(ae),z.y=H*Math.sin(ae),P.push(z.x,z.y,z.z),R.push(0,0,1),G.x=(z.x/s+1)/2,G.y=(z.y/s+1)/2,V.push(G.x,G.y)}H+=q}for(var J=0;J<f;J++)for(var se=J*(l+1),ge=0;ge<l;ge++){var _e=ge+se,We=_e+l+1,nt=_e+l+2,Me=_e+1;E.push(_e,We,Me),E.push(We,nt,Me)}return w.setIndex(E),w.setAttribute("position",new L(P,3)),w.setAttribute("normal",new L(R,3)),w.setAttribute("uv",new L(V,2)),w}return a}(qe),eE=function(e){Li(a,e);function a(t,s,l,f,v,x){var w=e.call(this)||this;return w.type="RingGeometry",w.parameters={innerRadius:t,outerRadius:s,thetaSegments:l,phiSegments:f,thetaStart:v,thetaLength:x},w.fromBufferGeometry(new fM(t,s,l,f,v,x)),w.mergeVertices(),w}return a}(Ss),dM=function(e){Li(a,e);function a(s,l){var f=e.call(this)||this;f.type="ShapeBufferGeometry",f.parameters={shapes:s,curveSegments:l},l=l||12;var v=[],x=[],w=[],E=[],P=0,R=0;if(Array.isArray(s)===!1)H(s);else for(var V=0;V<s.length;V++)H(s[V]),f.addGroup(P,R,V),P+=R,R=0;f.setIndex(v),f.setAttribute("position",new L(x,3)),f.setAttribute("normal",new L(w,3)),f.setAttribute("uv",new L(E,2));function H(q){var z=x.length/3,G=q.extractPoints(l),ie=G.shape,le=G.holes;Ku.isClockWise(ie)===!1&&(ie=ie.reverse());for(var ae=0,J=le.length;ae<J;ae++){var se=le[ae];Ku.isClockWise(se)===!0&&(le[ae]=se.reverse())}for(var ge=Ku.triangulateShape(ie,le),_e=0,We=le.length;_e<We;_e++){var nt=le[_e];ie=ie.concat(nt)}for(var Me=0,be=ie.length;Me<be;Me++){var ve=ie[Me];x.push(ve.x,ve.y,0),w.push(0,0,1),E.push(ve.x,ve.y)}for(var Ze=0,Ke=ge.length;Ze<Ke;Ze++){var Qe=ge[Ze],Bt=Qe[0]+z,fn=Qe[1]+z,un=Qe[2]+z;v.push(Bt,fn,un),R+=3}}return f}var t=a.prototype;return t.toJSON=function(){var s=qe.prototype.toJSON.call(this),l=this.parameters.shapes;return oC(l,s)},a}(qe);function oC(e,a){if(a.shapes=[],Array.isArray(e))for(var t=0,s=e.length;t<s;t++){var l=e[t];a.shapes.push(l.uuid)}else a.shapes.push(e.uuid);return a}var pM=function(e){Li(a,e);function a(s,l){var f=e.call(this)||this;return f.type="ShapeGeometry",typeof l=="object"&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),l=l.curveSegments),f.parameters={shapes:s,curveSegments:l},f.fromBufferGeometry(new dM(s,l)),f.mergeVertices(),f}var t=a.prototype;return t.toJSON=function(){var s=Ss.prototype.toJSON.call(this),l=this.parameters.shapes;return lC(l,s)},a}(Ss);function lC(e,a){if(a.shapes=[],Array.isArray(e))for(var t=0,s=e.length;t<s;t++){var l=e[t];a.shapes.push(l.uuid)}else a.shapes.push(e.uuid);return a}var Tx=function(e){Li(a,e);function a(t,s,l,f,v,x,w){var E=e.call(this)||this;E.type="SphereBufferGeometry",E.parameters={radius:t,widthSegments:s,heightSegments:l,phiStart:f,phiLength:v,thetaStart:x,thetaLength:w},t=t||1,s=Math.max(3,Math.floor(s)||8),l=Math.max(2,Math.floor(l)||6),f=f!==void 0?f:0,v=v!==void 0?v:Math.PI*2,x=x!==void 0?x:0,w=w!==void 0?w:Math.PI;for(var P=Math.min(x+w,Math.PI),R=0,V=[],H=new pe,q=new pe,z=[],G=[],ie=[],le=[],ae=0;ae<=l;ae++){var J=[],se=ae/l,ge=0;ae==0&&x==0?ge=.5/s:ae==l&&P==Math.PI&&(ge=-.5/s);for(var _e=0;_e<=s;_e++){var We=_e/s;H.x=-t*Math.cos(f+We*v)*Math.sin(x+se*w),H.y=t*Math.cos(x+se*w),H.z=t*Math.sin(f+We*v)*Math.sin(x+se*w),G.push(H.x,H.y,H.z),q.copy(H).normalize(),ie.push(q.x,q.y,q.z),le.push(We+ge,1-se),J.push(R++)}V.push(J)}for(var nt=0;nt<l;nt++)for(var Me=0;Me<s;Me++){var be=V[nt][Me+1],ve=V[nt][Me],Ze=V[nt+1][Me],Ke=V[nt+1][Me+1];(nt!==0||x>0)&&z.push(be,ve,Ke),(nt!==l-1||P<Math.PI)&&z.push(ve,Ze,Ke)}return E.setIndex(z),E.setAttribute("position",new L(G,3)),E.setAttribute("normal",new L(ie,3)),E.setAttribute("uv",new L(le,2)),E}return a}(qe),tE=function(e){Li(a,e);function a(t,s,l,f,v,x,w){var E=e.call(this)||this;return E.type="SphereGeometry",E.parameters={radius:t,widthSegments:s,heightSegments:l,phiStart:f,phiLength:v,thetaStart:x,thetaLength:w},E.fromBufferGeometry(new Tx(t,s,l,f,v,x,w)),E.mergeVertices(),E}return a}(Ss),mM=function(e){Li(a,e);function a(t,s){var l=e.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,s)||this;return l.type="TetrahedronBufferGeometry",l.parameters={radius:t,detail:s},l}return a}(yd),nE=function(e){Li(a,e);function a(t,s){var l=e.call(this)||this;return l.type="TetrahedronGeometry",l.parameters={radius:t,detail:s},l.fromBufferGeometry(new mM(t,s)),l.mergeVertices(),l}return a}(Ss),gM=function(e){Li(a,e);function a(t,s){var l;s=s||{};var f=s.font;if(!(f&&f.isFont))return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new qe||Xh(l);var v=f.generateShapes(t,s.size);return s.depth=s.height!==void 0?s.height:50,s.bevelThickness===void 0&&(s.bevelThickness=10),s.bevelSize===void 0&&(s.bevelSize=8),s.bevelEnabled===void 0&&(s.bevelEnabled=!1),l=e.call(this,v,s)||this,l.type="TextBufferGeometry",l}return a}(Lv),iE=function(e){Li(a,e);function a(t,s){var l=e.call(this)||this;return l.type="TextGeometry",l.parameters={text:t,parameters:s},l.fromBufferGeometry(new gM(t,s)),l.mergeVertices(),l}return a}(Ss),vM=function(e){Li(a,e);function a(t,s,l,f,v){var x=e.call(this)||this;x.type="TorusBufferGeometry",x.parameters={radius:t,tube:s,radialSegments:l,tubularSegments:f,arc:v},t=t||1,s=s||.4,l=Math.floor(l)||8,f=Math.floor(f)||6,v=v||Math.PI*2;for(var w=[],E=[],P=[],R=[],V=new pe,H=new pe,q=new pe,z=0;z<=l;z++)for(var G=0;G<=f;G++){var ie=G/f*v,le=z/l*Math.PI*2;H.x=(t+s*Math.cos(le))*Math.cos(ie),H.y=(t+s*Math.cos(le))*Math.sin(ie),H.z=s*Math.sin(le),E.push(H.x,H.y,H.z),V.x=t*Math.cos(ie),V.y=t*Math.sin(ie),q.subVectors(H,V).normalize(),P.push(q.x,q.y,q.z),R.push(G/f),R.push(z/l)}for(var ae=1;ae<=l;ae++)for(var J=1;J<=f;J++){var se=(f+1)*ae+J-1,ge=(f+1)*(ae-1)+J-1,_e=(f+1)*(ae-1)+J,We=(f+1)*ae+J;w.push(se,ge,We),w.push(ge,_e,We)}return x.setIndex(w),x.setAttribute("position",new L(E,3)),x.setAttribute("normal",new L(P,3)),x.setAttribute("uv",new L(R,2)),x}return a}(qe),rE=function(e){Li(a,e);function a(t,s,l,f,v){var x=e.call(this)||this;return x.type="TorusGeometry",x.parameters={radius:t,tube:s,radialSegments:l,tubularSegments:f,arc:v},x.fromBufferGeometry(new vM(t,s,l,f,v)),x.mergeVertices(),x}return a}(Ss),yM=function(e){Li(a,e);function a(t,s,l,f,v,x){var w=e.call(this)||this;w.type="TorusKnotBufferGeometry",w.parameters={radius:t,tube:s,tubularSegments:l,radialSegments:f,p:v,q:x},t=t||1,s=s||.4,l=Math.floor(l)||64,f=Math.floor(f)||8,v=v||2,x=x||3;for(var E=[],P=[],R=[],V=[],H=new pe,q=new pe,z=new pe,G=new pe,ie=new pe,le=new pe,ae=new pe,J=0;J<=l;++J){var se=J/l*v*Math.PI*2;Bt(se,v,x,t,z),Bt(se+.01,v,x,t,G),le.subVectors(G,z),ae.addVectors(G,z),ie.crossVectors(le,ae),ae.crossVectors(ie,le),ie.normalize(),ae.normalize();for(var ge=0;ge<=f;++ge){var _e=ge/f*Math.PI*2,We=-s*Math.cos(_e),nt=s*Math.sin(_e);H.x=z.x+(We*ae.x+nt*ie.x),H.y=z.y+(We*ae.y+nt*ie.y),H.z=z.z+(We*ae.z+nt*ie.z),P.push(H.x,H.y,H.z),q.subVectors(H,z).normalize(),R.push(q.x,q.y,q.z),V.push(J/l),V.push(ge/f)}}for(var Me=1;Me<=l;Me++)for(var be=1;be<=f;be++){var ve=(f+1)*(Me-1)+(be-1),Ze=(f+1)*Me+(be-1),Ke=(f+1)*Me+be,Qe=(f+1)*(Me-1)+be;E.push(ve,Ze,Qe),E.push(Ze,Ke,Qe)}w.setIndex(E),w.setAttribute("position",new L(P,3)),w.setAttribute("normal",new L(R,3)),w.setAttribute("uv",new L(V,2));function Bt(fn,un,Qt,Sn,ai){var ei=Math.cos(fn),Pi=Math.sin(fn),Hi=Qt/un*fn,on=Math.cos(Hi);ai.x=Sn*(2+on)*.5*ei,ai.y=Sn*(2+on)*Pi*.5,ai.z=Sn*Math.sin(Hi)*.5}return w}return a}(qe),sE=function(e){Li(a,e);function a(t,s,l,f,v,x,w){var E=e.call(this)||this;return E.type="TorusKnotGeometry",E.parameters={radius:t,tube:s,tubularSegments:l,radialSegments:f,p:v,q:x},w!==void 0&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),E.fromBufferGeometry(new yM(t,s,l,f,v,x)),E.mergeVertices(),E}return a}(Ss),xM=function(e){Li(a,e);function a(s,l,f,v,x){var w=e.call(this)||this;w.type="TubeBufferGeometry",w.parameters={path:s,tubularSegments:l,radius:f,radialSegments:v,closed:x},l=l||64,f=f||1,v=v||8,x=x||!1;var E=s.computeFrenetFrames(l,x);w.tangents=E.tangents,w.normals=E.normals,w.binormals=E.binormals;var P=new pe,R=new pe,V=new bn,H=new pe,q=[],z=[],G=[],ie=[];le(),w.setIndex(ie),w.setAttribute("position",new L(q,3)),w.setAttribute("normal",new L(z,3)),w.setAttribute("uv",new L(G,2));function le(){for(var ge=0;ge<l;ge++)ae(ge);ae(x===!1?l:0),se(),J()}function ae(ge){H=s.getPointAt(ge/l,H);for(var _e=E.normals[ge],We=E.binormals[ge],nt=0;nt<=v;nt++){var Me=nt/v*Math.PI*2,be=Math.sin(Me),ve=-Math.cos(Me);R.x=ve*_e.x+be*We.x,R.y=ve*_e.y+be*We.y,R.z=ve*_e.z+be*We.z,R.normalize(),z.push(R.x,R.y,R.z),P.x=H.x+f*R.x,P.y=H.y+f*R.y,P.z=H.z+f*R.z,q.push(P.x,P.y,P.z)}}function J(){for(var ge=1;ge<=l;ge++)for(var _e=1;_e<=v;_e++){var We=(v+1)*(ge-1)+(_e-1),nt=(v+1)*ge+(_e-1),Me=(v+1)*ge+_e,be=(v+1)*(ge-1)+_e;ie.push(We,nt,be),ie.push(nt,Me,be)}}function se(){for(var ge=0;ge<=l;ge++)for(var _e=0;_e<=v;_e++)V.x=ge/l,V.y=_e/v,G.push(V.x,V.y)}return w}var t=a.prototype;return t.toJSON=function(){var s=qe.prototype.toJSON.call(this);return s.path=this.parameters.path.toJSON(),s},a}(qe),aE=function(e){Li(a,e);function a(t,s,l,f,v,x){var w=e.call(this)||this;w.type="TubeGeometry",w.parameters={path:t,tubularSegments:s,radius:l,radialSegments:f,closed:v},x!==void 0&&console.warn("THREE.TubeGeometry: taper has been removed.");var E=new xM(t,s,l,f,v);return w.tangents=E.tangents,w.normals=E.normals,w.binormals=E.binormals,w.fromBufferGeometry(E),w.mergeVertices(),w}return a}(Ss),_M=function(e){Li(a,e);function a(t){var s=e.call(this)||this;s.type="WireframeGeometry";var l=[],f=[0,0],v={},x=["a","b","c"];if(t&&t.isGeometry){for(var w=t.faces,E=0,P=w.length;E<P;E++)for(var R=w[E],V=0;V<3;V++){var H=R[x[V]],q=R[x[(V+1)%3]];f[0]=Math.min(H,q),f[1]=Math.max(H,q);var z=f[0]+","+f[1];v[z]===void 0&&(v[z]={index1:f[0],index2:f[1]})}for(var G in v){var ie=v[G],le=t.vertices[ie.index1];l.push(le.x,le.y,le.z),le=t.vertices[ie.index2],l.push(le.x,le.y,le.z)}}else if(t&&t.isBufferGeometry){var ae=new pe;if(t.index!==null){var J=t.attributes.position,se=t.index,ge=t.groups;ge.length===0&&(ge=[{start:0,count:se.count,materialIndex:0}]);for(var _e=0,We=ge.length;_e<We;++_e)for(var nt=ge[_e],Me=nt.start,be=nt.count,ve=Me;ve<Me+be;ve+=3)for(var Ze=0;Ze<3;Ze++){var Ke=se.getX(ve+Ze),Qe=se.getX(ve+(Ze+1)%3);f[0]=Math.min(Ke,Qe),f[1]=Math.max(Ke,Qe);var Bt=f[0]+","+f[1];v[Bt]===void 0&&(v[Bt]={index1:f[0],index2:f[1]})}for(var fn in v){var un=v[fn];ae.fromBufferAttribute(J,un.index1),l.push(ae.x,ae.y,ae.z),ae.fromBufferAttribute(J,un.index2),l.push(ae.x,ae.y,ae.z)}}else for(var Qt=t.attributes.position,Sn=0,ai=Qt.count/3;Sn<ai;Sn++)for(var ei=0;ei<3;ei++){var Pi=3*Sn+ei;ae.fromBufferAttribute(Qt,Pi),l.push(ae.x,ae.y,ae.z);var Hi=3*Sn+(ei+1)%3;ae.fromBufferAttribute(Qt,Hi),l.push(ae.x,ae.y,ae.z)}}return s.setAttribute("position",new L(l,3)),s}return a}(qe),To=Object.freeze({__proto__:null,BoxGeometry:tM,BoxBufferGeometry:ol,CircleGeometry:z1,CircleBufferGeometry:nM,ConeGeometry:U1,ConeBufferGeometry:H1,CylinderGeometry:iM,CylinderBufferGeometry:Sv,DodecahedronGeometry:G1,DodecahedronBufferGeometry:rM,EdgesGeometry:aM,ExtrudeGeometry:cM,ExtrudeBufferGeometry:Lv,IcosahedronGeometry:Z1,IcosahedronBufferGeometry:uM,LatheGeometry:J1,LatheBufferGeometry:hM,OctahedronGeometry:$1,OctahedronBufferGeometry:Ex,ParametricGeometry:Cv,ParametricBufferGeometry:pm,PlaneGeometry:K1,PlaneBufferGeometry:nx,PolyhedronGeometry:Q1,PolyhedronBufferGeometry:yd,RingGeometry:eE,RingBufferGeometry:fM,ShapeGeometry:pM,ShapeBufferGeometry:dM,SphereGeometry:tE,SphereBufferGeometry:Tx,TetrahedronGeometry:nE,TetrahedronBufferGeometry:mM,TextGeometry:iE,TextBufferGeometry:gM,TorusGeometry:rE,TorusBufferGeometry:vM,TorusKnotGeometry:sE,TorusKnotBufferGeometry:yM,TubeGeometry:aE,TubeBufferGeometry:xM,WireframeGeometry:_M});function xd(e){zi.call(this),this.type="ShadowMaterial",this.color=new mi(0),this.transparent=!0,this.setValues(e)}xd.prototype=Object.create(zi.prototype),xd.prototype.constructor=xd,xd.prototype.isShadowMaterial=!0,xd.prototype.copy=function(e){return zi.prototype.copy.call(this,e),this.color.copy(e.color),this};function Qu(e){za.call(this,e),this.type="RawShaderMaterial"}Qu.prototype=Object.create(za.prototype),Qu.prototype.constructor=Qu,Qu.prototype.isRawShaderMaterial=!0;function au(e){zi.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new mi(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new mi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Hu,this.normalScale=new bn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.vertexTangents=!1,this.setValues(e)}au.prototype=Object.create(zi.prototype),au.prototype.constructor=au,au.prototype.isMeshStandardMaterial=!0,au.prototype.copy=function(e){return zi.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.vertexTangents=e.vertexTangents,this};function hf(e){au.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new bn(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,Object.defineProperty(this,"ior",{get:function(){return(1+.4*this.reflectivity)/(1-.4*this.reflectivity)},set:function(a){this.reflectivity=nr.clamp(2.5*(a-1)/(a+1),0,1)}}),this.sheen=null,this.transmission=0,this.transmissionMap=null,this.setValues(e)}hf.prototype=Object.create(au.prototype),hf.prototype.constructor=hf,hf.prototype.isMeshPhysicalMaterial=!0,hf.prototype.copy=function(e){return au.prototype.copy.call(this,e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.reflectivity=e.reflectivity,e.sheen?this.sheen=(this.sheen||new mi).copy(e.sheen):this.sheen=null,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this};function ff(e){zi.call(this),this.type="MeshPhongMaterial",this.color=new mi(16777215),this.specular=new mi(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new mi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Hu,this.normalScale=new bn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Le,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}ff.prototype=Object.create(zi.prototype),ff.prototype.constructor=ff,ff.prototype.isMeshPhongMaterial=!0,ff.prototype.copy=function(e){return zi.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this};function _d(e){zi.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new mi(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new mi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Hu,this.normalScale=new bn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}_d.prototype=Object.create(zi.prototype),_d.prototype.constructor=_d,_d.prototype.isMeshToonMaterial=!0,_d.prototype.copy=function(e){return zi.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this};function bd(e){zi.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Hu,this.normalScale=new bn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}bd.prototype=Object.create(zi.prototype),bd.prototype.constructor=bd,bd.prototype.isMeshNormalMaterial=!0,bd.prototype.copy=function(e){return zi.prototype.copy.call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this};function wd(e){zi.call(this),this.type="MeshLambertMaterial",this.color=new mi(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new mi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Le,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}wd.prototype=Object.create(zi.prototype),wd.prototype.constructor=wd,wd.prototype.isMeshLambertMaterial=!0,wd.prototype.copy=function(e){return zi.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this};function Md(e){zi.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new mi(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Hu,this.normalScale=new bn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}Md.prototype=Object.create(zi.prototype),Md.prototype.constructor=Md,Md.prototype.isMeshMatcapMaterial=!0,Md.prototype.copy=function(e){return zi.prototype.copy.call(this,e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this};function Sd(e){Js.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}Sd.prototype=Object.create(Js.prototype),Sd.prototype.constructor=Sd,Sd.prototype.isLineDashedMaterial=!0,Sd.prototype.copy=function(e){return Js.prototype.copy.call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this};var cC=Object.freeze({__proto__:null,ShadowMaterial:xd,SpriteMaterial:cf,RawShaderMaterial:Qu,ShaderMaterial:za,PointsMaterial:dc,MeshPhysicalMaterial:hf,MeshStandardMaterial:au,MeshPhongMaterial:ff,MeshToonMaterial:_d,MeshNormalMaterial:bd,MeshLambertMaterial:wd,MeshDepthMaterial:sf,MeshDistanceMaterial:af,MeshBasicMaterial:Sa,MeshMatcapMaterial:Md,LineDashedMaterial:Sd,LineBasicMaterial:Js,Material:zi}),Gs={arraySlice:function(e,a,t){return Gs.isTypedArray(e)?new e.constructor(e.subarray(a,t!==void 0?t:e.length)):e.slice(a,t)},convertArray:function(e,a,t){return!e||!t&&e.constructor===a?e:typeof a.BYTES_PER_ELEMENT=="number"?new a(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){function a(f,v){return e[f]-e[v]}for(var t=e.length,s=new Array(t),l=0;l!==t;++l)s[l]=l;return s.sort(a),s},sortedArray:function(e,a,t){for(var s=e.length,l=new e.constructor(s),f=0,v=0;v!==s;++f)for(var x=t[f]*a,w=0;w!==a;++w)l[v++]=e[x+w];return l},flattenJSON:function(e,a,t,s){for(var l=1,f=e[0];f!==void 0&&f[s]===void 0;)f=e[l++];if(f!==void 0){var v=f[s];if(v!==void 0)if(Array.isArray(v))do v=f[s],v!==void 0&&(a.push(f.time),t.push.apply(t,v)),f=e[l++];while(f!==void 0);else if(v.toArray!==void 0)do v=f[s],v!==void 0&&(a.push(f.time),v.toArray(t,t.length)),f=e[l++];while(f!==void 0);else do v=f[s],v!==void 0&&(a.push(f.time),t.push(v)),f=e[l++];while(f!==void 0)}},subclip:function(e,a,t,s,l){l=l||30;var f=e.clone();f.name=a;for(var v=[],x=0;x<f.tracks.length;++x){for(var w=f.tracks[x],E=w.getValueSize(),P=[],R=[],V=0;V<w.times.length;++V){var H=w.times[V]*l;if(!(H<t||H>=s)){P.push(w.times[V]);for(var q=0;q<E;++q)R.push(w.values[V*E+q])}}P.length!==0&&(w.times=Gs.convertArray(P,w.times.constructor),w.values=Gs.convertArray(R,w.values.constructor),v.push(w))}f.tracks=v;for(var z=1/0,G=0;G<f.tracks.length;++G)z>f.tracks[G].times[0]&&(z=f.tracks[G].times[0]);for(var ie=0;ie<f.tracks.length;++ie)f.tracks[ie].shift(-1*z);return f.resetDuration(),f},makeClipAdditive:function(e,a,t,s){a===void 0&&(a=0),t===void 0&&(t=e),(s===void 0||s<=0)&&(s=30);for(var l=t.tracks.length,f=a/s,v=function(E){var P=t.tracks[E],R=P.ValueTypeName;if(R==="bool"||R==="string")return"continue";var V=e.tracks.find(function(Bt){return Bt.name===P.name&&Bt.ValueTypeName===R});if(V===void 0)return"continue";var H=0,q=P.getValueSize();P.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(H=q/3);var z=0,G=V.getValueSize();V.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(z=G/3);var ie=P.times.length-1,le=void 0;if(f<=P.times[0]){var ae=H,J=q-H;le=Gs.arraySlice(P.values,ae,J)}else if(f>=P.times[ie]){var se=ie*q+H,ge=se+q-H;le=Gs.arraySlice(P.values,se,ge)}else{var _e=P.createInterpolant(),We=H,nt=q-H;_e.evaluate(f),le=Gs.arraySlice(_e.resultBuffer,We,nt)}if(R==="quaternion"){var Me=new ka().fromArray(le).normalize().conjugate();Me.toArray(le)}for(var be=V.times.length,ve=0;ve<be;++ve){var Ze=ve*G+z;if(R==="quaternion")ka.multiplyQuaternionsFlat(V.values,Ze,le,0,V.values,Ze);else for(var Ke=G-z*2,Qe=0;Qe<Ke;++Qe)V.values[Ze+Qe]-=le[Qe]}},x=0;x<l;++x)var w=v(x);return e.blendMode=ac,e}};function ul(e,a,t,s){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=s!==void 0?s:new a.constructor(t),this.sampleValues=a,this.valueSize=t}Object.assign(ul.prototype,{evaluate:function(e){var a=this.parameterPositions,t=this._cachedIndex,s=a[t],l=a[t-1];e:{t:{var f;n:{i:if(!(e<s)){for(var v=t+2;;){if(s===void 0){if(e<l)break i;return t=a.length,this._cachedIndex=t,this.afterEnd_(t-1,e,l)}if(t===v)break;if(l=s,s=a[++t],e<s)break t}f=a.length;break n}if(!(e>=l)){var x=a[1];e<x&&(t=2,l=x);for(var w=t-2;;){if(l===void 0)return this._cachedIndex=0,this.beforeStart_(0,e,s);if(t===w)break;if(s=l,l=a[--t-1],e>=l)break t}f=t,t=0;break n}break e}for(;t<f;){var E=t+f>>>1;e<a[E]?f=E:t=E+1}if(s=a[t],l=a[t-1],l===void 0)return this._cachedIndex=0,this.beforeStart_(0,e,s);if(s===void 0)return t=a.length,this._cachedIndex=t,this.afterEnd_(t-1,l,e)}this._cachedIndex=t,this.intervalChanged_(t,l,s)}return this.interpolate_(t,l,e,s)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){for(var a=this.resultBuffer,t=this.sampleValues,s=this.valueSize,l=0;l!==s;++l)a[l]=t[e*s+l];return a},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(ul.prototype,{beforeStart_:ul.prototype.copySampleValue_,afterEnd_:ul.prototype.copySampleValue_});function Ax(e,a,t,s){ul.call(this,e,a,t,s),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}Ax.prototype=Object.assign(Object.create(ul.prototype),{constructor:Ax,DefaultSettings_:{endingStart:zu,endingEnd:zu},intervalChanged_:function(e,a,t){var s=this.parameterPositions,l=e-2,f=e+1,v=s[l],x=s[f];if(v===void 0)switch(this.getSettings_().endingStart){case qc:l=e,v=2*a-t;break;case Vh:l=s.length-2,v=a+s[l]-s[l+1];break;default:l=e,v=t}if(x===void 0)switch(this.getSettings_().endingEnd){case qc:f=e,x=2*t-a;break;case Vh:f=1,x=t+s[1]-s[0];break;default:f=e-1,x=a}var w=(t-a)*.5,E=this.valueSize;this._weightPrev=w/(a-v),this._weightNext=w/(x-t),this._offsetPrev=l*E,this._offsetNext=f*E},interpolate_:function(e,a,t,s){for(var l=this.resultBuffer,f=this.sampleValues,v=this.valueSize,x=e*v,w=this._offsetPrev,E=this._offsetNext,P=this._weightPrev,R=this._weightNext,V=(t-a)/(s-a),H=V*V,q=H*V,z=0;z!==v;++z)l[z]=(-P*q+2*P*H-P*V)*f[w+z]+((1+P)*q+(-1.5-2*P)*H+(-.5+P)*V+1)*f[x-v+z]+((-1-R)*q+(1.5+R)*H+.5*V)*f[x+z]+(R*q-R*H)*f[E+z];return l}});function Pv(e,a,t,s){ul.call(this,e,a,t,s)}Pv.prototype=Object.assign(Object.create(ul.prototype),{constructor:Pv,interpolate_:function(e,a,t,s){for(var l=this.resultBuffer,f=this.sampleValues,v=this.valueSize,x=e*v,w=(t-a)/(s-a),E=0;E!==v;++E)l[E]=f[x-v+E]*(1-w)+f[x+E]*w;return l}});function Lx(e,a,t,s){ul.call(this,e,a,t,s)}Lx.prototype=Object.assign(Object.create(ul.prototype),{constructor:Lx,interpolate_:function(e){return this.copySampleValue_(e-1)}});function Za(e,a,t,s){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(a===void 0||a.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Gs.convertArray(a,this.TimeBufferType),this.values=Gs.convertArray(t,this.ValueBufferType),this.setInterpolation(s||this.DefaultInterpolation)}Object.assign(Za,{toJSON:function(e){var a=e.constructor,t;if(a.toJSON!==void 0)t=a.toJSON(e);else{t={name:e.name,times:Gs.convertArray(e.times,Array),values:Gs.convertArray(e.values,Array)};var s=e.getInterpolation();s!==e.DefaultInterpolation&&(t.interpolation=s)}return t.type=e.ValueTypeName,t}}),Object.assign(Za.prototype,{constructor:Za,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:id,InterpolantFactoryMethodDiscrete:function(e){return new Lx(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new Pv(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new Ax(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){var a;switch(e){case nd:a=this.InterpolantFactoryMethodDiscrete;break;case id:a=this.InterpolantFactoryMethodLinear;break;case Vp:a=this.InterpolantFactoryMethodSmooth;break}if(a===void 0){var t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(t);return console.warn("THREE.KeyframeTrack:",t),this}return this.createInterpolant=a,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return nd;case this.InterpolantFactoryMethodLinear:return id;case this.InterpolantFactoryMethodSmooth:return Vp}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(e!==0)for(var a=this.times,t=0,s=a.length;t!==s;++t)a[t]+=e;return this},scale:function(e){if(e!==1)for(var a=this.times,t=0,s=a.length;t!==s;++t)a[t]*=e;return this},trim:function(e,a){for(var t=this.times,s=t.length,l=0,f=s-1;l!==s&&t[l]<e;)++l;for(;f!==-1&&t[f]>a;)--f;if(++f,l!==0||f!==s){l>=f&&(f=Math.max(f,1),l=f-1);var v=this.getValueSize();this.times=Gs.arraySlice(t,l,f),this.values=Gs.arraySlice(this.values,l*v,f*v)}return this},validate:function(){var e=!0,a=this.getValueSize();a-Math.floor(a)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);var t=this.times,s=this.values,l=t.length;l===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);for(var f=null,v=0;v!==l;v++){var x=t[v];if(typeof x=="number"&&isNaN(x)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,v,x),e=!1;break}if(f!==null&&f>x){console.error("THREE.KeyframeTrack: Out of order keys.",this,v,x,f),e=!1;break}f=x}if(s!==void 0&&Gs.isTypedArray(s))for(var w=0,E=s.length;w!==E;++w){var P=s[w];if(isNaN(P)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,w,P),e=!1;break}}return e},optimize:function(){for(var e=Gs.arraySlice(this.times),a=Gs.arraySlice(this.values),t=this.getValueSize(),s=this.getInterpolation()===Vp,l=e.length-1,f=1,v=1;v<l;++v){var x=!1,w=e[v],E=e[v+1];if(w!==E&&(v!==1||w!==w[0]))if(s)x=!0;else for(var P=v*t,R=0;R!==t;++R){var V=a[P+R];if(V!==a[P-t+R]||V!==a[P+t+R]){x=!0;break}}if(x){if(v!==f){e[f]=e[v];for(var H=v*t,q=f*t,z=0;z!==t;++z)a[q+z]=a[H+z]}++f}}if(l>0){e[f]=e[l];for(var G=f*t,ie=0;ie!==t;++ie)a[G+ie]=a[l*t+ie];++f}return f!==e.length?(this.times=Gs.arraySlice(e,0,f),this.values=Gs.arraySlice(a,0,f*t)):(this.times=e,this.values=a),this},clone:function(){var e=Gs.arraySlice(this.times,0),a=Gs.arraySlice(this.values,0),t=this.constructor,s=new t(this.name,e,a);return s.createInterpolant=this.createInterpolant,s}});function Cx(e,a,t){Za.call(this,e,a,t)}Cx.prototype=Object.assign(Object.create(Za.prototype),{constructor:Cx,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:nd,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});function Px(e,a,t,s){Za.call(this,e,a,t,s)}Px.prototype=Object.assign(Object.create(Za.prototype),{constructor:Px,ValueTypeName:"color"});function mm(e,a,t,s){Za.call(this,e,a,t,s)}mm.prototype=Object.assign(Object.create(Za.prototype),{constructor:mm,ValueTypeName:"number"});function Rx(e,a,t,s){ul.call(this,e,a,t,s)}Rx.prototype=Object.assign(Object.create(ul.prototype),{constructor:Rx,interpolate_:function(e,a,t,s){for(var l=this.resultBuffer,f=this.sampleValues,v=this.valueSize,x=e*v,w=x+v;x!==w;x+=4)ka.slerpFlat(l,0,f,x-v,f,x,(t-a)/(s-a));return l}});function Rv(e,a,t,s){Za.call(this,e,a,t,s)}Rv.prototype=Object.assign(Object.create(Za.prototype),{constructor:Rv,ValueTypeName:"quaternion",DefaultInterpolation:id,InterpolantFactoryMethodLinear:function(e){return new Rx(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0});function Dx(e,a,t,s){Za.call(this,e,a,t,s)}Dx.prototype=Object.assign(Object.create(Za.prototype),{constructor:Dx,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:nd,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});function gm(e,a,t,s){Za.call(this,e,a,t,s)}gm.prototype=Object.assign(Object.create(Za.prototype),{constructor:gm,ValueTypeName:"vector"});function Il(e,a,t,s){this.name=e,this.tracks=t,this.duration=a!==void 0?a:-1,this.blendMode=s!==void 0?s:sc,this.uuid=nr.generateUUID(),this.duration<0&&this.resetDuration()}function uC(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return mm;case"vector":case"vector2":case"vector3":case"vector4":return gm;case"color":return Px;case"quaternion":return Rv;case"bool":case"boolean":return Cx;case"string":return Dx}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}function hC(e){if(e.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var a=uC(e.type);if(e.times===void 0){var t=[],s=[];Gs.flattenJSON(e.keys,t,s,"value"),e.times=t,e.values=s}return a.parse!==void 0?a.parse(e):new a(e.name,e.times,e.values,e.interpolation)}Object.assign(Il,{parse:function(e){for(var a=[],t=e.tracks,s=1/(e.fps||1),l=0,f=t.length;l!==f;++l)a.push(hC(t[l]).scale(s));return new Il(e.name,e.duration,a,e.blendMode)},toJSON:function(e){for(var a=[],t=e.tracks,s={name:e.name,duration:e.duration,tracks:a,uuid:e.uuid,blendMode:e.blendMode},l=0,f=t.length;l!==f;++l)a.push(Za.toJSON(t[l]));return s},CreateFromMorphTargetSequence:function(e,a,t,s){for(var l=a.length,f=[],v=0;v<l;v++){var x=[],w=[];x.push((v+l-1)%l,v,(v+1)%l),w.push(0,1,0);var E=Gs.getKeyframeOrder(x);x=Gs.sortedArray(x,1,E),w=Gs.sortedArray(w,1,E),!s&&x[0]===0&&(x.push(l),w.push(w[0])),f.push(new mm(".morphTargetInfluences["+a[v].name+"]",x,w).scale(1/t))}return new Il(e,-1,f)},findByName:function(e,a){var t=e;if(!Array.isArray(e)){var s=e;t=s.geometry&&s.geometry.animations||s.animations}for(var l=0;l<t.length;l++)if(t[l].name===a)return t[l];return null},CreateClipsFromMorphTargetSequences:function(e,a,t){for(var s={},l=0,f=e.length;l<f;l++){var v=e[l],x=v.name.match(/^([\w-]*?)([\d]+)$/);if(x&&x.length>1){var w=x[1],E=s[w];E||(s[w]=E=[]),E.push(v)}}var P=[];for(var R in s)P.push(Il.CreateFromMorphTargetSequence(R,s[R],a,t));return P},parseAnimation:function(e,a){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var t=function(se,ge,_e,We,nt){if(_e.length!==0){var Me=[],be=[];Gs.flattenJSON(_e,Me,be,We),Me.length!==0&&nt.push(new se(ge,Me,be))}},s=[],l=e.name||"default",f=e.fps||30,v=e.blendMode,x=e.length||-1,w=e.hierarchy||[],E=0;E<w.length;E++){var P=w[E].keys;if(!(!P||P.length===0))if(P[0].morphTargets){var R={},V=void 0;for(V=0;V<P.length;V++)if(P[V].morphTargets)for(var H=0;H<P[V].morphTargets.length;H++)R[P[V].morphTargets[H]]=-1;for(var q in R){for(var z=[],G=[],ie=0;ie!==P[V].morphTargets.length;++ie){var le=P[V];z.push(le.time),G.push(le.morphTarget===q?1:0)}s.push(new mm(".morphTargetInfluence["+q+"]",z,G))}x=R.length*(f||1)}else{var ae=".bones["+a[E].name+"]";t(gm,ae+".position",P,"pos",s),t(Rv,ae+".quaternion",P,"rot",s),t(gm,ae+".scale",P,"scl",s)}}if(s.length===0)return null;var J=new Il(l,x,s,v);return J}}),Object.assign(Il.prototype,{resetDuration:function(){for(var e=this.tracks,a=0,t=0,s=e.length;t!==s;++t){var l=this.tracks[t];a=Math.max(a,l.times[l.times.length-1])}return this.duration=a,this},trim:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},validate:function(){for(var e=!0,a=0;a<this.tracks.length;a++)e=e&&this.tracks[a].validate();return e},optimize:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this},clone:function(){for(var e=[],a=0;a<this.tracks.length;a++)e.push(this.tracks[a].clone());return new Il(this.name,this.duration,e,this.blendMode)}});var Ed={enabled:!1,files:{},add:function(e,a){this.enabled!==!1&&(this.files[e]=a)},get:function(e){if(this.enabled!==!1)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};function bM(e,a,t){var s=this,l=!1,f=0,v=0,x=void 0,w=[];this.onStart=void 0,this.onLoad=e,this.onProgress=a,this.onError=t,this.itemStart=function(E){v++,l===!1&&s.onStart!==void 0&&s.onStart(E,f,v),l=!0},this.itemEnd=function(E){f++,s.onProgress!==void 0&&s.onProgress(E,f,v),f===v&&(l=!1,s.onLoad!==void 0&&s.onLoad())},this.itemError=function(E){s.onError!==void 0&&s.onError(E)},this.resolveURL=function(E){return x?x(E):E},this.setURLModifier=function(E){return x=E,this},this.addHandler=function(E,P){return w.push(E,P),this},this.removeHandler=function(E){var P=w.indexOf(E);return P!==-1&&w.splice(P,2),this},this.getHandler=function(E){for(var P=0,R=w.length;P<R;P+=2){var V=w[P],H=w[P+1];if(V.global&&(V.lastIndex=0),V.test(E))return H}return null}}var oE=new bM;function bs(e){this.manager=e!==void 0?e:oE,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}Object.assign(bs.prototype,{load:function(){},loadAsync:function(e,a){var t=this;return new Promise(function(s,l){t.load(e,s,a,l)})},parse:function(){},setCrossOrigin:function(e){return this.crossOrigin=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}});var pc={};function Nl(e){bs.call(this,e)}Nl.prototype=Object.assign(Object.create(bs.prototype),{constructor:Nl,load:function(e,a,t,s){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);var l=this,f=Ed.get(e);if(f!==void 0)return l.manager.itemStart(e),setTimeout(function(){a&&a(f),l.manager.itemEnd(e)},0),f;if(pc[e]!==void 0){pc[e].push({onLoad:a,onProgress:t,onError:s});return}var v=e.match(/^data:(.*?)(;base64)?,(.*)$/),x;if(v){var w=v[1],E=!!v[2],P=v[3];P=decodeURIComponent(P),E&&(P=atob(P));try{var R,V=(this.responseType||"").toLowerCase();switch(V){case"arraybuffer":case"blob":for(var H=new Uint8Array(P.length),q=0;q<P.length;q++)H[q]=P.charCodeAt(q);V==="blob"?R=new Blob([H.buffer],{type:w}):R=H.buffer;break;case"document":var z=new DOMParser;R=z.parseFromString(P,w);break;case"json":R=JSON.parse(P);break;default:R=P;break}setTimeout(function(){a&&a(R),l.manager.itemEnd(e)},0)}catch(ie){setTimeout(function(){s&&s(ie),l.manager.itemError(e),l.manager.itemEnd(e)},0)}}else{pc[e]=[],pc[e].push({onLoad:a,onProgress:t,onError:s}),x=new XMLHttpRequest,x.open("GET",e,!0),x.addEventListener("load",function(ie){var le=this.response,ae=pc[e];if(delete pc[e],this.status===200||this.status===0){this.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),Ed.add(e,le);for(var J=0,se=ae.length;J<se;J++){var ge=ae[J];ge.onLoad&&ge.onLoad(le)}l.manager.itemEnd(e)}else{for(var _e=0,We=ae.length;_e<We;_e++){var nt=ae[_e];nt.onError&&nt.onError(ie)}l.manager.itemError(e),l.manager.itemEnd(e)}},!1),x.addEventListener("progress",function(ie){for(var le=pc[e],ae=0,J=le.length;ae<J;ae++){var se=le[ae];se.onProgress&&se.onProgress(ie)}},!1),x.addEventListener("error",function(ie){var le=pc[e];delete pc[e];for(var ae=0,J=le.length;ae<J;ae++){var se=le[ae];se.onError&&se.onError(ie)}l.manager.itemError(e),l.manager.itemEnd(e)},!1),x.addEventListener("abort",function(ie){var le=pc[e];delete pc[e];for(var ae=0,J=le.length;ae<J;ae++){var se=le[ae];se.onError&&se.onError(ie)}l.manager.itemError(e),l.manager.itemEnd(e)},!1),this.responseType!==void 0&&(x.responseType=this.responseType),this.withCredentials!==void 0&&(x.withCredentials=this.withCredentials),x.overrideMimeType&&x.overrideMimeType(this.mimeType!==void 0?this.mimeType:"text/plain");for(var G in this.requestHeader)x.setRequestHeader(G,this.requestHeader[G]);x.send(null)}return l.manager.itemStart(e),x},setResponseType:function(e){return this.responseType=e,this},setMimeType:function(e){return this.mimeType=e,this}});function wM(e){bs.call(this,e)}wM.prototype=Object.assign(Object.create(bs.prototype),{constructor:wM,load:function(e,a,t,s){var l=this,f=new Nl(l.manager);f.setPath(l.path),f.setRequestHeader(l.requestHeader),f.setWithCredentials(l.withCredentials),f.load(e,function(v){try{a(l.parse(JSON.parse(v)))}catch(x){s?s(x):console.error(x),l.manager.itemError(e)}},t,s)},parse:function(e){for(var a=[],t=0;t<e.length;t++){var s=Il.parse(e[t]);a.push(s)}return a}});function MM(e){bs.call(this,e)}MM.prototype=Object.assign(Object.create(bs.prototype),{constructor:MM,load:function(e,a,t,s){var l=this,f=[],v=new hm;v.image=f;var x=new Nl(this.manager);x.setPath(this.path),x.setResponseType("arraybuffer"),x.setRequestHeader(this.requestHeader),x.setWithCredentials(l.withCredentials);var w=0;function E(V){x.load(e[V],function(H){var q=l.parse(H,!0);f[V]={width:q.width,height:q.height,format:q.format,mipmaps:q.mipmaps},w+=1,w===6&&(q.mipmapCount===1&&(v.minFilter=jn),v.format=q.format,v.needsUpdate=!0,a&&a(v))},t,s)}if(Array.isArray(e))for(var P=0,R=e.length;P<R;++P)E(P);else x.load(e,function(V){var H=l.parse(V,!0);if(H.isCubemap)for(var q=H.mipmaps.length/H.mipmapCount,z=0;z<q;z++){f[z]={mipmaps:[]};for(var G=0;G<H.mipmapCount;G++)f[z].mipmaps.push(H.mipmaps[z*H.mipmapCount+G]),f[z].format=H.format,f[z].width=H.width,f[z].height=H.height}else v.image.width=H.width,v.image.height=H.height,v.mipmaps=H.mipmaps;H.mipmapCount===1&&(v.minFilter=jn),v.format=H.format,v.needsUpdate=!0,a&&a(v)},t,s);return v}});function vm(e){bs.call(this,e)}vm.prototype=Object.assign(Object.create(bs.prototype),{constructor:vm,load:function(e,a,t,s){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);var l=this,f=Ed.get(e);if(f!==void 0)return l.manager.itemStart(e),setTimeout(function(){a&&a(f),l.manager.itemEnd(e)},0),f;var v=document.createElementNS("http://www.w3.org/1999/xhtml","img");function x(){v.removeEventListener("load",x,!1),v.removeEventListener("error",w,!1),Ed.add(e,this),a&&a(this),l.manager.itemEnd(e)}function w(E){v.removeEventListener("load",x,!1),v.removeEventListener("error",w,!1),s&&s(E),l.manager.itemError(e),l.manager.itemEnd(e)}return v.addEventListener("load",x,!1),v.addEventListener("error",w,!1),e.substr(0,5)!=="data:"&&this.crossOrigin!==void 0&&(v.crossOrigin=this.crossOrigin),l.manager.itemStart(e),v.src=e,v}});function Ox(e){bs.call(this,e)}Ox.prototype=Object.assign(Object.create(bs.prototype),{constructor:Ox,load:function(e,a,t,s){var l=new ru,f=new vm(this.manager);f.setCrossOrigin(this.crossOrigin),f.setPath(this.path);var v=0;function x(E){f.load(e[E],function(P){l.images[E]=P,v++,v===6&&(l.needsUpdate=!0,a&&a(l))},void 0,s)}for(var w=0;w<e.length;++w)x(w);return l}});function Ix(e){bs.call(this,e)}Ix.prototype=Object.assign(Object.create(bs.prototype),{constructor:Ix,load:function(e,a,t,s){var l=this,f=new gd,v=new Nl(this.manager);return v.setResponseType("arraybuffer"),v.setRequestHeader(this.requestHeader),v.setPath(this.path),v.setWithCredentials(l.withCredentials),v.load(e,function(x){var w=l.parse(x);!w||(w.image!==void 0?f.image=w.image:w.data!==void 0&&(f.image.width=w.width,f.image.height=w.height,f.image.data=w.data),f.wrapS=w.wrapS!==void 0?w.wrapS:xn,f.wrapT=w.wrapT!==void 0?w.wrapT:xn,f.magFilter=w.magFilter!==void 0?w.magFilter:jn,f.minFilter=w.minFilter!==void 0?w.minFilter:jn,f.anisotropy=w.anisotropy!==void 0?w.anisotropy:1,w.format!==void 0&&(f.format=w.format),w.type!==void 0&&(f.type=w.type),w.mipmaps!==void 0&&(f.mipmaps=w.mipmaps,f.minFilter=ts),w.mipmapCount===1&&(f.minFilter=jn),f.needsUpdate=!0,a&&a(f,w))},t,s),f}});function Nx(e){bs.call(this,e)}Nx.prototype=Object.assign(Object.create(bs.prototype),{constructor:Nx,load:function(e,a,t,s){var l=new ds,f=new vm(this.manager);return f.setCrossOrigin(this.crossOrigin),f.setPath(this.path),f.load(e,function(v){l.image=v;var x=e.search(/\.jpe?g($|\?)/i)>0||e.search(/^data\:image\/jpeg/)===0;l.format=x?nl:ye,l.needsUpdate=!0,a!==void 0&&a(l)},t,s),l}});function Ui(){this.type="Curve",this.arcLengthDivisions=200}Object.assign(Ui.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(e,a){var t=this.getUtoTmapping(e);return this.getPoint(t,a)},getPoints:function(e){e===void 0&&(e=5);for(var a=[],t=0;t<=e;t++)a.push(this.getPoint(t/e));return a},getSpacedPoints:function(e){e===void 0&&(e=5);for(var a=[],t=0;t<=e;t++)a.push(this.getPointAt(t/e));return a},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(e===void 0&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var a=[],t,s=this.getPoint(0),l=0;a.push(0);for(var f=1;f<=e;f++)t=this.getPoint(f/e),l+=t.distanceTo(s),a.push(l),s=t;return this.cacheArcLengths=a,a},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,a){var t=this.getLengths(),s=0,l=t.length,f;a?f=a:f=e*t[l-1];for(var v=0,x=l-1,w;v<=x;)if(s=Math.floor(v+(x-v)/2),w=t[s]-f,w<0)v=s+1;else if(w>0)x=s-1;else{x=s;break}if(s=x,t[s]===f)return s/(l-1);var E=t[s],P=t[s+1],R=(f-E)/(P-E),V=(s+R)/(l-1);return V},getTangent:function(e,a){var t=1e-4,s=e-t,l=e+t;s<0&&(s=0),l>1&&(l=1);var f=this.getPoint(s),v=this.getPoint(l),x=a||(f.isVector2?new bn:new pe);return x.copy(v).sub(f).normalize(),x},getTangentAt:function(e,a){var t=this.getUtoTmapping(e);return this.getTangent(t,a)},computeFrenetFrames:function(e,a){for(var t=new pe,s=[],l=[],f=[],v=new pe,x=new wr,w=0;w<=e;w++){var E=w/e;s[w]=this.getTangentAt(E,new pe),s[w].normalize()}l[0]=new pe,f[0]=new pe;var P=Number.MAX_VALUE,R=Math.abs(s[0].x),V=Math.abs(s[0].y),H=Math.abs(s[0].z);R<=P&&(P=R,t.set(1,0,0)),V<=P&&(P=V,t.set(0,1,0)),H<=P&&t.set(0,0,1),v.crossVectors(s[0],t).normalize(),l[0].crossVectors(s[0],v),f[0].crossVectors(s[0],l[0]);for(var q=1;q<=e;q++){if(l[q]=l[q-1].clone(),f[q]=f[q-1].clone(),v.crossVectors(s[q-1],s[q]),v.length()>Number.EPSILON){v.normalize();var z=Math.acos(nr.clamp(s[q-1].dot(s[q]),-1,1));l[q].applyMatrix4(x.makeRotationAxis(v,z))}f[q].crossVectors(s[q],l[q])}if(a===!0){var G=Math.acos(nr.clamp(l[0].dot(l[e]),-1,1));G/=e,s[0].dot(v.crossVectors(l[0],l[e]))>0&&(G=-G);for(var ie=1;ie<=e;ie++)l[ie].applyMatrix4(x.makeRotationAxis(s[ie],G*ie)),f[ie].crossVectors(s[ie],l[ie])}return{tangents:s,normals:l,binormals:f}},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this},toJSON:function(){var e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e},fromJSON:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}});function hl(e,a,t,s,l,f,v,x){Ui.call(this),this.type="EllipseCurve",this.aX=e||0,this.aY=a||0,this.xRadius=t||1,this.yRadius=s||1,this.aStartAngle=l||0,this.aEndAngle=f||2*Math.PI,this.aClockwise=v||!1,this.aRotation=x||0}hl.prototype=Object.create(Ui.prototype),hl.prototype.constructor=hl,hl.prototype.isEllipseCurve=!0,hl.prototype.getPoint=function(e,a){for(var t=a||new bn,s=Math.PI*2,l=this.aEndAngle-this.aStartAngle,f=Math.abs(l)<Number.EPSILON;l<0;)l+=s;for(;l>s;)l-=s;l<Number.EPSILON&&(f?l=0:l=s),this.aClockwise===!0&&!f&&(l===s?l=-s:l=l-s);var v=this.aStartAngle+e*l,x=this.aX+this.xRadius*Math.cos(v),w=this.aY+this.yRadius*Math.sin(v);if(this.aRotation!==0){var E=Math.cos(this.aRotation),P=Math.sin(this.aRotation),R=x-this.aX,V=w-this.aY;x=R*E-V*P+this.aX,w=R*P+V*E+this.aY}return t.set(x,w)},hl.prototype.copy=function(e){return Ui.prototype.copy.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},hl.prototype.toJSON=function(){var e=Ui.prototype.toJSON.call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e},hl.prototype.fromJSON=function(e){return Ui.prototype.fromJSON.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this};function ym(e,a,t,s,l,f){hl.call(this,e,a,t,t,s,l,f),this.type="ArcCurve"}ym.prototype=Object.create(hl.prototype),ym.prototype.constructor=ym,ym.prototype.isArcCurve=!0;function SM(){var e=0,a=0,t=0,s=0;function l(f,v,x,w){e=f,a=x,t=-3*f+3*v-2*x-w,s=2*f-2*v+x+w}return{initCatmullRom:function(f,v,x,w,E){l(v,x,E*(x-f),E*(w-v))},initNonuniformCatmullRom:function(f,v,x,w,E,P,R){var V=(v-f)/E-(x-f)/(E+P)+(x-v)/P,H=(x-v)/P-(w-v)/(P+R)+(w-x)/R;V*=P,H*=P,l(v,x,V,H)},calc:function(f){var v=f*f;return e+a*f+t*v+s*(v*f)}}}var Fx=new pe,EM=new SM,TM=new SM,AM=new SM;function oo(e,a,t,s){Ui.call(this),this.type="CatmullRomCurve3",this.points=e||[],this.closed=a||!1,this.curveType=t||"centripetal",this.tension=s!==void 0?s:.5}oo.prototype=Object.create(Ui.prototype),oo.prototype.constructor=oo,oo.prototype.isCatmullRomCurve3=!0,oo.prototype.getPoint=function(e,a){var t=a||new pe,s=this.points,l=s.length,f=(l-(this.closed?0:1))*e,v=Math.floor(f),x=f-v;this.closed?v+=v>0?0:(Math.floor(Math.abs(v)/l)+1)*l:x===0&&v===l-1&&(v=l-2,x=1);var w,E;this.closed||v>0?w=s[(v-1)%l]:(Fx.subVectors(s[0],s[1]).add(s[0]),w=Fx);var P=s[v%l],R=s[(v+1)%l];if(this.closed||v+2<l?E=s[(v+2)%l]:(Fx.subVectors(s[l-1],s[l-2]).add(s[l-1]),E=Fx),this.curveType==="centripetal"||this.curveType==="chordal"){var V=this.curveType==="chordal"?.5:.25,H=Math.pow(w.distanceToSquared(P),V),q=Math.pow(P.distanceToSquared(R),V),z=Math.pow(R.distanceToSquared(E),V);q<1e-4&&(q=1),H<1e-4&&(H=q),z<1e-4&&(z=q),EM.initNonuniformCatmullRom(w.x,P.x,R.x,E.x,H,q,z),TM.initNonuniformCatmullRom(w.y,P.y,R.y,E.y,H,q,z),AM.initNonuniformCatmullRom(w.z,P.z,R.z,E.z,H,q,z)}else this.curveType==="catmullrom"&&(EM.initCatmullRom(w.x,P.x,R.x,E.x,this.tension),TM.initCatmullRom(w.y,P.y,R.y,E.y,this.tension),AM.initCatmullRom(w.z,P.z,R.z,E.z,this.tension));return t.set(EM.calc(x),TM.calc(x),AM.calc(x)),t},oo.prototype.copy=function(e){Ui.prototype.copy.call(this,e),this.points=[];for(var a=0,t=e.points.length;a<t;a++){var s=e.points[a];this.points.push(s.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},oo.prototype.toJSON=function(){var e=Ui.prototype.toJSON.call(this);e.points=[];for(var a=0,t=this.points.length;a<t;a++){var s=this.points[a];e.points.push(s.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e},oo.prototype.fromJSON=function(e){Ui.prototype.fromJSON.call(this,e),this.points=[];for(var a=0,t=e.points.length;a<t;a++){var s=e.points[a];this.points.push(new pe().fromArray(s))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this};function lE(e,a,t,s,l){var f=(s-a)*.5,v=(l-t)*.5,x=e*e;return(2*t-2*s+f+v)*(e*x)+(-3*t+3*s-2*f-v)*x+f*e+t}function fC(e,a){var t=1-e;return t*t*a}function dC(e,a){return 2*(1-e)*e*a}function pC(e,a){return e*e*a}function Dv(e,a,t,s){return fC(e,a)+dC(e,t)+pC(e,s)}function mC(e,a){var t=1-e;return t*t*t*a}function gC(e,a){var t=1-e;return 3*t*t*e*a}function vC(e,a){return 3*(1-e)*e*e*a}function yC(e,a){return e*e*e*a}function Ov(e,a,t,s,l){return mC(e,a)+gC(e,t)+vC(e,s)+yC(e,l)}function mc(e,a,t,s){Ui.call(this),this.type="CubicBezierCurve",this.v0=e||new bn,this.v1=a||new bn,this.v2=t||new bn,this.v3=s||new bn}mc.prototype=Object.create(Ui.prototype),mc.prototype.constructor=mc,mc.prototype.isCubicBezierCurve=!0,mc.prototype.getPoint=function(e,a){var t=a||new bn,s=this.v0,l=this.v1,f=this.v2,v=this.v3;return t.set(Ov(e,s.x,l.x,f.x,v.x),Ov(e,s.y,l.y,f.y,v.y)),t},mc.prototype.copy=function(e){return Ui.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},mc.prototype.toJSON=function(){var e=Ui.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},mc.prototype.fromJSON=function(e){return Ui.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this};function ou(e,a,t,s){Ui.call(this),this.type="CubicBezierCurve3",this.v0=e||new pe,this.v1=a||new pe,this.v2=t||new pe,this.v3=s||new pe}ou.prototype=Object.create(Ui.prototype),ou.prototype.constructor=ou,ou.prototype.isCubicBezierCurve3=!0,ou.prototype.getPoint=function(e,a){var t=a||new pe,s=this.v0,l=this.v1,f=this.v2,v=this.v3;return t.set(Ov(e,s.x,l.x,f.x,v.x),Ov(e,s.y,l.y,f.y,v.y),Ov(e,s.z,l.z,f.z,v.z)),t},ou.prototype.copy=function(e){return Ui.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},ou.prototype.toJSON=function(){var e=Ui.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},ou.prototype.fromJSON=function(e){return Ui.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this};function Go(e,a){Ui.call(this),this.type="LineCurve",this.v1=e||new bn,this.v2=a||new bn}Go.prototype=Object.create(Ui.prototype),Go.prototype.constructor=Go,Go.prototype.isLineCurve=!0,Go.prototype.getPoint=function(e,a){var t=a||new bn;return e===1?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t},Go.prototype.getPointAt=function(e,a){return this.getPoint(e,a)},Go.prototype.getTangent=function(e,a){var t=a||new bn;return t.copy(this.v2).sub(this.v1).normalize(),t},Go.prototype.copy=function(e){return Ui.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Go.prototype.toJSON=function(){var e=Ui.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Go.prototype.fromJSON=function(e){return Ui.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this};function gc(e,a){Ui.call(this),this.type="LineCurve3",this.v1=e||new pe,this.v2=a||new pe}gc.prototype=Object.create(Ui.prototype),gc.prototype.constructor=gc,gc.prototype.isLineCurve3=!0,gc.prototype.getPoint=function(e,a){var t=a||new pe;return e===1?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t},gc.prototype.getPointAt=function(e,a){return this.getPoint(e,a)},gc.prototype.copy=function(e){return Ui.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},gc.prototype.toJSON=function(){var e=Ui.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},gc.prototype.fromJSON=function(e){return Ui.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this};function vc(e,a,t){Ui.call(this),this.type="QuadraticBezierCurve",this.v0=e||new bn,this.v1=a||new bn,this.v2=t||new bn}vc.prototype=Object.create(Ui.prototype),vc.prototype.constructor=vc,vc.prototype.isQuadraticBezierCurve=!0,vc.prototype.getPoint=function(e,a){var t=a||new bn,s=this.v0,l=this.v1,f=this.v2;return t.set(Dv(e,s.x,l.x,f.x),Dv(e,s.y,l.y,f.y)),t},vc.prototype.copy=function(e){return Ui.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},vc.prototype.toJSON=function(){var e=Ui.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},vc.prototype.fromJSON=function(e){return Ui.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this};function lu(e,a,t){Ui.call(this),this.type="QuadraticBezierCurve3",this.v0=e||new pe,this.v1=a||new pe,this.v2=t||new pe}lu.prototype=Object.create(Ui.prototype),lu.prototype.constructor=lu,lu.prototype.isQuadraticBezierCurve3=!0,lu.prototype.getPoint=function(e,a){var t=a||new pe,s=this.v0,l=this.v1,f=this.v2;return t.set(Dv(e,s.x,l.x,f.x),Dv(e,s.y,l.y,f.y),Dv(e,s.z,l.z,f.z)),t},lu.prototype.copy=function(e){return Ui.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},lu.prototype.toJSON=function(){var e=Ui.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},lu.prototype.fromJSON=function(e){return Ui.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this};function yc(e){Ui.call(this),this.type="SplineCurve",this.points=e||[]}yc.prototype=Object.create(Ui.prototype),yc.prototype.constructor=yc,yc.prototype.isSplineCurve=!0,yc.prototype.getPoint=function(e,a){var t=a||new bn,s=this.points,l=(s.length-1)*e,f=Math.floor(l),v=l-f,x=s[f===0?f:f-1],w=s[f],E=s[f>s.length-2?s.length-1:f+1],P=s[f>s.length-3?s.length-1:f+2];return t.set(lE(v,x.x,w.x,E.x,P.x),lE(v,x.y,w.y,E.y,P.y)),t},yc.prototype.copy=function(e){Ui.prototype.copy.call(this,e),this.points=[];for(var a=0,t=e.points.length;a<t;a++){var s=e.points[a];this.points.push(s.clone())}return this},yc.prototype.toJSON=function(){var e=Ui.prototype.toJSON.call(this);e.points=[];for(var a=0,t=this.points.length;a<t;a++){var s=this.points[a];e.points.push(s.toArray())}return e},yc.prototype.fromJSON=function(e){Ui.prototype.fromJSON.call(this,e),this.points=[];for(var a=0,t=e.points.length;a<t;a++){var s=e.points[a];this.points.push(new bn().fromArray(s))}return this};var LM=Object.freeze({__proto__:null,ArcCurve:ym,CatmullRomCurve3:oo,CubicBezierCurve:mc,CubicBezierCurve3:ou,EllipseCurve:hl,LineCurve:Go,LineCurve3:gc,QuadraticBezierCurve:vc,QuadraticBezierCurve3:lu,SplineCurve:yc});function eh(){Ui.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}eh.prototype=Object.assign(Object.create(Ui.prototype),{constructor:eh,add:function(e){this.curves.push(e)},closePath:function(){var e=this.curves[0].getPoint(0),a=this.curves[this.curves.length-1].getPoint(1);e.equals(a)||this.curves.push(new Go(a,e))},getPoint:function(e){for(var a=e*this.getLength(),t=this.getCurveLengths(),s=0;s<t.length;){if(t[s]>=a){var l=t[s]-a,f=this.curves[s],v=f.getLength(),x=v===0?0:1-l/v;return f.getPointAt(x)}s++}return null},getLength:function(){var e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],a=0,t=0,s=this.curves.length;t<s;t++)a+=this.curves[t].getLength(),e.push(a);return this.cacheLengths=e,e},getSpacedPoints:function(e){e===void 0&&(e=40);for(var a=[],t=0;t<=e;t++)a.push(this.getPoint(t/e));return this.autoClose&&a.push(a[0]),a},getPoints:function(e){e=e||12;for(var a=[],t,s=0,l=this.curves;s<l.length;s++)for(var f=l[s],v=f&&f.isEllipseCurve?e*2:f&&(f.isLineCurve||f.isLineCurve3)?1:f&&f.isSplineCurve?e*f.points.length:e,x=f.getPoints(v),w=0;w<x.length;w++){var E=x[w];t&&t.equals(E)||(a.push(E),t=E)}return this.autoClose&&a.length>1&&!a[a.length-1].equals(a[0])&&a.push(a[0]),a},copy:function(e){Ui.prototype.copy.call(this,e),this.curves=[];for(var a=0,t=e.curves.length;a<t;a++){var s=e.curves[a];this.curves.push(s.clone())}return this.autoClose=e.autoClose,this},toJSON:function(){var e=Ui.prototype.toJSON.call(this);e.autoClose=this.autoClose,e.curves=[];for(var a=0,t=this.curves.length;a<t;a++){var s=this.curves[a];e.curves.push(s.toJSON())}return e},fromJSON:function(e){Ui.prototype.fromJSON.call(this,e),this.autoClose=e.autoClose,this.curves=[];for(var a=0,t=e.curves.length;a<t;a++){var s=e.curves[a];this.curves.push(new LM[s.type]().fromJSON(s))}return this}});function xc(e){eh.call(this),this.type="Path",this.currentPoint=new bn,e&&this.setFromPoints(e)}xc.prototype=Object.assign(Object.create(eh.prototype),{constructor:xc,setFromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(var a=1,t=e.length;a<t;a++)this.lineTo(e[a].x,e[a].y);return this},moveTo:function(e,a){return this.currentPoint.set(e,a),this},lineTo:function(e,a){var t=new Go(this.currentPoint.clone(),new bn(e,a));return this.curves.push(t),this.currentPoint.set(e,a),this},quadraticCurveTo:function(e,a,t,s){var l=new vc(this.currentPoint.clone(),new bn(e,a),new bn(t,s));return this.curves.push(l),this.currentPoint.set(t,s),this},bezierCurveTo:function(e,a,t,s,l,f){var v=new mc(this.currentPoint.clone(),new bn(e,a),new bn(t,s),new bn(l,f));return this.curves.push(v),this.currentPoint.set(l,f),this},splineThru:function(e){var a=[this.currentPoint.clone()].concat(e),t=new yc(a);return this.curves.push(t),this.currentPoint.copy(e[e.length-1]),this},arc:function(e,a,t,s,l,f){var v=this.currentPoint.x,x=this.currentPoint.y;return this.absarc(e+v,a+x,t,s,l,f),this},absarc:function(e,a,t,s,l,f){return this.absellipse(e,a,t,t,s,l,f),this},ellipse:function(e,a,t,s,l,f,v,x){var w=this.currentPoint.x,E=this.currentPoint.y;return this.absellipse(e+w,a+E,t,s,l,f,v,x),this},absellipse:function(e,a,t,s,l,f,v,x){var w=new hl(e,a,t,s,l,f,v,x);if(this.curves.length>0){var E=w.getPoint(0);E.equals(this.currentPoint)||this.lineTo(E.x,E.y)}this.curves.push(w);var P=w.getPoint(1);return this.currentPoint.copy(P),this},copy:function(e){return eh.prototype.copy.call(this,e),this.currentPoint.copy(e.currentPoint),this},toJSON:function(){var e=eh.prototype.toJSON.call(this);return e.currentPoint=this.currentPoint.toArray(),e},fromJSON:function(e){return eh.prototype.fromJSON.call(this,e),this.currentPoint.fromArray(e.currentPoint),this}});function df(e){xc.call(this,e),this.uuid=nr.generateUUID(),this.type="Shape",this.holes=[]}df.prototype=Object.assign(Object.create(xc.prototype),{constructor:df,getPointsHoles:function(e){for(var a=[],t=0,s=this.holes.length;t<s;t++)a[t]=this.holes[t].getPoints(e);return a},extractPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},copy:function(e){xc.prototype.copy.call(this,e),this.holes=[];for(var a=0,t=e.holes.length;a<t;a++){var s=e.holes[a];this.holes.push(s.clone())}return this},toJSON:function(){var e=xc.prototype.toJSON.call(this);e.uuid=this.uuid,e.holes=[];for(var a=0,t=this.holes.length;a<t;a++){var s=this.holes[a];e.holes.push(s.toJSON())}return e},fromJSON:function(e){xc.prototype.fromJSON.call(this,e),this.uuid=e.uuid,this.holes=[];for(var a=0,t=e.holes.length;a<t;a++){var s=e.holes[a];this.holes.push(new xc().fromJSON(s))}return this}});function Fs(e,a){Ei.call(this),this.type="Light",this.color=new mi(e),this.intensity=a!==void 0?a:1}Fs.prototype=Object.assign(Object.create(Ei.prototype),{constructor:Fs,isLight:!0,copy:function(e){return Ei.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},toJSON:function(e){var a=Ei.prototype.toJSON.call(this,e);return a.object.color=this.color.getHex(),a.object.intensity=this.intensity,this.groundColor!==void 0&&(a.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(a.object.distance=this.distance),this.angle!==void 0&&(a.object.angle=this.angle),this.decay!==void 0&&(a.object.decay=this.decay),this.penumbra!==void 0&&(a.object.penumbra=this.penumbra),this.shadow!==void 0&&(a.object.shadow=this.shadow.toJSON()),a}});function Bx(e,a,t){Fs.call(this,e,t),this.type="HemisphereLight",this.position.copy(Ei.DefaultUp),this.updateMatrix(),this.groundColor=new mi(a)}Bx.prototype=Object.assign(Object.create(Fs.prototype),{constructor:Bx,isHemisphereLight:!0,copy:function(e){return Fs.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}});function th(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new bn(512,512),this.map=null,this.mapPass=null,this.matrix=new wr,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new hv,this._frameExtents=new bn(1,1),this._viewportCount=1,this._viewports=[new ps(0,0,1,1)]}Object.assign(th.prototype,{_projScreenMatrix:new wr,_lightPositionWorld:new pe,_lookTarget:new pe,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(e){var a=this.camera,t=this.matrix,s=this._projScreenMatrix,l=this._lookTarget,f=this._lightPositionWorld;f.setFromMatrixPosition(e.matrixWorld),a.position.copy(f),l.setFromMatrixPosition(e.target.matrixWorld),a.lookAt(l),a.updateMatrixWorld(),s.multiplyMatrices(a.projectionMatrix,a.matrixWorldInverse),this._frustum.setFromProjectionMatrix(s),t.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),t.multiply(a.projectionMatrix),t.multiply(a.matrixWorldInverse)},getViewport:function(e){return this._viewports[e]},getFrameExtents:function(){return this._frameExtents},copy:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){var e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}});function CM(){th.call(this,new Ms(50,1,.5,500)),this.focus=1}CM.prototype=Object.assign(Object.create(th.prototype),{constructor:CM,isSpotLightShadow:!0,updateMatrices:function(e){var a=this.camera,t=nr.RAD2DEG*2*e.angle*this.focus,s=this.mapSize.width/this.mapSize.height,l=e.distance||a.far;(t!==a.fov||s!==a.aspect||l!==a.far)&&(a.fov=t,a.aspect=s,a.far=l,a.updateProjectionMatrix()),th.prototype.updateMatrices.call(this,e)}});function kx(e,a,t,s,l,f){Fs.call(this,e,a),this.type="SpotLight",this.position.copy(Ei.DefaultUp),this.updateMatrix(),this.target=new Ei,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(v){this.intensity=v/Math.PI}}),this.distance=t!==void 0?t:0,this.angle=s!==void 0?s:Math.PI/3,this.penumbra=l!==void 0?l:0,this.decay=f!==void 0?f:1,this.shadow=new CM}kx.prototype=Object.assign(Object.create(Fs.prototype),{constructor:kx,isSpotLight:!0,copy:function(e){return Fs.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}});function PM(){th.call(this,new Ms(90,1,.5,500)),this._frameExtents=new bn(4,2),this._viewportCount=6,this._viewports=[new ps(2,1,1,1),new ps(0,1,1,1),new ps(3,1,1,1),new ps(1,1,1,1),new ps(3,0,1,1),new ps(1,0,1,1)],this._cubeDirections=[new pe(1,0,0),new pe(-1,0,0),new pe(0,0,1),new pe(0,0,-1),new pe(0,1,0),new pe(0,-1,0)],this._cubeUps=[new pe(0,1,0),new pe(0,1,0),new pe(0,1,0),new pe(0,1,0),new pe(0,0,1),new pe(0,0,-1)]}PM.prototype=Object.assign(Object.create(th.prototype),{constructor:PM,isPointLightShadow:!0,updateMatrices:function(e,a){a===void 0&&(a=0);var t=this.camera,s=this.matrix,l=this._lightPositionWorld,f=this._lookTarget,v=this._projScreenMatrix;l.setFromMatrixPosition(e.matrixWorld),t.position.copy(l),f.copy(t.position),f.add(this._cubeDirections[a]),t.up.copy(this._cubeUps[a]),t.lookAt(f),t.updateMatrixWorld(),s.makeTranslation(-l.x,-l.y,-l.z),v.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(v)}});function zx(e,a,t,s){Fs.call(this,e,a),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return this.intensity*4*Math.PI},set:function(l){this.intensity=l/(4*Math.PI)}}),this.distance=t!==void 0?t:0,this.decay=s!==void 0?s:1,this.shadow=new PM}zx.prototype=Object.assign(Object.create(Fs.prototype),{constructor:zx,isPointLight:!0,copy:function(e){return Fs.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}});function xm(e,a,t,s,l,f){Ta.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e!==void 0?e:-1,this.right=a!==void 0?a:1,this.top=t!==void 0?t:1,this.bottom=s!==void 0?s:-1,this.near=l!==void 0?l:.1,this.far=f!==void 0?f:2e3,this.updateProjectionMatrix()}xm.prototype=Object.assign(Object.create(Ta.prototype),{constructor:xm,isOrthographicCamera:!0,copy:function(e,a){return Ta.prototype.copy.call(this,e,a),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this},setViewOffset:function(e,a,t,s,l,f){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=a,this.view.offsetX=t,this.view.offsetY=s,this.view.width=l,this.view.height=f,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=(this.right-this.left)/(2*this.zoom),a=(this.top-this.bottom)/(2*this.zoom),t=(this.right+this.left)/2,s=(this.top+this.bottom)/2,l=t-e,f=t+e,v=s+a,x=s-a;if(this.view!==null&&this.view.enabled){var w=(this.right-this.left)/this.view.fullWidth/this.zoom,E=(this.top-this.bottom)/this.view.fullHeight/this.zoom;l+=w*this.view.offsetX,f=l+w*this.view.width,v-=E*this.view.offsetY,x=v-E*this.view.height}this.projectionMatrix.makeOrthographic(l,f,v,x,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){var a=Ei.prototype.toJSON.call(this,e);return a.object.zoom=this.zoom,a.object.left=this.left,a.object.right=this.right,a.object.top=this.top,a.object.bottom=this.bottom,a.object.near=this.near,a.object.far=this.far,this.view!==null&&(a.object.view=Object.assign({},this.view)),a}});function RM(){th.call(this,new xm(-5,5,5,-5,.5,500))}RM.prototype=Object.assign(Object.create(th.prototype),{constructor:RM,isDirectionalLightShadow:!0,updateMatrices:function(e){th.prototype.updateMatrices.call(this,e)}});function Ux(e,a){Fs.call(this,e,a),this.type="DirectionalLight",this.position.copy(Ei.DefaultUp),this.updateMatrix(),this.target=new Ei,this.shadow=new RM}Ux.prototype=Object.assign(Object.create(Fs.prototype),{constructor:Ux,isDirectionalLight:!0,copy:function(e){return Fs.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}});function Hx(e,a){Fs.call(this,e,a),this.type="AmbientLight"}Hx.prototype=Object.assign(Object.create(Fs.prototype),{constructor:Hx,isAmbientLight:!0});function Gx(e,a,t,s){Fs.call(this,e,a),this.type="RectAreaLight",this.width=t!==void 0?t:10,this.height=s!==void 0?s:10}Gx.prototype=Object.assign(Object.create(Fs.prototype),{constructor:Gx,isRectAreaLight:!0,copy:function(e){return Fs.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},toJSON:function(e){var a=Fs.prototype.toJSON.call(this,e);return a.object.width=this.width,a.object.height=this.height,a}});var cE=function(){function e(){Object.defineProperty(this,"isSphericalHarmonics3",{value:!0}),this.coefficients=[];for(var t=0;t<9;t++)this.coefficients.push(new pe)}var a=e.prototype;return a.set=function(t){for(var s=0;s<9;s++)this.coefficients[s].copy(t[s]);return this},a.zero=function(){for(var t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this},a.getAt=function(t,s){var l=t.x,f=t.y,v=t.z,x=this.coefficients;return s.copy(x[0]).multiplyScalar(.282095),s.addScaledVector(x[1],.488603*f),s.addScaledVector(x[2],.488603*v),s.addScaledVector(x[3],.488603*l),s.addScaledVector(x[4],1.092548*(l*f)),s.addScaledVector(x[5],1.092548*(f*v)),s.addScaledVector(x[6],.315392*(3*v*v-1)),s.addScaledVector(x[7],1.092548*(l*v)),s.addScaledVector(x[8],.546274*(l*l-f*f)),s},a.getIrradianceAt=function(t,s){var l=t.x,f=t.y,v=t.z,x=this.coefficients;return s.copy(x[0]).multiplyScalar(.886227),s.addScaledVector(x[1],2*.511664*f),s.addScaledVector(x[2],2*.511664*v),s.addScaledVector(x[3],2*.511664*l),s.addScaledVector(x[4],2*.429043*l*f),s.addScaledVector(x[5],2*.429043*f*v),s.addScaledVector(x[6],.743125*v*v-.247708),s.addScaledVector(x[7],2*.429043*l*v),s.addScaledVector(x[8],.429043*(l*l-f*f)),s},a.add=function(t){for(var s=0;s<9;s++)this.coefficients[s].add(t.coefficients[s]);return this},a.addScaledSH=function(t,s){for(var l=0;l<9;l++)this.coefficients[l].addScaledVector(t.coefficients[l],s);return this},a.scale=function(t){for(var s=0;s<9;s++)this.coefficients[s].multiplyScalar(t);return this},a.lerp=function(t,s){for(var l=0;l<9;l++)this.coefficients[l].lerp(t.coefficients[l],s);return this},a.equals=function(t){for(var s=0;s<9;s++)if(!this.coefficients[s].equals(t.coefficients[s]))return!1;return!0},a.copy=function(t){return this.set(t.coefficients)},a.clone=function(){return new this.constructor().copy(this)},a.fromArray=function(t,s){s===void 0&&(s=0);for(var l=this.coefficients,f=0;f<9;f++)l[f].fromArray(t,s+f*3);return this},a.toArray=function(t,s){t===void 0&&(t=[]),s===void 0&&(s=0);for(var l=this.coefficients,f=0;f<9;f++)l[f].toArray(t,s+f*3);return t},e.getBasisAt=function(t,s){var l=t.x,f=t.y,v=t.z;s[0]=.282095,s[1]=.488603*f,s[2]=.488603*v,s[3]=.488603*l,s[4]=1.092548*l*f,s[5]=1.092548*f*v,s[6]=.315392*(3*v*v-1),s[7]=1.092548*l*v,s[8]=.546274*(l*l-f*f)},e}();function Fl(e,a){Fs.call(this,void 0,a),this.type="LightProbe",this.sh=e!==void 0?e:new cE}Fl.prototype=Object.assign(Object.create(Fs.prototype),{constructor:Fl,isLightProbe:!0,copy:function(e){return Fs.prototype.copy.call(this,e),this.sh.copy(e.sh),this},fromJSON:function(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this},toJSON:function(e){var a=Fs.prototype.toJSON.call(this,e);return a.object.sh=this.sh.toArray(),a}});function Vx(e){bs.call(this,e),this.textures={}}Vx.prototype=Object.assign(Object.create(bs.prototype),{constructor:Vx,load:function(e,a,t,s){var l=this,f=new Nl(l.manager);f.setPath(l.path),f.setRequestHeader(l.requestHeader),f.setWithCredentials(l.withCredentials),f.load(e,function(v){try{a(l.parse(JSON.parse(v)))}catch(x){s?s(x):console.error(x),l.manager.itemError(e)}},t,s)},parse:function(e){var a=this.textures;function t(w){return a[w]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",w),a[w]}var s=new cC[e.type];if(e.uuid!==void 0&&(s.uuid=e.uuid),e.name!==void 0&&(s.name=e.name),e.color!==void 0&&s.color.setHex(e.color),e.roughness!==void 0&&(s.roughness=e.roughness),e.metalness!==void 0&&(s.metalness=e.metalness),e.sheen!==void 0&&(s.sheen=new mi().setHex(e.sheen)),e.emissive!==void 0&&s.emissive.setHex(e.emissive),e.specular!==void 0&&s.specular.setHex(e.specular),e.shininess!==void 0&&(s.shininess=e.shininess),e.clearcoat!==void 0&&(s.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(s.clearcoatRoughness=e.clearcoatRoughness),e.fog!==void 0&&(s.fog=e.fog),e.flatShading!==void 0&&(s.flatShading=e.flatShading),e.blending!==void 0&&(s.blending=e.blending),e.combine!==void 0&&(s.combine=e.combine),e.side!==void 0&&(s.side=e.side),e.opacity!==void 0&&(s.opacity=e.opacity),e.transparent!==void 0&&(s.transparent=e.transparent),e.alphaTest!==void 0&&(s.alphaTest=e.alphaTest),e.depthTest!==void 0&&(s.depthTest=e.depthTest),e.depthWrite!==void 0&&(s.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(s.colorWrite=e.colorWrite),e.stencilWrite!==void 0&&(s.stencilWrite=e.stencilWrite),e.stencilWriteMask!==void 0&&(s.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(s.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(s.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(s.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(s.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(s.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(s.stencilZPass=e.stencilZPass),e.wireframe!==void 0&&(s.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(s.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(s.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(s.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(s.rotation=e.rotation),e.linewidth!==1&&(s.linewidth=e.linewidth),e.dashSize!==void 0&&(s.dashSize=e.dashSize),e.gapSize!==void 0&&(s.gapSize=e.gapSize),e.scale!==void 0&&(s.scale=e.scale),e.polygonOffset!==void 0&&(s.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(s.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(s.polygonOffsetUnits=e.polygonOffsetUnits),e.skinning!==void 0&&(s.skinning=e.skinning),e.morphTargets!==void 0&&(s.morphTargets=e.morphTargets),e.morphNormals!==void 0&&(s.morphNormals=e.morphNormals),e.dithering!==void 0&&(s.dithering=e.dithering),e.vertexTangents!==void 0&&(s.vertexTangents=e.vertexTangents),e.visible!==void 0&&(s.visible=e.visible),e.toneMapped!==void 0&&(s.toneMapped=e.toneMapped),e.userData!==void 0&&(s.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?s.vertexColors=e.vertexColors>0:s.vertexColors=e.vertexColors),e.uniforms!==void 0)for(var l in e.uniforms){var f=e.uniforms[l];switch(s.uniforms[l]={},f.type){case"t":s.uniforms[l].value=t(f.value);break;case"c":s.uniforms[l].value=new mi().setHex(f.value);break;case"v2":s.uniforms[l].value=new bn().fromArray(f.value);break;case"v3":s.uniforms[l].value=new pe().fromArray(f.value);break;case"v4":s.uniforms[l].value=new ps().fromArray(f.value);break;case"m3":s.uniforms[l].value=new qa().fromArray(f.value);break;case"m4":s.uniforms[l].value=new wr().fromArray(f.value);break;default:s.uniforms[l].value=f.value}}if(e.defines!==void 0&&(s.defines=e.defines),e.vertexShader!==void 0&&(s.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(s.fragmentShader=e.fragmentShader),e.extensions!==void 0)for(var v in e.extensions)s.extensions[v]=e.extensions[v];if(e.shading!==void 0&&(s.flatShading=e.shading===1),e.size!==void 0&&(s.size=e.size),e.sizeAttenuation!==void 0&&(s.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(s.map=t(e.map)),e.matcap!==void 0&&(s.matcap=t(e.matcap)),e.alphaMap!==void 0&&(s.alphaMap=t(e.alphaMap)),e.bumpMap!==void 0&&(s.bumpMap=t(e.bumpMap)),e.bumpScale!==void 0&&(s.bumpScale=e.bumpScale),e.normalMap!==void 0&&(s.normalMap=t(e.normalMap)),e.normalMapType!==void 0&&(s.normalMapType=e.normalMapType),e.normalScale!==void 0){var x=e.normalScale;Array.isArray(x)===!1&&(x=[x,x]),s.normalScale=new bn().fromArray(x)}return e.displacementMap!==void 0&&(s.displacementMap=t(e.displacementMap)),e.displacementScale!==void 0&&(s.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(s.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(s.roughnessMap=t(e.roughnessMap)),e.metalnessMap!==void 0&&(s.metalnessMap=t(e.metalnessMap)),e.emissiveMap!==void 0&&(s.emissiveMap=t(e.emissiveMap)),e.emissiveIntensity!==void 0&&(s.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(s.specularMap=t(e.specularMap)),e.envMap!==void 0&&(s.envMap=t(e.envMap)),e.envMapIntensity!==void 0&&(s.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(s.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(s.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(s.lightMap=t(e.lightMap)),e.lightMapIntensity!==void 0&&(s.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(s.aoMap=t(e.aoMap)),e.aoMapIntensity!==void 0&&(s.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(s.gradientMap=t(e.gradientMap)),e.clearcoatMap!==void 0&&(s.clearcoatMap=t(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(s.clearcoatRoughnessMap=t(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(s.clearcoatNormalMap=t(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(s.clearcoatNormalScale=new bn().fromArray(e.clearcoatNormalScale)),e.transmission!==void 0&&(s.transmission=e.transmission),e.transmissionMap!==void 0&&(s.transmissionMap=t(e.transmissionMap)),s},setTextures:function(e){return this.textures=e,this}});var DM={decodeText:function(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);for(var a="",t=0,s=e.length;t<s;t++)a+=String.fromCharCode(e[t]);try{return decodeURIComponent(escape(a))}catch{return a}},extractUrlBase:function(e){var a=e.lastIndexOf("/");return a===-1?"./":e.substr(0,a+1)}};function Iv(){qe.call(this),this.type="InstancedBufferGeometry",this.instanceCount=1/0}Iv.prototype=Object.assign(Object.create(qe.prototype),{constructor:Iv,isInstancedBufferGeometry:!0,copy:function(e){return qe.prototype.copy.call(this,e),this.instanceCount=e.instanceCount,this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){var e=qe.prototype.toJSON.call(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}});function Wx(e,a,t,s){typeof t=="number"&&(s=t,t=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),qi.call(this,e,a,t),this.meshPerAttribute=s||1}Wx.prototype=Object.assign(Object.create(qi.prototype),{constructor:Wx,isInstancedBufferAttribute:!0,copy:function(e){return qi.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},toJSON:function(){var e=qi.prototype.toJSON.call(this);return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}});function Xx(e){bs.call(this,e)}Xx.prototype=Object.assign(Object.create(bs.prototype),{constructor:Xx,load:function(e,a,t,s){var l=this,f=new Nl(l.manager);f.setPath(l.path),f.setRequestHeader(l.requestHeader),f.setWithCredentials(l.withCredentials),f.load(e,function(v){try{a(l.parse(JSON.parse(v)))}catch(x){s?s(x):console.error(x),l.manager.itemError(e)}},t,s)},parse:function(e){var a={},t={};function s(Bt,fn){if(a[fn]!==void 0)return a[fn];var un=Bt.interleavedBuffers,Qt=un[fn],Sn=l(Bt,Qt.buffer),ai=new qx[Qt.type](Sn),ei=new cl(ai,Qt.stride);return ei.uuid=Qt.uuid,a[fn]=ei,ei}function l(Bt,fn){if(t[fn]!==void 0)return t[fn];var un=Bt.arrayBuffers,Qt=un[fn],Sn=new Uint32Array(Qt).buffer;return t[fn]=Sn,Sn}var f=e.isInstancedBufferGeometry?new Iv:new qe,v=e.data.index;if(v!==void 0){var x=new qx[v.type](v.array);f.setIndex(new qi(x,1))}var w=e.data.attributes;for(var E in w){var P=w[E],R=void 0;if(P.isInterleavedBufferAttribute){var V=s(e.data,P.data);R=new lf(V,P.itemSize,P.offset,P.normalized)}else{var H=new qx[P.type](P.array),q=P.isInstancedBufferAttribute?Wx:qi;R=new q(H,P.itemSize,P.normalized)}P.name!==void 0&&(R.name=P.name),f.setAttribute(E,R)}var z=e.data.morphAttributes;if(z)for(var G in z){for(var ie=z[G],le=[],ae=0,J=ie.length;ae<J;ae++){var se=ie[ae],ge=void 0;if(se.isInterleavedBufferAttribute){var _e=s(e.data,se.data);ge=new lf(_e,se.itemSize,se.offset,se.normalized)}else{var We=new qx[se.type](se.array);ge=new qi(We,se.itemSize,se.normalized)}se.name!==void 0&&(ge.name=se.name),le.push(ge)}f.morphAttributes[G]=le}var nt=e.data.morphTargetsRelative;nt&&(f.morphTargetsRelative=!0);var Me=e.data.groups||e.data.drawcalls||e.data.offsets;if(Me!==void 0)for(var be=0,ve=Me.length;be!==ve;++be){var Ze=Me[be];f.addGroup(Ze.start,Ze.count,Ze.materialIndex)}var Ke=e.data.boundingSphere;if(Ke!==void 0){var Qe=new pe;Ke.center!==void 0&&Qe.fromArray(Ke.center),f.boundingSphere=new ro(Qe,Ke.radius)}return e.name&&(f.name=e.name),e.userData&&(f.userData=e.userData),f}});var qx={Int8Array,Uint8Array,Uint8ClampedArray:typeof Uint8ClampedArray<"u"?Uint8ClampedArray:Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array},xC=function(e){Li(a,e);function a(s){return e.call(this,s)||this}var t=a.prototype;return t.load=function(s,l,f,v){var x=this,w=this.path===""?DM.extractUrlBase(s):this.path;this.resourcePath=this.resourcePath||w;var E=new Nl(this.manager);E.setPath(this.path),E.setRequestHeader(this.requestHeader),E.setWithCredentials(this.withCredentials),E.load(s,function(P){var R=null;try{R=JSON.parse(P)}catch(H){v!==void 0&&v(H),console.error("THREE:ObjectLoader: Can't parse "+s+".",H.message);return}var V=R.metadata;if(V===void 0||V.type===void 0||V.type.toLowerCase()==="geometry"){console.error("THREE.ObjectLoader: Can't load "+s);return}x.parse(R,l)},f,v)},t.parse=function(s,l){var f=this.parseShape(s.shapes),v=this.parseGeometries(s.geometries,f),x=this.parseImages(s.images,function(){l!==void 0&&l(P)}),w=this.parseTextures(s.textures,x),E=this.parseMaterials(s.materials,w),P=this.parseObject(s.object,v,E);return s.animations&&(P.animations=this.parseAnimations(s.animations)),(s.images===void 0||s.images.length===0)&&l!==void 0&&l(P),P},t.parseShape=function(s){var l={};if(s!==void 0)for(var f=0,v=s.length;f<v;f++){var x=new df().fromJSON(s[f]);l[x.uuid]=x}return l},t.parseGeometries=function(s,l){var f={},v;if(s!==void 0)for(var x=new Xx,w=0,E=s.length;w<E;w++){var P=void 0,R=s[w];switch(R.type){case"PlaneGeometry":case"PlaneBufferGeometry":P=new To[R.type](R.width,R.height,R.widthSegments,R.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":P=new To[R.type](R.width,R.height,R.depth,R.widthSegments,R.heightSegments,R.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":P=new To[R.type](R.radius,R.segments,R.thetaStart,R.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":P=new To[R.type](R.radiusTop,R.radiusBottom,R.height,R.radialSegments,R.heightSegments,R.openEnded,R.thetaStart,R.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":P=new To[R.type](R.radius,R.height,R.radialSegments,R.heightSegments,R.openEnded,R.thetaStart,R.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":P=new To[R.type](R.radius,R.widthSegments,R.heightSegments,R.phiStart,R.phiLength,R.thetaStart,R.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":P=new To[R.type](R.radius,R.detail);break;case"RingGeometry":case"RingBufferGeometry":P=new To[R.type](R.innerRadius,R.outerRadius,R.thetaSegments,R.phiSegments,R.thetaStart,R.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":P=new To[R.type](R.radius,R.tube,R.radialSegments,R.tubularSegments,R.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":P=new To[R.type](R.radius,R.tube,R.tubularSegments,R.radialSegments,R.p,R.q);break;case"TubeGeometry":case"TubeBufferGeometry":P=new To[R.type](new LM[R.path.type]().fromJSON(R.path),R.tubularSegments,R.radius,R.radialSegments,R.closed);break;case"LatheGeometry":case"LatheBufferGeometry":P=new To[R.type](R.points,R.segments,R.phiStart,R.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":P=new To[R.type](R.vertices,R.indices,R.radius,R.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":v=[];for(var V=0,H=R.shapes.length;V<H;V++){var q=l[R.shapes[V]];v.push(q)}P=new To[R.type](v,R.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":v=[];for(var z=0,G=R.shapes.length;z<G;z++){var ie=l[R.shapes[z]];v.push(ie)}var le=R.options.extrudePath;le!==void 0&&(R.options.extrudePath=new LM[le.type]().fromJSON(le)),P=new To[R.type](v,R.options);break;case"BufferGeometry":case"InstancedBufferGeometry":P=x.parse(R);break;case"Geometry":console.error('THREE.ObjectLoader: Loading "Geometry" is not supported anymore.');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+R.type+'"');continue}P.uuid=R.uuid,R.name!==void 0&&(P.name=R.name),P.isBufferGeometry===!0&&R.userData!==void 0&&(P.userData=R.userData),f[R.uuid]=P}return f},t.parseMaterials=function(s,l){var f={},v={};if(s!==void 0){var x=new Vx;x.setTextures(l);for(var w=0,E=s.length;w<E;w++){var P=s[w];if(P.type==="MultiMaterial"){for(var R=[],V=0;V<P.materials.length;V++){var H=P.materials[V];f[H.uuid]===void 0&&(f[H.uuid]=x.parse(H)),R.push(f[H.uuid])}v[P.uuid]=R}else f[P.uuid]===void 0&&(f[P.uuid]=x.parse(P)),v[P.uuid]=f[P.uuid]}}return v},t.parseAnimations=function(s){for(var l=[],f=0;f<s.length;f++){var v=s[f],x=Il.parse(v);v.uuid!==void 0&&(x.uuid=v.uuid),l.push(x)}return l},t.parseImages=function(s,l){var f=this,v={},x;function w(ae){return f.manager.itemStart(ae),x.load(ae,function(){f.manager.itemEnd(ae)},void 0,function(){f.manager.itemError(ae),f.manager.itemEnd(ae)})}if(s!==void 0&&s.length>0){var E=new bM(l);x=new vm(E),x.setCrossOrigin(this.crossOrigin);for(var P=0,R=s.length;P<R;P++){var V=s[P],H=V.url;if(Array.isArray(H)){v[V.uuid]=[];for(var q=0,z=H.length;q<z;q++){var G=H[q],ie=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(G)?G:f.resourcePath+G;v[V.uuid].push(w(ie))}}else{var le=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(V.url)?V.url:f.resourcePath+V.url;v[V.uuid]=w(le)}}}return v},t.parseTextures=function(s,l){function f(R,V){return typeof R=="number"?R:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",R),V[R])}var v={};if(s!==void 0)for(var x=0,w=s.length;x<w;x++){var E=s[x];E.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',E.uuid),l[E.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",E.image);var P=void 0;Array.isArray(l[E.image])?P=new ru(l[E.image]):P=new ds(l[E.image]),P.needsUpdate=!0,P.uuid=E.uuid,E.name!==void 0&&(P.name=E.name),E.mapping!==void 0&&(P.mapping=f(E.mapping,_C)),E.offset!==void 0&&P.offset.fromArray(E.offset),E.repeat!==void 0&&P.repeat.fromArray(E.repeat),E.center!==void 0&&P.center.fromArray(E.center),E.rotation!==void 0&&(P.rotation=E.rotation),E.wrap!==void 0&&(P.wrapS=f(E.wrap[0],uE),P.wrapT=f(E.wrap[1],uE)),E.format!==void 0&&(P.format=E.format),E.type!==void 0&&(P.type=E.type),E.encoding!==void 0&&(P.encoding=E.encoding),E.minFilter!==void 0&&(P.minFilter=f(E.minFilter,hE)),E.magFilter!==void 0&&(P.magFilter=f(E.magFilter,hE)),E.anisotropy!==void 0&&(P.anisotropy=E.anisotropy),E.flipY!==void 0&&(P.flipY=E.flipY),E.premultiplyAlpha!==void 0&&(P.premultiplyAlpha=E.premultiplyAlpha),E.unpackAlignment!==void 0&&(P.unpackAlignment=E.unpackAlignment),v[E.uuid]=P}return v},t.parseObject=function(s,l,f){var v;function x(ae){return l[ae]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",ae),l[ae]}function w(ae){if(ae!==void 0){if(Array.isArray(ae)){for(var J=[],se=0,ge=ae.length;se<ge;se++){var _e=ae[se];f[_e]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",_e),J.push(f[_e])}return J}return f[ae]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",ae),f[ae]}}var E,P;switch(s.type){case"Scene":v=new Yw,s.background!==void 0&&Number.isInteger(s.background)&&(v.background=new mi(s.background)),s.fog!==void 0&&(s.fog.type==="Fog"?v.fog=new A1(s.fog.color,s.fog.near,s.fog.far):s.fog.type==="FogExp2"&&(v.fog=new T1(s.fog.color,s.fog.density)));break;case"PerspectiveCamera":v=new Ms(s.fov,s.aspect,s.near,s.far),s.focus!==void 0&&(v.focus=s.focus),s.zoom!==void 0&&(v.zoom=s.zoom),s.filmGauge!==void 0&&(v.filmGauge=s.filmGauge),s.filmOffset!==void 0&&(v.filmOffset=s.filmOffset),s.view!==void 0&&(v.view=Object.assign({},s.view));break;case"OrthographicCamera":v=new xm(s.left,s.right,s.top,s.bottom,s.near,s.far),s.zoom!==void 0&&(v.zoom=s.zoom),s.view!==void 0&&(v.view=Object.assign({},s.view));break;case"AmbientLight":v=new Hx(s.color,s.intensity);break;case"DirectionalLight":v=new Ux(s.color,s.intensity);break;case"PointLight":v=new zx(s.color,s.intensity,s.distance,s.decay);break;case"RectAreaLight":v=new Gx(s.color,s.intensity,s.width,s.height);break;case"SpotLight":v=new kx(s.color,s.intensity,s.distance,s.angle,s.penumbra,s.decay);break;case"HemisphereLight":v=new Bx(s.color,s.groundColor,s.intensity);break;case"LightProbe":v=new Fl().fromJSON(s);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":E=x(s.geometry),P=w(s.material),v=new xr(E,P);break;case"InstancedMesh":E=x(s.geometry),P=w(s.material);var R=s.count,V=s.instanceMatrix;v=new hx(E,P,R),v.instanceMatrix=new qi(new Float32Array(V.array),16);break;case"LOD":v=new _v;break;case"Line":v=new Ol(x(s.geometry),w(s.material),s.mode);break;case"LineLoop":v=new gx(x(s.geometry),w(s.material));break;case"LineSegments":v=new Eo(x(s.geometry),w(s.material));break;case"PointCloud":case"Points":v=new um(x(s.geometry),w(s.material));break;case"Sprite":v=new xv(w(s.material));break;case"Group":v=new of;break;default:v=new Ei}if(v.uuid=s.uuid,s.name!==void 0&&(v.name=s.name),s.matrix!==void 0?(v.matrix.fromArray(s.matrix),s.matrixAutoUpdate!==void 0&&(v.matrixAutoUpdate=s.matrixAutoUpdate),v.matrixAutoUpdate&&v.matrix.decompose(v.position,v.quaternion,v.scale)):(s.position!==void 0&&v.position.fromArray(s.position),s.rotation!==void 0&&v.rotation.fromArray(s.rotation),s.quaternion!==void 0&&v.quaternion.fromArray(s.quaternion),s.scale!==void 0&&v.scale.fromArray(s.scale)),s.castShadow!==void 0&&(v.castShadow=s.castShadow),s.receiveShadow!==void 0&&(v.receiveShadow=s.receiveShadow),s.shadow&&(s.shadow.bias!==void 0&&(v.shadow.bias=s.shadow.bias),s.shadow.normalBias!==void 0&&(v.shadow.normalBias=s.shadow.normalBias),s.shadow.radius!==void 0&&(v.shadow.radius=s.shadow.radius),s.shadow.mapSize!==void 0&&v.shadow.mapSize.fromArray(s.shadow.mapSize),s.shadow.camera!==void 0&&(v.shadow.camera=this.parseObject(s.shadow.camera))),s.visible!==void 0&&(v.visible=s.visible),s.frustumCulled!==void 0&&(v.frustumCulled=s.frustumCulled),s.renderOrder!==void 0&&(v.renderOrder=s.renderOrder),s.userData!==void 0&&(v.userData=s.userData),s.layers!==void 0&&(v.layers.mask=s.layers),s.children!==void 0)for(var H=s.children,q=0;q<H.length;q++)v.add(this.parseObject(H[q],l,f));if(s.type==="LOD"){s.autoUpdate!==void 0&&(v.autoUpdate=s.autoUpdate);for(var z=s.levels,G=0;G<z.length;G++){var ie=z[G],le=v.getObjectByProperty("uuid",ie.object);le!==void 0&&v.addLevel(le,ie.distance)}}return v},t.setTexturePath=function(s){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(s)},a}(bs),_C={UVMapping:ue,CubeReflectionMapping:oe,CubeRefractionMapping:lt,EquirectangularReflectionMapping:yt,EquirectangularRefractionMapping:Ce,CubeUVReflectionMapping:Pt,CubeUVRefractionMapping:Kt},uE={RepeatWrapping:qn,ClampToEdgeWrapping:xn,MirroredRepeatWrapping:Oe},hE={NearestFilter:Ht,NearestMipmapNearestFilter:Kn,NearestMipmapLinearFilter:hn,LinearFilter:jn,LinearMipmapNearestFilter:er,LinearMipmapLinearFilter:ts};function OM(e){typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),bs.call(this,e),this.options={premultiplyAlpha:"none"}}OM.prototype=Object.assign(Object.create(bs.prototype),{constructor:OM,isImageBitmapLoader:!0,setOptions:function(e){return this.options=e,this},load:function(e,a,t,s){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);var l=this,f=Ed.get(e);if(f!==void 0)return l.manager.itemStart(e),setTimeout(function(){a&&a(f),l.manager.itemEnd(e)},0),f;var v={};v.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",fetch(e,v).then(function(x){return x.blob()}).then(function(x){return createImageBitmap(x,l.options)}).then(function(x){Ed.add(e,x),a&&a(x),l.manager.itemEnd(e)}).catch(function(x){s&&s(x),l.manager.itemError(e),l.manager.itemEnd(e)}),l.manager.itemStart(e)}});function IM(){this.type="ShapePath",this.color=new mi,this.subPaths=[],this.currentPath=null}Object.assign(IM.prototype,{moveTo:function(e,a){return this.currentPath=new xc,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,a),this},lineTo:function(e,a){return this.currentPath.lineTo(e,a),this},quadraticCurveTo:function(e,a,t,s){return this.currentPath.quadraticCurveTo(e,a,t,s),this},bezierCurveTo:function(e,a,t,s,l,f){return this.currentPath.bezierCurveTo(e,a,t,s,l,f),this},splineThru:function(e){return this.currentPath.splineThru(e),this},toShapes:function(e,a){function t(un){for(var Qt=[],Sn=0,ai=un.length;Sn<ai;Sn++){var ei=un[Sn],Pi=new df;Pi.curves=ei.curves,Qt.push(Pi)}return Qt}function s(un,Qt){for(var Sn=Qt.length,ai=!1,ei=Sn-1,Pi=0;Pi<Sn;ei=Pi++){var Hi=Qt[ei],on=Qt[Pi],_r=on.x-Hi.x,pr=on.y-Hi.y;if(Math.abs(pr)>Number.EPSILON){if(pr<0&&(Hi=Qt[Pi],_r=-_r,on=Qt[ei],pr=-pr),un.y<Hi.y||un.y>on.y)continue;if(un.y===Hi.y){if(un.x===Hi.x)return!0}else{var Zi=pr*(un.x-Hi.x)-_r*(un.y-Hi.y);if(Zi===0)return!0;if(Zi<0)continue;ai=!ai}}else{if(un.y!==Hi.y)continue;if(on.x<=un.x&&un.x<=Hi.x||Hi.x<=un.x&&un.x<=on.x)return!0}}return ai}var l=Ku.isClockWise,f=this.subPaths;if(f.length===0)return[];if(a===!0)return t(f);var v,x,w,E=[];if(f.length===1)return x=f[0],w=new df,w.curves=x.curves,E.push(w),E;var P=!l(f[0].getPoints());P=e?!P:P;var R=[],V=[],H=[],q=0,z;V[q]=void 0,H[q]=[];for(var G=0,ie=f.length;G<ie;G++)x=f[G],z=x.getPoints(),v=l(z),v=e?!v:v,v?(!P&&V[q]&&q++,V[q]={s:new df,p:z},V[q].s.curves=x.curves,P&&q++,H[q]=[]):H[q].push({h:x,p:z[0]});if(!V[0])return t(f);if(V.length>1){for(var le=!1,ae=[],J=0,se=V.length;J<se;J++)R[J]=[];for(var ge=0,_e=V.length;ge<_e;ge++)for(var We=H[ge],nt=0;nt<We.length;nt++){for(var Me=We[nt],be=!0,ve=0;ve<V.length;ve++)s(Me.p,V[ve].p)&&(ge!==ve&&ae.push({froms:ge,tos:ve,hole:nt}),be?(be=!1,R[ve].push(Me)):le=!0);be&&R[ge].push(Me)}ae.length>0&&(le||(H=R))}for(var Ze,Ke=0,Qe=V.length;Ke<Qe;Ke++){w=V[Ke].s,E.push(w),Ze=H[Ke];for(var Bt=0,fn=Ze.length;Bt<fn;Bt++)w.holes.push(Ze[Bt].h)}return E}});function NM(e){this.type="Font",this.data=e}Object.assign(NM.prototype,{isFont:!0,generateShapes:function(e,a){a===void 0&&(a=100);for(var t=[],s=bC(e,a,this.data),l=0,f=s.length;l<f;l++)Array.prototype.push.apply(t,s[l].toShapes());return t}});function bC(e,a,t){for(var s=Array.from?Array.from(e):String(e).split(""),l=a/t.resolution,f=(t.boundingBox.yMax-t.boundingBox.yMin+t.underlineThickness)*l,v=[],x=0,w=0,E=0;E<s.length;E++){var P=s[E];if(P===`
`)x=0,w-=f;else{var R=wC(P,l,x,w,t);x+=R.offsetX,v.push(R.path)}}return v}function wC(e,a,t,s,l){var f=l.glyphs[e]||l.glyphs["?"];if(!f){console.error('THREE.Font: character "'+e+'" does not exists in font family '+l.familyName+".");return}var v=new IM,x,w,E,P,R,V,H,q;if(f.o)for(var z=f._cachedOutline||(f._cachedOutline=f.o.split(" ")),G=0,ie=z.length;G<ie;){var le=z[G++];switch(le){case"m":x=z[G++]*a+t,w=z[G++]*a+s,v.moveTo(x,w);break;case"l":x=z[G++]*a+t,w=z[G++]*a+s,v.lineTo(x,w);break;case"q":E=z[G++]*a+t,P=z[G++]*a+s,R=z[G++]*a+t,V=z[G++]*a+s,v.quadraticCurveTo(R,V,E,P);break;case"b":E=z[G++]*a+t,P=z[G++]*a+s,R=z[G++]*a+t,V=z[G++]*a+s,H=z[G++]*a+t,q=z[G++]*a+s,v.bezierCurveTo(R,V,H,q,E,P);break}}return{offsetX:f.ha*a,path:v}}function FM(e){bs.call(this,e)}FM.prototype=Object.assign(Object.create(bs.prototype),{constructor:FM,load:function(e,a,t,s){var l=this,f=new Nl(this.manager);f.setPath(this.path),f.setRequestHeader(this.requestHeader),f.setWithCredentials(l.withCredentials),f.load(e,function(v){var x;try{x=JSON.parse(v)}catch{console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),x=JSON.parse(v.substring(65,v.length-2))}var w=l.parse(x);a&&a(w)},t,s)},parse:function(e){return new NM(e)}});var jx,BM={getContext:function(){return jx===void 0&&(jx=new(window.AudioContext||window.webkitAudioContext)),jx},setContext:function(e){jx=e}};function Yx(e){bs.call(this,e)}Yx.prototype=Object.assign(Object.create(bs.prototype),{constructor:Yx,load:function(e,a,t,s){var l=this,f=new Nl(l.manager);f.setResponseType("arraybuffer"),f.setPath(l.path),f.setRequestHeader(l.requestHeader),f.setWithCredentials(l.withCredentials),f.load(e,function(v){try{var x=v.slice(0),w=BM.getContext();w.decodeAudioData(x,function(E){a(E)})}catch(E){s?s(E):console.error(E),l.manager.itemError(e)}},t,s)}});function kM(e,a,t){Fl.call(this,void 0,t);var s=new mi().set(e),l=new mi().set(a),f=new pe(s.r,s.g,s.b),v=new pe(l.r,l.g,l.b),x=Math.sqrt(Math.PI),w=x*Math.sqrt(.75);this.sh.coefficients[0].copy(f).add(v).multiplyScalar(x),this.sh.coefficients[1].copy(f).sub(v).multiplyScalar(w)}kM.prototype=Object.assign(Object.create(Fl.prototype),{constructor:kM,isHemisphereLightProbe:!0,copy:function(e){return Fl.prototype.copy.call(this,e),this},toJSON:function(e){var a=Fl.prototype.toJSON.call(this,e);return a}});function zM(e,a){Fl.call(this,void 0,a);var t=new mi().set(e);this.sh.coefficients[0].set(t.r,t.g,t.b).multiplyScalar(2*Math.sqrt(Math.PI))}zM.prototype=Object.assign(Object.create(Fl.prototype),{constructor:zM,isAmbientLightProbe:!0,copy:function(e){return Fl.prototype.copy.call(this,e),this},toJSON:function(e){var a=Fl.prototype.toJSON.call(this,e);return a}});var fE=new wr,dE=new wr;function pE(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Ms,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Ms,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}Object.assign(pE.prototype,{update:function(e){var a=this._cache,t=a.focus!==e.focus||a.fov!==e.fov||a.aspect!==e.aspect*this.aspect||a.near!==e.near||a.far!==e.far||a.zoom!==e.zoom||a.eyeSep!==this.eyeSep;if(t){a.focus=e.focus,a.fov=e.fov,a.aspect=e.aspect*this.aspect,a.near=e.near,a.far=e.far,a.zoom=e.zoom,a.eyeSep=this.eyeSep;var s=e.projectionMatrix.clone(),l=a.eyeSep/2,f=l*a.near/a.focus,v=a.near*Math.tan(nr.DEG2RAD*a.fov*.5)/a.zoom,x,w;dE.elements[12]=-l,fE.elements[12]=l,x=-v*a.aspect+f,w=v*a.aspect+f,s.elements[0]=2*a.near/(w-x),s.elements[8]=(w+x)/(w-x),this.cameraL.projectionMatrix.copy(s),x=-v*a.aspect-f,w=v*a.aspect-f,s.elements[0]=2*a.near/(w-x),s.elements[8]=(w+x)/(w-x),this.cameraR.projectionMatrix.copy(s)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(dE),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(fE)}});var mE=function(){function e(t){this.autoStart=t!==void 0?t:!0,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}var a=e.prototype;return a.start=function(){this.startTime=(typeof performance>"u"?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},a.stop=function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},a.getElapsedTime=function(){return this.getDelta(),this.elapsedTime},a.getDelta=function(){var t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var s=(typeof performance>"u"?Date:performance).now();t=(s-this.oldTime)/1e3,this.oldTime=s,this.elapsedTime+=t}return t},e}(),Td=new pe,gE=new ka,MC=new pe,Ad=new pe,SC=function(e){Li(a,e);function a(){var s=e.call(this)||this;return s.type="AudioListener",s.context=BM.getContext(),s.gain=s.context.createGain(),s.gain.connect(s.context.destination),s.filter=null,s.timeDelta=0,s._clock=new mE,s}var t=a.prototype;return t.getInput=function(){return this.gain},t.removeFilter=function(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},t.getFilter=function(){return this.filter},t.setFilter=function(s){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=s,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},t.getMasterVolume=function(){return this.gain.gain.value},t.setMasterVolume=function(s){return this.gain.gain.setTargetAtTime(s,this.context.currentTime,.01),this},t.updateMatrixWorld=function(s){e.prototype.updateMatrixWorld.call(this,s);var l=this.context.listener,f=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Td,gE,MC),Ad.set(0,0,-1).applyQuaternion(gE),l.positionX){var v=this.context.currentTime+this.timeDelta;l.positionX.linearRampToValueAtTime(Td.x,v),l.positionY.linearRampToValueAtTime(Td.y,v),l.positionZ.linearRampToValueAtTime(Td.z,v),l.forwardX.linearRampToValueAtTime(Ad.x,v),l.forwardY.linearRampToValueAtTime(Ad.y,v),l.forwardZ.linearRampToValueAtTime(Ad.z,v),l.upX.linearRampToValueAtTime(f.x,v),l.upY.linearRampToValueAtTime(f.y,v),l.upZ.linearRampToValueAtTime(f.z,v)}else l.setPosition(Td.x,Td.y,Td.z),l.setOrientation(Ad.x,Ad.y,Ad.z,f.x,f.y,f.z)},a}(Ei),UM=function(e){Li(a,e);function a(s){var l=e.call(this)||this;return l.type="Audio",l.listener=s,l.context=s.context,l.gain=l.context.createGain(),l.gain.connect(s.getInput()),l.autoplay=!1,l.buffer=null,l.detune=0,l.loop=!1,l.loopStart=0,l.loopEnd=0,l.offset=0,l.duration=void 0,l.playbackRate=1,l.isPlaying=!1,l.hasPlaybackControl=!0,l.source=null,l.sourceType="empty",l._startedAt=0,l._progress=0,l._connected=!1,l.filters=[],l}var t=a.prototype;return t.getOutput=function(){return this.gain},t.setNodeSource=function(s){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=s,this.connect(),this},t.setMediaElementSource=function(s){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(s),this.connect(),this},t.setMediaStreamSource=function(s){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(s),this.connect(),this},t.setBuffer=function(s){return this.buffer=s,this.sourceType="buffer",this.autoplay&&this.play(),this},t.play=function(s){if(s===void 0&&(s=0),this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+s;var l=this.context.createBufferSource();return l.buffer=this.buffer,l.loop=this.loop,l.loopStart=this.loopStart,l.loopEnd=this.loopEnd,l.onended=this.onEnded.bind(this),l.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=l,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()},t.pause=function(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this},t.stop=function(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this},t.connect=function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var s=1,l=this.filters.length;s<l;s++)this.filters[s-1].connect(this.filters[s]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this},t.disconnect=function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var s=1,l=this.filters.length;s<l;s++)this.filters[s-1].disconnect(this.filters[s]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this},t.getFilters=function(){return this.filters},t.setFilters=function(s){return s||(s=[]),this._connected===!0?(this.disconnect(),this.filters=s,this.connect()):this.filters=s,this},t.setDetune=function(s){if(this.detune=s,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},t.getDetune=function(){return this.detune},t.getFilter=function(){return this.getFilters()[0]},t.setFilter=function(s){return this.setFilters(s?[s]:[])},t.setPlaybackRate=function(s){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=s,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this},t.getPlaybackRate=function(){return this.playbackRate},t.onEnded=function(){this.isPlaying=!1},t.getLoop=function(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},t.setLoop=function(s){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=s,this.isPlaying===!0&&(this.source.loop=this.loop),this},t.setLoopStart=function(s){return this.loopStart=s,this},t.setLoopEnd=function(s){return this.loopEnd=s,this},t.getVolume=function(){return this.gain.gain.value},t.setVolume=function(s){return this.gain.gain.setTargetAtTime(s,this.context.currentTime,.01),this},a}(Ei),Ld=new pe,vE=new ka,EC=new pe,Cd=new pe,TC=function(e){Li(a,e);function a(s){var l=e.call(this,s)||this;return l.panner=l.context.createPanner(),l.panner.panningModel="HRTF",l.panner.connect(l.gain),l}var t=a.prototype;return t.getOutput=function(){return this.panner},t.getRefDistance=function(){return this.panner.refDistance},t.setRefDistance=function(s){return this.panner.refDistance=s,this},t.getRolloffFactor=function(){return this.panner.rolloffFactor},t.setRolloffFactor=function(s){return this.panner.rolloffFactor=s,this},t.getDistanceModel=function(){return this.panner.distanceModel},t.setDistanceModel=function(s){return this.panner.distanceModel=s,this},t.getMaxDistance=function(){return this.panner.maxDistance},t.setMaxDistance=function(s){return this.panner.maxDistance=s,this},t.setDirectionalCone=function(s,l,f){return this.panner.coneInnerAngle=s,this.panner.coneOuterAngle=l,this.panner.coneOuterGain=f,this},t.updateMatrixWorld=function(s){if(e.prototype.updateMatrixWorld.call(this,s),!(this.hasPlaybackControl===!0&&this.isPlaying===!1)){this.matrixWorld.decompose(Ld,vE,EC),Cd.set(0,0,1).applyQuaternion(vE);var l=this.panner;if(l.positionX){var f=this.context.currentTime+this.listener.timeDelta;l.positionX.linearRampToValueAtTime(Ld.x,f),l.positionY.linearRampToValueAtTime(Ld.y,f),l.positionZ.linearRampToValueAtTime(Ld.z,f),l.orientationX.linearRampToValueAtTime(Cd.x,f),l.orientationY.linearRampToValueAtTime(Cd.y,f),l.orientationZ.linearRampToValueAtTime(Cd.z,f)}else l.setPosition(Ld.x,Ld.y,Ld.z),l.setOrientation(Cd.x,Cd.y,Cd.z)}},a}(UM),yE=function(){function e(t,s){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=s!==void 0?s:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}var a=e.prototype;return a.getFrequencyData=function(){return this.analyser.getByteFrequencyData(this.data),this.data},a.getAverageFrequency=function(){for(var t=0,s=this.getFrequencyData(),l=0;l<s.length;l++)t+=s[l];return t/s.length},e}();function HM(e,a,t){this.binding=e,this.valueSize=t;var s,l,f;switch(a){case"quaternion":s=this._slerp,l=this._slerpAdditive,f=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(t*6),this._workIndex=5;break;case"string":case"bool":s=this._select,l=this._select,f=this._setAdditiveIdentityOther,this.buffer=new Array(t*5);break;default:s=this._lerp,l=this._lerpAdditive,f=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(t*5)}this._mixBufferRegion=s,this._mixBufferRegionAdditive=l,this._setIdentity=f,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}Object.assign(HM.prototype,{accumulate:function(e,a){var t=this.buffer,s=this.valueSize,l=e*s+s,f=this.cumulativeWeight;if(f===0){for(var v=0;v!==s;++v)t[l+v]=t[v];f=a}else{f+=a;var x=a/f;this._mixBufferRegion(t,l,0,x,s)}this.cumulativeWeight=f},accumulateAdditive:function(e){var a=this.buffer,t=this.valueSize,s=t*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(a,s,0,e,t),this.cumulativeWeightAdditive+=e},apply:function(e){var a=this.valueSize,t=this.buffer,s=e*a+a,l=this.cumulativeWeight,f=this.cumulativeWeightAdditive,v=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,l<1){var x=a*this._origIndex;this._mixBufferRegion(t,s,x,1-l,a)}f>0&&this._mixBufferRegionAdditive(t,s,this._addIndex*a,1,a);for(var w=a;w!==a+a;++w)if(t[w]!==t[w+a]){v.setValue(t,s);break}},saveOriginalState:function(){var e=this.binding,a=this.buffer,t=this.valueSize,s=t*this._origIndex;e.getValue(a,s);for(var l=t;l!==s;++l)a[l]=a[s+l%t];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0},restoreOriginalState:function(){var e=this.valueSize*3;this.binding.setValue(this.buffer,e)},_setAdditiveIdentityNumeric:function(){for(var e=this._addIndex*this.valueSize,a=e+this.valueSize,t=e;t<a;t++)this.buffer[t]=0},_setAdditiveIdentityQuaternion:function(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1},_setAdditiveIdentityOther:function(){for(var e=this._origIndex*this.valueSize,a=this._addIndex*this.valueSize,t=0;t<this.valueSize;t++)this.buffer[a+t]=this.buffer[e+t]},_select:function(e,a,t,s,l){if(s>=.5)for(var f=0;f!==l;++f)e[a+f]=e[t+f]},_slerp:function(e,a,t,s){ka.slerpFlat(e,a,e,a,e,t,s)},_slerpAdditive:function(e,a,t,s,l){var f=this._workIndex*l;ka.multiplyQuaternionsFlat(e,f,e,a,e,t),ka.slerpFlat(e,a,e,a,e,f,s)},_lerp:function(e,a,t,s,l){for(var f=0;f!==l;++f){var v=a+f;e[v]=e[v]*(1-s)+e[t+f]*s}},_lerpAdditive:function(e,a,t,s,l){for(var f=0;f!==l;++f){var v=a+f;e[v]=e[v]+e[t+f]*s}}});var GM="\\[\\]\\.:\\/",AC=new RegExp("["+GM+"]","g"),VM="[^"+GM+"]",LC="[^"+GM.replace("\\.","")+"]",CC=/((?:WC+[\/:])*)/.source.replace("WC",VM),PC=/(WCOD+)?/.source.replace("WCOD",LC),RC=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",VM),DC=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",VM),OC=new RegExp("^"+CC+PC+RC+DC+"$"),IC=["material","materials","bones"];function xE(e,a,t){var s=t||lo.parseTrackName(a);this._targetGroup=e,this._bindings=e.subscribe_(a,s)}Object.assign(xE.prototype,{getValue:function(e,a){this.bind();var t=this._targetGroup.nCachedObjects_,s=this._bindings[t];s!==void 0&&s.getValue(e,a)},setValue:function(e,a){for(var t=this._bindings,s=this._targetGroup.nCachedObjects_,l=t.length;s!==l;++s)t[s].setValue(e,a)},bind:function(){for(var e=this._bindings,a=this._targetGroup.nCachedObjects_,t=e.length;a!==t;++a)e[a].bind()},unbind:function(){for(var e=this._bindings,a=this._targetGroup.nCachedObjects_,t=e.length;a!==t;++a)e[a].unbind()}});function lo(e,a,t){this.path=a,this.parsedPath=t||lo.parseTrackName(a),this.node=lo.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}Object.assign(lo,{Composite:xE,create:function(e,a,t){return e&&e.isAnimationObjectGroup?new lo.Composite(e,a,t):new lo(e,a,t)},sanitizeNodeName:function(e){return e.replace(/\s/g,"_").replace(AC,"")},parseTrackName:function(e){var a=OC.exec(e);if(!a)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var t={nodeName:a[2],objectName:a[3],objectIndex:a[4],propertyName:a[5],propertyIndex:a[6]},s=t.nodeName&&t.nodeName.lastIndexOf(".");if(s!==void 0&&s!==-1){var l=t.nodeName.substring(s+1);IC.indexOf(l)!==-1&&(t.nodeName=t.nodeName.substring(0,s),t.objectName=l)}if(t.propertyName===null||t.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return t},findNode:function(e,a){if(!a||a===""||a==="."||a===-1||a===e.name||a===e.uuid)return e;if(e.skeleton){var t=e.skeleton.getBoneByName(a);if(t!==void 0)return t}if(e.children){var s=function f(v){for(var x=0;x<v.length;x++){var w=v[x];if(w.name===a||w.uuid===a)return w;var E=f(w.children);if(E)return E}return null},l=s(e.children);if(l)return l}return null}}),Object.assign(lo.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,a){e[a]=this.node[this.propertyName]},function(e,a){for(var t=this.resolvedProperty,s=0,l=t.length;s!==l;++s)e[a++]=t[s]},function(e,a){e[a]=this.resolvedProperty[this.propertyIndex]},function(e,a){this.resolvedProperty.toArray(e,a)}],SetterByBindingTypeAndVersioning:[[function(e,a){this.targetObject[this.propertyName]=e[a]},function(e,a){this.targetObject[this.propertyName]=e[a],this.targetObject.needsUpdate=!0},function(e,a){this.targetObject[this.propertyName]=e[a],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,a){for(var t=this.resolvedProperty,s=0,l=t.length;s!==l;++s)t[s]=e[a++]},function(e,a){for(var t=this.resolvedProperty,s=0,l=t.length;s!==l;++s)t[s]=e[a++];this.targetObject.needsUpdate=!0},function(e,a){for(var t=this.resolvedProperty,s=0,l=t.length;s!==l;++s)t[s]=e[a++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,a){this.resolvedProperty[this.propertyIndex]=e[a]},function(e,a){this.resolvedProperty[this.propertyIndex]=e[a],this.targetObject.needsUpdate=!0},function(e,a){this.resolvedProperty[this.propertyIndex]=e[a],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,a){this.resolvedProperty.fromArray(e,a)},function(e,a){this.resolvedProperty.fromArray(e,a),this.targetObject.needsUpdate=!0},function(e,a){this.resolvedProperty.fromArray(e,a),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,a){this.bind(),this.getValue(e,a)},setValue:function(e,a){this.bind(),this.setValue(e,a)},bind:function(){var e=this.node,a=this.parsedPath,t=a.objectName,s=a.propertyName,l=a.propertyIndex;if(e||(e=lo.findNode(this.rootNode,a.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(t){var f=a.objectIndex;switch(t){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(var v=0;v<e.length;v++)if(e[v].name===f){f=v;break}break;default:if(e[t]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[t]}if(f!==void 0){if(e[f]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[f]}}var x=e[s];if(x===void 0){var w=a.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+w+"."+s+" but it wasn't found.",e);return}var E=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?E=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(E=this.Versioning.MatrixWorldNeedsUpdate);var P=this.BindingType.Direct;if(l!==void 0){if(s==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[l]!==void 0&&(l=e.morphTargetDictionary[l])}else{console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);return}}P=this.BindingType.ArrayElement,this.resolvedProperty=x,this.propertyIndex=l}else x.fromArray!==void 0&&x.toArray!==void 0?(P=this.BindingType.HasFromToArray,this.resolvedProperty=x):Array.isArray(x)?(P=this.BindingType.EntireArray,this.resolvedProperty=x):this.propertyName=s;this.getValue=this.GetterByBindingType[P],this.setValue=this.SetterByBindingTypeAndVersioning[P][E]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(lo.prototype,{_getValue_unbound:lo.prototype.getValue,_setValue_unbound:lo.prototype.setValue});function _E(){this.uuid=nr.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var e={};this._indicesByUUID=e;for(var a=0,t=arguments.length;a!==t;++a)e[arguments[a].uuid]=a;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var s=this;this.stats={objects:{get total(){return s._objects.length},get inUse(){return this.total-s.nCachedObjects_}},get bindingsPerObject(){return s._bindings.length}}}Object.assign(_E.prototype,{isAnimationObjectGroup:!0,add:function(){for(var e=this._objects,a=this._indicesByUUID,t=this._paths,s=this._parsedPaths,l=this._bindings,f=l.length,v=void 0,x=e.length,w=this.nCachedObjects_,E=0,P=arguments.length;E!==P;++E){var R=arguments[E],V=R.uuid,H=a[V];if(H===void 0){H=x++,a[V]=H,e.push(R);for(var q=0;q!==f;++q)l[q].push(new lo(R,t[q],s[q]))}else if(H<w){v=e[H];var z=--w,G=e[z];a[G.uuid]=H,e[H]=G,a[V]=z,e[z]=R;for(var ie=0;ie!==f;++ie){var le=l[ie],ae=le[z],J=le[H];le[H]=ae,J===void 0&&(J=new lo(R,t[ie],s[ie])),le[z]=J}}else e[H]!==v&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=w},remove:function(){for(var e=this._objects,a=this._indicesByUUID,t=this._bindings,s=t.length,l=this.nCachedObjects_,f=0,v=arguments.length;f!==v;++f){var x=arguments[f],w=x.uuid,E=a[w];if(E!==void 0&&E>=l){var P=l++,R=e[P];a[R.uuid]=E,e[E]=R,a[w]=P,e[P]=x;for(var V=0;V!==s;++V){var H=t[V],q=H[P],z=H[E];H[E]=q,H[P]=z}}}this.nCachedObjects_=l},uncache:function(){for(var e=this._objects,a=this._indicesByUUID,t=this._bindings,s=t.length,l=this.nCachedObjects_,f=e.length,v=0,x=arguments.length;v!==x;++v){var w=arguments[v],E=w.uuid,P=a[E];if(P!==void 0)if(delete a[E],P<l){var R=--l,V=e[R],H=--f,q=e[H];a[V.uuid]=P,e[P]=V,a[q.uuid]=R,e[R]=q,e.pop();for(var z=0;z!==s;++z){var G=t[z],ie=G[R],le=G[H];G[P]=ie,G[R]=le,G.pop()}}else{var ae=--f,J=e[ae];a[J.uuid]=P,e[P]=J,e.pop();for(var se=0;se!==s;++se){var ge=t[se];ge[P]=ge[ae],ge.pop()}}}this.nCachedObjects_=l},subscribe_:function(e,a){var t=this._bindingsIndicesByPath,s=t[e],l=this._bindings;if(s!==void 0)return l[s];var f=this._paths,v=this._parsedPaths,x=this._objects,w=x.length,E=this.nCachedObjects_,P=new Array(w);s=l.length,t[e]=s,f.push(e),v.push(a),l.push(P);for(var R=E,V=x.length;R!==V;++R){var H=x[R];P[R]=new lo(H,e,a)}return P},unsubscribe_:function(e){var a=this._bindingsIndicesByPath,t=a[e];if(t!==void 0){var s=this._paths,l=this._parsedPaths,f=this._bindings,v=f.length-1,x=f[v],w=e[v];a[w]=t,f[t]=x,f.pop(),l[t]=l[v],l.pop(),s[t]=s[v],s.pop()}}});var NC=function(){function e(t,s,l,f){this._mixer=t,this._clip=s,this._localRoot=l||null,this.blendMode=f||s.blendMode;for(var v=s.tracks,x=v.length,w=new Array(x),E={endingStart:zu,endingEnd:zu},P=0;P!==x;++P){var R=v[P].createInterpolant(null);w[P]=R,R.settings=E}this._interpolantSettings=E,this._interpolants=w,this._propertyBindings=new Array(x),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=kr,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}var a=e.prototype;return a.play=function(){return this._mixer._activateAction(this),this},a.stop=function(){return this._mixer._deactivateAction(this),this.reset()},a.reset=function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},a.isRunning=function(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)},a.isScheduled=function(){return this._mixer._isActiveAction(this)},a.startAt=function(t){return this._startTime=t,this},a.setLoop=function(t,s){return this.loop=t,this.repetitions=s,this},a.setEffectiveWeight=function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},a.getEffectiveWeight=function(){return this._effectiveWeight},a.fadeIn=function(t){return this._scheduleFading(t,0,1)},a.fadeOut=function(t){return this._scheduleFading(t,1,0)},a.crossFadeFrom=function(t,s,l){if(t.fadeOut(s),this.fadeIn(s),l){var f=this._clip.duration,v=t._clip.duration;t.warp(1,v/f,s),this.warp(f/v,1,s)}return this},a.crossFadeTo=function(t,s,l){return t.crossFadeFrom(this,s,l)},a.stopFading=function(){var t=this._weightInterpolant;return t!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},a.setEffectiveTimeScale=function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},a.getEffectiveTimeScale=function(){return this._effectiveTimeScale},a.setDuration=function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},a.syncWith=function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},a.halt=function(t){return this.warp(this._effectiveTimeScale,0,t)},a.warp=function(t,s,l){var f=this._mixer,v=f.time,x=this.timeScale,w=this._timeScaleInterpolant;w===null&&(w=f._lendControlInterpolant(),this._timeScaleInterpolant=w);var E=w.parameterPositions,P=w.sampleValues;return E[0]=v,E[1]=v+l,P[0]=t/x,P[1]=s/x,this},a.stopWarping=function(){var t=this._timeScaleInterpolant;return t!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},a.getMixer=function(){return this._mixer},a.getClip=function(){return this._clip},a.getRoot=function(){return this._localRoot||this._mixer._root},a._update=function(t,s,l,f){if(!this.enabled){this._updateWeight(t);return}var v=this._startTime;if(v!==null){var x=(t-v)*l;if(x<0||l===0)return;this._startTime=null,s=l*x}s*=this._updateTimeScale(t);var w=this._updateTime(s),E=this._updateWeight(t);if(E>0){var P=this._interpolants,R=this._propertyBindings;switch(this.blendMode){case ac:for(var V=0,H=P.length;V!==H;++V)P[V].evaluate(w),R[V].accumulateAdditive(E);break;case sc:default:for(var q=0,z=P.length;q!==z;++q)P[q].evaluate(w),R[q].accumulate(f,E)}}},a._updateWeight=function(t){var s=0;if(this.enabled){s=this.weight;var l=this._weightInterpolant;if(l!==null){var f=l.evaluate(t)[0];s*=f,t>l.parameterPositions[1]&&(this.stopFading(),f===0&&(this.enabled=!1))}}return this._effectiveWeight=s,s},a._updateTimeScale=function(t){var s=0;if(!this.paused){s=this.timeScale;var l=this._timeScaleInterpolant;if(l!==null){var f=l.evaluate(t)[0];s*=f,t>l.parameterPositions[1]&&(this.stopWarping(),s===0?this.paused=!0:this.timeScale=s)}}return this._effectiveTimeScale=s,s},a._updateTime=function(t){var s=this._clip.duration,l=this.loop,f=this.time+t,v=this._loopCount,x=l===q0;if(t===0)return v===-1?f:x&&(v&1)===1?s-f:f;if(l===ku){v===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(f>=s)f=s;else if(f<0)f=0;else{this.time=f;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=f,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(v===-1&&(t>=0?(v=0,this._setEndings(!0,this.repetitions===0,x)):this._setEndings(this.repetitions===0,!0,x)),f>=s||f<0){var w=Math.floor(f/s);f-=s*w,v+=Math.abs(w);var E=this.repetitions-v;if(E<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,f=t>0?s:0,this.time=f,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(E===1){var P=t<0;this._setEndings(P,!P,x)}else this._setEndings(!1,!1,x);this._loopCount=v,this.time=f,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:w})}}else this.time=f;if(x&&(v&1)===1)return s-f}return f},a._setEndings=function(t,s,l){var f=this._interpolantSettings;l?(f.endingStart=qc,f.endingEnd=qc):(t?f.endingStart=this.zeroSlopeAtStart?qc:zu:f.endingStart=Vh,s?f.endingEnd=this.zeroSlopeAtEnd?qc:zu:f.endingEnd=Vh)},a._scheduleFading=function(t,s,l){var f=this._mixer,v=f.time,x=this._weightInterpolant;x===null&&(x=f._lendControlInterpolant(),this._weightInterpolant=x);var w=x.parameterPositions,E=x.sampleValues;return w[0]=v,E[0]=s,w[1]=v+t,E[1]=l,this},e}();function WM(e){this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}WM.prototype=Object.assign(Object.create(il.prototype),{constructor:WM,_bindAction:function(e,a){var t=e._localRoot||this._root,s=e._clip.tracks,l=s.length,f=e._propertyBindings,v=e._interpolants,x=t.uuid,w=this._bindingsByRootAndName,E=w[x];E===void 0&&(E={},w[x]=E);for(var P=0;P!==l;++P){var R=s[P],V=R.name,H=E[V];if(H!==void 0)f[P]=H;else{if(H=f[P],H!==void 0){H._cacheIndex===null&&(++H.referenceCount,this._addInactiveBinding(H,x,V));continue}var q=a&&a._propertyBindings[P].binding.parsedPath;H=new HM(lo.create(t,V,q),R.ValueTypeName,R.getValueSize()),++H.referenceCount,this._addInactiveBinding(H,x,V),f[P]=H}v[P].resultBuffer=H.buffer}},_activateAction:function(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){var a=(e._localRoot||this._root).uuid,t=e._clip.uuid,s=this._actionsByClip[t];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,t,a)}for(var l=e._propertyBindings,f=0,v=l.length;f!==v;++f){var x=l[f];x.useCount++===0&&(this._lendBinding(x),x.saveOriginalState())}this._lendAction(e)}},_deactivateAction:function(e){if(this._isActiveAction(e)){for(var a=e._propertyBindings,t=0,s=a.length;t!==s;++t){var l=a[t];--l.useCount===0&&(l.restoreOriginalState(),this._takeBackBinding(l))}this._takeBackAction(e)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){var a=e._cacheIndex;return a!==null&&a<this._nActiveActions},_addInactiveAction:function(e,a,t){var s=this._actions,l=this._actionsByClip,f=l[a];if(f===void 0)f={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,l[a]=f;else{var v=f.knownActions;e._byClipCacheIndex=v.length,v.push(e)}e._cacheIndex=s.length,s.push(e),f.actionByRoot[t]=e},_removeInactiveAction:function(e){var a=this._actions,t=a[a.length-1],s=e._cacheIndex;t._cacheIndex=s,a[s]=t,a.pop(),e._cacheIndex=null;var l=e._clip.uuid,f=this._actionsByClip,v=f[l],x=v.knownActions,w=x[x.length-1],E=e._byClipCacheIndex;w._byClipCacheIndex=E,x[E]=w,x.pop(),e._byClipCacheIndex=null;var P=v.actionByRoot,R=(e._localRoot||this._root).uuid;delete P[R],x.length===0&&delete f[l],this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function(e){for(var a=e._propertyBindings,t=0,s=a.length;t!==s;++t){var l=a[t];--l.referenceCount===0&&this._removeInactiveBinding(l)}},_lendAction:function(e){var a=this._actions,t=e._cacheIndex,s=this._nActiveActions++,l=a[s];e._cacheIndex=s,a[s]=e,l._cacheIndex=t,a[t]=l},_takeBackAction:function(e){var a=this._actions,t=e._cacheIndex,s=--this._nActiveActions,l=a[s];e._cacheIndex=s,a[s]=e,l._cacheIndex=t,a[t]=l},_addInactiveBinding:function(e,a,t){var s=this._bindingsByRootAndName,l=this._bindings,f=s[a];f===void 0&&(f={},s[a]=f),f[t]=e,e._cacheIndex=l.length,l.push(e)},_removeInactiveBinding:function(e){var a=this._bindings,t=e.binding,s=t.rootNode.uuid,l=t.path,f=this._bindingsByRootAndName,v=f[s],x=a[a.length-1],w=e._cacheIndex;x._cacheIndex=w,a[w]=x,a.pop(),delete v[l],Object.keys(v).length===0&&delete f[s]},_lendBinding:function(e){var a=this._bindings,t=e._cacheIndex,s=this._nActiveBindings++,l=a[s];e._cacheIndex=s,a[s]=e,l._cacheIndex=t,a[t]=l},_takeBackBinding:function(e){var a=this._bindings,t=e._cacheIndex,s=--this._nActiveBindings,l=a[s];e._cacheIndex=s,a[s]=e,l._cacheIndex=t,a[t]=l},_lendControlInterpolant:function(){var e=this._controlInterpolants,a=this._nActiveControlInterpolants++,t=e[a];return t===void 0&&(t=new Pv(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),t.__cacheIndex=a,e[a]=t),t},_takeBackControlInterpolant:function(e){var a=this._controlInterpolants,t=e.__cacheIndex,s=--this._nActiveControlInterpolants,l=a[s];e.__cacheIndex=s,a[s]=e,l.__cacheIndex=t,a[t]=l},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(e,a,t){var s=a||this._root,l=s.uuid,f=typeof e=="string"?Il.findByName(s,e):e,v=f!==null?f.uuid:e,x=this._actionsByClip[v],w=null;if(t===void 0&&(f!==null?t=f.blendMode:t=sc),x!==void 0){var E=x.actionByRoot[l];if(E!==void 0&&E.blendMode===t)return E;w=x.knownActions[0],f===null&&(f=w._clip)}if(f===null)return null;var P=new NC(this,f,a,t);return this._bindAction(P,w),this._addInactiveAction(P,v,l),P},existingAction:function(e,a){var t=a||this._root,s=t.uuid,l=typeof e=="string"?Il.findByName(t,e):e,f=l?l.uuid:e,v=this._actionsByClip[f];return v!==void 0&&v.actionByRoot[s]||null},stopAllAction:function(){for(var e=this._actions,a=this._nActiveActions,t=a-1;t>=0;--t)e[t].stop();return this},update:function(e){e*=this.timeScale;for(var a=this._actions,t=this._nActiveActions,s=this.time+=e,l=Math.sign(e),f=this._accuIndex^=1,v=0;v!==t;++v){var x=a[v];x._update(s,e,l,f)}for(var w=this._bindings,E=this._nActiveBindings,P=0;P!==E;++P)w[P].apply(f);return this},setTime:function(e){this.time=0;for(var a=0;a<this._actions.length;a++)this._actions[a].time=0;return this.update(e)},getRoot:function(){return this._root},uncacheClip:function(e){var a=this._actions,t=e.uuid,s=this._actionsByClip,l=s[t];if(l!==void 0){for(var f=l.knownActions,v=0,x=f.length;v!==x;++v){var w=f[v];this._deactivateAction(w);var E=w._cacheIndex,P=a[a.length-1];w._cacheIndex=null,w._byClipCacheIndex=null,P._cacheIndex=E,a[E]=P,a.pop(),this._removeInactiveBindingsForAction(w)}delete s[t]}},uncacheRoot:function(e){var a=e.uuid,t=this._actionsByClip;for(var s in t){var l=t[s].actionByRoot,f=l[a];f!==void 0&&(this._deactivateAction(f),this._removeInactiveAction(f))}var v=this._bindingsByRootAndName,x=v[a];if(x!==void 0)for(var w in x){var E=x[w];E.restoreOriginalState(),this._removeInactiveBinding(E)}},uncacheAction:function(e,a){var t=this.existingAction(e,a);t!==null&&(this._deactivateAction(t),this._removeInactiveAction(t))}});var bE=function(){function e(t){typeof t=="string"&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}var a=e.prototype;return a.clone=function(){return new e(this.value.clone===void 0?this.value:this.value.clone())},e}();function XM(e,a,t){cl.call(this,e,a),this.meshPerAttribute=t||1}XM.prototype=Object.assign(Object.create(cl.prototype),{constructor:XM,isInstancedInterleavedBuffer:!0,copy:function(e){return cl.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},clone:function(e){var a=cl.prototype.clone.call(this,e);return a.meshPerAttribute=this.meshPerAttribute,a},toJSON:function(e){var a=cl.prototype.toJSON.call(this,e);return a.isInstancedInterleavedBuffer=!0,a.meshPerAttribute=this.meshPerAttribute,a}});function qM(e,a,t,s,l){this.buffer=e,this.type=a,this.itemSize=t,this.elementSize=s,this.count=l,this.version=0}Object.defineProperty(qM.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}}),Object.assign(qM.prototype,{isGLBufferAttribute:!0,setBuffer:function(e){return this.buffer=e,this},setType:function(e,a){return this.type=e,this.elementSize=a,this},setItemSize:function(e){return this.itemSize=e,this},setCount:function(e){return this.count=e,this}});function jM(e,a,t,s){this.ray=new sl(e,a),this.near=t||0,this.far=s||1/0,this.camera=null,this.layers=new av,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function wE(e,a){return e.distance-a.distance}function YM(e,a,t,s){if(e.layers.test(a.layers)&&e.raycast(a,t),s===!0)for(var l=e.children,f=0,v=l.length;f<v;f++)YM(l[f],a,t,!0)}Object.assign(jM.prototype,{set:function(e,a){this.ray.set(e,a)},setFromCamera:function(e,a){a&&a.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(a.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(a).sub(this.ray.origin).normalize(),this.camera=a):a&&a.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(a.near+a.far)/(a.near-a.far)).unproject(a),this.ray.direction.set(0,0,-1).transformDirection(a.matrixWorld),this.camera=a):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,a,t){var s=t||[];return YM(e,this,s,a),s.sort(wE),s},intersectObjects:function(e,a,t){var s=t||[];if(Array.isArray(e)===!1)return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),s;for(var l=0,f=e.length;l<f;l++)YM(e[l],this,s,a);return s.sort(wE),s}});var FC=function(){function e(t,s,l){return t===void 0&&(t=1),s===void 0&&(s=0),l===void 0&&(l=0),this.radius=t,this.phi=s,this.theta=l,this}var a=e.prototype;return a.set=function(t,s,l){return this.radius=t,this.phi=s,this.theta=l,this},a.clone=function(){return new this.constructor().copy(this)},a.copy=function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},a.makeSafe=function(){var t=1e-6;return this.phi=Math.max(t,Math.min(Math.PI-t,this.phi)),this},a.setFromVector3=function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},a.setFromCartesianCoords=function(t,s,l){return this.radius=Math.sqrt(t*t+s*s+l*l),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,l),this.phi=Math.acos(nr.clamp(s/this.radius,-1,1))),this},e}(),BC=function(){function e(t,s,l){return this.radius=t!==void 0?t:1,this.theta=s!==void 0?s:0,this.y=l!==void 0?l:0,this}var a=e.prototype;return a.set=function(t,s,l){return this.radius=t,this.theta=s,this.y=l,this},a.clone=function(){return new this.constructor().copy(this)},a.copy=function(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this},a.setFromVector3=function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},a.setFromCartesianCoords=function(t,s,l){return this.radius=Math.sqrt(t*t+l*l),this.theta=Math.atan2(t,l),this.y=s,this},e}(),ME=new bn,SE=function(){function e(t,s){Object.defineProperty(this,"isBox2",{value:!0}),this.min=t!==void 0?t:new bn(1/0,1/0),this.max=s!==void 0?s:new bn(-1/0,-1/0)}var a=e.prototype;return a.set=function(t,s){return this.min.copy(t),this.max.copy(s),this},a.setFromPoints=function(t){this.makeEmpty();for(var s=0,l=t.length;s<l;s++)this.expandByPoint(t[s]);return this},a.setFromCenterAndSize=function(t,s){var l=ME.copy(s).multiplyScalar(.5);return this.min.copy(t).sub(l),this.max.copy(t).add(l),this},a.clone=function(){return new this.constructor().copy(this)},a.copy=function(t){return this.min.copy(t.min),this.max.copy(t.max),this},a.makeEmpty=function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},a.isEmpty=function(){return this.max.x<this.min.x||this.max.y<this.min.y},a.getCenter=function(t){return t===void 0&&(console.warn("THREE.Box2: .getCenter() target is now required"),t=new bn),this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},a.getSize=function(t){return t===void 0&&(console.warn("THREE.Box2: .getSize() target is now required"),t=new bn),this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},a.expandByPoint=function(t){return this.min.min(t),this.max.max(t),this},a.expandByVector=function(t){return this.min.sub(t),this.max.add(t),this},a.expandByScalar=function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},a.containsPoint=function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},a.containsBox=function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},a.getParameter=function(t,s){return s===void 0&&(console.warn("THREE.Box2: .getParameter() target is now required"),s=new bn),s.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},a.intersectsBox=function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},a.clampPoint=function(t,s){return s===void 0&&(console.warn("THREE.Box2: .clampPoint() target is now required"),s=new bn),s.copy(t).clamp(this.min,this.max)},a.distanceToPoint=function(t){var s=ME.copy(t).clamp(this.min,this.max);return s.sub(t).length()},a.intersect=function(t){return this.min.max(t.min),this.max.min(t.max),this},a.union=function(t){return this.min.min(t.min),this.max.max(t.max),this},a.translate=function(t){return this.min.add(t),this.max.add(t),this},a.equals=function(t){return t.min.equals(this.min)&&t.max.equals(this.max)},e}(),EE=new pe,Zx=new pe,TE=function(){function e(t,s){this.start=t!==void 0?t:new pe,this.end=s!==void 0?s:new pe}var a=e.prototype;return a.set=function(t,s){return this.start.copy(t),this.end.copy(s),this},a.clone=function(){return new this.constructor().copy(this)},a.copy=function(t){return this.start.copy(t.start),this.end.copy(t.end),this},a.getCenter=function(t){return t===void 0&&(console.warn("THREE.Line3: .getCenter() target is now required"),t=new pe),t.addVectors(this.start,this.end).multiplyScalar(.5)},a.delta=function(t){return t===void 0&&(console.warn("THREE.Line3: .delta() target is now required"),t=new pe),t.subVectors(this.end,this.start)},a.distanceSq=function(){return this.start.distanceToSquared(this.end)},a.distance=function(){return this.start.distanceTo(this.end)},a.at=function(t,s){return s===void 0&&(console.warn("THREE.Line3: .at() target is now required"),s=new pe),this.delta(s).multiplyScalar(t).add(this.start)},a.closestPointToPointParameter=function(t,s){EE.subVectors(t,this.start),Zx.subVectors(this.end,this.start);var l=Zx.dot(Zx),f=Zx.dot(EE),v=f/l;return s&&(v=nr.clamp(v,0,1)),v},a.closestPointToPoint=function(t,s,l){var f=this.closestPointToPointParameter(t,s);return l===void 0&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),l=new pe),this.delta(l).multiplyScalar(f).add(this.start)},a.applyMatrix4=function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},a.equals=function(t){return t.start.equals(this.start)&&t.end.equals(this.end)},e}();function Nv(e){Ei.call(this),this.material=e,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}Nv.prototype=Object.create(Ei.prototype),Nv.prototype.constructor=Nv,Nv.prototype.isImmediateRenderObject=!0;var AE=new pe,kC=function(e){Li(a,e);function a(s,l){var f=e.call(this)||this;f.light=s,f.light.updateMatrixWorld(),f.matrix=s.matrixWorld,f.matrixAutoUpdate=!1,f.color=l;for(var v=new qe,x=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],w=0,E=1,P=32;w<P;w++,E++){var R=w/P*Math.PI*2,V=E/P*Math.PI*2;x.push(Math.cos(R),Math.sin(R),1,Math.cos(V),Math.sin(V),1)}v.setAttribute("position",new L(x,3));var H=new Js({fog:!1,toneMapped:!1});return f.cone=new Eo(v,H),f.add(f.cone),f.update(),f}var t=a.prototype;return t.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},t.update=function(){this.light.updateMatrixWorld();var s=this.light.distance?this.light.distance:1e3,l=s*Math.tan(this.light.angle);this.cone.scale.set(l,l,s),AE.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(AE),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)},a}(Ei),pf=new pe,Jx=new wr,ZM=new wr,LE=function(e){Li(a,e);function a(s){for(var l,f=CE(s),v=new qe,x=[],w=[],E=new mi(0,0,1),P=new mi(0,1,0),R=0;R<f.length;R++){var V=f[R];V.parent&&V.parent.isBone&&(x.push(0,0,0),x.push(0,0,0),w.push(E.r,E.g,E.b),w.push(P.r,P.g,P.b))}v.setAttribute("position",new L(x,3)),v.setAttribute("color",new L(w,3));var H=new Js({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});return l=e.call(this,v,H)||this,l.type="SkeletonHelper",l.isSkeletonHelper=!0,l.root=s,l.bones=f,l.matrix=s.matrixWorld,l.matrixAutoUpdate=!1,l}var t=a.prototype;return t.updateMatrixWorld=function(s){var l=this.bones,f=this.geometry,v=f.getAttribute("position");ZM.getInverse(this.root.matrixWorld);for(var x=0,w=0;x<l.length;x++){var E=l[x];E.parent&&E.parent.isBone&&(Jx.multiplyMatrices(ZM,E.matrixWorld),pf.setFromMatrixPosition(Jx),v.setXYZ(w,pf.x,pf.y,pf.z),Jx.multiplyMatrices(ZM,E.parent.matrixWorld),pf.setFromMatrixPosition(Jx),v.setXYZ(w+1,pf.x,pf.y,pf.z),w+=2)}f.getAttribute("position").needsUpdate=!0,e.prototype.updateMatrixWorld.call(this,s)},a}(Eo);function CE(e){var a=[];e&&e.isBone&&a.push(e);for(var t=0;t<e.children.length;t++)a.push.apply(a,CE(e.children[t]));return a}var zC=function(e){Li(a,e);function a(s,l,f){var v,x=new Tx(l,4,2),w=new Sa({wireframe:!0,fog:!1,toneMapped:!1});return v=e.call(this,x,w)||this,v.light=s,v.light.updateMatrixWorld(),v.color=f,v.type="PointLightHelper",v.matrix=v.light.matrixWorld,v.matrixAutoUpdate=!1,v.update(),v}var t=a.prototype;return t.dispose=function(){this.geometry.dispose(),this.material.dispose()},t.update=function(){this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)},a}(xr),UC=new pe,PE=new mi,RE=new mi,HC=function(e){Li(a,e);function a(s,l,f){var v=e.call(this)||this;v.light=s,v.light.updateMatrixWorld(),v.matrix=s.matrixWorld,v.matrixAutoUpdate=!1,v.color=f;var x=new Ex(l);x.rotateY(Math.PI*.5),v.material=new Sa({wireframe:!0,fog:!1,toneMapped:!1}),v.color===void 0&&(v.material.vertexColors=!0);var w=x.getAttribute("position"),E=new Float32Array(w.count*3);return x.setAttribute("color",new qi(E,3)),v.add(new xr(x,v.material)),v.update(),v}var t=a.prototype;return t.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},t.update=function(){var s=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{var l=s.geometry.getAttribute("color");PE.copy(this.light.color),RE.copy(this.light.groundColor);for(var f=0,v=l.count;f<v;f++){var x=f<v/2?PE:RE;l.setXYZ(f,x.r,x.g,x.b)}l.needsUpdate=!0}s.lookAt(UC.setFromMatrixPosition(this.light.matrixWorld).negate())},a}(Ei),DE=function(e){Li(a,e);function a(t,s,l,f){var v;t=t||10,s=s||10,l=new mi(l!==void 0?l:4473924),f=new mi(f!==void 0?f:8947848);for(var x=s/2,w=t/s,E=t/2,P=[],R=[],V=0,H=0,q=-E;V<=s;V++,q+=w){P.push(-E,0,q,E,0,q),P.push(q,0,-E,q,0,E);var z=V===x?l:f;z.toArray(R,H),H+=3,z.toArray(R,H),H+=3,z.toArray(R,H),H+=3,z.toArray(R,H),H+=3}var G=new qe;G.setAttribute("position",new L(P,3)),G.setAttribute("color",new L(R,3));var ie=new Js({vertexColors:!0,toneMapped:!1});return v=e.call(this,G,ie)||this,v.type="GridHelper",v}return a}(Eo),GC=function(e){Li(a,e);function a(t,s,l,f,v,x){var w;t=t||10,s=s||16,l=l||8,f=f||64,v=new mi(v!==void 0?v:4473924),x=new mi(x!==void 0?x:8947848);for(var E=[],P=[],R=0;R<=s;R++){var V=R/s*(Math.PI*2),H=Math.sin(V)*t,q=Math.cos(V)*t;E.push(0,0,0),E.push(H,0,q);var z=R&1?v:x;P.push(z.r,z.g,z.b),P.push(z.r,z.g,z.b)}for(var G=0;G<=l;G++)for(var ie=G&1?v:x,le=t-t/l*G,ae=0;ae<f;ae++){var J=ae/f*(Math.PI*2),se=Math.sin(J)*le,ge=Math.cos(J)*le;E.push(se,0,ge),P.push(ie.r,ie.g,ie.b),J=(ae+1)/f*(Math.PI*2),se=Math.sin(J)*le,ge=Math.cos(J)*le,E.push(se,0,ge),P.push(ie.r,ie.g,ie.b)}var _e=new qe;_e.setAttribute("position",new L(E,3)),_e.setAttribute("color",new L(P,3));var We=new Js({vertexColors:!0,toneMapped:!1});return w=e.call(this,_e,We)||this,w.type="PolarGridHelper",w}return a}(Eo),OE=new pe,$x=new pe,IE=new pe,VC=function(e){Li(a,e);function a(s,l,f){var v=e.call(this)||this;v.light=s,v.light.updateMatrixWorld(),v.matrix=s.matrixWorld,v.matrixAutoUpdate=!1,v.color=f,l===void 0&&(l=1);var x=new qe;x.setAttribute("position",new L([-l,l,0,l,l,0,l,-l,0,-l,-l,0,-l,l,0],3));var w=new Js({fog:!1,toneMapped:!1});return v.lightPlane=new Ol(x,w),v.add(v.lightPlane),x=new qe,x.setAttribute("position",new L([0,0,0,0,0,1],3)),v.targetLine=new Ol(x,w),v.add(v.targetLine),v.update(),v}var t=a.prototype;return t.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},t.update=function(){OE.setFromMatrixPosition(this.light.matrixWorld),$x.setFromMatrixPosition(this.light.target.matrixWorld),IE.subVectors($x,OE),this.lightPlane.lookAt($x),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt($x),this.targetLine.scale.z=IE.length()},a}(Ei),Kx=new pe,ua=new Ta,WC=function(e){Li(a,e);function a(s){var l,f=new qe,v=new Js({color:16777215,vertexColors:!0,toneMapped:!1}),x=[],w=[],E={},P=new mi(16755200),R=new mi(16711680),V=new mi(43775),H=new mi(16777215),q=new mi(3355443);z("n1","n2",P),z("n2","n4",P),z("n4","n3",P),z("n3","n1",P),z("f1","f2",P),z("f2","f4",P),z("f4","f3",P),z("f3","f1",P),z("n1","f1",P),z("n2","f2",P),z("n3","f3",P),z("n4","f4",P),z("p","n1",R),z("p","n2",R),z("p","n3",R),z("p","n4",R),z("u1","u2",V),z("u2","u3",V),z("u3","u1",V),z("c","t",H),z("p","c",q),z("cn1","cn2",q),z("cn3","cn4",q),z("cf1","cf2",q),z("cf3","cf4",q);function z(ie,le,ae){G(ie,ae),G(le,ae)}function G(ie,le){x.push(0,0,0),w.push(le.r,le.g,le.b),E[ie]===void 0&&(E[ie]=[]),E[ie].push(x.length/3-1)}return f.setAttribute("position",new L(x,3)),f.setAttribute("color",new L(w,3)),l=e.call(this,f,v)||this,l.type="CameraHelper",l.camera=s,l.camera.updateProjectionMatrix&&l.camera.updateProjectionMatrix(),l.matrix=s.matrixWorld,l.matrixAutoUpdate=!1,l.pointMap=E,l.update(),l}var t=a.prototype;return t.update=function(){var s=this.geometry,l=this.pointMap,f=1,v=1;ua.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),ga("c",l,s,ua,0,0,-1),ga("t",l,s,ua,0,0,1),ga("n1",l,s,ua,-f,-v,-1),ga("n2",l,s,ua,f,-v,-1),ga("n3",l,s,ua,-f,v,-1),ga("n4",l,s,ua,f,v,-1),ga("f1",l,s,ua,-f,-v,1),ga("f2",l,s,ua,f,-v,1),ga("f3",l,s,ua,-f,v,1),ga("f4",l,s,ua,f,v,1),ga("u1",l,s,ua,f*.7,v*1.1,-1),ga("u2",l,s,ua,-f*.7,v*1.1,-1),ga("u3",l,s,ua,0,v*2,-1),ga("cf1",l,s,ua,-f,0,1),ga("cf2",l,s,ua,f,0,1),ga("cf3",l,s,ua,0,-v,1),ga("cf4",l,s,ua,0,v,1),ga("cn1",l,s,ua,-f,0,-1),ga("cn2",l,s,ua,f,0,-1),ga("cn3",l,s,ua,0,-v,-1),ga("cn4",l,s,ua,0,v,-1),s.getAttribute("position").needsUpdate=!0},a}(Eo);function ga(e,a,t,s,l,f,v){Kx.set(l,f,v).unproject(s);var x=a[e];if(x!==void 0)for(var w=t.getAttribute("position"),E=0,P=x.length;E<P;E++)w.setXYZ(x[E],Kx.x,Kx.y,Kx.z)}var Qx=new Tl,NE=function(e){Li(a,e);function a(s,l){var f;l===void 0&&(l=16776960);var v=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),x=new Float32Array(8*3),w=new qe;return w.setIndex(new qi(v,1)),w.setAttribute("position",new qi(x,3)),f=e.call(this,w,new Js({color:l,toneMapped:!1}))||this,f.object=s,f.type="BoxHelper",f.matrixAutoUpdate=!1,f.update(),f}var t=a.prototype;return t.update=function(s){if(s!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&Qx.setFromObject(this.object),!Qx.isEmpty()){var l=Qx.min,f=Qx.max,v=this.geometry.attributes.position,x=v.array;x[0]=f.x,x[1]=f.y,x[2]=f.z,x[3]=l.x,x[4]=f.y,x[5]=f.z,x[6]=l.x,x[7]=l.y,x[8]=f.z,x[9]=f.x,x[10]=l.y,x[11]=f.z,x[12]=f.x,x[13]=f.y,x[14]=l.z,x[15]=l.x,x[16]=f.y,x[17]=l.z,x[18]=l.x,x[19]=l.y,x[20]=l.z,x[21]=f.x,x[22]=l.y,x[23]=l.z,v.needsUpdate=!0,this.geometry.computeBoundingSphere()}},t.setFromObject=function(s){return this.object=s,this.update(),this},t.copy=function(s){return Eo.prototype.copy.call(this,s),this.object=s.object,this},a}(Eo),XC=function(e){Li(a,e);function a(s,l){var f;l===void 0&&(l=16776960);var v=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),x=new qe;return x.setIndex(new qi(v,1)),x.setAttribute("position",new L([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),f=e.call(this,x,new Js({color:l,toneMapped:!1}))||this,f.box=s,f.type="Box3Helper",f.geometry.computeBoundingSphere(),f}var t=a.prototype;return t.updateMatrixWorld=function(s){var l=this.box;l.isEmpty()||(l.getCenter(this.position),l.getSize(this.scale),this.scale.multiplyScalar(.5),e.prototype.updateMatrixWorld.call(this,s))},a}(Eo),qC=function(e){Li(a,e);function a(s,l,f){var v,x=f!==void 0?f:16776960,w=new qe;w.setAttribute("position",new L([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),w.computeBoundingSphere(),v=e.call(this,w,new Js({color:x,toneMapped:!1}))||this,v.type="PlaneHelper",v.plane=s,v.size=l===void 0?1:l;var E=new qe;return E.setAttribute("position",new L([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),E.computeBoundingSphere(),v.add(new xr(E,new Sa({color:x,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1}))),v}var t=a.prototype;return t.updateMatrixWorld=function(s){var l=-this.plane.constant;Math.abs(l)<1e-8&&(l=1e-8),this.scale.set(.5*this.size,.5*this.size,l),this.children[0].material.side=l<0?O:F,this.lookAt(this.plane.normal),e.prototype.updateMatrixWorld.call(this,s)},a}(Ol),FE=new pe,e_,JM,jC=function(e){Li(a,e);function a(s,l,f,v,x,w){var E=e.call(this)||this;return E.type="ArrowHelper",s===void 0&&(s=new pe(0,0,1)),l===void 0&&(l=new pe(0,0,0)),f===void 0&&(f=1),v===void 0&&(v=16776960),x===void 0&&(x=.2*f),w===void 0&&(w=.2*x),e_===void 0&&(e_=new qe,e_.setAttribute("position",new L([0,0,0,0,1,0],3)),JM=new Sv(0,.5,1,5,1),JM.translate(0,-.5,0)),E.position.copy(l),E.line=new Ol(e_,new Js({color:v,toneMapped:!1})),E.line.matrixAutoUpdate=!1,E.add(E.line),E.cone=new xr(JM,new Sa({color:v,toneMapped:!1})),E.cone.matrixAutoUpdate=!1,E.add(E.cone),E.setDirection(s),E.setLength(f,x,w),E}var t=a.prototype;return t.setDirection=function(s){if(s.y>.99999)this.quaternion.set(0,0,0,1);else if(s.y<-.99999)this.quaternion.set(1,0,0,0);else{FE.set(s.z,0,-s.x).normalize();var l=Math.acos(s.y);this.quaternion.setFromAxisAngle(FE,l)}},t.setLength=function(s,l,f){l===void 0&&(l=.2*s),f===void 0&&(f=.2*l),this.line.scale.set(1,Math.max(1e-4,s-l),1),this.line.updateMatrix(),this.cone.scale.set(f,l,f),this.cone.position.y=s,this.cone.updateMatrix()},t.setColor=function(s){this.line.material.color.set(s),this.cone.material.color.set(s)},t.copy=function(s){return e.prototype.copy.call(this,s,!1),this.line.copy(s.line),this.cone.copy(s.cone),this},a}(Ei),BE=function(e){Li(a,e);function a(t){var s;t===void 0&&(t=1);var l=[0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t],f=new qe;f.setAttribute("position",new L(l,3)),f.setAttribute("color",new L([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));var v=new Js({vertexColors:!0,toneMapped:!1});return s=e.call(this,f,v)||this,s.type="AxesHelper",s}return a}(Eo),nh,_m=4,mf=8,cu=Math.pow(2,mf),kE=[.125,.215,.35,.446,.526,.582],zE=mf-_m+1+kE.length,bm=20,uu=(nh={},nh[Da]=0,nh[Uu]=1,nh[jc]=2,nh[$g]=3,nh[sd]=4,nh[Kg]=5,nh[rd]=6,nh),$M=new xm,KM=JC(),Fv=KM._lodPlanes,UE=KM._sizeLods,t_=KM._sigmas,QM=null,Pd=(1+Math.sqrt(5))/2,wm=1/Pd,HE=[new pe(1,1,1),new pe(-1,1,1),new pe(1,1,-1),new pe(-1,1,-1),new pe(0,Pd,wm),new pe(0,Pd,-wm),new pe(wm,0,Pd),new pe(-wm,0,Pd),new pe(Pd,wm,0),new pe(-Pd,wm,0)],YC=function(){function e(t){this._renderer=t,this._pingPongRenderTarget=null,this._blurMaterial=$C(bm),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}var a=e.prototype;return a.fromScene=function(t,s,l,f){s===void 0&&(s=0),l===void 0&&(l=.1),f===void 0&&(f=100),QM=this._renderer.getRenderTarget();var v=this._allocateTargets();return this._sceneToCubeUV(t,l,f,v),s>0&&this._blur(v,0,0,s),this._applyPMREM(v),this._cleanup(v),v},a.fromEquirectangular=function(t){return this._fromTexture(t)},a.fromCubemap=function(t){return this._fromTexture(t)},a.compileCubemapShader=function(){this._cubemapShader===null&&(this._cubemapShader=WE(),this._compileMaterial(this._cubemapShader))},a.compileEquirectangularShader=function(){this._equirectShader===null&&(this._equirectShader=VE(),this._compileMaterial(this._equirectShader))},a.dispose=function(){this._blurMaterial.dispose(),this._cubemapShader!==null&&this._cubemapShader.dispose(),this._equirectShader!==null&&this._equirectShader.dispose();for(var t=0;t<Fv.length;t++)Fv[t].dispose()},a._cleanup=function(t){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(QM),t.scissorTest=!1,n_(t,0,0,t.width,t.height)},a._fromTexture=function(t){QM=this._renderer.getRenderTarget();var s=this._allocateTargets(t);return this._textureToCubeUV(t,s),this._applyPMREM(s),this._cleanup(s),s},a._allocateTargets=function(t){var s={magFilter:Ht,minFilter:Ht,generateMipmaps:!1,type:wa,format:rn,encoding:ZC(t)?t.encoding:jc,depthBuffer:!1},l=GE(s);return l.depthBuffer=!t,this._pingPongRenderTarget=GE(s),l},a._compileMaterial=function(t){var s=new xr(Fv[0],t);this._renderer.compile(s,$M)},a._sceneToCubeUV=function(t,s,l,f){var v=new Ms(90,1,s,l),x=[1,-1,1,1,1,1],w=[1,1,1,-1,-1,-1],E=this._renderer,P=E.outputEncoding,R=E.toneMapping,V=E.getClearColor(),H=E.getClearAlpha();E.toneMapping=ke,E.outputEncoding=Da;var q=t.background;if(q&&q.isColor){q.convertSRGBToLinear();var z=Math.max(q.r,q.g,q.b),G=Math.min(Math.max(Math.ceil(Math.log2(z)),-128),127);q=q.multiplyScalar(Math.pow(2,-G)),E.setClearColor(q,(G+128)/255),t.background=null}for(var ie=0;ie<6;ie++){var le=ie%3;le==0?(v.up.set(0,x[ie],0),v.lookAt(w[ie],0,0)):le==1?(v.up.set(0,0,x[ie]),v.lookAt(0,w[ie],0)):(v.up.set(0,x[ie],0),v.lookAt(0,0,w[ie])),n_(f,le*cu,ie>2?cu:0,cu,cu),E.setRenderTarget(f),E.render(t,v)}E.toneMapping=R,E.outputEncoding=P,E.setClearColor(V,H)},a._textureToCubeUV=function(t,s){var l=this._renderer;t.isCubeTexture?this._cubemapShader==null&&(this._cubemapShader=WE()):this._equirectShader==null&&(this._equirectShader=VE());var f=t.isCubeTexture?this._cubemapShader:this._equirectShader,v=new xr(Fv[0],f),x=f.uniforms;x.envMap.value=t,t.isCubeTexture||x.texelSize.value.set(1/t.image.width,1/t.image.height),x.inputEncoding.value=uu[t.encoding],x.outputEncoding.value=uu[s.texture.encoding],n_(s,0,0,3*cu,2*cu),l.setRenderTarget(s),l.render(v,$M)},a._applyPMREM=function(t){var s=this._renderer,l=s.autoClear;s.autoClear=!1;for(var f=1;f<zE;f++){var v=Math.sqrt(t_[f]*t_[f]-t_[f-1]*t_[f-1]),x=HE[(f-1)%HE.length];this._blur(t,f-1,f,v,x)}s.autoClear=l},a._blur=function(t,s,l,f,v){var x=this._pingPongRenderTarget;this._halfBlur(t,x,s,l,f,"latitudinal",v),this._halfBlur(x,t,l,l,f,"longitudinal",v)},a._halfBlur=function(t,s,l,f,v,x,w){var E=this._renderer,P=this._blurMaterial;x!=="latitudinal"&&x!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");var R=new xr(Fv[f],P),V=P.uniforms,H=UE[l]-1,q=isFinite(v)?Math.PI/(2*H):2*Math.PI/(2*bm-1),z=v/q,G=isFinite(v)?1+Math.floor(3*z):bm;G>bm&&console.warn("sigmaRadians, "+v+", is too large and will clip, as it requested "+G+" samples when the maximum is set to "+bm);for(var ie=[],le=0,ae=0;ae<bm;++ae){var J=ae/z,se=Math.exp(-J*J/2);ie.push(se),ae==0?le+=se:ae<G&&(le+=2*se)}for(var ge=0;ge<ie.length;ge++)ie[ge]=ie[ge]/le;V.envMap.value=t.texture,V.samples.value=G,V.weights.value=ie,V.latitudinal.value=x==="latitudinal",w&&(V.poleAxis.value=w),V.dTheta.value=q,V.mipInt.value=mf-l,V.inputEncoding.value=uu[t.texture.encoding],V.outputEncoding.value=uu[t.texture.encoding];var _e=UE[f],We=3*Math.max(0,cu-2*_e),nt=(f===0?0:2*cu)+2*_e*(f>mf-_m?f-mf+_m:0);n_(s,We,nt,3*_e,2*_e),E.setRenderTarget(s),E.render(R,$M)},e}();function ZC(e){return e===void 0||e.type!==wa?!1:e.encoding===Da||e.encoding===Uu||e.encoding===rd}function JC(){for(var e=[],a=[],t=[],s=mf,l=0;l<zE;l++){var f=Math.pow(2,s);a.push(f);var v=1/f;l>mf-_m?v=kE[l-mf+_m-1]:l==0&&(v=0),t.push(v);for(var x=1/(f-1),w=-x/2,E=1+x/2,P=[w,w,E,w,E,E,w,w,E,E,w,E],R=6,V=6,H=3,q=2,z=1,G=new Float32Array(H*V*R),ie=new Float32Array(q*V*R),le=new Float32Array(z*V*R),ae=0;ae<R;ae++){var J=ae%3*2/3-1,se=ae>2?0:-1;G.set([J,se,0,J+2/3,se,0,J+2/3,se+1,0,J,se,0,J+2/3,se+1,0,J,se+1,0],H*V*ae),ie.set(P,q*V*ae);var ge=[ae,ae,ae,ae,ae,ae];le.set(ge,z*V*ae)}var _e=new qe;_e.setAttribute("position",new qi(G,H)),_e.setAttribute("uv",new qi(ie,q)),_e.setAttribute("faceIndex",new qi(le,z)),e.push(_e),s>_m&&s--}return{_lodPlanes:e,_sizeLods:a,_sigmas:t}}function GE(e){var a=new ja(3*cu,3*cu,e);return a.texture.mapping=Pt,a.texture.name="PMREM.cubeUv",a.scissorTest=!0,a}function n_(e,a,t,s,l){e.viewport.set(a,t,s,l),e.scissor.set(a,t,s,l)}function $C(e){var a=new Float32Array(e),t=new pe(0,1,0),s=new Qu({name:"SphericalGaussianBlur",defines:{n:e},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:a},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:t},inputEncoding:{value:uu[Da]},outputEncoding:{value:uu[Da]}},vertexShader:eS(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			`+tS()+`

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

				gl_FragColor = linearToOutputTexel( gl_FragColor );

			}
		`,blending:X,depthTest:!1,depthWrite:!1});return s}function VE(){var e=new bn(1,1),a=new Qu({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:e},inputEncoding:{value:uu[Da]},outputEncoding:{value:uu[Da]}},vertexShader:eS(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform vec2 texelSize;

			`+tS()+`

			#include <common>

			void main() {

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				vec2 f = fract( uv / texelSize - 0.5 );
				uv -= f * texelSize;
				vec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.x += texelSize.x;
				vec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.y += texelSize.y;
				vec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.x -= texelSize.x;
				vec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;

				vec3 tm = mix( tl, tr, f.x );
				vec3 bm = mix( bl, br, f.x );
				gl_FragColor.rgb = mix( tm, bm, f.y );

				gl_FragColor = linearToOutputTexel( gl_FragColor );

			}
		`,blending:X,depthTest:!1,depthWrite:!1});return a}function WE(){var e=new Qu({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:uu[Da]},outputEncoding:{value:uu[Da]}},vertexShader:eS(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			`+tS()+`

			void main() {

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;
				gl_FragColor = linearToOutputTexel( gl_FragColor );

			}
		`,blending:X,depthTest:!1,depthWrite:!1});return e}function eS(){return`

		precision mediump float;
		precision mediump int;

		attribute vec3 position;
		attribute vec2 uv;
		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function tS(){return`

		uniform int inputEncoding;
		uniform int outputEncoding;

		#include <encodings_pars_fragment>

		vec4 inputTexelToLinear( vec4 value ) {

			if ( inputEncoding == 0 ) {

				return value;

			} else if ( inputEncoding == 1 ) {

				return sRGBToLinear( value );

			} else if ( inputEncoding == 2 ) {

				return RGBEToLinear( value );

			} else if ( inputEncoding == 3 ) {

				return RGBMToLinear( value, 7.0 );

			} else if ( inputEncoding == 4 ) {

				return RGBMToLinear( value, 16.0 );

			} else if ( inputEncoding == 5 ) {

				return RGBDToLinear( value, 256.0 );

			} else {

				return GammaToLinear( value, 2.2 );

			}

		}

		vec4 linearToOutputTexel( vec4 value ) {

			if ( outputEncoding == 0 ) {

				return value;

			} else if ( outputEncoding == 1 ) {

				return LinearTosRGB( value );

			} else if ( outputEncoding == 2 ) {

				return LinearToRGBE( value );

			} else if ( outputEncoding == 3 ) {

				return LinearToRGBM( value, 7.0 );

			} else if ( outputEncoding == 4 ) {

				return LinearToRGBM( value, 16.0 );

			} else if ( outputEncoding == 5 ) {

				return LinearToRGBD( value, 256.0 );

			} else {

				return LinearToGamma( value, 2.2 );

			}

		}

		vec4 envMapTexelToLinear( vec4 color ) {

			return inputTexelToLinear( color );

		}
	`}Ui.create=function(e,a){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(Ui.prototype),e.prototype.constructor=e,e.prototype.getPoint=a,e},Object.assign(eh.prototype,{createPointsGeometry:function(e){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var a=this.getPoints(e);return this.createGeometry(a)},createSpacedPointsGeometry:function(e){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var a=this.getSpacedPoints(e);return this.createGeometry(a)},createGeometry:function(e){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var a=new Ss,t=0,s=e.length;t<s;t++){var l=e[t];a.vertices.push(new pe(l.x,l.y,l.z||0))}return a}}),Object.assign(xc.prototype,{fromPoints:function(e){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)}});function XE(e){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),oo.call(this,e),this.type="catmullrom",this.closed=!0}XE.prototype=Object.create(oo.prototype);function qE(e){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),oo.call(this,e),this.type="catmullrom"}qE.prototype=Object.create(oo.prototype);function nS(e){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),oo.call(this,e),this.type="catmullrom"}nS.prototype=Object.create(oo.prototype),Object.assign(nS.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),DE.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},LE.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(bs.prototype,{extractUrlBase:function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),DM.extractUrlBase(e)}}),bs.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Object.assign(SE.prototype,{center:function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},size:function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign(Tl.prototype,{center:function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionSphere:function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},size:function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign(ro.prototype,{empty:function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()}}),hv.prototype.setFromMatrix=function(e){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(e)},TE.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Object.assign(nr,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(e){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),nr.floorPowerOfTwo(e)},nextPowerOfTwo:function(e){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),nr.ceilPowerOfTwo(e)}}),Object.assign(qa.prototype,{flattenToArrayOffset:function(e,a){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,a)},multiplyVector3:function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(e){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(wr.prototype,{extractPosition:function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},flattenToArrayOffset:function(e,a){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,a)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),new pe().setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector4:function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(e){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(e,a,t,s,l,f){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,a,s,t,l,f)}}),so.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},ka.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},Object.assign(sl.prototype,{isIntersectionBox:function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionPlane:function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},isIntersectionSphere:function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)}}),Object.assign(zo.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(e,a){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,a)},midpoint:function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},normal:function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},plane:function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)}}),Object.assign(zo,{barycoordFromPoint:function(e,a,t,s,l){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),zo.getBarycoord(e,a,t,s,l)},normal:function(e,a,t,s){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),zo.getNormal(e,a,t,s)}}),Object.assign(df.prototype,{extractAllPoints:function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},extrude:function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new cM(this,e)},makeGeometry:function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new pM(this,e)}}),Object.assign(bn.prototype,{fromAttribute:function(e,a,t){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,a,t)},distanceToManhattan:function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(pe.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,a){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(a,e)},applyProjection:function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},fromAttribute:function(e,a,t){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,a,t)},distanceToManhattan:function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(ps.prototype,{fromAttribute:function(e,a,t){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,a,t)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Ss.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")},applyMatrix:function(e){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Object.assign(Ei.prototype,{getChildByName:function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(e,a){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(a,e)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(e){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Object.defineProperties(Ei.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.assign(xr.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}),Object.defineProperties(xr.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),Jg},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Object.defineProperties(_v.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(cx.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),lx.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(Ui.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),Ms.prototype.setLens=function(e,a){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),a!==void 0&&(this.filmGauge=a),this.setFocalLength(e)},Object.defineProperties(Fs.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(qi.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===Ts},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(Ts)}}}),Object.assign(qi.prototype,{setDynamic:function(e){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(e===!0?Ts:ad),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(qe.prototype,{addIndex:function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},addAttribute:function(e,a){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),!(a&&a.isBufferAttribute)&&!(a&&a.isInterleavedBufferAttribute)?(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(e,new qi(arguments[1],arguments[2]))):e==="index"?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(a),this):this.setAttribute(e,a)},addDrawCall:function(e,a,t){t!==void 0&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,a)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(e){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(e)},applyMatrix:function(e){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Object.defineProperties(qe.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(Iv.prototype,{maxInstancedCount:{get:function(){return console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount},set:function(e){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount=e}}}),Object.defineProperties(jM.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(e){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=e}}}),Object.defineProperties(cl.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===Ts},set:function(e){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(e)}}}),Object.assign(cl.prototype,{setDynamic:function(e){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(e===!0?Ts:ad),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(Lv.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.assign(Yw.prototype,{dispose:function(){console.error("THREE.Scene: .dispose() has been removed.")}}),Object.defineProperties(bE.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(zi.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new mi}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=e===N}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(e){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=e}}}),Object.defineProperties(ff.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(hf.prototype,{transparency:{get:function(){return console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission},set:function(e){console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission=e}}}),Object.defineProperties(za.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),Object.assign(mv.prototype,{clearTarget:function(e,a,t,s){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(e),this.clear(a,t,s)},animate:function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(e)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Object.defineProperties(mv.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(e){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=e===!0?Uu:Da}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(M1.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(ja.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),Object.defineProperties(UM.prototype,{load:{value:function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var a=this,t=new Yx;return t.load(e,function(s){a.setBuffer(s)}),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),yE.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},tm.prototype.updateCubeMap=function(e,a){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,a)},na.crossOrigin=void 0,na.loadTexture=function(e,a,t,s){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var l=new Nx;l.setCrossOrigin(this.crossOrigin);var f=l.load(e,t,void 0,s);return a&&(f.mapping=a),f},na.loadTextureCube=function(e,a,t,s){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var l=new Ox;l.setCrossOrigin(this.crossOrigin);var f=l.load(e,t,void 0,s);return a&&(f.mapping=a),f},na.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},na.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:u}})),n.ACESFilmicToneMapping=bt,n.AddEquation=Re,n.AddOperation=Ye,n.AdditiveAnimationBlendMode=ac,n.AdditiveBlending=te,n.AlphaFormat=bo,n.AlwaysDepth=Dn,n.AlwaysStencilFunc=ev,n.AmbientLight=Hx,n.AmbientLightProbe=zM,n.AnimationClip=Il,n.AnimationLoader=wM,n.AnimationMixer=WM,n.AnimationObjectGroup=_E,n.AnimationUtils=Gs,n.ArcCurve=ym,n.ArrayCamera=ix,n.ArrowHelper=jC,n.Audio=UM,n.AudioAnalyser=yE,n.AudioContext=BM,n.AudioListener=SC,n.AudioLoader=Yx,n.AxesHelper=BE,n.AxisHelper=function(e){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new BE(e)},n.BackSide=O,n.BasicDepthPacking=Qg,n.BasicShadowMap=0,n.BinaryTextureLoader=function(e){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new Ix(e)},n.Bone=Jw,n.BooleanKeyframeTrack=Cx,n.BoundingBoxHelper=function(e,a){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new NE(e,a)},n.Box2=SE,n.Box3=Tl,n.Box3Helper=XC,n.BoxBufferGeometry=ol,n.BoxGeometry=tM,n.BoxHelper=NE,n.BufferAttribute=qi,n.BufferGeometry=qe,n.BufferGeometryLoader=Xx,n.ByteType=zs,n.Cache=Ed,n.Camera=Ta,n.CameraHelper=WC,n.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been removed")},n.CanvasTexture=wv,n.CatmullRomCurve3=oo,n.CineonToneMapping=ot,n.CircleBufferGeometry=nM,n.CircleGeometry=z1,n.ClampToEdgeWrapping=xn,n.Clock=mE,n.ClosedSplineCurve3=XE,n.Color=mi,n.ColorKeyframeTrack=Px,n.CompressedTexture=hm,n.CompressedTextureLoader=MM,n.ConeBufferGeometry=H1,n.ConeGeometry=U1,n.CubeCamera=tm,n.CubeGeometry=tM,n.CubeReflectionMapping=oe,n.CubeRefractionMapping=lt,n.CubeTexture=ru,n.CubeTextureLoader=Ox,n.CubeUVReflectionMapping=Pt,n.CubeUVRefractionMapping=Kt,n.CubicBezierCurve=mc,n.CubicBezierCurve3=ou,n.CubicInterpolant=Ax,n.CullFaceBack=g,n.CullFaceFront=b,n.CullFaceFrontBack=3,n.CullFaceNone=p,n.Curve=Ui,n.CurvePath=eh,n.CustomBlending=Pe,n.CustomToneMapping=Mt,n.CylinderBufferGeometry=Sv,n.CylinderGeometry=iM,n.Cylindrical=BC,n.DataTexture=gd,n.DataTexture2DArray=im,n.DataTexture3D=rm,n.DataTextureLoader=Ix,n.DecrementStencilOp=7683,n.DecrementWrapStencilOp=34056,n.DefaultLoadingManager=oE,n.DepthFormat=Qn,n.DepthStencilFormat=ar,n.DepthTexture=Mv,n.DirectionalLight=Ux,n.DirectionalLightHelper=VC,n.DiscreteInterpolant=Lx,n.DodecahedronBufferGeometry=rM,n.DodecahedronGeometry=G1,n.DoubleSide=k,n.DstAlphaFactor=Ve,n.DstColorFactor=ft,n.DynamicBufferAttribute=function(e,a){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new qi(e,a).setUsage(Ts)},n.DynamicCopyUsage=35050,n.DynamicDrawUsage=Ts,n.DynamicReadUsage=35049,n.EdgesGeometry=aM,n.EdgesHelper=function(e,a){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new Eo(new aM(e.geometry),new Js({color:a!==void 0?a:16777215}))},n.EllipseCurve=hl,n.EqualDepth=he,n.EqualStencilFunc=514,n.EquirectangularReflectionMapping=yt,n.EquirectangularRefractionMapping=Ce,n.Euler=Yp,n.EventDispatcher=il,n.ExtrudeBufferGeometry=Lv,n.ExtrudeGeometry=cM,n.Face3=pd,n.Face4=function(e,a,t,s,l,f,v){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new pd(e,a,t,l,f,v)},n.FaceColors=1,n.FileLoader=Nl,n.FlatShading=N,n.Float32Attribute=function(e,a){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new L(e,a)},n.Float32BufferAttribute=L,n.Float64Attribute=function(e,a){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new I(e,a)},n.Float64BufferAttribute=I,n.FloatType=xs,n.Fog=A1,n.FogExp2=T1,n.Font=NM,n.FontLoader=FM,n.FrontSide=F,n.Frustum=hv,n.GLBufferAttribute=qM,n.GLSL1="100",n.GLSL3=od,n.GammaEncoding=rd,n.Geometry=Ss,n.GeometryUtils={merge:function(e,a,t){console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.");var s;a.isMesh&&(a.matrixAutoUpdate&&a.updateMatrix(),s=a.matrix,a=a.geometry),e.merge(a,s,t)},center:function(e){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),e.center()}},n.GreaterDepth=Fe,n.GreaterEqualDepth=K,n.GreaterEqualStencilFunc=518,n.GreaterStencilFunc=516,n.GridHelper=DE,n.Group=of,n.HalfFloatType=tl,n.HemisphereLight=Bx,n.HemisphereLightHelper=HC,n.HemisphereLightProbe=kM,n.IcosahedronBufferGeometry=uM,n.IcosahedronGeometry=Z1,n.ImageBitmapLoader=OM,n.ImageLoader=vm,n.ImageUtils=na,n.ImmediateRenderObject=Nv,n.IncrementStencilOp=7682,n.IncrementWrapStencilOp=34055,n.InstancedBufferAttribute=Wx,n.InstancedBufferGeometry=Iv,n.InstancedInterleavedBuffer=XM,n.InstancedMesh=hx,n.Int16Attribute=function(e,a){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new Ju(e,a)},n.Int16BufferAttribute=Ju,n.Int32Attribute=function(e,a){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new xe(e,a)},n.Int32BufferAttribute=xe,n.Int8Attribute=function(e,a){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new tf(e,a)},n.Int8BufferAttribute=tf,n.IntType=to,n.InterleavedBuffer=cl,n.InterleavedBufferAttribute=lf,n.Interpolant=ul,n.InterpolateDiscrete=nd,n.InterpolateLinear=id,n.InterpolateSmooth=Vp,n.InvertStencilOp=5386,n.JSONLoader=function(){console.error("THREE.JSONLoader has been removed.")},n.KeepStencilOp=Yc,n.KeyframeTrack=Za,n.LOD=_v,n.LatheBufferGeometry=hM,n.LatheGeometry=J1,n.Layers=av,n.LensFlare=function(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")},n.LessDepth=Ci,n.LessEqualDepth=vi,n.LessEqualStencilFunc=515,n.LessStencilFunc=513,n.Light=Fs,n.LightProbe=Fl,n.Line=Ol,n.Line3=TE,n.LineBasicMaterial=Js,n.LineCurve=Go,n.LineCurve3=gc,n.LineDashedMaterial=Sd,n.LineLoop=gx,n.LinePieces=1,n.LineSegments=Eo,n.LineStrip=0,n.LinearEncoding=Da,n.LinearFilter=jn,n.LinearInterpolant=Pv,n.LinearMipMapLinearFilter=1008,n.LinearMipMapNearestFilter=1007,n.LinearMipmapLinearFilter=ts,n.LinearMipmapNearestFilter=er,n.LinearToneMapping=He,n.Loader=bs,n.LoaderUtils=DM,n.LoadingManager=bM,n.LogLuvEncoding=Oa,n.LoopOnce=ku,n.LoopPingPong=q0,n.LoopRepeat=kr,n.LuminanceAlphaFormat=Rt,n.LuminanceFormat=Dt,n.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},n.Material=zi,n.MaterialLoader=Vx,n.Math=nr,n.MathUtils=nr,n.Matrix3=qa,n.Matrix4=wr,n.MaxEquation=Gt,n.Mesh=xr,n.MeshBasicMaterial=Sa,n.MeshDepthMaterial=sf,n.MeshDistanceMaterial=af,n.MeshFaceMaterial=function(e){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),e},n.MeshLambertMaterial=wd,n.MeshMatcapMaterial=Md,n.MeshNormalMaterial=bd,n.MeshPhongMaterial=ff,n.MeshPhysicalMaterial=hf,n.MeshStandardMaterial=au,n.MeshToonMaterial=_d,n.MinEquation=$e,n.MirroredRepeatWrapping=Oe,n.MixOperation=Be,n.MultiMaterial=function(e){return e===void 0&&(e=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),e.isMultiMaterial=!0,e.materials=e,e.clone=function(){return e.slice()},e},n.MultiplyBlending=W,n.MultiplyOperation=Le,n.NearestFilter=Ht,n.NearestMipMapLinearFilter=1005,n.NearestMipMapNearestFilter=1004,n.NearestMipmapLinearFilter=hn,n.NearestMipmapNearestFilter=Kn,n.NeverDepth=Vt,n.NeverStencilFunc=512,n.NoBlending=X,n.NoColors=0,n.NoToneMapping=ke,n.NormalAnimationBlendMode=sc,n.NormalBlending=ne,n.NotEqualDepth=me,n.NotEqualStencilFunc=517,n.NumberKeyframeTrack=mm,n.Object3D=Ei,n.ObjectLoader=xC,n.ObjectSpaceNormalMap=j0,n.OctahedronBufferGeometry=Ex,n.OctahedronGeometry=$1,n.OneFactor=an,n.OneMinusDstAlphaFactor=ht,n.OneMinusDstColorFactor=Wt,n.OneMinusSrcAlphaFactor=je,n.OneMinusSrcColorFactor=et,n.OrthographicCamera=xm,n.PCFShadowMap=M,n.PCFSoftShadowMap=A,n.PMREMGenerator=YC,n.ParametricBufferGeometry=pm,n.ParametricGeometry=Cv,n.Particle=function(e){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new xv(e)},n.ParticleBasicMaterial=function(e){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new dc(e)},n.ParticleSystem=function(e,a){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new um(e,a)},n.ParticleSystemMaterial=function(e){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new dc(e)},n.Path=xc,n.PerspectiveCamera=Ms,n.Plane=so,n.PlaneBufferGeometry=nx,n.PlaneGeometry=K1,n.PlaneHelper=qC,n.PointCloud=function(e,a){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new um(e,a)},n.PointCloudMaterial=function(e){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new dc(e)},n.PointLight=zx,n.PointLightHelper=zC,n.Points=um,n.PointsMaterial=dc,n.PolarGridHelper=GC,n.PolyhedronBufferGeometry=yd,n.PolyhedronGeometry=Q1,n.PositionalAudio=TC,n.PropertyBinding=lo,n.PropertyMixer=HM,n.QuadraticBezierCurve=vc,n.QuadraticBezierCurve3=lu,n.Quaternion=ka,n.QuaternionKeyframeTrack=Rv,n.QuaternionLinearInterpolant=Rx,n.REVISION=u,n.RGBADepthPacking=oc,n.RGBAFormat=ye,n.RGBAIntegerFormat=Ii,n.RGBA_ASTC_10x10_Format=Wg,n.RGBA_ASTC_10x5_Format=H0,n.RGBA_ASTC_10x6_Format=G0,n.RGBA_ASTC_10x8_Format=Uh,n.RGBA_ASTC_12x10_Format=V0,n.RGBA_ASTC_12x12_Format=Xg,n.RGBA_ASTC_4x4_Format=Ug,n.RGBA_ASTC_5x4_Format=Hp,n.RGBA_ASTC_5x5_Format=Hg,n.RGBA_ASTC_6x5_Format=Gg,n.RGBA_ASTC_6x6_Format=k0,n.RGBA_ASTC_8x5_Format=z0,n.RGBA_ASTC_8x6_Format=U0,n.RGBA_ASTC_8x8_Format=Vg,n.RGBA_BPTC_Format=wo,n.RGBA_ETC2_EAC_Format=Up,n.RGBA_PVRTC_2BPPV1_Format=nc,n.RGBA_PVRTC_4BPPV1_Format=ma,n.RGBA_S3TC_DXT1_Format=oa,n.RGBA_S3TC_DXT3_Format=Wr,n.RGBA_S3TC_DXT5_Format=Us,n.RGBDEncoding=Kg,n.RGBEEncoding=jc,n.RGBEFormat=rn,n.RGBFormat=nl,n.RGBIntegerFormat=Is,n.RGBM16Encoding=sd,n.RGBM7Encoding=$g,n.RGB_ETC1_Format=la,n.RGB_ETC2_Format=ic,n.RGB_PVRTC_2BPPV1_Format=tc,n.RGB_PVRTC_4BPPV1_Format=Zs,n.RGB_S3TC_DXT1_Format=Vr,n.RGFormat=tr,n.RGIntegerFormat=Os,n.RawShaderMaterial=Qu,n.Ray=sl,n.Raycaster=jM,n.RectAreaLight=Gx,n.RedFormat=dr,n.RedIntegerFormat=Mr,n.ReinhardToneMapping=Je,n.RepeatWrapping=qn,n.ReplaceStencilOp=7681,n.ReverseSubtractEquation=de,n.RingBufferGeometry=fM,n.RingGeometry=eE,n.SRGB8_ALPHA8_ASTC_10x10_Format=Zg,n.SRGB8_ALPHA8_ASTC_10x5_Format=Yg,n.SRGB8_ALPHA8_ASTC_10x6_Format=rc,n.SRGB8_ALPHA8_ASTC_10x8_Format=X0,n.SRGB8_ALPHA8_ASTC_12x10_Format=td,n.SRGB8_ALPHA8_ASTC_12x12_Format=Mo,n.SRGB8_ALPHA8_ASTC_4x4_Format=Hh,n.SRGB8_ALPHA8_ASTC_5x4_Format=Bu,n.SRGB8_ALPHA8_ASTC_5x5_Format=W0,n.SRGB8_ALPHA8_ASTC_6x5_Format=fs,n.SRGB8_ALPHA8_ASTC_6x6_Format=Gh,n.SRGB8_ALPHA8_ASTC_8x5_Format=Gp,n.SRGB8_ALPHA8_ASTC_8x6_Format=qg,n.SRGB8_ALPHA8_ASTC_8x8_Format=jg,n.Scene=Yw,n.SceneUtils={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}},n.ShaderChunk=Nr,n.ShaderLib=fc,n.ShaderMaterial=za,n.ShadowMaterial=xd,n.Shape=df,n.ShapeBufferGeometry=dM,n.ShapeGeometry=pM,n.ShapePath=IM,n.ShapeUtils=Ku,n.ShortType=Ra,n.Skeleton=cx,n.SkeletonHelper=LE,n.SkinnedMesh=lx,n.SmoothShading=2,n.Sphere=ro,n.SphereBufferGeometry=Tx,n.SphereGeometry=tE,n.Spherical=FC,n.SphericalHarmonics3=cE,n.Spline=nS,n.SplineCurve=yc,n.SplineCurve3=qE,n.SpotLight=kx,n.SpotLightHelper=kC,n.Sprite=xv,n.SpriteMaterial=cf,n.SrcAlphaFactor=rt,n.SrcAlphaSaturateFactor=An,n.SrcColorFactor=_t,n.StaticCopyUsage=35046,n.StaticDrawUsage=ad,n.StaticReadUsage=35045,n.StereoCamera=pE,n.StreamCopyUsage=35042,n.StreamDrawUsage=35040,n.StreamReadUsage=35041,n.StringKeyframeTrack=Dx,n.SubtractEquation=Ne,n.SubtractiveBlending=j,n.TOUCH={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},n.TangentSpaceNormalMap=Hu,n.TetrahedronBufferGeometry=mM,n.TetrahedronGeometry=nE,n.TextBufferGeometry=gM,n.TextGeometry=iE,n.Texture=ds,n.TextureLoader=Nx,n.TorusBufferGeometry=vM,n.TorusGeometry=rE,n.TorusKnotBufferGeometry=yM,n.TorusKnotGeometry=sE,n.Triangle=zo,n.TriangleFanDrawMode=2,n.TriangleStripDrawMode=1,n.TrianglesDrawMode=Jg,n.TubeBufferGeometry=xM,n.TubeGeometry=aE,n.UVMapping=ue,n.Uint16Attribute=function(e,a){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new $u(e,a)},n.Uint16BufferAttribute=$u,n.Uint32Attribute=function(e,a){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new S(e,a)},n.Uint32BufferAttribute=S,n.Uint8Attribute=function(e,a){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new md(e,a)},n.Uint8BufferAttribute=md,n.Uint8ClampedAttribute=function(e,a){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new Zu(e,a)},n.Uint8ClampedBufferAttribute=Zu,n.Uniform=bE,n.UniformsLib=fi,n.UniformsUtils=iu,n.UnsignedByteType=wa,n.UnsignedInt248Type=io,n.UnsignedIntType=Ds,n.UnsignedShort4444Type=no,n.UnsignedShort5551Type=El,n.UnsignedShort565Type=ta,n.UnsignedShortType=ec,n.VSMShadowMap=C,n.Vector2=bn,n.Vector3=pe,n.Vector4=ps,n.VectorKeyframeTrack=gm,n.Vertex=function(e,a,t){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new pe(e,a,t)},n.VertexColors=2,n.VideoTexture=Qw,n.WebGL1Renderer=jw,n.WebGLCubeRenderTarget=nf,n.WebGLMultisampleRenderTarget=ko,n.WebGLRenderTarget=ja,n.WebGLRenderTargetCube=function(e,a,t){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new nf(e,t)},n.WebGLRenderer=mv,n.WebGLUtils=S1,n.WireframeGeometry=_M,n.WireframeHelper=function(e,a){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new Eo(new _M(e.geometry),new Js({color:a!==void 0?a:16777215}))},n.WrapAroundEnding=Vh,n.XHRLoader=function(e){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new Nl(e)},n.ZeroCurvatureEnding=zu,n.ZeroFactor=dt,n.ZeroSlopeEnding=qc,n.ZeroStencilOp=0,n.sRGBEncoding=Uu,Object.defineProperty(n,"__esModule",{value:!0})})}),en=Rn(Un);Un.GLTFLoader;const Yt="121",Pn={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Nt={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},Ee=0,Xe=1,pt=2,wt=1,kt=2,mt=3,St=0,It=1,Tn=2,Ft=1,cn=0,nn=1,di=2,Ri=3,Ti=4,Gi=5,Xn=100,zt=101,Ln=102,Nn=103,Tt=104,_n=200,Ut=201,ce=202,At=203,$t=204,wn=205,Gn=206,yi=207,ir=208,Oi=209,Rr=210,Qi=0,Bi=1,ni=2,li=3,at=4,Ge=5,ct=6,Cn=7,jt=0,pn=1,ki=2,Ai=0,jr=1,Si=2,or=3,ns=4,rr=5,lr=300,xt=301,sn=302,_i=303,Hr=304,Er=306,ci=307,cr=1e3,$r=1001,Lo=1002,Kr=1003,Na=1004,tn=1005,ti=1006,$n=1007,es=1008,os=1009,Ls=1010,Ga=1011,ha=1012,kv=1013,Dr=1014,Tr=1015,ur=1016,Ws=1017,ho=1018,gr=1019,ah=1020,Tm=1021,Or=1022,vr=1023,vf=1024,yf=1025,zv=vr,hu=1026,dl=1027,oh=1028,Uv=1029,Hv=1030,Mc=1031,Id=1032,fo=1033,pl=33776,Am=33777,Sc=33778,Nd=33779,lh=35840,Fd=35841,Ir=35842,Cs=35843,us=36196,Lm=37492,ch=37496,Gv=37808,Xs=37809,uh=37810,Cm=37811,po=37812,Xo=37813,Pm=37814,Vv=37815,fu=37816,hh=37817,Wv=37818,Rm=37819,Co=37820,Bd=37821,Dm=36492,Xv=37840,kd=37841,qv=37842,Po=37843,xf=37844,fa=37845,jv=37846,Yv=37847,_f=37848,Zv=37849,Ec=37850,Om=37851,bf=37852,Tc=37853,wf=2200,Mf=2201,Jv=2202,fh=2300,mo=2301,Im=2302,dh=2400,ml=2401,du=2402,Ro=2500,Nm=2501,$v=0,Kv=1,Fm=2,Bl=3e3,ph=3001,Bm=3007,Sf=3002,zd=3003,Ud=3004,Qv=3005,a_=3006,pu=3200,o_=3201,mu=0,km=1,zm=7680,Um=519,Ef=35044,gu=35048,Hm="300 es";function go(){}Object.assign(go.prototype,{addEventListener:function(r,i){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[r]===void 0&&(n[r]=[]),n[r].indexOf(i)===-1&&n[r].push(i)},hasEventListener:function(r,i){if(this._listeners===void 0)return!1;const n=this._listeners;return n[r]!==void 0&&n[r].indexOf(i)!==-1},removeEventListener:function(r,i){if(this._listeners===void 0)return;const u=this._listeners[r];if(u!==void 0){const p=u.indexOf(i);p!==-1&&u.splice(p,1)}},dispatchEvent:function(r){if(this._listeners===void 0)return;const n=this._listeners[r.type];if(n!==void 0){r.target=this;const u=n.slice(0);for(let p=0,g=u.length;p<g;p++)u[p].call(this,r)}}});const Qs=[];for(let r=0;r<256;r++)Qs[r]=(r<16?"0":"")+r.toString(16);let Hd=1234567;const fr={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){const r=Math.random()*4294967295|0,i=Math.random()*4294967295|0,n=Math.random()*4294967295|0,u=Math.random()*4294967295|0;return(Qs[r&255]+Qs[r>>8&255]+Qs[r>>16&255]+Qs[r>>24&255]+"-"+Qs[i&255]+Qs[i>>8&255]+"-"+Qs[i>>16&15|64]+Qs[i>>24&255]+"-"+Qs[n&63|128]+Qs[n>>8&255]+"-"+Qs[n>>16&255]+Qs[n>>24&255]+Qs[u&255]+Qs[u>>8&255]+Qs[u>>16&255]+Qs[u>>24&255]).toUpperCase()},clamp:function(r,i,n){return Math.max(i,Math.min(n,r))},euclideanModulo:function(r,i){return(r%i+i)%i},mapLinear:function(r,i,n,u,p){return u+(r-i)*(p-u)/(n-i)},lerp:function(r,i,n){return(1-n)*r+n*i},smoothstep:function(r,i,n){return r<=i?0:r>=n?1:(r=(r-i)/(n-i),r*r*(3-2*r))},smootherstep:function(r,i,n){return r<=i?0:r>=n?1:(r=(r-i)/(n-i),r*r*r*(r*(r*6-15)+10))},randInt:function(r,i){return r+Math.floor(Math.random()*(i-r+1))},randFloat:function(r,i){return r+Math.random()*(i-r)},randFloatSpread:function(r){return r*(.5-Math.random())},seededRandom:function(r){return r!==void 0&&(Hd=r%2147483647),Hd=Hd*16807%2147483647,(Hd-1)/2147483646},degToRad:function(r){return r*fr.DEG2RAD},radToDeg:function(r){return r*fr.RAD2DEG},isPowerOfTwo:function(r){return(r&r-1)===0&&r!==0},ceilPowerOfTwo:function(r){return Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))},floorPowerOfTwo:function(r){return Math.pow(2,Math.floor(Math.log(r)/Math.LN2))},setQuaternionFromProperEuler:function(r,i,n,u,p){const g=Math.cos,b=Math.sin,M=g(n/2),A=b(n/2),C=g((i+u)/2),F=b((i+u)/2),O=g((i-u)/2),k=b((i-u)/2),N=g((u-i)/2),X=b((u-i)/2);switch(p){case"XYX":r.set(M*F,A*O,A*k,M*C);break;case"YZY":r.set(A*k,M*F,A*O,M*C);break;case"ZXZ":r.set(A*O,A*k,M*F,M*C);break;case"XZX":r.set(M*F,A*X,A*N,M*C);break;case"YXY":r.set(A*N,M*F,A*X,M*C);break;case"ZYZ":r.set(A*X,A*N,M*F,M*C);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+p)}}};class vn{constructor(i=0,n=0){Object.defineProperty(this,"isVector2",{value:!0}),this.x=i,this.y=n}get width(){return this.x}set width(i){this.x=i}get height(){return this.y}set height(i){this.y=i}set(i,n){return this.x=i,this.y=n,this}setScalar(i){return this.x=i,this.y=i,this}setX(i){return this.x=i,this}setY(i){return this.y=i,this}setComponent(i,n){switch(i){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+i)}return this}getComponent(i){switch(i){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+i)}}clone(){return new this.constructor(this.x,this.y)}copy(i){return this.x=i.x,this.y=i.y,this}add(i,n){return n!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(i,n)):(this.x+=i.x,this.y+=i.y,this)}addScalar(i){return this.x+=i,this.y+=i,this}addVectors(i,n){return this.x=i.x+n.x,this.y=i.y+n.y,this}addScaledVector(i,n){return this.x+=i.x*n,this.y+=i.y*n,this}sub(i,n){return n!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(i,n)):(this.x-=i.x,this.y-=i.y,this)}subScalar(i){return this.x-=i,this.y-=i,this}subVectors(i,n){return this.x=i.x-n.x,this.y=i.y-n.y,this}multiply(i){return this.x*=i.x,this.y*=i.y,this}multiplyScalar(i){return this.x*=i,this.y*=i,this}divide(i){return this.x/=i.x,this.y/=i.y,this}divideScalar(i){return this.multiplyScalar(1/i)}applyMatrix3(i){const n=this.x,u=this.y,p=i.elements;return this.x=p[0]*n+p[3]*u+p[6],this.y=p[1]*n+p[4]*u+p[7],this}min(i){return this.x=Math.min(this.x,i.x),this.y=Math.min(this.y,i.y),this}max(i){return this.x=Math.max(this.x,i.x),this.y=Math.max(this.y,i.y),this}clamp(i,n){return this.x=Math.max(i.x,Math.min(n.x,this.x)),this.y=Math.max(i.y,Math.min(n.y,this.y)),this}clampScalar(i,n){return this.x=Math.max(i,Math.min(n,this.x)),this.y=Math.max(i,Math.min(n,this.y)),this}clampLength(i,n){const u=this.length();return this.divideScalar(u||1).multiplyScalar(Math.max(i,Math.min(n,u)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(i){return this.x*i.x+this.y*i.y}cross(i){return this.x*i.y-this.y*i.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(i){return Math.sqrt(this.distanceToSquared(i))}distanceToSquared(i){const n=this.x-i.x,u=this.y-i.y;return n*n+u*u}manhattanDistanceTo(i){return Math.abs(this.x-i.x)+Math.abs(this.y-i.y)}setLength(i){return this.normalize().multiplyScalar(i)}lerp(i,n){return this.x+=(i.x-this.x)*n,this.y+=(i.y-this.y)*n,this}lerpVectors(i,n,u){return this.x=i.x+(n.x-i.x)*u,this.y=i.y+(n.y-i.y)*u,this}equals(i){return i.x===this.x&&i.y===this.y}fromArray(i,n){return n===void 0&&(n=0),this.x=i[n],this.y=i[n+1],this}toArray(i,n){return i===void 0&&(i=[]),n===void 0&&(n=0),i[n]=this.x,i[n+1]=this.y,i}fromBufferAttribute(i,n,u){return u!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=i.getX(n),this.y=i.getY(n),this}rotateAround(i,n){const u=Math.cos(n),p=Math.sin(n),g=this.x-i.x,b=this.y-i.y;return this.x=g*u-b*p+i.x,this.y=g*p+b*u+i.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}}class Ja{constructor(){Object.defineProperty(this,"isMatrix3",{value:!0}),this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(i,n,u,p,g,b,M,A,C){const F=this.elements;return F[0]=i,F[1]=p,F[2]=M,F[3]=n,F[4]=g,F[5]=A,F[6]=u,F[7]=b,F[8]=C,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}clone(){return new this.constructor().fromArray(this.elements)}copy(i){const n=this.elements,u=i.elements;return n[0]=u[0],n[1]=u[1],n[2]=u[2],n[3]=u[3],n[4]=u[4],n[5]=u[5],n[6]=u[6],n[7]=u[7],n[8]=u[8],this}extractBasis(i,n,u){return i.setFromMatrix3Column(this,0),n.setFromMatrix3Column(this,1),u.setFromMatrix3Column(this,2),this}setFromMatrix4(i){const n=i.elements;return this.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),this}multiply(i){return this.multiplyMatrices(this,i)}premultiply(i){return this.multiplyMatrices(i,this)}multiplyMatrices(i,n){const u=i.elements,p=n.elements,g=this.elements,b=u[0],M=u[3],A=u[6],C=u[1],F=u[4],O=u[7],k=u[2],N=u[5],X=u[8],ne=p[0],te=p[3],j=p[6],W=p[1],Pe=p[4],Re=p[7],Ne=p[2],de=p[5],$e=p[8];return g[0]=b*ne+M*W+A*Ne,g[3]=b*te+M*Pe+A*de,g[6]=b*j+M*Re+A*$e,g[1]=C*ne+F*W+O*Ne,g[4]=C*te+F*Pe+O*de,g[7]=C*j+F*Re+O*$e,g[2]=k*ne+N*W+X*Ne,g[5]=k*te+N*Pe+X*de,g[8]=k*j+N*Re+X*$e,this}multiplyScalar(i){const n=this.elements;return n[0]*=i,n[3]*=i,n[6]*=i,n[1]*=i,n[4]*=i,n[7]*=i,n[2]*=i,n[5]*=i,n[8]*=i,this}determinant(){const i=this.elements,n=i[0],u=i[1],p=i[2],g=i[3],b=i[4],M=i[5],A=i[6],C=i[7],F=i[8];return n*b*F-n*M*C-u*g*F+u*M*A+p*g*C-p*b*A}getInverse(i,n){n!==void 0&&console.warn("THREE.Matrix3: .getInverse() can no longer be configured to throw on degenerate.");const u=i.elements,p=this.elements,g=u[0],b=u[1],M=u[2],A=u[3],C=u[4],F=u[5],O=u[6],k=u[7],N=u[8],X=N*C-F*k,ne=F*O-N*A,te=k*A-C*O,j=g*X+b*ne+M*te;if(j===0)return this.set(0,0,0,0,0,0,0,0,0);const W=1/j;return p[0]=X*W,p[1]=(M*k-N*b)*W,p[2]=(F*b-M*C)*W,p[3]=ne*W,p[4]=(N*g-M*O)*W,p[5]=(M*A-F*g)*W,p[6]=te*W,p[7]=(b*O-k*g)*W,p[8]=(C*g-b*A)*W,this}transpose(){let i;const n=this.elements;return i=n[1],n[1]=n[3],n[3]=i,i=n[2],n[2]=n[6],n[6]=i,i=n[5],n[5]=n[7],n[7]=i,this}getNormalMatrix(i){return this.setFromMatrix4(i).getInverse(this).transpose()}transposeIntoArray(i){const n=this.elements;return i[0]=n[0],i[1]=n[3],i[2]=n[6],i[3]=n[1],i[4]=n[4],i[5]=n[7],i[6]=n[2],i[7]=n[5],i[8]=n[8],this}setUvTransform(i,n,u,p,g,b,M){const A=Math.cos(g),C=Math.sin(g);this.set(u*A,u*C,-u*(A*b+C*M)+b+i,-p*C,p*A,-p*(-C*b+A*M)+M+n,0,0,1)}scale(i,n){const u=this.elements;return u[0]*=i,u[3]*=i,u[6]*=i,u[1]*=n,u[4]*=n,u[7]*=n,this}rotate(i){const n=Math.cos(i),u=Math.sin(i),p=this.elements,g=p[0],b=p[3],M=p[6],A=p[1],C=p[4],F=p[7];return p[0]=n*g+u*A,p[3]=n*b+u*C,p[6]=n*M+u*F,p[1]=-u*g+n*A,p[4]=-u*b+n*C,p[7]=-u*M+n*F,this}translate(i,n){const u=this.elements;return u[0]+=i*u[2],u[3]+=i*u[5],u[6]+=i*u[8],u[1]+=n*u[2],u[4]+=n*u[5],u[7]+=n*u[8],this}equals(i){const n=this.elements,u=i.elements;for(let p=0;p<9;p++)if(n[p]!==u[p])return!1;return!0}fromArray(i,n){n===void 0&&(n=0);for(let u=0;u<9;u++)this.elements[u]=i[u+n];return this}toArray(i,n){i===void 0&&(i=[]),n===void 0&&(n=0);const u=this.elements;return i[n]=u[0],i[n+1]=u[1],i[n+2]=u[2],i[n+3]=u[3],i[n+4]=u[4],i[n+5]=u[5],i[n+6]=u[6],i[n+7]=u[7],i[n+8]=u[8],i}}let Ac;const kl={getDataURL:function(r){if(/^data:/i.test(r.src)||typeof HTMLCanvasElement>"u")return r.src;let i;if(r instanceof HTMLCanvasElement)i=r;else{Ac===void 0&&(Ac=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),Ac.width=r.width,Ac.height=r.height;const n=Ac.getContext("2d");r instanceof ImageData?n.putImageData(r,0,0):n.drawImage(r,0,0,r.width,r.height),i=Ac}return i.width>2048||i.height>2048?i.toDataURL("image/jpeg",.6):i.toDataURL("image/png")}};let ey=0;function gs(r,i,n,u,p,g,b,M,A,C){Object.defineProperty(this,"id",{value:ey++}),this.uuid=fr.generateUUID(),this.name="",this.image=r!==void 0?r:gs.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=i!==void 0?i:gs.DEFAULT_MAPPING,this.wrapS=n!==void 0?n:$r,this.wrapT=u!==void 0?u:$r,this.magFilter=p!==void 0?p:ti,this.minFilter=g!==void 0?g:es,this.anisotropy=A!==void 0?A:1,this.format=b!==void 0?b:vr,this.internalFormat=null,this.type=M!==void 0?M:os,this.offset=new vn(0,0),this.repeat=new vn(1,1),this.center=new vn(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ja,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=C!==void 0?C:Bl,this.version=0,this.onUpdate=null}gs.DEFAULT_IMAGE=void 0,gs.DEFAULT_MAPPING=lr,gs.prototype=Object.assign(Object.create(go.prototype),{constructor:gs,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return new this.constructor().copy(this)},copy:function(r){return this.name=r.name,this.image=r.image,this.mipmaps=r.mipmaps.slice(0),this.mapping=r.mapping,this.wrapS=r.wrapS,this.wrapT=r.wrapT,this.magFilter=r.magFilter,this.minFilter=r.minFilter,this.anisotropy=r.anisotropy,this.format=r.format,this.internalFormat=r.internalFormat,this.type=r.type,this.offset.copy(r.offset),this.repeat.copy(r.repeat),this.center.copy(r.center),this.rotation=r.rotation,this.matrixAutoUpdate=r.matrixAutoUpdate,this.matrix.copy(r.matrix),this.generateMipmaps=r.generateMipmaps,this.premultiplyAlpha=r.premultiplyAlpha,this.flipY=r.flipY,this.unpackAlignment=r.unpackAlignment,this.encoding=r.encoding,this},toJSON:function(r){const i=r===void 0||typeof r=="string";if(!i&&r.textures[this.uuid]!==void 0)return r.textures[this.uuid];const n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(this.image!==void 0){const u=this.image;if(u.uuid===void 0&&(u.uuid=fr.generateUUID()),!i&&r.images[u.uuid]===void 0){let p;if(Array.isArray(u)){p=[];for(let g=0,b=u.length;g<b;g++)p.push(kl.getDataURL(u[g]))}else p=kl.getDataURL(u);r.images[u.uuid]={uuid:u.uuid,url:p}}n.image=u.uuid}return i||(r.textures[this.uuid]=n),n},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(r){if(this.mapping!==lr)return r;if(r.applyMatrix3(this.matrix),r.x<0||r.x>1)switch(this.wrapS){case cr:r.x=r.x-Math.floor(r.x);break;case $r:r.x=r.x<0?0:1;break;case Lo:Math.abs(Math.floor(r.x)%2)===1?r.x=Math.ceil(r.x)-r.x:r.x=r.x-Math.floor(r.x);break}if(r.y<0||r.y>1)switch(this.wrapT){case cr:r.y=r.y-Math.floor(r.y);break;case $r:r.y=r.y<0?0:1;break;case Lo:Math.abs(Math.floor(r.y)%2)===1?r.y=Math.ceil(r.y)-r.y:r.y=r.y-Math.floor(r.y);break}return this.flipY&&(r.y=1-r.y),r}}),Object.defineProperty(gs.prototype,"needsUpdate",{set:function(r){r===!0&&this.version++}});class vs{constructor(i=0,n=0,u=0,p=1){Object.defineProperty(this,"isVector4",{value:!0}),this.x=i,this.y=n,this.z=u,this.w=p}get width(){return this.z}set width(i){this.z=i}get height(){return this.w}set height(i){this.w=i}set(i,n,u,p){return this.x=i,this.y=n,this.z=u,this.w=p,this}setScalar(i){return this.x=i,this.y=i,this.z=i,this.w=i,this}setX(i){return this.x=i,this}setY(i){return this.y=i,this}setZ(i){return this.z=i,this}setW(i){return this.w=i,this}setComponent(i,n){switch(i){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw new Error("index is out of range: "+i)}return this}getComponent(i){switch(i){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+i)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(i){return this.x=i.x,this.y=i.y,this.z=i.z,this.w=i.w!==void 0?i.w:1,this}add(i,n){return n!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(i,n)):(this.x+=i.x,this.y+=i.y,this.z+=i.z,this.w+=i.w,this)}addScalar(i){return this.x+=i,this.y+=i,this.z+=i,this.w+=i,this}addVectors(i,n){return this.x=i.x+n.x,this.y=i.y+n.y,this.z=i.z+n.z,this.w=i.w+n.w,this}addScaledVector(i,n){return this.x+=i.x*n,this.y+=i.y*n,this.z+=i.z*n,this.w+=i.w*n,this}sub(i,n){return n!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(i,n)):(this.x-=i.x,this.y-=i.y,this.z-=i.z,this.w-=i.w,this)}subScalar(i){return this.x-=i,this.y-=i,this.z-=i,this.w-=i,this}subVectors(i,n){return this.x=i.x-n.x,this.y=i.y-n.y,this.z=i.z-n.z,this.w=i.w-n.w,this}multiplyScalar(i){return this.x*=i,this.y*=i,this.z*=i,this.w*=i,this}applyMatrix4(i){const n=this.x,u=this.y,p=this.z,g=this.w,b=i.elements;return this.x=b[0]*n+b[4]*u+b[8]*p+b[12]*g,this.y=b[1]*n+b[5]*u+b[9]*p+b[13]*g,this.z=b[2]*n+b[6]*u+b[10]*p+b[14]*g,this.w=b[3]*n+b[7]*u+b[11]*p+b[15]*g,this}divideScalar(i){return this.multiplyScalar(1/i)}setAxisAngleFromQuaternion(i){this.w=2*Math.acos(i.w);const n=Math.sqrt(1-i.w*i.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=i.x/n,this.y=i.y/n,this.z=i.z/n),this}setAxisAngleFromRotationMatrix(i){let n,u,p,g;const A=i.elements,C=A[0],F=A[4],O=A[8],k=A[1],N=A[5],X=A[9],ne=A[2],te=A[6],j=A[10];if(Math.abs(F-k)<.01&&Math.abs(O-ne)<.01&&Math.abs(X-te)<.01){if(Math.abs(F+k)<.1&&Math.abs(O+ne)<.1&&Math.abs(X+te)<.1&&Math.abs(C+N+j-3)<.1)return this.set(1,0,0,0),this;n=Math.PI;const Pe=(C+1)/2,Re=(N+1)/2,Ne=(j+1)/2,de=(F+k)/4,$e=(O+ne)/4,Gt=(X+te)/4;return Pe>Re&&Pe>Ne?Pe<.01?(u=0,p=.707106781,g=.707106781):(u=Math.sqrt(Pe),p=de/u,g=$e/u):Re>Ne?Re<.01?(u=.707106781,p=0,g=.707106781):(p=Math.sqrt(Re),u=de/p,g=Gt/p):Ne<.01?(u=.707106781,p=.707106781,g=0):(g=Math.sqrt(Ne),u=$e/g,p=Gt/g),this.set(u,p,g,n),this}let W=Math.sqrt((te-X)*(te-X)+(O-ne)*(O-ne)+(k-F)*(k-F));return Math.abs(W)<.001&&(W=1),this.x=(te-X)/W,this.y=(O-ne)/W,this.z=(k-F)/W,this.w=Math.acos((C+N+j-1)/2),this}min(i){return this.x=Math.min(this.x,i.x),this.y=Math.min(this.y,i.y),this.z=Math.min(this.z,i.z),this.w=Math.min(this.w,i.w),this}max(i){return this.x=Math.max(this.x,i.x),this.y=Math.max(this.y,i.y),this.z=Math.max(this.z,i.z),this.w=Math.max(this.w,i.w),this}clamp(i,n){return this.x=Math.max(i.x,Math.min(n.x,this.x)),this.y=Math.max(i.y,Math.min(n.y,this.y)),this.z=Math.max(i.z,Math.min(n.z,this.z)),this.w=Math.max(i.w,Math.min(n.w,this.w)),this}clampScalar(i,n){return this.x=Math.max(i,Math.min(n,this.x)),this.y=Math.max(i,Math.min(n,this.y)),this.z=Math.max(i,Math.min(n,this.z)),this.w=Math.max(i,Math.min(n,this.w)),this}clampLength(i,n){const u=this.length();return this.divideScalar(u||1).multiplyScalar(Math.max(i,Math.min(n,u)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(i){return this.x*i.x+this.y*i.y+this.z*i.z+this.w*i.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(i){return this.normalize().multiplyScalar(i)}lerp(i,n){return this.x+=(i.x-this.x)*n,this.y+=(i.y-this.y)*n,this.z+=(i.z-this.z)*n,this.w+=(i.w-this.w)*n,this}lerpVectors(i,n,u){return this.x=i.x+(n.x-i.x)*u,this.y=i.y+(n.y-i.y)*u,this.z=i.z+(n.z-i.z)*u,this.w=i.w+(n.w-i.w)*u,this}equals(i){return i.x===this.x&&i.y===this.y&&i.z===this.z&&i.w===this.w}fromArray(i,n){return n===void 0&&(n=0),this.x=i[n],this.y=i[n+1],this.z=i[n+2],this.w=i[n+3],this}toArray(i,n){return i===void 0&&(i=[]),n===void 0&&(n=0),i[n]=this.x,i[n+1]=this.y,i[n+2]=this.z,i[n+3]=this.w,i}fromBufferAttribute(i,n,u){return u!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=i.getX(n),this.y=i.getY(n),this.z=i.getZ(n),this.w=i.getW(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}function qo(r,i,n){this.width=r,this.height=i,this.scissor=new vs(0,0,r,i),this.scissorTest=!1,this.viewport=new vs(0,0,r,i),n=n||{},this.texture=new gs(void 0,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.image={},this.texture.image.width=r,this.texture.image.height=i,this.texture.generateMipmaps=n.generateMipmaps!==void 0?n.generateMipmaps:!1,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:ti,this.depthBuffer=n.depthBuffer!==void 0?n.depthBuffer:!0,this.stencilBuffer=n.stencilBuffer!==void 0?n.stencilBuffer:!1,this.depthTexture=n.depthTexture!==void 0?n.depthTexture:null}qo.prototype=Object.assign(Object.create(go.prototype),{constructor:qo,isWebGLRenderTarget:!0,setSize:function(r,i){(this.width!==r||this.height!==i)&&(this.width=r,this.height=i,this.texture.image.width=r,this.texture.image.height=i,this.dispose()),this.viewport.set(0,0,r,i),this.scissor.set(0,0,r,i)},clone:function(){return new this.constructor().copy(this)},copy:function(r){return this.width=r.width,this.height=r.height,this.viewport.copy(r.viewport),this.texture=r.texture.clone(),this.depthBuffer=r.depthBuffer,this.stencilBuffer=r.stencilBuffer,this.depthTexture=r.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});function Gm(r,i,n){qo.call(this,r,i,n),this.samples=4}Gm.prototype=Object.assign(Object.create(qo.prototype),{constructor:Gm,isWebGLMultisampleRenderTarget:!0,copy:function(r){return qo.prototype.copy.call(this,r),this.samples=r.samples,this}});class Va{constructor(i=0,n=0,u=0,p=1){Object.defineProperty(this,"isQuaternion",{value:!0}),this._x=i,this._y=n,this._z=u,this._w=p}static slerp(i,n,u,p){return u.copy(i).slerp(n,p)}static slerpFlat(i,n,u,p,g,b,M){let A=u[p+0],C=u[p+1],F=u[p+2],O=u[p+3];const k=g[b+0],N=g[b+1],X=g[b+2],ne=g[b+3];if(O!==ne||A!==k||C!==N||F!==X){let te=1-M;const j=A*k+C*N+F*X+O*ne,W=j>=0?1:-1,Pe=1-j*j;if(Pe>Number.EPSILON){const Ne=Math.sqrt(Pe),de=Math.atan2(Ne,j*W);te=Math.sin(te*de)/Ne,M=Math.sin(M*de)/Ne}const Re=M*W;if(A=A*te+k*Re,C=C*te+N*Re,F=F*te+X*Re,O=O*te+ne*Re,te===1-M){const Ne=1/Math.sqrt(A*A+C*C+F*F+O*O);A*=Ne,C*=Ne,F*=Ne,O*=Ne}}i[n]=A,i[n+1]=C,i[n+2]=F,i[n+3]=O}static multiplyQuaternionsFlat(i,n,u,p,g,b){const M=u[p],A=u[p+1],C=u[p+2],F=u[p+3],O=g[b],k=g[b+1],N=g[b+2],X=g[b+3];return i[n]=M*X+F*O+A*N-C*k,i[n+1]=A*X+F*k+C*O-M*N,i[n+2]=C*X+F*N+M*k-A*O,i[n+3]=F*X-M*O-A*k-C*N,i}get x(){return this._x}set x(i){this._x=i,this._onChangeCallback()}get y(){return this._y}set y(i){this._y=i,this._onChangeCallback()}get z(){return this._z}set z(i){this._z=i,this._onChangeCallback()}get w(){return this._w}set w(i){this._w=i,this._onChangeCallback()}set(i,n,u,p){return this._x=i,this._y=n,this._z=u,this._w=p,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(i){return this._x=i.x,this._y=i.y,this._z=i.z,this._w=i.w,this._onChangeCallback(),this}setFromEuler(i,n){if(!(i&&i.isEuler))throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const u=i._x,p=i._y,g=i._z,b=i._order,M=Math.cos,A=Math.sin,C=M(u/2),F=M(p/2),O=M(g/2),k=A(u/2),N=A(p/2),X=A(g/2);switch(b){case"XYZ":this._x=k*F*O+C*N*X,this._y=C*N*O-k*F*X,this._z=C*F*X+k*N*O,this._w=C*F*O-k*N*X;break;case"YXZ":this._x=k*F*O+C*N*X,this._y=C*N*O-k*F*X,this._z=C*F*X-k*N*O,this._w=C*F*O+k*N*X;break;case"ZXY":this._x=k*F*O-C*N*X,this._y=C*N*O+k*F*X,this._z=C*F*X+k*N*O,this._w=C*F*O-k*N*X;break;case"ZYX":this._x=k*F*O-C*N*X,this._y=C*N*O+k*F*X,this._z=C*F*X-k*N*O,this._w=C*F*O+k*N*X;break;case"YZX":this._x=k*F*O+C*N*X,this._y=C*N*O+k*F*X,this._z=C*F*X-k*N*O,this._w=C*F*O-k*N*X;break;case"XZY":this._x=k*F*O-C*N*X,this._y=C*N*O-k*F*X,this._z=C*F*X+k*N*O,this._w=C*F*O+k*N*X;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+b)}return n!==!1&&this._onChangeCallback(),this}setFromAxisAngle(i,n){const u=n/2,p=Math.sin(u);return this._x=i.x*p,this._y=i.y*p,this._z=i.z*p,this._w=Math.cos(u),this._onChangeCallback(),this}setFromRotationMatrix(i){const n=i.elements,u=n[0],p=n[4],g=n[8],b=n[1],M=n[5],A=n[9],C=n[2],F=n[6],O=n[10],k=u+M+O;if(k>0){const N=.5/Math.sqrt(k+1);this._w=.25/N,this._x=(F-A)*N,this._y=(g-C)*N,this._z=(b-p)*N}else if(u>M&&u>O){const N=2*Math.sqrt(1+u-M-O);this._w=(F-A)/N,this._x=.25*N,this._y=(p+b)/N,this._z=(g+C)/N}else if(M>O){const N=2*Math.sqrt(1+M-u-O);this._w=(g-C)/N,this._x=(p+b)/N,this._y=.25*N,this._z=(A+F)/N}else{const N=2*Math.sqrt(1+O-u-M);this._w=(b-p)/N,this._x=(g+C)/N,this._y=(A+F)/N,this._z=.25*N}return this._onChangeCallback(),this}setFromUnitVectors(i,n){let p=i.dot(n)+1;return p<1e-6?(p=0,Math.abs(i.x)>Math.abs(i.z)?(this._x=-i.y,this._y=i.x,this._z=0,this._w=p):(this._x=0,this._y=-i.z,this._z=i.y,this._w=p)):(this._x=i.y*n.z-i.z*n.y,this._y=i.z*n.x-i.x*n.z,this._z=i.x*n.y-i.y*n.x,this._w=p),this.normalize()}angleTo(i){return 2*Math.acos(Math.abs(fr.clamp(this.dot(i),-1,1)))}rotateTowards(i,n){const u=this.angleTo(i);if(u===0)return this;const p=Math.min(1,n/u);return this.slerp(i,p),this}identity(){return this.set(0,0,0,1)}inverse(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(i){return this._x*i._x+this._y*i._y+this._z*i._z+this._w*i._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let i=this.length();return i===0?(this._x=0,this._y=0,this._z=0,this._w=1):(i=1/i,this._x=this._x*i,this._y=this._y*i,this._z=this._z*i,this._w=this._w*i),this._onChangeCallback(),this}multiply(i,n){return n!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(i,n)):this.multiplyQuaternions(this,i)}premultiply(i){return this.multiplyQuaternions(i,this)}multiplyQuaternions(i,n){const u=i._x,p=i._y,g=i._z,b=i._w,M=n._x,A=n._y,C=n._z,F=n._w;return this._x=u*F+b*M+p*C-g*A,this._y=p*F+b*A+g*M-u*C,this._z=g*F+b*C+u*A-p*M,this._w=b*F-u*M-p*A-g*C,this._onChangeCallback(),this}slerp(i,n){if(n===0)return this;if(n===1)return this.copy(i);const u=this._x,p=this._y,g=this._z,b=this._w;let M=b*i._w+u*i._x+p*i._y+g*i._z;if(M<0?(this._w=-i._w,this._x=-i._x,this._y=-i._y,this._z=-i._z,M=-M):this.copy(i),M>=1)return this._w=b,this._x=u,this._y=p,this._z=g,this;const A=1-M*M;if(A<=Number.EPSILON){const N=1-n;return this._w=N*b+n*this._w,this._x=N*u+n*this._x,this._y=N*p+n*this._y,this._z=N*g+n*this._z,this.normalize(),this._onChangeCallback(),this}const C=Math.sqrt(A),F=Math.atan2(C,M),O=Math.sin((1-n)*F)/C,k=Math.sin(n*F)/C;return this._w=b*O+this._w*k,this._x=u*O+this._x*k,this._y=p*O+this._y*k,this._z=g*O+this._z*k,this._onChangeCallback(),this}equals(i){return i._x===this._x&&i._y===this._y&&i._z===this._z&&i._w===this._w}fromArray(i,n){return n===void 0&&(n=0),this._x=i[n],this._y=i[n+1],this._z=i[n+2],this._w=i[n+3],this._onChangeCallback(),this}toArray(i,n){return i===void 0&&(i=[]),n===void 0&&(n=0),i[n]=this._x,i[n+1]=this._y,i[n+2]=this._z,i[n+3]=this._w,i}fromBufferAttribute(i,n){return this._x=i.getX(n),this._y=i.getY(n),this._z=i.getZ(n),this._w=i.getW(n),this}_onChange(i){return this._onChangeCallback=i,this}_onChangeCallback(){}}class De{constructor(i=0,n=0,u=0){Object.defineProperty(this,"isVector3",{value:!0}),this.x=i,this.y=n,this.z=u}set(i,n,u){return u===void 0&&(u=this.z),this.x=i,this.y=n,this.z=u,this}setScalar(i){return this.x=i,this.y=i,this.z=i,this}setX(i){return this.x=i,this}setY(i){return this.y=i,this}setZ(i){return this.z=i,this}setComponent(i,n){switch(i){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+i)}return this}getComponent(i){switch(i){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+i)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(i){return this.x=i.x,this.y=i.y,this.z=i.z,this}add(i,n){return n!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(i,n)):(this.x+=i.x,this.y+=i.y,this.z+=i.z,this)}addScalar(i){return this.x+=i,this.y+=i,this.z+=i,this}addVectors(i,n){return this.x=i.x+n.x,this.y=i.y+n.y,this.z=i.z+n.z,this}addScaledVector(i,n){return this.x+=i.x*n,this.y+=i.y*n,this.z+=i.z*n,this}sub(i,n){return n!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(i,n)):(this.x-=i.x,this.y-=i.y,this.z-=i.z,this)}subScalar(i){return this.x-=i,this.y-=i,this.z-=i,this}subVectors(i,n){return this.x=i.x-n.x,this.y=i.y-n.y,this.z=i.z-n.z,this}multiply(i,n){return n!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(i,n)):(this.x*=i.x,this.y*=i.y,this.z*=i.z,this)}multiplyScalar(i){return this.x*=i,this.y*=i,this.z*=i,this}multiplyVectors(i,n){return this.x=i.x*n.x,this.y=i.y*n.y,this.z=i.z*n.z,this}applyEuler(i){return i&&i.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Lc.setFromEuler(i))}applyAxisAngle(i,n){return this.applyQuaternion(Lc.setFromAxisAngle(i,n))}applyMatrix3(i){const n=this.x,u=this.y,p=this.z,g=i.elements;return this.x=g[0]*n+g[3]*u+g[6]*p,this.y=g[1]*n+g[4]*u+g[7]*p,this.z=g[2]*n+g[5]*u+g[8]*p,this}applyNormalMatrix(i){return this.applyMatrix3(i).normalize()}applyMatrix4(i){const n=this.x,u=this.y,p=this.z,g=i.elements,b=1/(g[3]*n+g[7]*u+g[11]*p+g[15]);return this.x=(g[0]*n+g[4]*u+g[8]*p+g[12])*b,this.y=(g[1]*n+g[5]*u+g[9]*p+g[13])*b,this.z=(g[2]*n+g[6]*u+g[10]*p+g[14])*b,this}applyQuaternion(i){const n=this.x,u=this.y,p=this.z,g=i.x,b=i.y,M=i.z,A=i.w,C=A*n+b*p-M*u,F=A*u+M*n-g*p,O=A*p+g*u-b*n,k=-g*n-b*u-M*p;return this.x=C*A+k*-g+F*-M-O*-b,this.y=F*A+k*-b+O*-g-C*-M,this.z=O*A+k*-M+C*-b-F*-g,this}project(i){return this.applyMatrix4(i.matrixWorldInverse).applyMatrix4(i.projectionMatrix)}unproject(i){return this.applyMatrix4(i.projectionMatrixInverse).applyMatrix4(i.matrixWorld)}transformDirection(i){const n=this.x,u=this.y,p=this.z,g=i.elements;return this.x=g[0]*n+g[4]*u+g[8]*p,this.y=g[1]*n+g[5]*u+g[9]*p,this.z=g[2]*n+g[6]*u+g[10]*p,this.normalize()}divide(i){return this.x/=i.x,this.y/=i.y,this.z/=i.z,this}divideScalar(i){return this.multiplyScalar(1/i)}min(i){return this.x=Math.min(this.x,i.x),this.y=Math.min(this.y,i.y),this.z=Math.min(this.z,i.z),this}max(i){return this.x=Math.max(this.x,i.x),this.y=Math.max(this.y,i.y),this.z=Math.max(this.z,i.z),this}clamp(i,n){return this.x=Math.max(i.x,Math.min(n.x,this.x)),this.y=Math.max(i.y,Math.min(n.y,this.y)),this.z=Math.max(i.z,Math.min(n.z,this.z)),this}clampScalar(i,n){return this.x=Math.max(i,Math.min(n,this.x)),this.y=Math.max(i,Math.min(n,this.y)),this.z=Math.max(i,Math.min(n,this.z)),this}clampLength(i,n){const u=this.length();return this.divideScalar(u||1).multiplyScalar(Math.max(i,Math.min(n,u)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(i){return this.x*i.x+this.y*i.y+this.z*i.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(i){return this.normalize().multiplyScalar(i)}lerp(i,n){return this.x+=(i.x-this.x)*n,this.y+=(i.y-this.y)*n,this.z+=(i.z-this.z)*n,this}lerpVectors(i,n,u){return this.x=i.x+(n.x-i.x)*u,this.y=i.y+(n.y-i.y)*u,this.z=i.z+(n.z-i.z)*u,this}cross(i,n){return n!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(i,n)):this.crossVectors(this,i)}crossVectors(i,n){const u=i.x,p=i.y,g=i.z,b=n.x,M=n.y,A=n.z;return this.x=p*A-g*M,this.y=g*b-u*A,this.z=u*M-p*b,this}projectOnVector(i){const n=i.lengthSq();if(n===0)return this.set(0,0,0);const u=i.dot(this)/n;return this.copy(i).multiplyScalar(u)}projectOnPlane(i){return Tf.copy(this).projectOnVector(i),this.sub(Tf)}reflect(i){return this.sub(Tf.copy(i).multiplyScalar(2*this.dot(i)))}angleTo(i){const n=Math.sqrt(this.lengthSq()*i.lengthSq());if(n===0)return Math.PI/2;const u=this.dot(i)/n;return Math.acos(fr.clamp(u,-1,1))}distanceTo(i){return Math.sqrt(this.distanceToSquared(i))}distanceToSquared(i){const n=this.x-i.x,u=this.y-i.y,p=this.z-i.z;return n*n+u*u+p*p}manhattanDistanceTo(i){return Math.abs(this.x-i.x)+Math.abs(this.y-i.y)+Math.abs(this.z-i.z)}setFromSpherical(i){return this.setFromSphericalCoords(i.radius,i.phi,i.theta)}setFromSphericalCoords(i,n,u){const p=Math.sin(n)*i;return this.x=p*Math.sin(u),this.y=Math.cos(n)*i,this.z=p*Math.cos(u),this}setFromCylindrical(i){return this.setFromCylindricalCoords(i.radius,i.theta,i.y)}setFromCylindricalCoords(i,n,u){return this.x=i*Math.sin(n),this.y=u,this.z=i*Math.cos(n),this}setFromMatrixPosition(i){const n=i.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this}setFromMatrixScale(i){const n=this.setFromMatrixColumn(i,0).length(),u=this.setFromMatrixColumn(i,1).length(),p=this.setFromMatrixColumn(i,2).length();return this.x=n,this.y=u,this.z=p,this}setFromMatrixColumn(i,n){return this.fromArray(i.elements,n*4)}setFromMatrix3Column(i,n){return this.fromArray(i.elements,n*3)}equals(i){return i.x===this.x&&i.y===this.y&&i.z===this.z}fromArray(i,n){return n===void 0&&(n=0),this.x=i[n],this.y=i[n+1],this.z=i[n+2],this}toArray(i,n){return i===void 0&&(i=[]),n===void 0&&(n=0),i[n]=this.x,i[n+1]=this.y,i[n+2]=this.z,i}fromBufferAttribute(i,n,u){return u!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=i.getX(n),this.y=i.getY(n),this.z=i.getZ(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}}const Tf=new De,Lc=new Va;class Ps{constructor(i,n){Object.defineProperty(this,"isBox3",{value:!0}),this.min=i!==void 0?i:new De(1/0,1/0,1/0),this.max=n!==void 0?n:new De(-1/0,-1/0,-1/0)}set(i,n){return this.min.copy(i),this.max.copy(n),this}setFromArray(i){let n=1/0,u=1/0,p=1/0,g=-1/0,b=-1/0,M=-1/0;for(let A=0,C=i.length;A<C;A+=3){const F=i[A],O=i[A+1],k=i[A+2];F<n&&(n=F),O<u&&(u=O),k<p&&(p=k),F>g&&(g=F),O>b&&(b=O),k>M&&(M=k)}return this.min.set(n,u,p),this.max.set(g,b,M),this}setFromBufferAttribute(i){let n=1/0,u=1/0,p=1/0,g=-1/0,b=-1/0,M=-1/0;for(let A=0,C=i.count;A<C;A++){const F=i.getX(A),O=i.getY(A),k=i.getZ(A);F<n&&(n=F),O<u&&(u=O),k<p&&(p=k),F>g&&(g=F),O>b&&(b=O),k>M&&(M=k)}return this.min.set(n,u,p),this.max.set(g,b,M),this}setFromPoints(i){this.makeEmpty();for(let n=0,u=i.length;n<u;n++)this.expandByPoint(i[n]);return this}setFromCenterAndSize(i,n){const u=mh.copy(n).multiplyScalar(.5);return this.min.copy(i).sub(u),this.max.copy(i).add(u),this}setFromObject(i){return this.makeEmpty(),this.expandByObject(i)}clone(){return new this.constructor().copy(this)}copy(i){return this.min.copy(i.min),this.max.copy(i.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(i){return i===void 0&&(console.warn("THREE.Box3: .getCenter() target is now required"),i=new De),this.isEmpty()?i.set(0,0,0):i.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(i){return i===void 0&&(console.warn("THREE.Box3: .getSize() target is now required"),i=new De),this.isEmpty()?i.set(0,0,0):i.subVectors(this.max,this.min)}expandByPoint(i){return this.min.min(i),this.max.max(i),this}expandByVector(i){return this.min.sub(i),this.max.add(i),this}expandByScalar(i){return this.min.addScalar(-i),this.max.addScalar(i),this}expandByObject(i){i.updateWorldMatrix(!1,!1);const n=i.geometry;n!==void 0&&(n.boundingBox===null&&n.computeBoundingBox(),jo.copy(n.boundingBox),jo.applyMatrix4(i.matrixWorld),this.union(jo));const u=i.children;for(let p=0,g=u.length;p<g;p++)this.expandByObject(u[p]);return this}containsPoint(i){return!(i.x<this.min.x||i.x>this.max.x||i.y<this.min.y||i.y>this.max.y||i.z<this.min.z||i.z>this.max.z)}containsBox(i){return this.min.x<=i.min.x&&i.max.x<=this.max.x&&this.min.y<=i.min.y&&i.max.y<=this.max.y&&this.min.z<=i.min.z&&i.max.z<=this.max.z}getParameter(i,n){return n===void 0&&(console.warn("THREE.Box3: .getParameter() target is now required"),n=new De),n.set((i.x-this.min.x)/(this.max.x-this.min.x),(i.y-this.min.y)/(this.max.y-this.min.y),(i.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(i){return!(i.max.x<this.min.x||i.min.x>this.max.x||i.max.y<this.min.y||i.min.y>this.max.y||i.max.z<this.min.z||i.min.z>this.max.z)}intersectsSphere(i){return this.clampPoint(i.center,mh),mh.distanceToSquared(i.center)<=i.radius*i.radius}intersectsPlane(i){let n,u;return i.normal.x>0?(n=i.normal.x*this.min.x,u=i.normal.x*this.max.x):(n=i.normal.x*this.max.x,u=i.normal.x*this.min.x),i.normal.y>0?(n+=i.normal.y*this.min.y,u+=i.normal.y*this.max.y):(n+=i.normal.y*this.max.y,u+=i.normal.y*this.min.y),i.normal.z>0?(n+=i.normal.z*this.min.z,u+=i.normal.z*this.max.z):(n+=i.normal.z*this.max.z,u+=i.normal.z*this.min.z),n<=-i.constant&&u>=-i.constant}intersectsTriangle(i){if(this.isEmpty())return!1;this.getCenter(Af),Gd.subVectors(this.max,Af),vu.subVectors(i.a,Af),gl.subVectors(i.b,Af),yu.subVectors(i.c,Af),Do.subVectors(gl,vu),Cc.subVectors(yu,gl),xu.subVectors(vu,yu);let n=[0,-Do.z,Do.y,0,-Cc.z,Cc.y,0,-xu.z,xu.y,Do.z,0,-Do.x,Cc.z,0,-Cc.x,xu.z,0,-xu.x,-Do.y,Do.x,0,-Cc.y,Cc.x,0,-xu.y,xu.x,0];return!qs(n,vu,gl,yu,Gd)||(n=[1,0,0,0,1,0,0,0,1],!qs(n,vu,gl,yu,Gd))?!1:(Lf.crossVectors(Do,Cc),n=[Lf.x,Lf.y,Lf.z],qs(n,vu,gl,yu,Gd))}clampPoint(i,n){return n===void 0&&(console.warn("THREE.Box3: .clampPoint() target is now required"),n=new De),n.copy(i).clamp(this.min,this.max)}distanceToPoint(i){return mh.copy(i).clamp(this.min,this.max).sub(i).length()}getBoundingSphere(i){return i===void 0&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(i.center),i.radius=this.getSize(mh).length()*.5,i}intersect(i){return this.min.max(i.min),this.max.min(i.max),this.isEmpty()&&this.makeEmpty(),this}union(i){return this.min.min(i.min),this.max.max(i.max),this}applyMatrix4(i){return this.isEmpty()?this:($a[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(i),$a[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(i),$a[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(i),$a[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(i),$a[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(i),$a[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(i),$a[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(i),$a[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(i),this.setFromPoints($a),this)}translate(i){return this.min.add(i),this.max.add(i),this}equals(i){return i.min.equals(this.min)&&i.max.equals(this.max)}}function qs(r,i,n,u,p){for(let g=0,b=r.length-3;g<=b;g+=3){Pc.fromArray(r,g);const M=p.x*Math.abs(Pc.x)+p.y*Math.abs(Pc.y)+p.z*Math.abs(Pc.z),A=i.dot(Pc),C=n.dot(Pc),F=u.dot(Pc);if(Math.max(-Math.max(A,C,F),Math.min(A,C,F))>M)return!1}return!0}const $a=[new De,new De,new De,new De,new De,new De,new De,new De],mh=new De,jo=new Ps,vu=new De,gl=new De,yu=new De,Do=new De,Cc=new De,xu=new De,Af=new De,Gd=new De,Lf=new De,Pc=new De,l_=new Ps;class zl{constructor(i,n){this.center=i!==void 0?i:new De,this.radius=n!==void 0?n:-1}set(i,n){return this.center.copy(i),this.radius=n,this}setFromPoints(i,n){const u=this.center;n!==void 0?u.copy(n):l_.setFromPoints(i).getCenter(u);let p=0;for(let g=0,b=i.length;g<b;g++)p=Math.max(p,u.distanceToSquared(i[g]));return this.radius=Math.sqrt(p),this}clone(){return new this.constructor().copy(this)}copy(i){return this.center.copy(i.center),this.radius=i.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(i){return i.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(i){return i.distanceTo(this.center)-this.radius}intersectsSphere(i){const n=this.radius+i.radius;return i.center.distanceToSquared(this.center)<=n*n}intersectsBox(i){return i.intersectsSphere(this)}intersectsPlane(i){return Math.abs(i.distanceToPoint(this.center))<=this.radius}clampPoint(i,n){const u=this.center.distanceToSquared(i);return n===void 0&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),n=new De),n.copy(i),u>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n}getBoundingBox(i){return i===void 0&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),i=new Ps),this.isEmpty()?(i.makeEmpty(),i):(i.set(this.center,this.center),i.expandByScalar(this.radius),i)}applyMatrix4(i){return this.center.applyMatrix4(i),this.radius=this.radius*i.getMaxScaleOnAxis(),this}translate(i){return this.center.add(i),this}equals(i){return i.center.equals(this.center)&&i.radius===this.radius}}const Ul=new De,_u=new De,bu=new De,Hl=new De,da=new De,wu=new De,Gl=new De;class Mu{constructor(i,n){this.origin=i!==void 0?i:new De,this.direction=n!==void 0?n:new De(0,0,-1)}set(i,n){return this.origin.copy(i),this.direction.copy(n),this}clone(){return new this.constructor().copy(this)}copy(i){return this.origin.copy(i.origin),this.direction.copy(i.direction),this}at(i,n){return n===void 0&&(console.warn("THREE.Ray: .at() target is now required"),n=new De),n.copy(this.direction).multiplyScalar(i).add(this.origin)}lookAt(i){return this.direction.copy(i).sub(this.origin).normalize(),this}recast(i){return this.origin.copy(this.at(i,Ul)),this}closestPointToPoint(i,n){n===void 0&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),n=new De),n.subVectors(i,this.origin);const u=n.dot(this.direction);return u<0?n.copy(this.origin):n.copy(this.direction).multiplyScalar(u).add(this.origin)}distanceToPoint(i){return Math.sqrt(this.distanceSqToPoint(i))}distanceSqToPoint(i){const n=Ul.subVectors(i,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(i):(Ul.copy(this.direction).multiplyScalar(n).add(this.origin),Ul.distanceToSquared(i))}distanceSqToSegment(i,n,u,p){_u.copy(i).add(n).multiplyScalar(.5),bu.copy(n).sub(i).normalize(),Hl.copy(this.origin).sub(_u);const g=i.distanceTo(n)*.5,b=-this.direction.dot(bu),M=Hl.dot(this.direction),A=-Hl.dot(bu),C=Hl.lengthSq(),F=Math.abs(1-b*b);let O,k,N,X;if(F>0)if(O=b*A-M,k=b*M-A,X=g*F,O>=0)if(k>=-X)if(k<=X){const ne=1/F;O*=ne,k*=ne,N=O*(O+b*k+2*M)+k*(b*O+k+2*A)+C}else k=g,O=Math.max(0,-(b*k+M)),N=-O*O+k*(k+2*A)+C;else k=-g,O=Math.max(0,-(b*k+M)),N=-O*O+k*(k+2*A)+C;else k<=-X?(O=Math.max(0,-(-b*g+M)),k=O>0?-g:Math.min(Math.max(-g,-A),g),N=-O*O+k*(k+2*A)+C):k<=X?(O=0,k=Math.min(Math.max(-g,-A),g),N=k*(k+2*A)+C):(O=Math.max(0,-(b*g+M)),k=O>0?g:Math.min(Math.max(-g,-A),g),N=-O*O+k*(k+2*A)+C);else k=b>0?-g:g,O=Math.max(0,-(b*k+M)),N=-O*O+k*(k+2*A)+C;return u&&u.copy(this.direction).multiplyScalar(O).add(this.origin),p&&p.copy(bu).multiplyScalar(k).add(_u),N}intersectSphere(i,n){Ul.subVectors(i.center,this.origin);const u=Ul.dot(this.direction),p=Ul.dot(Ul)-u*u,g=i.radius*i.radius;if(p>g)return null;const b=Math.sqrt(g-p),M=u-b,A=u+b;return M<0&&A<0?null:M<0?this.at(A,n):this.at(M,n)}intersectsSphere(i){return this.distanceSqToPoint(i.center)<=i.radius*i.radius}distanceToPlane(i){const n=i.normal.dot(this.direction);if(n===0)return i.distanceToPoint(this.origin)===0?0:null;const u=-(this.origin.dot(i.normal)+i.constant)/n;return u>=0?u:null}intersectPlane(i,n){const u=this.distanceToPlane(i);return u===null?null:this.at(u,n)}intersectsPlane(i){const n=i.distanceToPoint(this.origin);return n===0||i.normal.dot(this.direction)*n<0}intersectBox(i,n){let u,p,g,b,M,A;const C=1/this.direction.x,F=1/this.direction.y,O=1/this.direction.z,k=this.origin;return C>=0?(u=(i.min.x-k.x)*C,p=(i.max.x-k.x)*C):(u=(i.max.x-k.x)*C,p=(i.min.x-k.x)*C),F>=0?(g=(i.min.y-k.y)*F,b=(i.max.y-k.y)*F):(g=(i.max.y-k.y)*F,b=(i.min.y-k.y)*F),u>b||g>p||((g>u||u!==u)&&(u=g),(b<p||p!==p)&&(p=b),O>=0?(M=(i.min.z-k.z)*O,A=(i.max.z-k.z)*O):(M=(i.max.z-k.z)*O,A=(i.min.z-k.z)*O),u>A||M>p)||((M>u||u!==u)&&(u=M),(A<p||p!==p)&&(p=A),p<0)?null:this.at(u>=0?u:p,n)}intersectsBox(i){return this.intersectBox(i,Ul)!==null}intersectTriangle(i,n,u,p,g){da.subVectors(n,i),wu.subVectors(u,i),Gl.crossVectors(da,wu);let b=this.direction.dot(Gl),M;if(b>0){if(p)return null;M=1}else if(b<0)M=-1,b=-b;else return null;Hl.subVectors(this.origin,i);const A=M*this.direction.dot(wu.crossVectors(Hl,wu));if(A<0)return null;const C=M*this.direction.dot(da.cross(Hl));if(C<0||A+C>b)return null;const F=-M*Hl.dot(Gl);return F<0?null:this.at(F/b,g)}applyMatrix4(i){return this.origin.applyMatrix4(i),this.direction.transformDirection(i),this}equals(i){return i.origin.equals(this.origin)&&i.direction.equals(this.direction)}}class yr{constructor(){Object.defineProperty(this,"isMatrix4",{value:!0}),this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(i,n,u,p,g,b,M,A,C,F,O,k,N,X,ne,te){const j=this.elements;return j[0]=i,j[4]=n,j[8]=u,j[12]=p,j[1]=g,j[5]=b,j[9]=M,j[13]=A,j[2]=C,j[6]=F,j[10]=O,j[14]=k,j[3]=N,j[7]=X,j[11]=ne,j[15]=te,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new yr().fromArray(this.elements)}copy(i){const n=this.elements,u=i.elements;return n[0]=u[0],n[1]=u[1],n[2]=u[2],n[3]=u[3],n[4]=u[4],n[5]=u[5],n[6]=u[6],n[7]=u[7],n[8]=u[8],n[9]=u[9],n[10]=u[10],n[11]=u[11],n[12]=u[12],n[13]=u[13],n[14]=u[14],n[15]=u[15],this}copyPosition(i){const n=this.elements,u=i.elements;return n[12]=u[12],n[13]=u[13],n[14]=u[14],this}extractBasis(i,n,u){return i.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),u.setFromMatrixColumn(this,2),this}makeBasis(i,n,u){return this.set(i.x,n.x,u.x,0,i.y,n.y,u.y,0,i.z,n.z,u.z,0,0,0,0,1),this}extractRotation(i){const n=this.elements,u=i.elements,p=1/Su.setFromMatrixColumn(i,0).length(),g=1/Su.setFromMatrixColumn(i,1).length(),b=1/Su.setFromMatrixColumn(i,2).length();return n[0]=u[0]*p,n[1]=u[1]*p,n[2]=u[2]*p,n[3]=0,n[4]=u[4]*g,n[5]=u[5]*g,n[6]=u[6]*g,n[7]=0,n[8]=u[8]*b,n[9]=u[9]*b,n[10]=u[10]*b,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromEuler(i){i&&i.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const n=this.elements,u=i.x,p=i.y,g=i.z,b=Math.cos(u),M=Math.sin(u),A=Math.cos(p),C=Math.sin(p),F=Math.cos(g),O=Math.sin(g);if(i.order==="XYZ"){const k=b*F,N=b*O,X=M*F,ne=M*O;n[0]=A*F,n[4]=-A*O,n[8]=C,n[1]=N+X*C,n[5]=k-ne*C,n[9]=-M*A,n[2]=ne-k*C,n[6]=X+N*C,n[10]=b*A}else if(i.order==="YXZ"){const k=A*F,N=A*O,X=C*F,ne=C*O;n[0]=k+ne*M,n[4]=X*M-N,n[8]=b*C,n[1]=b*O,n[5]=b*F,n[9]=-M,n[2]=N*M-X,n[6]=ne+k*M,n[10]=b*A}else if(i.order==="ZXY"){const k=A*F,N=A*O,X=C*F,ne=C*O;n[0]=k-ne*M,n[4]=-b*O,n[8]=X+N*M,n[1]=N+X*M,n[5]=b*F,n[9]=ne-k*M,n[2]=-b*C,n[6]=M,n[10]=b*A}else if(i.order==="ZYX"){const k=b*F,N=b*O,X=M*F,ne=M*O;n[0]=A*F,n[4]=X*C-N,n[8]=k*C+ne,n[1]=A*O,n[5]=ne*C+k,n[9]=N*C-X,n[2]=-C,n[6]=M*A,n[10]=b*A}else if(i.order==="YZX"){const k=b*A,N=b*C,X=M*A,ne=M*C;n[0]=A*F,n[4]=ne-k*O,n[8]=X*O+N,n[1]=O,n[5]=b*F,n[9]=-M*F,n[2]=-C*F,n[6]=N*O+X,n[10]=k-ne*O}else if(i.order==="XZY"){const k=b*A,N=b*C,X=M*A,ne=M*C;n[0]=A*F,n[4]=-O,n[8]=C*F,n[1]=k*O+ne,n[5]=b*F,n[9]=N*O-X,n[2]=X*O-N,n[6]=M*F,n[10]=ne*O+k}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromQuaternion(i){return this.compose(c_,i,u_)}lookAt(i,n,u){const p=this.elements;return vo.subVectors(i,n),vo.lengthSq()===0&&(vo.z=1),vo.normalize(),Rc.crossVectors(u,vo),Rc.lengthSq()===0&&(Math.abs(u.z)===1?vo.x+=1e-4:vo.z+=1e-4,vo.normalize(),Rc.crossVectors(u,vo)),Rc.normalize(),Cf.crossVectors(vo,Rc),p[0]=Rc.x,p[4]=Cf.x,p[8]=vo.x,p[1]=Rc.y,p[5]=Cf.y,p[9]=vo.y,p[2]=Rc.z,p[6]=Cf.z,p[10]=vo.z,this}multiply(i,n){return n!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(i,n)):this.multiplyMatrices(this,i)}premultiply(i){return this.multiplyMatrices(i,this)}multiplyMatrices(i,n){const u=i.elements,p=n.elements,g=this.elements,b=u[0],M=u[4],A=u[8],C=u[12],F=u[1],O=u[5],k=u[9],N=u[13],X=u[2],ne=u[6],te=u[10],j=u[14],W=u[3],Pe=u[7],Re=u[11],Ne=u[15],de=p[0],$e=p[4],Gt=p[8],dt=p[12],an=p[1],_t=p[5],et=p[9],rt=p[13],je=p[2],Ve=p[6],ht=p[10],ft=p[14],Wt=p[3],An=p[7],Vt=p[11],Dn=p[15];return g[0]=b*de+M*an+A*je+C*Wt,g[4]=b*$e+M*_t+A*Ve+C*An,g[8]=b*Gt+M*et+A*ht+C*Vt,g[12]=b*dt+M*rt+A*ft+C*Dn,g[1]=F*de+O*an+k*je+N*Wt,g[5]=F*$e+O*_t+k*Ve+N*An,g[9]=F*Gt+O*et+k*ht+N*Vt,g[13]=F*dt+O*rt+k*ft+N*Dn,g[2]=X*de+ne*an+te*je+j*Wt,g[6]=X*$e+ne*_t+te*Ve+j*An,g[10]=X*Gt+ne*et+te*ht+j*Vt,g[14]=X*dt+ne*rt+te*ft+j*Dn,g[3]=W*de+Pe*an+Re*je+Ne*Wt,g[7]=W*$e+Pe*_t+Re*Ve+Ne*An,g[11]=W*Gt+Pe*et+Re*ht+Ne*Vt,g[15]=W*dt+Pe*rt+Re*ft+Ne*Dn,this}multiplyScalar(i){const n=this.elements;return n[0]*=i,n[4]*=i,n[8]*=i,n[12]*=i,n[1]*=i,n[5]*=i,n[9]*=i,n[13]*=i,n[2]*=i,n[6]*=i,n[10]*=i,n[14]*=i,n[3]*=i,n[7]*=i,n[11]*=i,n[15]*=i,this}determinant(){const i=this.elements,n=i[0],u=i[4],p=i[8],g=i[12],b=i[1],M=i[5],A=i[9],C=i[13],F=i[2],O=i[6],k=i[10],N=i[14],X=i[3],ne=i[7],te=i[11],j=i[15];return X*(+g*A*O-p*C*O-g*M*k+u*C*k+p*M*N-u*A*N)+ne*(+n*A*N-n*C*k+g*b*k-p*b*N+p*C*F-g*A*F)+te*(+n*C*O-n*M*N-g*b*O+u*b*N+g*M*F-u*C*F)+j*(-p*M*F-n*A*O+n*M*k+p*b*O-u*b*k+u*A*F)}transpose(){const i=this.elements;let n;return n=i[1],i[1]=i[4],i[4]=n,n=i[2],i[2]=i[8],i[8]=n,n=i[6],i[6]=i[9],i[9]=n,n=i[3],i[3]=i[12],i[12]=n,n=i[7],i[7]=i[13],i[13]=n,n=i[11],i[11]=i[14],i[14]=n,this}setPosition(i,n,u){const p=this.elements;return i.isVector3?(p[12]=i.x,p[13]=i.y,p[14]=i.z):(p[12]=i,p[13]=n,p[14]=u),this}getInverse(i,n){n!==void 0&&console.warn("THREE.Matrix4: .getInverse() can no longer be configured to throw on degenerate.");const u=this.elements,p=i.elements,g=p[0],b=p[1],M=p[2],A=p[3],C=p[4],F=p[5],O=p[6],k=p[7],N=p[8],X=p[9],ne=p[10],te=p[11],j=p[12],W=p[13],Pe=p[14],Re=p[15],Ne=X*Pe*k-W*ne*k+W*O*te-F*Pe*te-X*O*Re+F*ne*Re,de=j*ne*k-N*Pe*k-j*O*te+C*Pe*te+N*O*Re-C*ne*Re,$e=N*W*k-j*X*k+j*F*te-C*W*te-N*F*Re+C*X*Re,Gt=j*X*O-N*W*O-j*F*ne+C*W*ne+N*F*Pe-C*X*Pe,dt=g*Ne+b*de+M*$e+A*Gt;if(dt===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const an=1/dt;return u[0]=Ne*an,u[1]=(W*ne*A-X*Pe*A-W*M*te+b*Pe*te+X*M*Re-b*ne*Re)*an,u[2]=(F*Pe*A-W*O*A+W*M*k-b*Pe*k-F*M*Re+b*O*Re)*an,u[3]=(X*O*A-F*ne*A-X*M*k+b*ne*k+F*M*te-b*O*te)*an,u[4]=de*an,u[5]=(N*Pe*A-j*ne*A+j*M*te-g*Pe*te-N*M*Re+g*ne*Re)*an,u[6]=(j*O*A-C*Pe*A-j*M*k+g*Pe*k+C*M*Re-g*O*Re)*an,u[7]=(C*ne*A-N*O*A+N*M*k-g*ne*k-C*M*te+g*O*te)*an,u[8]=$e*an,u[9]=(j*X*A-N*W*A-j*b*te+g*W*te+N*b*Re-g*X*Re)*an,u[10]=(C*W*A-j*F*A+j*b*k-g*W*k-C*b*Re+g*F*Re)*an,u[11]=(N*F*A-C*X*A-N*b*k+g*X*k+C*b*te-g*F*te)*an,u[12]=Gt*an,u[13]=(N*W*M-j*X*M+j*b*ne-g*W*ne-N*b*Pe+g*X*Pe)*an,u[14]=(j*F*M-C*W*M-j*b*O+g*W*O+C*b*Pe-g*F*Pe)*an,u[15]=(C*X*M-N*F*M+N*b*O-g*X*O-C*b*ne+g*F*ne)*an,this}scale(i){const n=this.elements,u=i.x,p=i.y,g=i.z;return n[0]*=u,n[4]*=p,n[8]*=g,n[1]*=u,n[5]*=p,n[9]*=g,n[2]*=u,n[6]*=p,n[10]*=g,n[3]*=u,n[7]*=p,n[11]*=g,this}getMaxScaleOnAxis(){const i=this.elements,n=i[0]*i[0]+i[1]*i[1]+i[2]*i[2],u=i[4]*i[4]+i[5]*i[5]+i[6]*i[6],p=i[8]*i[8]+i[9]*i[9]+i[10]*i[10];return Math.sqrt(Math.max(n,u,p))}makeTranslation(i,n,u){return this.set(1,0,0,i,0,1,0,n,0,0,1,u,0,0,0,1),this}makeRotationX(i){const n=Math.cos(i),u=Math.sin(i);return this.set(1,0,0,0,0,n,-u,0,0,u,n,0,0,0,0,1),this}makeRotationY(i){const n=Math.cos(i),u=Math.sin(i);return this.set(n,0,u,0,0,1,0,0,-u,0,n,0,0,0,0,1),this}makeRotationZ(i){const n=Math.cos(i),u=Math.sin(i);return this.set(n,-u,0,0,u,n,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(i,n){const u=Math.cos(n),p=Math.sin(n),g=1-u,b=i.x,M=i.y,A=i.z,C=g*b,F=g*M;return this.set(C*b+u,C*M-p*A,C*A+p*M,0,C*M+p*A,F*M+u,F*A-p*b,0,C*A-p*M,F*A+p*b,g*A*A+u,0,0,0,0,1),this}makeScale(i,n,u){return this.set(i,0,0,0,0,n,0,0,0,0,u,0,0,0,0,1),this}makeShear(i,n,u){return this.set(1,n,u,0,i,1,u,0,i,n,1,0,0,0,0,1),this}compose(i,n,u){const p=this.elements,g=n._x,b=n._y,M=n._z,A=n._w,C=g+g,F=b+b,O=M+M,k=g*C,N=g*F,X=g*O,ne=b*F,te=b*O,j=M*O,W=A*C,Pe=A*F,Re=A*O,Ne=u.x,de=u.y,$e=u.z;return p[0]=(1-(ne+j))*Ne,p[1]=(N+Re)*Ne,p[2]=(X-Pe)*Ne,p[3]=0,p[4]=(N-Re)*de,p[5]=(1-(k+j))*de,p[6]=(te+W)*de,p[7]=0,p[8]=(X+Pe)*$e,p[9]=(te-W)*$e,p[10]=(1-(k+ne))*$e,p[11]=0,p[12]=i.x,p[13]=i.y,p[14]=i.z,p[15]=1,this}decompose(i,n,u){const p=this.elements;let g=Su.set(p[0],p[1],p[2]).length();const b=Su.set(p[4],p[5],p[6]).length(),M=Su.set(p[8],p[9],p[10]).length();this.determinant()<0&&(g=-g),i.x=p[12],i.y=p[13],i.z=p[14],Oo.copy(this);const C=1/g,F=1/b,O=1/M;return Oo.elements[0]*=C,Oo.elements[1]*=C,Oo.elements[2]*=C,Oo.elements[4]*=F,Oo.elements[5]*=F,Oo.elements[6]*=F,Oo.elements[8]*=O,Oo.elements[9]*=O,Oo.elements[10]*=O,n.setFromRotationMatrix(Oo),u.x=g,u.y=b,u.z=M,this}makePerspective(i,n,u,p,g,b){b===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const M=this.elements,A=2*g/(n-i),C=2*g/(u-p),F=(n+i)/(n-i),O=(u+p)/(u-p),k=-(b+g)/(b-g),N=-2*b*g/(b-g);return M[0]=A,M[4]=0,M[8]=F,M[12]=0,M[1]=0,M[5]=C,M[9]=O,M[13]=0,M[2]=0,M[6]=0,M[10]=k,M[14]=N,M[3]=0,M[7]=0,M[11]=-1,M[15]=0,this}makeOrthographic(i,n,u,p,g,b){const M=this.elements,A=1/(n-i),C=1/(u-p),F=1/(b-g),O=(n+i)*A,k=(u+p)*C,N=(b+g)*F;return M[0]=2*A,M[4]=0,M[8]=0,M[12]=-O,M[1]=0,M[5]=2*C,M[9]=0,M[13]=-k,M[2]=0,M[6]=0,M[10]=-2*F,M[14]=-N,M[3]=0,M[7]=0,M[11]=0,M[15]=1,this}equals(i){const n=this.elements,u=i.elements;for(let p=0;p<16;p++)if(n[p]!==u[p])return!1;return!0}fromArray(i,n){n===void 0&&(n=0);for(let u=0;u<16;u++)this.elements[u]=i[u+n];return this}toArray(i,n){i===void 0&&(i=[]),n===void 0&&(n=0);const u=this.elements;return i[n]=u[0],i[n+1]=u[1],i[n+2]=u[2],i[n+3]=u[3],i[n+4]=u[4],i[n+5]=u[5],i[n+6]=u[6],i[n+7]=u[7],i[n+8]=u[8],i[n+9]=u[9],i[n+10]=u[10],i[n+11]=u[11],i[n+12]=u[12],i[n+13]=u[13],i[n+14]=u[14],i[n+15]=u[15],i}}const Su=new De,Oo=new yr,c_=new De(0,0,0),u_=new De(1,1,1),Rc=new De,Cf=new De,vo=new De;class Pf{constructor(i=0,n=0,u=0,p=Pf.DefaultOrder){Object.defineProperty(this,"isEuler",{value:!0}),this._x=i,this._y=n,this._z=u,this._order=p}get x(){return this._x}set x(i){this._x=i,this._onChangeCallback()}get y(){return this._y}set y(i){this._y=i,this._onChangeCallback()}get z(){return this._z}set z(i){this._z=i,this._onChangeCallback()}get order(){return this._order}set order(i){this._order=i,this._onChangeCallback()}set(i,n,u,p){return this._x=i,this._y=n,this._z=u,this._order=p||this._order,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(i){return this._x=i._x,this._y=i._y,this._z=i._z,this._order=i._order,this._onChangeCallback(),this}setFromRotationMatrix(i,n,u){const p=fr.clamp,g=i.elements,b=g[0],M=g[4],A=g[8],C=g[1],F=g[5],O=g[9],k=g[2],N=g[6],X=g[10];switch(n=n||this._order,n){case"XYZ":this._y=Math.asin(p(A,-1,1)),Math.abs(A)<.9999999?(this._x=Math.atan2(-O,X),this._z=Math.atan2(-M,b)):(this._x=Math.atan2(N,F),this._z=0);break;case"YXZ":this._x=Math.asin(-p(O,-1,1)),Math.abs(O)<.9999999?(this._y=Math.atan2(A,X),this._z=Math.atan2(C,F)):(this._y=Math.atan2(-k,b),this._z=0);break;case"ZXY":this._x=Math.asin(p(N,-1,1)),Math.abs(N)<.9999999?(this._y=Math.atan2(-k,X),this._z=Math.atan2(-M,F)):(this._y=0,this._z=Math.atan2(C,b));break;case"ZYX":this._y=Math.asin(-p(k,-1,1)),Math.abs(k)<.9999999?(this._x=Math.atan2(N,X),this._z=Math.atan2(C,b)):(this._x=0,this._z=Math.atan2(-M,F));break;case"YZX":this._z=Math.asin(p(C,-1,1)),Math.abs(C)<.9999999?(this._x=Math.atan2(-O,F),this._y=Math.atan2(-k,b)):(this._x=0,this._y=Math.atan2(A,X));break;case"XZY":this._z=Math.asin(-p(M,-1,1)),Math.abs(M)<.9999999?(this._x=Math.atan2(N,F),this._y=Math.atan2(A,b)):(this._x=Math.atan2(-O,X),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,u!==!1&&this._onChangeCallback(),this}setFromQuaternion(i,n,u){return Vd.makeRotationFromQuaternion(i),this.setFromRotationMatrix(Vd,n,u)}setFromVector3(i,n){return this.set(i.x,i.y,i.z,n||this._order)}reorder(i){return Vm.setFromEuler(this),this.setFromQuaternion(Vm,i)}equals(i){return i._x===this._x&&i._y===this._y&&i._z===this._z&&i._order===this._order}fromArray(i){return this._x=i[0],this._y=i[1],this._z=i[2],i[3]!==void 0&&(this._order=i[3]),this._onChangeCallback(),this}toArray(i,n){return i===void 0&&(i=[]),n===void 0&&(n=0),i[n]=this._x,i[n+1]=this._y,i[n+2]=this._z,i[n+3]=this._order,i}toVector3(i){return i?i.set(this._x,this._y,this._z):new De(this._x,this._y,this._z)}_onChange(i){return this._onChangeCallback=i,this}_onChangeCallback(){}}Pf.DefaultOrder="XYZ",Pf.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];const Vd=new yr,Vm=new Va;class ty{constructor(){this.mask=1}set(i){this.mask=1<<i|0}enable(i){this.mask|=1<<i|0}enableAll(){this.mask=-1}toggle(i){this.mask^=1<<i|0}disable(i){this.mask&=~(1<<i|0)}disableAll(){this.mask=0}test(i){return(this.mask&i.mask)!==0}}let h_=0;const Wm=new De,Eu=new Va,Vl=new yr,Wd=new De,vl=new De,ny=new De,iy=new Va,ry=new De(1,0,0),sy=new De(0,1,0),Xm=new De(0,0,1),Xd={type:"added"},f_={type:"removed"};function Ni(){Object.defineProperty(this,"id",{value:h_++}),this.uuid=fr.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Ni.DefaultUp.clone();const r=new De,i=new Pf,n=new Va,u=new De(1,1,1);function p(){n.setFromEuler(i,!1)}function g(){i.setFromQuaternion(n,void 0,!1)}i._onChange(p),n._onChange(g),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:r},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:u},modelViewMatrix:{value:new yr},normalMatrix:{value:new Ja}}),this.matrix=new yr,this.matrixWorld=new yr,this.matrixAutoUpdate=Ni.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new ty,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}Ni.DefaultUp=new De(0,1,0),Ni.DefaultMatrixAutoUpdate=!0,Ni.prototype=Object.assign(Object.create(go.prototype),{constructor:Ni,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(r){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(r),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(r){return this.quaternion.premultiply(r),this},setRotationFromAxisAngle:function(r,i){this.quaternion.setFromAxisAngle(r,i)},setRotationFromEuler:function(r){this.quaternion.setFromEuler(r,!0)},setRotationFromMatrix:function(r){this.quaternion.setFromRotationMatrix(r)},setRotationFromQuaternion:function(r){this.quaternion.copy(r)},rotateOnAxis:function(r,i){return Eu.setFromAxisAngle(r,i),this.quaternion.multiply(Eu),this},rotateOnWorldAxis:function(r,i){return Eu.setFromAxisAngle(r,i),this.quaternion.premultiply(Eu),this},rotateX:function(r){return this.rotateOnAxis(ry,r)},rotateY:function(r){return this.rotateOnAxis(sy,r)},rotateZ:function(r){return this.rotateOnAxis(Xm,r)},translateOnAxis:function(r,i){return Wm.copy(r).applyQuaternion(this.quaternion),this.position.add(Wm.multiplyScalar(i)),this},translateX:function(r){return this.translateOnAxis(ry,r)},translateY:function(r){return this.translateOnAxis(sy,r)},translateZ:function(r){return this.translateOnAxis(Xm,r)},localToWorld:function(r){return r.applyMatrix4(this.matrixWorld)},worldToLocal:function(r){return r.applyMatrix4(Vl.getInverse(this.matrixWorld))},lookAt:function(r,i,n){r.isVector3?Wd.copy(r):Wd.set(r,i,n);const u=this.parent;this.updateWorldMatrix(!0,!1),vl.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Vl.lookAt(vl,Wd,this.up):Vl.lookAt(Wd,vl,this.up),this.quaternion.setFromRotationMatrix(Vl),u&&(Vl.extractRotation(u.matrixWorld),Eu.setFromRotationMatrix(Vl),this.quaternion.premultiply(Eu.inverse()))},add:function(r){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return r===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",r),this):(r&&r.isObject3D?(r.parent!==null&&r.parent.remove(r),r.parent=this,this.children.push(r),r.dispatchEvent(Xd)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",r),this)},remove:function(r){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const i=this.children.indexOf(r);return i!==-1&&(r.parent=null,this.children.splice(i,1),r.dispatchEvent(f_)),this},attach:function(r){return this.updateWorldMatrix(!0,!1),Vl.getInverse(this.matrixWorld),r.parent!==null&&(r.parent.updateWorldMatrix(!0,!1),Vl.multiply(r.parent.matrixWorld)),r.applyMatrix4(Vl),r.updateWorldMatrix(!1,!1),this.add(r),this},getObjectById:function(r){return this.getObjectByProperty("id",r)},getObjectByName:function(r){return this.getObjectByProperty("name",r)},getObjectByProperty:function(r,i){if(this[r]===i)return this;for(let n=0,u=this.children.length;n<u;n++){const g=this.children[n].getObjectByProperty(r,i);if(g!==void 0)return g}},getWorldPosition:function(r){return r===void 0&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),r=new De),this.updateWorldMatrix(!0,!1),r.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(r){return r===void 0&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),r=new Va),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(vl,r,ny),r},getWorldScale:function(r){return r===void 0&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),r=new De),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(vl,iy,r),r},getWorldDirection:function(r){r===void 0&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),r=new De),this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return r.set(i[8],i[9],i[10]).normalize()},raycast:function(){},traverse:function(r){r(this);const i=this.children;for(let n=0,u=i.length;n<u;n++)i[n].traverse(r)},traverseVisible:function(r){if(this.visible===!1)return;r(this);const i=this.children;for(let n=0,u=i.length;n<u;n++)i[n].traverseVisible(r)},traverseAncestors:function(r){const i=this.parent;i!==null&&(r(i),i.traverseAncestors(r))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(r){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||r)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,r=!0);const i=this.children;for(let n=0,u=i.length;n<u;n++)i[n].updateMatrixWorld(r)},updateWorldMatrix:function(r,i){const n=this.parent;if(r===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),i===!0){const u=this.children;for(let p=0,g=u.length;p<g;p++)u[p].updateWorldMatrix(!1,!0)}},toJSON:function(r){const i=r===void 0||typeof r=="string",n={};i&&(r={geometries:{},materials:{},textures:{},images:{},shapes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const u={};u.uuid=this.uuid,u.type=this.type,this.name!==""&&(u.name=this.name),this.castShadow===!0&&(u.castShadow=!0),this.receiveShadow===!0&&(u.receiveShadow=!0),this.visible===!1&&(u.visible=!1),this.frustumCulled===!1&&(u.frustumCulled=!1),this.renderOrder!==0&&(u.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(u.userData=this.userData),u.layers=this.layers.mask,u.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(u.matrixAutoUpdate=!1),this.isInstancedMesh&&(u.type="InstancedMesh",u.count=this.count,u.instanceMatrix=this.instanceMatrix.toJSON());function p(b,M){return b[M.uuid]===void 0&&(b[M.uuid]=M.toJSON(r)),M.uuid}if(this.isMesh||this.isLine||this.isPoints){u.geometry=p(r.geometries,this.geometry);const b=this.geometry.parameters;if(b!==void 0&&b.shapes!==void 0){const M=b.shapes;if(Array.isArray(M))for(let A=0,C=M.length;A<C;A++){const F=M[A];p(r.shapes,F)}else p(r.shapes,M)}}if(this.material!==void 0)if(Array.isArray(this.material)){const b=[];for(let M=0,A=this.material.length;M<A;M++)b.push(p(r.materials,this.material[M]));u.material=b}else u.material=p(r.materials,this.material);if(this.children.length>0){u.children=[];for(let b=0;b<this.children.length;b++)u.children.push(this.children[b].toJSON(r).object)}if(i){const b=g(r.geometries),M=g(r.materials),A=g(r.textures),C=g(r.images),F=g(r.shapes);b.length>0&&(n.geometries=b),M.length>0&&(n.materials=M),A.length>0&&(n.textures=A),C.length>0&&(n.images=C),F.length>0&&(n.shapes=F)}return n.object=u,n;function g(b){const M=[];for(const A in b){const C=b[A];delete C.metadata,M.push(C)}return M}},clone:function(r){return new this.constructor().copy(this,r)},copy:function(r,i){if(i===void 0&&(i=!0),this.name=r.name,this.up.copy(r.up),this.position.copy(r.position),this.rotation.order=r.rotation.order,this.quaternion.copy(r.quaternion),this.scale.copy(r.scale),this.matrix.copy(r.matrix),this.matrixWorld.copy(r.matrixWorld),this.matrixAutoUpdate=r.matrixAutoUpdate,this.matrixWorldNeedsUpdate=r.matrixWorldNeedsUpdate,this.layers.mask=r.layers.mask,this.visible=r.visible,this.castShadow=r.castShadow,this.receiveShadow=r.receiveShadow,this.frustumCulled=r.frustumCulled,this.renderOrder=r.renderOrder,this.userData=JSON.parse(JSON.stringify(r.userData)),i===!0)for(let n=0;n<r.children.length;n++){const u=r.children[n];this.add(u.clone())}return this}});const gh=new De,ay=new De,oy=new Ja;class Ka{constructor(i,n){Object.defineProperty(this,"isPlane",{value:!0}),this.normal=i!==void 0?i:new De(1,0,0),this.constant=n!==void 0?n:0}set(i,n){return this.normal.copy(i),this.constant=n,this}setComponents(i,n,u,p){return this.normal.set(i,n,u),this.constant=p,this}setFromNormalAndCoplanarPoint(i,n){return this.normal.copy(i),this.constant=-n.dot(this.normal),this}setFromCoplanarPoints(i,n,u){const p=gh.subVectors(u,n).cross(ay.subVectors(i,n)).normalize();return this.setFromNormalAndCoplanarPoint(p,i),this}clone(){return new this.constructor().copy(this)}copy(i){return this.normal.copy(i.normal),this.constant=i.constant,this}normalize(){const i=1/this.normal.length();return this.normal.multiplyScalar(i),this.constant*=i,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(i){return this.normal.dot(i)+this.constant}distanceToSphere(i){return this.distanceToPoint(i.center)-i.radius}projectPoint(i,n){return n===void 0&&(console.warn("THREE.Plane: .projectPoint() target is now required"),n=new De),n.copy(this.normal).multiplyScalar(-this.distanceToPoint(i)).add(i)}intersectLine(i,n){n===void 0&&(console.warn("THREE.Plane: .intersectLine() target is now required"),n=new De);const u=i.delta(gh),p=this.normal.dot(u);if(p===0)return this.distanceToPoint(i.start)===0?n.copy(i.start):void 0;const g=-(i.start.dot(this.normal)+this.constant)/p;if(!(g<0||g>1))return n.copy(u).multiplyScalar(g).add(i.start)}intersectsLine(i){const n=this.distanceToPoint(i.start),u=this.distanceToPoint(i.end);return n<0&&u>0||u<0&&n>0}intersectsBox(i){return i.intersectsPlane(this)}intersectsSphere(i){return i.intersectsPlane(this)}coplanarPoint(i){return i===void 0&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),i=new De),i.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(i,n){const u=n||oy.getNormalMatrix(i),p=this.coplanarPoint(gh).applyMatrix4(i),g=this.normal.applyMatrix3(u).normalize();return this.constant=-p.dot(g),this}translate(i){return this.constant-=i.dot(this.normal),this}equals(i){return i.normal.equals(this.normal)&&i.constant===this.constant}}const ya=new De,yl=new De,qd=new De,xl=new De,vh=new De,Yo=new De,ly=new De,qm=new De,Wl=new De,Rf=new De;class xa{constructor(i,n,u){this.a=i!==void 0?i:new De,this.b=n!==void 0?n:new De,this.c=u!==void 0?u:new De}static getNormal(i,n,u,p){p===void 0&&(console.warn("THREE.Triangle: .getNormal() target is now required"),p=new De),p.subVectors(u,n),ya.subVectors(i,n),p.cross(ya);const g=p.lengthSq();return g>0?p.multiplyScalar(1/Math.sqrt(g)):p.set(0,0,0)}static getBarycoord(i,n,u,p,g){ya.subVectors(p,n),yl.subVectors(u,n),qd.subVectors(i,n);const b=ya.dot(ya),M=ya.dot(yl),A=ya.dot(qd),C=yl.dot(yl),F=yl.dot(qd),O=b*C-M*M;if(g===void 0&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),g=new De),O===0)return g.set(-2,-1,-1);const k=1/O,N=(C*A-M*F)*k,X=(b*F-M*A)*k;return g.set(1-N-X,X,N)}static containsPoint(i,n,u,p){return this.getBarycoord(i,n,u,p,xl),xl.x>=0&&xl.y>=0&&xl.x+xl.y<=1}static getUV(i,n,u,p,g,b,M,A){return this.getBarycoord(i,n,u,p,xl),A.set(0,0),A.addScaledVector(g,xl.x),A.addScaledVector(b,xl.y),A.addScaledVector(M,xl.z),A}static isFrontFacing(i,n,u,p){return ya.subVectors(u,n),yl.subVectors(i,n),ya.cross(yl).dot(p)<0}set(i,n,u){return this.a.copy(i),this.b.copy(n),this.c.copy(u),this}setFromPointsAndIndices(i,n,u,p){return this.a.copy(i[n]),this.b.copy(i[u]),this.c.copy(i[p]),this}clone(){return new this.constructor().copy(this)}copy(i){return this.a.copy(i.a),this.b.copy(i.b),this.c.copy(i.c),this}getArea(){return ya.subVectors(this.c,this.b),yl.subVectors(this.a,this.b),ya.cross(yl).length()*.5}getMidpoint(i){return i===void 0&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),i=new De),i.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(i){return xa.getNormal(this.a,this.b,this.c,i)}getPlane(i){return i===void 0&&(console.warn("THREE.Triangle: .getPlane() target is now required"),i=new Ka),i.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(i,n){return xa.getBarycoord(i,this.a,this.b,this.c,n)}getUV(i,n,u,p,g){return xa.getUV(i,this.a,this.b,this.c,n,u,p,g)}containsPoint(i){return xa.containsPoint(i,this.a,this.b,this.c)}isFrontFacing(i){return xa.isFrontFacing(this.a,this.b,this.c,i)}intersectsBox(i){return i.intersectsTriangle(this)}closestPointToPoint(i,n){n===void 0&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),n=new De);const u=this.a,p=this.b,g=this.c;let b,M;vh.subVectors(p,u),Yo.subVectors(g,u),qm.subVectors(i,u);const A=vh.dot(qm),C=Yo.dot(qm);if(A<=0&&C<=0)return n.copy(u);Wl.subVectors(i,p);const F=vh.dot(Wl),O=Yo.dot(Wl);if(F>=0&&O<=F)return n.copy(p);const k=A*O-F*C;if(k<=0&&A>=0&&F<=0)return b=A/(A-F),n.copy(u).addScaledVector(vh,b);Rf.subVectors(i,g);const N=vh.dot(Rf),X=Yo.dot(Rf);if(X>=0&&N<=X)return n.copy(g);const ne=N*C-A*X;if(ne<=0&&C>=0&&X<=0)return M=C/(C-X),n.copy(u).addScaledVector(Yo,M);const te=F*X-N*O;if(te<=0&&O-F>=0&&N-X>=0)return ly.subVectors(g,p),M=(O-F)/(O-F+(N-X)),n.copy(p).addScaledVector(ly,M);const j=1/(te+ne+k);return b=ne*j,M=k*j,n.copy(u).addScaledVector(vh,b).addScaledVector(Yo,M)}equals(i){return i.a.equals(this.a)&&i.b.equals(this.b)&&i.c.equals(this.c)}}const jm={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Io={h:0,s:0,l:0},jd={h:0,s:0,l:0};function Df(r,i,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?r+(i-r)*6*n:n<1/2?i:n<2/3?r+(i-r)*6*(2/3-n):r}function Of(r){return r<.04045?r*.0773993808:Math.pow(r*.9478672986+.0521327014,2.4)}function Ym(r){return r<.0031308?r*12.92:1.055*Math.pow(r,.41666)-.055}class Mi{constructor(i,n,u){return Object.defineProperty(this,"isColor",{value:!0}),n===void 0&&u===void 0?this.set(i):this.setRGB(i,n,u)}set(i){return i&&i.isColor?this.copy(i):typeof i=="number"?this.setHex(i):typeof i=="string"&&this.setStyle(i),this}setScalar(i){return this.r=i,this.g=i,this.b=i,this}setHex(i){return i=Math.floor(i),this.r=(i>>16&255)/255,this.g=(i>>8&255)/255,this.b=(i&255)/255,this}setRGB(i,n,u){return this.r=i,this.g=n,this.b=u,this}setHSL(i,n,u){if(i=fr.euclideanModulo(i,1),n=fr.clamp(n,0,1),u=fr.clamp(u,0,1),n===0)this.r=this.g=this.b=u;else{const p=u<=.5?u*(1+n):u+n-u*n,g=2*u-p;this.r=Df(g,p,i+1/3),this.g=Df(g,p,i),this.b=Df(g,p,i-1/3)}return this}setStyle(i){function n(p){p!==void 0&&parseFloat(p)<1&&console.warn("THREE.Color: Alpha component of "+i+" will be ignored.")}let u;if(u=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(i)){let p;const g=u[1],b=u[2];switch(g){case"rgb":case"rgba":if(p=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(b))return this.r=Math.min(255,parseInt(p[1],10))/255,this.g=Math.min(255,parseInt(p[2],10))/255,this.b=Math.min(255,parseInt(p[3],10))/255,n(p[5]),this;if(p=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(b))return this.r=Math.min(100,parseInt(p[1],10))/100,this.g=Math.min(100,parseInt(p[2],10))/100,this.b=Math.min(100,parseInt(p[3],10))/100,n(p[5]),this;break;case"hsl":case"hsla":if(p=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(b)){const M=parseFloat(p[1])/360,A=parseInt(p[2],10)/100,C=parseInt(p[3],10)/100;return n(p[5]),this.setHSL(M,A,C)}break}}else if(u=/^\#([A-Fa-f0-9]+)$/.exec(i)){const p=u[1],g=p.length;if(g===3)return this.r=parseInt(p.charAt(0)+p.charAt(0),16)/255,this.g=parseInt(p.charAt(1)+p.charAt(1),16)/255,this.b=parseInt(p.charAt(2)+p.charAt(2),16)/255,this;if(g===6)return this.r=parseInt(p.charAt(0)+p.charAt(1),16)/255,this.g=parseInt(p.charAt(2)+p.charAt(3),16)/255,this.b=parseInt(p.charAt(4)+p.charAt(5),16)/255,this}return i&&i.length>0?this.setColorName(i):this}setColorName(i){const n=jm[i];return n!==void 0?this.setHex(n):console.warn("THREE.Color: Unknown color "+i),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(i){return this.r=i.r,this.g=i.g,this.b=i.b,this}copyGammaToLinear(i,n){return n===void 0&&(n=2),this.r=Math.pow(i.r,n),this.g=Math.pow(i.g,n),this.b=Math.pow(i.b,n),this}copyLinearToGamma(i,n){n===void 0&&(n=2);const u=n>0?1/n:1;return this.r=Math.pow(i.r,u),this.g=Math.pow(i.g,u),this.b=Math.pow(i.b,u),this}convertGammaToLinear(i){return this.copyGammaToLinear(this,i),this}convertLinearToGamma(i){return this.copyLinearToGamma(this,i),this}copySRGBToLinear(i){return this.r=Of(i.r),this.g=Of(i.g),this.b=Of(i.b),this}copyLinearToSRGB(i){return this.r=Ym(i.r),this.g=Ym(i.g),this.b=Ym(i.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return this.r*255<<16^this.g*255<<8^this.b*255<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(i){i===void 0&&(console.warn("THREE.Color: .getHSL() target is now required"),i={h:0,s:0,l:0});const n=this.r,u=this.g,p=this.b,g=Math.max(n,u,p),b=Math.min(n,u,p);let M,A;const C=(b+g)/2;if(b===g)M=0,A=0;else{const F=g-b;switch(A=C<=.5?F/(g+b):F/(2-g-b),g){case n:M=(u-p)/F+(u<p?6:0);break;case u:M=(p-n)/F+2;break;case p:M=(n-u)/F+4;break}M/=6}return i.h=M,i.s=A,i.l=C,i}getStyle(){return"rgb("+(this.r*255|0)+","+(this.g*255|0)+","+(this.b*255|0)+")"}offsetHSL(i,n,u){return this.getHSL(Io),Io.h+=i,Io.s+=n,Io.l+=u,this.setHSL(Io.h,Io.s,Io.l),this}add(i){return this.r+=i.r,this.g+=i.g,this.b+=i.b,this}addColors(i,n){return this.r=i.r+n.r,this.g=i.g+n.g,this.b=i.b+n.b,this}addScalar(i){return this.r+=i,this.g+=i,this.b+=i,this}sub(i){return this.r=Math.max(0,this.r-i.r),this.g=Math.max(0,this.g-i.g),this.b=Math.max(0,this.b-i.b),this}multiply(i){return this.r*=i.r,this.g*=i.g,this.b*=i.b,this}multiplyScalar(i){return this.r*=i,this.g*=i,this.b*=i,this}lerp(i,n){return this.r+=(i.r-this.r)*n,this.g+=(i.g-this.g)*n,this.b+=(i.b-this.b)*n,this}lerpHSL(i,n){this.getHSL(Io),i.getHSL(jd);const u=fr.lerp(Io.h,jd.h,n),p=fr.lerp(Io.s,jd.s,n),g=fr.lerp(Io.l,jd.l,n);return this.setHSL(u,p,g),this}equals(i){return i.r===this.r&&i.g===this.g&&i.b===this.b}fromArray(i,n){return n===void 0&&(n=0),this.r=i[n],this.g=i[n+1],this.b=i[n+2],this}toArray(i,n){return i===void 0&&(i=[]),n===void 0&&(n=0),i[n]=this.r,i[n+1]=this.g,i[n+2]=this.b,i}fromBufferAttribute(i,n){return this.r=i.getX(n),this.g=i.getY(n),this.b=i.getZ(n),i.normalized===!0&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}Mi.NAMES=jm,Mi.prototype.r=1,Mi.prototype.g=1,Mi.prototype.b=1;class Yd{constructor(i,n,u,p,g,b){this.a=i,this.b=n,this.c=u,this.normal=p&&p.isVector3?p:new De,this.vertexNormals=Array.isArray(p)?p:[],this.color=g&&g.isColor?g:new Mi,this.vertexColors=Array.isArray(g)?g:[],this.materialIndex=b!==void 0?b:0}clone(){return new this.constructor().copy(this)}copy(i){this.a=i.a,this.b=i.b,this.c=i.c,this.normal.copy(i.normal),this.color.copy(i.color),this.materialIndex=i.materialIndex;for(let n=0,u=i.vertexNormals.length;n<u;n++)this.vertexNormals[n]=i.vertexNormals[n].clone();for(let n=0,u=i.vertexColors.length;n<u;n++)this.vertexColors[n]=i.vertexColors[n].clone();return this}}let cy=0;function Yi(){Object.defineProperty(this,"id",{value:cy++}),this.uuid=fr.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=nn,this.side=St,this.flatShading=!1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=$t,this.blendDst=wn,this.blendEquation=Xn,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=li,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Um,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=zm,this.stencilZFail=zm,this.stencilZPass=zm,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}Yi.prototype=Object.assign(Object.create(go.prototype),{constructor:Yi,isMaterial:!0,onBeforeCompile:function(){},customProgramCacheKey:function(){return this.onBeforeCompile.toString()},setValues:function(r){if(r!==void 0)for(const i in r){const n=r[i];if(n===void 0){console.warn("THREE.Material: '"+i+"' parameter is undefined.");continue}if(i==="shading"){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=n===Ft;continue}const u=this[i];if(u===void 0){console.warn("THREE."+this.type+": '"+i+"' is not a property of this material.");continue}u&&u.isColor?u.set(n):u&&u.isVector3&&n&&n.isVector3?u.copy(n):this[i]=n}},toJSON:function(r){const i=r===void 0||typeof r=="string";i&&(r={textures:{},images:{}});const n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(n.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(r).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(r).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(r).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(r).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(r).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(r).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(r).uuid),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(r).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(r).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(r).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(r).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(r).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(r).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(r).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(r).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(r).uuid,n.reflectivity=this.reflectivity,n.refractionRatio=this.refractionRatio,this.combine!==void 0&&(n.combine=this.combine),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(r).uuid),this.size!==void 0&&(n.size=this.size),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==nn&&(n.blending=this.blending),this.flatShading===!0&&(n.flatShading=this.flatShading),this.side!==St&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.morphTargets===!0&&(n.morphTargets=!0),this.morphNormals===!0&&(n.morphNormals=!0),this.skinning===!0&&(n.skinning=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),JSON.stringify(this.userData)!=="{}"&&(n.userData=this.userData);function u(p){const g=[];for(const b in p){const M=p[b];delete M.metadata,g.push(M)}return g}if(i){const p=u(r.textures),g=u(r.images);p.length>0&&(n.textures=p),g.length>0&&(n.images=g)}return n},clone:function(){return new this.constructor().copy(this)},copy:function(r){this.name=r.name,this.fog=r.fog,this.blending=r.blending,this.side=r.side,this.flatShading=r.flatShading,this.vertexColors=r.vertexColors,this.opacity=r.opacity,this.transparent=r.transparent,this.blendSrc=r.blendSrc,this.blendDst=r.blendDst,this.blendEquation=r.blendEquation,this.blendSrcAlpha=r.blendSrcAlpha,this.blendDstAlpha=r.blendDstAlpha,this.blendEquationAlpha=r.blendEquationAlpha,this.depthFunc=r.depthFunc,this.depthTest=r.depthTest,this.depthWrite=r.depthWrite,this.stencilWriteMask=r.stencilWriteMask,this.stencilFunc=r.stencilFunc,this.stencilRef=r.stencilRef,this.stencilFuncMask=r.stencilFuncMask,this.stencilFail=r.stencilFail,this.stencilZFail=r.stencilZFail,this.stencilZPass=r.stencilZPass,this.stencilWrite=r.stencilWrite;const i=r.clippingPlanes;let n=null;if(i!==null){const u=i.length;n=new Array(u);for(let p=0;p!==u;++p)n[p]=i[p].clone()}return this.clippingPlanes=n,this.clipIntersection=r.clipIntersection,this.clipShadows=r.clipShadows,this.shadowSide=r.shadowSide,this.colorWrite=r.colorWrite,this.precision=r.precision,this.polygonOffset=r.polygonOffset,this.polygonOffsetFactor=r.polygonOffsetFactor,this.polygonOffsetUnits=r.polygonOffsetUnits,this.dithering=r.dithering,this.alphaTest=r.alphaTest,this.premultipliedAlpha=r.premultipliedAlpha,this.visible=r.visible,this.toneMapped=r.toneMapped,this.userData=JSON.parse(JSON.stringify(r.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(Yi.prototype,"needsUpdate",{set:function(r){r===!0&&this.version++}});function yo(r){Yi.call(this),this.type="MeshBasicMaterial",this.color=new Mi(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=jt,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(r)}yo.prototype=Object.create(Yi.prototype),yo.prototype.constructor=yo,yo.prototype.isMeshBasicMaterial=!0,yo.prototype.copy=function(r){return Yi.prototype.copy.call(this,r),this.color.copy(r.color),this.map=r.map,this.lightMap=r.lightMap,this.lightMapIntensity=r.lightMapIntensity,this.aoMap=r.aoMap,this.aoMapIntensity=r.aoMapIntensity,this.specularMap=r.specularMap,this.alphaMap=r.alphaMap,this.envMap=r.envMap,this.combine=r.combine,this.reflectivity=r.reflectivity,this.refractionRatio=r.refractionRatio,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.wireframeLinecap=r.wireframeLinecap,this.wireframeLinejoin=r.wireframeLinejoin,this.skinning=r.skinning,this.morphTargets=r.morphTargets,this};const ws=new De,Zd=new vn;function sr(r,i,n){if(Array.isArray(r))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=r,this.itemSize=i,this.count=r!==void 0?r.length/i:0,this.normalized=n===!0,this.usage=Ef,this.updateRange={offset:0,count:-1},this.version=0}Object.defineProperty(sr.prototype,"needsUpdate",{set:function(r){r===!0&&this.version++}}),Object.assign(sr.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(r){return this.usage=r,this},copy:function(r){return this.name=r.name,this.array=new r.array.constructor(r.array),this.itemSize=r.itemSize,this.count=r.count,this.normalized=r.normalized,this.usage=r.usage,this},copyAt:function(r,i,n){r*=this.itemSize,n*=i.itemSize;for(let u=0,p=this.itemSize;u<p;u++)this.array[r+u]=i.array[n+u];return this},copyArray:function(r){return this.array.set(r),this},copyColorsArray:function(r){const i=this.array;let n=0;for(let u=0,p=r.length;u<p;u++){let g=r[u];g===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",u),g=new Mi),i[n++]=g.r,i[n++]=g.g,i[n++]=g.b}return this},copyVector2sArray:function(r){const i=this.array;let n=0;for(let u=0,p=r.length;u<p;u++){let g=r[u];g===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",u),g=new vn),i[n++]=g.x,i[n++]=g.y}return this},copyVector3sArray:function(r){const i=this.array;let n=0;for(let u=0,p=r.length;u<p;u++){let g=r[u];g===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",u),g=new De),i[n++]=g.x,i[n++]=g.y,i[n++]=g.z}return this},copyVector4sArray:function(r){const i=this.array;let n=0;for(let u=0,p=r.length;u<p;u++){let g=r[u];g===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",u),g=new vs),i[n++]=g.x,i[n++]=g.y,i[n++]=g.z,i[n++]=g.w}return this},applyMatrix3:function(r){if(this.itemSize===2)for(let i=0,n=this.count;i<n;i++)Zd.fromBufferAttribute(this,i),Zd.applyMatrix3(r),this.setXY(i,Zd.x,Zd.y);else if(this.itemSize===3)for(let i=0,n=this.count;i<n;i++)ws.fromBufferAttribute(this,i),ws.applyMatrix3(r),this.setXYZ(i,ws.x,ws.y,ws.z);return this},applyMatrix4:function(r){for(let i=0,n=this.count;i<n;i++)ws.x=this.getX(i),ws.y=this.getY(i),ws.z=this.getZ(i),ws.applyMatrix4(r),this.setXYZ(i,ws.x,ws.y,ws.z);return this},applyNormalMatrix:function(r){for(let i=0,n=this.count;i<n;i++)ws.x=this.getX(i),ws.y=this.getY(i),ws.z=this.getZ(i),ws.applyNormalMatrix(r),this.setXYZ(i,ws.x,ws.y,ws.z);return this},transformDirection:function(r){for(let i=0,n=this.count;i<n;i++)ws.x=this.getX(i),ws.y=this.getY(i),ws.z=this.getZ(i),ws.transformDirection(r),this.setXYZ(i,ws.x,ws.y,ws.z);return this},set:function(r,i){return i===void 0&&(i=0),this.array.set(r,i),this},getX:function(r){return this.array[r*this.itemSize]},setX:function(r,i){return this.array[r*this.itemSize]=i,this},getY:function(r){return this.array[r*this.itemSize+1]},setY:function(r,i){return this.array[r*this.itemSize+1]=i,this},getZ:function(r){return this.array[r*this.itemSize+2]},setZ:function(r,i){return this.array[r*this.itemSize+2]=i,this},getW:function(r){return this.array[r*this.itemSize+3]},setW:function(r,i){return this.array[r*this.itemSize+3]=i,this},setXY:function(r,i,n){return r*=this.itemSize,this.array[r+0]=i,this.array[r+1]=n,this},setXYZ:function(r,i,n,u){return r*=this.itemSize,this.array[r+0]=i,this.array[r+1]=n,this.array[r+2]=u,this},setXYZW:function(r,i,n,u,p){return r*=this.itemSize,this.array[r+0]=i,this.array[r+1]=n,this.array[r+2]=u,this.array[r+3]=p,this},onUpload:function(r){return this.onUploadCallback=r,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}});function Jd(r,i,n){sr.call(this,new Int8Array(r),i,n)}Jd.prototype=Object.create(sr.prototype),Jd.prototype.constructor=Jd;function yh(r,i,n){sr.call(this,new Uint8Array(r),i,n)}yh.prototype=Object.create(sr.prototype),yh.prototype.constructor=yh;function Zm(r,i,n){sr.call(this,new Uint8ClampedArray(r),i,n)}Zm.prototype=Object.create(sr.prototype),Zm.prototype.constructor=Zm;function $d(r,i,n){sr.call(this,new Int16Array(r),i,n)}$d.prototype=Object.create(sr.prototype),$d.prototype.constructor=$d;function If(r,i,n){sr.call(this,new Uint16Array(r),i,n)}If.prototype=Object.create(sr.prototype),If.prototype.constructor=If;function Kd(r,i,n){sr.call(this,new Int32Array(r),i,n)}Kd.prototype=Object.create(sr.prototype),Kd.prototype.constructor=Kd;function Nf(r,i,n){sr.call(this,new Uint32Array(r),i,n)}Nf.prototype=Object.create(sr.prototype),Nf.prototype.constructor=Nf;function is(r,i,n){sr.call(this,new Float32Array(r),i,n)}is.prototype=Object.create(sr.prototype),is.prototype.constructor=is;function Jm(r,i,n){sr.call(this,new Float64Array(r),i,n)}Jm.prototype=Object.create(sr.prototype),Jm.prototype.constructor=Jm;class d_{constructor(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}computeGroups(i){const n=[];let u,p,g;const b=i.faces;for(p=0;p<b.length;p++){const M=b[p];M.materialIndex!==g&&(g=M.materialIndex,u!==void 0&&(u.count=p*3-u.start,n.push(u)),u={start:p*3,materialIndex:g})}u!==void 0&&(u.count=p*3-u.start,n.push(u)),this.groups=n}fromGeometry(i){const n=i.faces,u=i.vertices,p=i.faceVertexUvs,g=p[0]&&p[0].length>0,b=p[1]&&p[1].length>0,M=i.morphTargets,A=M.length;let C;if(A>0){C=[];for(let j=0;j<A;j++)C[j]={name:M[j].name,data:[]};this.morphTargets.position=C}const F=i.morphNormals,O=F.length;let k;if(O>0){k=[];for(let j=0;j<O;j++)k[j]={name:F[j].name,data:[]};this.morphTargets.normal=k}const N=i.skinIndices,X=i.skinWeights,ne=N.length===u.length,te=X.length===u.length;u.length>0&&n.length===0&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(let j=0;j<n.length;j++){const W=n[j];this.vertices.push(u[W.a],u[W.b],u[W.c]);const Pe=W.vertexNormals;if(Pe.length===3)this.normals.push(Pe[0],Pe[1],Pe[2]);else{const Ne=W.normal;this.normals.push(Ne,Ne,Ne)}const Re=W.vertexColors;if(Re.length===3)this.colors.push(Re[0],Re[1],Re[2]);else{const Ne=W.color;this.colors.push(Ne,Ne,Ne)}if(g===!0){const Ne=p[0][j];Ne!==void 0?this.uvs.push(Ne[0],Ne[1],Ne[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",j),this.uvs.push(new vn,new vn,new vn))}if(b===!0){const Ne=p[1][j];Ne!==void 0?this.uvs2.push(Ne[0],Ne[1],Ne[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",j),this.uvs2.push(new vn,new vn,new vn))}for(let Ne=0;Ne<A;Ne++){const de=M[Ne].vertices;C[Ne].data.push(de[W.a],de[W.b],de[W.c])}for(let Ne=0;Ne<O;Ne++){const de=F[Ne].vertexNormals[j];k[Ne].data.push(de.a,de.b,de.c)}ne&&this.skinIndices.push(N[W.a],N[W.b],N[W.c]),te&&this.skinWeights.push(X[W.a],X[W.b],X[W.c])}return this.computeGroups(i),this.verticesNeedUpdate=i.verticesNeedUpdate,this.normalsNeedUpdate=i.normalsNeedUpdate,this.colorsNeedUpdate=i.colorsNeedUpdate,this.uvsNeedUpdate=i.uvsNeedUpdate,this.groupsNeedUpdate=i.groupsNeedUpdate,i.boundingSphere!==null&&(this.boundingSphere=i.boundingSphere.clone()),i.boundingBox!==null&&(this.boundingBox=i.boundingBox.clone()),this}}function uy(r){if(r.length===0)return-1/0;let i=r[0];for(let n=1,u=r.length;n<u;++n)r[n]>i&&(i=r[n]);return i}let Ff=1;const Zo=new yr,Qd=new Ni,xh=new De,xo=new Ps,Bf=new Ps,aa=new De;function hs(){Object.defineProperty(this,"id",{value:Ff+=2}),this.uuid=fr.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}hs.prototype=Object.assign(Object.create(go.prototype),{constructor:hs,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(r){return Array.isArray(r)?this.index=new(uy(r)>65535?Nf:If)(r,1):this.index=r,this},getAttribute:function(r){return this.attributes[r]},setAttribute:function(r,i){return this.attributes[r]=i,this},deleteAttribute:function(r){return delete this.attributes[r],this},addGroup:function(r,i,n){this.groups.push({start:r,count:i,materialIndex:n!==void 0?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(r,i){this.drawRange.start=r,this.drawRange.count=i},applyMatrix4:function(r){const i=this.attributes.position;i!==void 0&&(i.applyMatrix4(r),i.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const p=new Ja().getNormalMatrix(r);n.applyNormalMatrix(p),n.needsUpdate=!0}const u=this.attributes.tangent;return u!==void 0&&(u.transformDirection(r),u.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this},rotateX:function(r){return Zo.makeRotationX(r),this.applyMatrix4(Zo),this},rotateY:function(r){return Zo.makeRotationY(r),this.applyMatrix4(Zo),this},rotateZ:function(r){return Zo.makeRotationZ(r),this.applyMatrix4(Zo),this},translate:function(r,i,n){return Zo.makeTranslation(r,i,n),this.applyMatrix4(Zo),this},scale:function(r,i,n){return Zo.makeScale(r,i,n),this.applyMatrix4(Zo),this},lookAt:function(r){return Qd.lookAt(r),Qd.updateMatrix(),this.applyMatrix4(Qd.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(xh).negate(),this.translate(xh.x,xh.y,xh.z),this},setFromObject:function(r){const i=r.geometry;if(r.isPoints||r.isLine){const n=new is(i.vertices.length*3,3),u=new is(i.colors.length*3,3);if(this.setAttribute("position",n.copyVector3sArray(i.vertices)),this.setAttribute("color",u.copyColorsArray(i.colors)),i.lineDistances&&i.lineDistances.length===i.vertices.length){const p=new is(i.lineDistances.length,1);this.setAttribute("lineDistance",p.copyArray(i.lineDistances))}i.boundingSphere!==null&&(this.boundingSphere=i.boundingSphere.clone()),i.boundingBox!==null&&(this.boundingBox=i.boundingBox.clone())}else r.isMesh&&i&&i.isGeometry&&this.fromGeometry(i);return this},setFromPoints:function(r){const i=[];for(let n=0,u=r.length;n<u;n++){const p=r[n];i.push(p.x,p.y,p.z||0)}return this.setAttribute("position",new is(i,3)),this},updateFromObject:function(r){let i=r.geometry;if(r.isMesh){let n=i.__directGeometry;if(i.elementsNeedUpdate===!0&&(n=void 0,i.elementsNeedUpdate=!1),n===void 0)return this.fromGeometry(i);n.verticesNeedUpdate=i.verticesNeedUpdate,n.normalsNeedUpdate=i.normalsNeedUpdate,n.colorsNeedUpdate=i.colorsNeedUpdate,n.uvsNeedUpdate=i.uvsNeedUpdate,n.groupsNeedUpdate=i.groupsNeedUpdate,i.verticesNeedUpdate=!1,i.normalsNeedUpdate=!1,i.colorsNeedUpdate=!1,i.uvsNeedUpdate=!1,i.groupsNeedUpdate=!1,i=n}if(i.verticesNeedUpdate===!0){const n=this.attributes.position;n!==void 0&&(n.copyVector3sArray(i.vertices),n.needsUpdate=!0),i.verticesNeedUpdate=!1}if(i.normalsNeedUpdate===!0){const n=this.attributes.normal;n!==void 0&&(n.copyVector3sArray(i.normals),n.needsUpdate=!0),i.normalsNeedUpdate=!1}if(i.colorsNeedUpdate===!0){const n=this.attributes.color;n!==void 0&&(n.copyColorsArray(i.colors),n.needsUpdate=!0),i.colorsNeedUpdate=!1}if(i.uvsNeedUpdate){const n=this.attributes.uv;n!==void 0&&(n.copyVector2sArray(i.uvs),n.needsUpdate=!0),i.uvsNeedUpdate=!1}if(i.lineDistancesNeedUpdate){const n=this.attributes.lineDistance;n!==void 0&&(n.copyArray(i.lineDistances),n.needsUpdate=!0),i.lineDistancesNeedUpdate=!1}return i.groupsNeedUpdate&&(i.computeGroups(r.geometry),this.groups=i.groups,i.groupsNeedUpdate=!1),this},fromGeometry:function(r){return r.__directGeometry=new d_().fromGeometry(r),this.fromDirectGeometry(r.__directGeometry)},fromDirectGeometry:function(r){const i=new Float32Array(r.vertices.length*3);if(this.setAttribute("position",new sr(i,3).copyVector3sArray(r.vertices)),r.normals.length>0){const n=new Float32Array(r.normals.length*3);this.setAttribute("normal",new sr(n,3).copyVector3sArray(r.normals))}if(r.colors.length>0){const n=new Float32Array(r.colors.length*3);this.setAttribute("color",new sr(n,3).copyColorsArray(r.colors))}if(r.uvs.length>0){const n=new Float32Array(r.uvs.length*2);this.setAttribute("uv",new sr(n,2).copyVector2sArray(r.uvs))}if(r.uvs2.length>0){const n=new Float32Array(r.uvs2.length*2);this.setAttribute("uv2",new sr(n,2).copyVector2sArray(r.uvs2))}this.groups=r.groups;for(const n in r.morphTargets){const u=[],p=r.morphTargets[n];for(let g=0,b=p.length;g<b;g++){const M=p[g],A=new is(M.data.length*3,3);A.name=M.name,u.push(A.copyVector3sArray(M.data))}this.morphAttributes[n]=u}if(r.skinIndices.length>0){const n=new is(r.skinIndices.length*4,4);this.setAttribute("skinIndex",n.copyVector4sArray(r.skinIndices))}if(r.skinWeights.length>0){const n=new is(r.skinWeights.length*4,4);this.setAttribute("skinWeight",n.copyVector4sArray(r.skinWeights))}return r.boundingSphere!==null&&(this.boundingSphere=r.boundingSphere.clone()),r.boundingBox!==null&&(this.boundingBox=r.boundingBox.clone()),this},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new Ps);const r=this.attributes.position,i=this.morphAttributes.position;if(r&&r.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new De(-1/0,-1/0,-1/0),new De(1/0,1/0,1/0));return}if(r!==void 0){if(this.boundingBox.setFromBufferAttribute(r),i)for(let n=0,u=i.length;n<u;n++){const p=i[n];xo.setFromBufferAttribute(p),this.morphTargetsRelative?(aa.addVectors(this.boundingBox.min,xo.min),this.boundingBox.expandByPoint(aa),aa.addVectors(this.boundingBox.max,xo.max),this.boundingBox.expandByPoint(aa)):(this.boundingBox.expandByPoint(xo.min),this.boundingBox.expandByPoint(xo.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){this.boundingSphere===null&&(this.boundingSphere=new zl);const r=this.attributes.position,i=this.morphAttributes.position;if(r&&r.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new De,1/0);return}if(r){const n=this.boundingSphere.center;if(xo.setFromBufferAttribute(r),i)for(let p=0,g=i.length;p<g;p++){const b=i[p];Bf.setFromBufferAttribute(b),this.morphTargetsRelative?(aa.addVectors(xo.min,Bf.min),xo.expandByPoint(aa),aa.addVectors(xo.max,Bf.max),xo.expandByPoint(aa)):(xo.expandByPoint(Bf.min),xo.expandByPoint(Bf.max))}xo.getCenter(n);let u=0;for(let p=0,g=r.count;p<g;p++)aa.fromBufferAttribute(r,p),u=Math.max(u,n.distanceToSquared(aa));if(i)for(let p=0,g=i.length;p<g;p++){const b=i[p],M=this.morphTargetsRelative;for(let A=0,C=b.count;A<C;A++)aa.fromBufferAttribute(b,A),M&&(xh.fromBufferAttribute(r,A),aa.add(xh)),u=Math.max(u,n.distanceToSquared(aa))}this.boundingSphere.radius=Math.sqrt(u),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){const r=this.index,i=this.getAttribute("position");if(i!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new sr(new Float32Array(i.count*3),3),this.setAttribute("normal",n);else for(let O=0,k=n.count;O<k;O++)n.setXYZ(O,0,0,0);const u=new De,p=new De,g=new De,b=new De,M=new De,A=new De,C=new De,F=new De;if(r)for(let O=0,k=r.count;O<k;O+=3){const N=r.getX(O+0),X=r.getX(O+1),ne=r.getX(O+2);u.fromBufferAttribute(i,N),p.fromBufferAttribute(i,X),g.fromBufferAttribute(i,ne),C.subVectors(g,p),F.subVectors(u,p),C.cross(F),b.fromBufferAttribute(n,N),M.fromBufferAttribute(n,X),A.fromBufferAttribute(n,ne),b.add(C),M.add(C),A.add(C),n.setXYZ(N,b.x,b.y,b.z),n.setXYZ(X,M.x,M.y,M.z),n.setXYZ(ne,A.x,A.y,A.z)}else for(let O=0,k=i.count;O<k;O+=3)u.fromBufferAttribute(i,O+0),p.fromBufferAttribute(i,O+1),g.fromBufferAttribute(i,O+2),C.subVectors(g,p),F.subVectors(u,p),C.cross(F),n.setXYZ(O+0,C.x,C.y,C.z),n.setXYZ(O+1,C.x,C.y,C.z),n.setXYZ(O+2,C.x,C.y,C.z);this.normalizeNormals(),n.needsUpdate=!0}},merge:function(r,i){if(!(r&&r.isBufferGeometry)){console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",r);return}i===void 0&&(i=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const n=this.attributes;for(const u in n){if(r.attributes[u]===void 0)continue;const g=n[u].array,b=r.attributes[u],M=b.array,A=b.itemSize*i,C=Math.min(M.length,g.length-A);for(let F=0,O=A;F<C;F++,O++)g[O]=M[F]}return this},normalizeNormals:function(){const r=this.attributes.normal;for(let i=0,n=r.count;i<n;i++)aa.fromBufferAttribute(r,i),aa.normalize(),r.setXYZ(i,aa.x,aa.y,aa.z)},toNonIndexed:function(){function r(b,M){const A=b.array,C=b.itemSize,F=b.normalized,O=new A.constructor(M.length*C);let k=0,N=0;for(let X=0,ne=M.length;X<ne;X++){k=M[X]*C;for(let te=0;te<C;te++)O[N++]=A[k++]}return new sr(O,C,F)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;const i=new hs,n=this.index.array,u=this.attributes;for(const b in u){const M=u[b],A=r(M,n);i.setAttribute(b,A)}const p=this.morphAttributes;for(const b in p){const M=[],A=p[b];for(let C=0,F=A.length;C<F;C++){const O=A[C],k=r(O,n);M.push(k)}i.morphAttributes[b]=M}i.morphTargetsRelative=this.morphTargetsRelative;const g=this.groups;for(let b=0,M=g.length;b<M;b++){const A=g[b];i.addGroup(A.start,A.count,A.materialIndex)}return i},toJSON:function(){const r={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),Object.keys(this.userData).length>0&&(r.userData=this.userData),this.parameters!==void 0){const M=this.parameters;for(const A in M)M[A]!==void 0&&(r[A]=M[A]);return r}r.data={attributes:{}};const i=this.index;i!==null&&(r.data.index={type:i.array.constructor.name,array:Array.prototype.slice.call(i.array)});const n=this.attributes;for(const M in n){const A=n[M],C=A.toJSON(r.data);A.name!==""&&(C.name=A.name),r.data.attributes[M]=C}const u={};let p=!1;for(const M in this.morphAttributes){const A=this.morphAttributes[M],C=[];for(let F=0,O=A.length;F<O;F++){const k=A[F],N=k.toJSON(r.data);k.name!==""&&(N.name=k.name),C.push(N)}C.length>0&&(u[M]=C,p=!0)}p&&(r.data.morphAttributes=u,r.data.morphTargetsRelative=this.morphTargetsRelative);const g=this.groups;g.length>0&&(r.data.groups=JSON.parse(JSON.stringify(g)));const b=this.boundingSphere;return b!==null&&(r.data.boundingSphere={center:b.center.toArray(),radius:b.radius}),r},clone:function(){return new hs().copy(this)},copy:function(r){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const i={};this.name=r.name;const n=r.index;n!==null&&this.setIndex(n.clone(i));const u=r.attributes;for(const A in u){const C=u[A];this.setAttribute(A,C.clone(i))}const p=r.morphAttributes;for(const A in p){const C=[],F=p[A];for(let O=0,k=F.length;O<k;O++)C.push(F[O].clone(i));this.morphAttributes[A]=C}this.morphTargetsRelative=r.morphTargetsRelative;const g=r.groups;for(let A=0,C=g.length;A<C;A++){const F=g[A];this.addGroup(F.start,F.count,F.materialIndex)}const b=r.boundingBox;b!==null&&(this.boundingBox=b.clone());const M=r.boundingSphere;return M!==null&&(this.boundingSphere=M.clone()),this.drawRange.start=r.drawRange.start,this.drawRange.count=r.drawRange.count,this.userData=r.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});const $m=new yr,Dc=new Mu,ep=new zl,Xl=new De,Oc=new De,ql=new De,Km=new De,kf=new De,Qm=new De,tp=new De,zf=new De,np=new De,_h=new vn,Tu=new vn,Au=new vn,Uf=new De,Hf=new De;function Ca(r,i){Ni.call(this),this.type="Mesh",this.geometry=r!==void 0?r:new hs,this.material=i!==void 0?i:new yo,this.updateMorphTargets()}Ca.prototype=Object.assign(Object.create(Ni.prototype),{constructor:Ca,isMesh:!0,copy:function(r){return Ni.prototype.copy.call(this,r),r.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=r.morphTargetInfluences.slice()),r.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},r.morphTargetDictionary)),this.material=r.material,this.geometry=r.geometry,this},updateMorphTargets:function(){const r=this.geometry;if(r.isBufferGeometry){const i=r.morphAttributes,n=Object.keys(i);if(n.length>0){const u=i[n[0]];if(u!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let p=0,g=u.length;p<g;p++){const b=u[p].name||String(p);this.morphTargetInfluences.push(0),this.morphTargetDictionary[b]=p}}}}else{const i=r.morphTargets;i!==void 0&&i.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(r,i){const n=this.geometry,u=this.material,p=this.matrixWorld;if(u===void 0||(n.boundingSphere===null&&n.computeBoundingSphere(),ep.copy(n.boundingSphere),ep.applyMatrix4(p),r.ray.intersectsSphere(ep)===!1)||($m.getInverse(p),Dc.copy(r.ray).applyMatrix4($m),n.boundingBox!==null&&Dc.intersectsBox(n.boundingBox)===!1))return;let g;if(n.isBufferGeometry){const b=n.index,M=n.attributes.position,A=n.morphAttributes.position,C=n.morphTargetsRelative,F=n.attributes.uv,O=n.attributes.uv2,k=n.groups,N=n.drawRange;if(b!==null)if(Array.isArray(u))for(let X=0,ne=k.length;X<ne;X++){const te=k[X],j=u[te.materialIndex],W=Math.max(te.start,N.start),Pe=Math.min(te.start+te.count,N.start+N.count);for(let Re=W,Ne=Pe;Re<Ne;Re+=3){const de=b.getX(Re),$e=b.getX(Re+1),Gt=b.getX(Re+2);g=ip(this,j,r,Dc,M,A,C,F,O,de,$e,Gt),g&&(g.faceIndex=Math.floor(Re/3),g.face.materialIndex=te.materialIndex,i.push(g))}}else{const X=Math.max(0,N.start),ne=Math.min(b.count,N.start+N.count);for(let te=X,j=ne;te<j;te+=3){const W=b.getX(te),Pe=b.getX(te+1),Re=b.getX(te+2);g=ip(this,u,r,Dc,M,A,C,F,O,W,Pe,Re),g&&(g.faceIndex=Math.floor(te/3),i.push(g))}}else if(M!==void 0)if(Array.isArray(u))for(let X=0,ne=k.length;X<ne;X++){const te=k[X],j=u[te.materialIndex],W=Math.max(te.start,N.start),Pe=Math.min(te.start+te.count,N.start+N.count);for(let Re=W,Ne=Pe;Re<Ne;Re+=3){const de=Re,$e=Re+1,Gt=Re+2;g=ip(this,j,r,Dc,M,A,C,F,O,de,$e,Gt),g&&(g.faceIndex=Math.floor(Re/3),g.face.materialIndex=te.materialIndex,i.push(g))}}else{const X=Math.max(0,N.start),ne=Math.min(M.count,N.start+N.count);for(let te=X,j=ne;te<j;te+=3){const W=te,Pe=te+1,Re=te+2;g=ip(this,u,r,Dc,M,A,C,F,O,W,Pe,Re),g&&(g.faceIndex=Math.floor(te/3),i.push(g))}}}else if(n.isGeometry){const b=Array.isArray(u),M=n.vertices,A=n.faces;let C;const F=n.faceVertexUvs[0];F.length>0&&(C=F);for(let O=0,k=A.length;O<k;O++){const N=A[O],X=b?u[N.materialIndex]:u;if(X===void 0)continue;const ne=M[N.a],te=M[N.b],j=M[N.c];if(g=hy(this,X,r,Dc,ne,te,j,Uf),g){if(C&&C[O]){const W=C[O];_h.copy(W[0]),Tu.copy(W[1]),Au.copy(W[2]),g.uv=xa.getUV(Uf,ne,te,j,_h,Tu,Au,new vn)}g.face=N,g.faceIndex=O,i.push(g)}}}}});function hy(r,i,n,u,p,g,b,M){let A;if(i.side===It?A=u.intersectTriangle(b,g,p,!0,M):A=u.intersectTriangle(p,g,b,i.side!==Tn,M),A===null)return null;Hf.copy(M),Hf.applyMatrix4(r.matrixWorld);const C=n.ray.origin.distanceTo(Hf);return C<n.near||C>n.far?null:{distance:C,point:Hf.clone(),object:r}}function ip(r,i,n,u,p,g,b,M,A,C,F,O){Xl.fromBufferAttribute(p,C),Oc.fromBufferAttribute(p,F),ql.fromBufferAttribute(p,O);const k=r.morphTargetInfluences;if(i.morphTargets&&g&&k){tp.set(0,0,0),zf.set(0,0,0),np.set(0,0,0);for(let X=0,ne=g.length;X<ne;X++){const te=k[X],j=g[X];te!==0&&(Km.fromBufferAttribute(j,C),kf.fromBufferAttribute(j,F),Qm.fromBufferAttribute(j,O),b?(tp.addScaledVector(Km,te),zf.addScaledVector(kf,te),np.addScaledVector(Qm,te)):(tp.addScaledVector(Km.sub(Xl),te),zf.addScaledVector(kf.sub(Oc),te),np.addScaledVector(Qm.sub(ql),te)))}Xl.add(tp),Oc.add(zf),ql.add(np)}r.isSkinnedMesh&&(r.boneTransform(C,Xl),r.boneTransform(F,Oc),r.boneTransform(O,ql));const N=hy(r,i,n,u,Xl,Oc,ql,Uf);if(N){M&&(_h.fromBufferAttribute(M,C),Tu.fromBufferAttribute(M,F),Au.fromBufferAttribute(M,O),N.uv=xa.getUV(Uf,Xl,Oc,ql,_h,Tu,Au,new vn)),A&&(_h.fromBufferAttribute(A,C),Tu.fromBufferAttribute(A,F),Au.fromBufferAttribute(A,O),N.uv2=xa.getUV(Uf,Xl,Oc,ql,_h,Tu,Au,new vn));const X=new Yd(C,F,O);xa.getNormal(Xl,Oc,ql,X.normal),N.face=X}return N}class eg extends hs{constructor(i=1,n=1,u=1,p=1,g=1,b=1){super(),this.type="BoxBufferGeometry",this.parameters={width:i,height:n,depth:u,widthSegments:p,heightSegments:g,depthSegments:b};const M=this;p=Math.floor(p),g=Math.floor(g),b=Math.floor(b);const A=[],C=[],F=[],O=[];let k=0,N=0;X("z","y","x",-1,-1,u,n,i,b,g,0),X("z","y","x",1,-1,u,n,-i,b,g,1),X("x","z","y",1,1,i,u,n,p,b,2),X("x","z","y",1,-1,i,u,-n,p,b,3),X("x","y","z",1,-1,i,n,u,p,g,4),X("x","y","z",-1,-1,i,n,-u,p,g,5),this.setIndex(A),this.setAttribute("position",new is(C,3)),this.setAttribute("normal",new is(F,3)),this.setAttribute("uv",new is(O,2));function X(ne,te,j,W,Pe,Re,Ne,de,$e,Gt,dt){const an=Re/$e,_t=Ne/Gt,et=Re/2,rt=Ne/2,je=de/2,Ve=$e+1,ht=Gt+1;let ft=0,Wt=0;const An=new De;for(let Vt=0;Vt<ht;Vt++){const Dn=Vt*_t-rt;for(let Ci=0;Ci<Ve;Ci++){const vi=Ci*an-et;An[ne]=vi*W,An[te]=Dn*Pe,An[j]=je,C.push(An.x,An.y,An.z),An[ne]=0,An[te]=0,An[j]=de>0?1:-1,F.push(An.x,An.y,An.z),O.push(Ci/$e),O.push(1-Vt/Gt),ft+=1}}for(let Vt=0;Vt<Gt;Vt++)for(let Dn=0;Dn<$e;Dn++){const Ci=k+Dn+Ve*Vt,vi=k+Dn+Ve*(Vt+1),he=k+(Dn+1)+Ve*(Vt+1),K=k+(Dn+1)+Ve*Vt;A.push(Ci,vi,K),A.push(vi,he,K),Wt+=6}M.addGroup(N,Wt,dt),N+=Wt,k+=ft}}}function Lu(r){const i={};for(const n in r){i[n]={};for(const u in r[n]){const p=r[n][u];p&&(p.isColor||p.isMatrix3||p.isMatrix4||p.isVector2||p.isVector3||p.isVector4||p.isTexture)?i[n][u]=p.clone():Array.isArray(p)?i[n][u]=p.slice():i[n][u]=p}}return i}function _a(r){const i={};for(let n=0;n<r.length;n++){const u=Lu(r[n]);for(const p in u)i[p]=u[p]}return i}const p_={clone:Lu,merge:_a};var m_=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,Gf=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;function Fa(r){Yi.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=m_,this.fragmentShader=Gf,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,r!==void 0&&(r.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(r))}Fa.prototype=Object.create(Yi.prototype),Fa.prototype.constructor=Fa,Fa.prototype.isShaderMaterial=!0,Fa.prototype.copy=function(r){return Yi.prototype.copy.call(this,r),this.fragmentShader=r.fragmentShader,this.vertexShader=r.vertexShader,this.uniforms=Lu(r.uniforms),this.defines=Object.assign({},r.defines),this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.lights=r.lights,this.clipping=r.clipping,this.skinning=r.skinning,this.morphTargets=r.morphTargets,this.morphNormals=r.morphNormals,this.extensions=Object.assign({},r.extensions),this.glslVersion=r.glslVersion,this},Fa.prototype.toJSON=function(r){const i=Yi.prototype.toJSON.call(this,r);i.glslVersion=this.glslVersion,i.uniforms={};for(const u in this.uniforms){const g=this.uniforms[u].value;g&&g.isTexture?i.uniforms[u]={type:"t",value:g.toJSON(r).uuid}:g&&g.isColor?i.uniforms[u]={type:"c",value:g.getHex()}:g&&g.isVector2?i.uniforms[u]={type:"v2",value:g.toArray()}:g&&g.isVector3?i.uniforms[u]={type:"v3",value:g.toArray()}:g&&g.isVector4?i.uniforms[u]={type:"v4",value:g.toArray()}:g&&g.isMatrix3?i.uniforms[u]={type:"m3",value:g.toArray()}:g&&g.isMatrix4?i.uniforms[u]={type:"m4",value:g.toArray()}:i.uniforms[u]={value:g}}Object.keys(this.defines).length>0&&(i.defines=this.defines),i.vertexShader=this.vertexShader,i.fragmentShader=this.fragmentShader;const n={};for(const u in this.extensions)this.extensions[u]===!0&&(n[u]=!0);return Object.keys(n).length>0&&(i.extensions=n),i};function jl(){Ni.call(this),this.type="Camera",this.matrixWorldInverse=new yr,this.projectionMatrix=new yr,this.projectionMatrixInverse=new yr}jl.prototype=Object.assign(Object.create(Ni.prototype),{constructor:jl,isCamera:!0,copy:function(r,i){return Ni.prototype.copy.call(this,r,i),this.matrixWorldInverse.copy(r.matrixWorldInverse),this.projectionMatrix.copy(r.projectionMatrix),this.projectionMatrixInverse.copy(r.projectionMatrixInverse),this},getWorldDirection:function(r){r===void 0&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),r=new De),this.updateMatrixWorld(!0);const i=this.matrixWorld.elements;return r.set(-i[8],-i[9],-i[10]).normalize()},updateMatrixWorld:function(r){Ni.prototype.updateMatrixWorld.call(this,r),this.matrixWorldInverse.getInverse(this.matrixWorld)},updateWorldMatrix:function(r,i){Ni.prototype.updateWorldMatrix.call(this,r,i),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return new this.constructor().copy(this)}});function ba(r,i,n,u){jl.call(this),this.type="PerspectiveCamera",this.fov=r!==void 0?r:50,this.zoom=1,this.near=n!==void 0?n:.1,this.far=u!==void 0?u:2e3,this.focus=10,this.aspect=i!==void 0?i:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}ba.prototype=Object.assign(Object.create(jl.prototype),{constructor:ba,isPerspectiveCamera:!0,copy:function(r,i){return jl.prototype.copy.call(this,r,i),this.fov=r.fov,this.zoom=r.zoom,this.near=r.near,this.far=r.far,this.focus=r.focus,this.aspect=r.aspect,this.view=r.view===null?null:Object.assign({},r.view),this.filmGauge=r.filmGauge,this.filmOffset=r.filmOffset,this},setFocalLength:function(r){const i=.5*this.getFilmHeight()/r;this.fov=fr.RAD2DEG*2*Math.atan(i),this.updateProjectionMatrix()},getFocalLength:function(){const r=Math.tan(fr.DEG2RAD*.5*this.fov);return .5*this.getFilmHeight()/r},getEffectiveFOV:function(){return fr.RAD2DEG*2*Math.atan(Math.tan(fr.DEG2RAD*.5*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(r,i,n,u,p,g){this.aspect=r/i,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=r,this.view.fullHeight=i,this.view.offsetX=n,this.view.offsetY=u,this.view.width=p,this.view.height=g,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){const r=this.near;let i=r*Math.tan(fr.DEG2RAD*.5*this.fov)/this.zoom,n=2*i,u=this.aspect*n,p=-.5*u;const g=this.view;if(this.view!==null&&this.view.enabled){const M=g.fullWidth,A=g.fullHeight;p+=g.offsetX*u/M,i-=g.offsetY*n/A,u*=g.width/M,n*=g.height/A}const b=this.filmOffset;b!==0&&(p+=r*b/this.getFilmWidth()),this.projectionMatrix.makePerspective(p,p+u,i,i-n,r,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(r){const i=Ni.prototype.toJSON.call(this,r);return i.object.fov=this.fov,i.object.zoom=this.zoom,i.object.near=this.near,i.object.far=this.far,i.object.focus=this.focus,i.object.aspect=this.aspect,this.view!==null&&(i.object.view=Object.assign({},this.view)),i.object.filmGauge=this.filmGauge,i.object.filmOffset=this.filmOffset,i}});const Ba=90,Pa=1;function bh(r,i,n){if(Ni.call(this),this.type="CubeCamera",n.isWebGLCubeRenderTarget!==!0){console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");return}this.renderTarget=n;const u=new ba(Ba,Pa,r,i);u.layers=this.layers,u.up.set(0,-1,0),u.lookAt(new De(1,0,0)),this.add(u);const p=new ba(Ba,Pa,r,i);p.layers=this.layers,p.up.set(0,-1,0),p.lookAt(new De(-1,0,0)),this.add(p);const g=new ba(Ba,Pa,r,i);g.layers=this.layers,g.up.set(0,0,1),g.lookAt(new De(0,1,0)),this.add(g);const b=new ba(Ba,Pa,r,i);b.layers=this.layers,b.up.set(0,0,-1),b.lookAt(new De(0,-1,0)),this.add(b);const M=new ba(Ba,Pa,r,i);M.layers=this.layers,M.up.set(0,-1,0),M.lookAt(new De(0,0,1)),this.add(M);const A=new ba(Ba,Pa,r,i);A.layers=this.layers,A.up.set(0,-1,0),A.lookAt(new De(0,0,-1)),this.add(A),this.update=function(C,F){this.parent===null&&this.updateMatrixWorld();const O=C.xr.enabled,k=C.getRenderTarget();C.xr.enabled=!1;const N=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,C.setRenderTarget(n,0),C.render(F,u),C.setRenderTarget(n,1),C.render(F,p),C.setRenderTarget(n,2),C.render(F,g),C.setRenderTarget(n,3),C.render(F,b),C.setRenderTarget(n,4),C.render(F,M),n.texture.generateMipmaps=N,C.setRenderTarget(n,5),C.render(F,A),C.setRenderTarget(k),C.xr.enabled=O},this.clear=function(C,F,O,k){const N=C.getRenderTarget();for(let X=0;X<6;X++)C.setRenderTarget(n,X),C.clear(F,O,k);C.setRenderTarget(N)}}bh.prototype=Object.create(Ni.prototype),bh.prototype.constructor=bh;function Ic(r,i,n,u,p,g,b,M,A,C){r=r!==void 0?r:[],i=i!==void 0?i:xt,b=b!==void 0?b:Or,gs.call(this,r,i,n,u,p,g,b,M,A,C),this.flipY=!1,this._needsFlipEnvMap=!0}Ic.prototype=Object.create(gs.prototype),Ic.prototype.constructor=Ic,Ic.prototype.isCubeTexture=!0,Object.defineProperty(Ic.prototype,"images",{get:function(){return this.image},set:function(r){this.image=r}});function _l(r,i,n){Number.isInteger(i)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),i=n),qo.call(this,r,r,i),i=i||{},this.texture=new Ic(void 0,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture._needsFlipEnvMap=!1}_l.prototype=Object.create(qo.prototype),_l.prototype.constructor=_l,_l.prototype.isWebGLCubeRenderTarget=!0,_l.prototype.fromEquirectangularTexture=function(r,i){this.texture.type=i.type,this.texture.format=vr,this.texture.encoding=i.encoding,this.texture.generateMipmaps=i.generateMipmaps,this.texture.minFilter=i.minFilter,this.texture.magFilter=i.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

			varying vec3 vWorldDirection;

			vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

				return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

			}

			void main() {

				vWorldDirection = transformDirection( position, modelMatrix );

				#include <begin_vertex>
				#include <project_vertex>

			}
		`,fragmentShader:`

			uniform sampler2D tEquirect;

			varying vec3 vWorldDirection;

			#include <common>

			void main() {

				vec3 direction = normalize( vWorldDirection );

				vec2 sampleUV = equirectUv( direction );

				gl_FragColor = texture2D( tEquirect, sampleUV );

			}
		`},u=new eg(5,5,5),p=new Fa({name:"CubemapFromEquirect",uniforms:Lu(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:It,blending:cn});p.uniforms.tEquirect.value=i;const g=new Ca(u,p),b=i.minFilter;return i.minFilter===es&&(i.minFilter=ti),new bh(1,10,this).update(r,g),i.minFilter=b,g.geometry.dispose(),g.material.dispose(),this};function wh(r,i,n,u,p,g,b,M,A,C,F,O){gs.call(this,null,g,b,M,A,C,u,p,F,O),this.image={data:r||null,width:i||1,height:n||1},this.magFilter=A!==void 0?A:Kr,this.minFilter=C!==void 0?C:Kr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}wh.prototype=Object.create(gs.prototype),wh.prototype.constructor=wh,wh.prototype.isDataTexture=!0;const Mh=new zl,rp=new De;class sp{constructor(i,n,u,p,g,b){this.planes=[i!==void 0?i:new Ka,n!==void 0?n:new Ka,u!==void 0?u:new Ka,p!==void 0?p:new Ka,g!==void 0?g:new Ka,b!==void 0?b:new Ka]}set(i,n,u,p,g,b){const M=this.planes;return M[0].copy(i),M[1].copy(n),M[2].copy(u),M[3].copy(p),M[4].copy(g),M[5].copy(b),this}clone(){return new this.constructor().copy(this)}copy(i){const n=this.planes;for(let u=0;u<6;u++)n[u].copy(i.planes[u]);return this}setFromProjectionMatrix(i){const n=this.planes,u=i.elements,p=u[0],g=u[1],b=u[2],M=u[3],A=u[4],C=u[5],F=u[6],O=u[7],k=u[8],N=u[9],X=u[10],ne=u[11],te=u[12],j=u[13],W=u[14],Pe=u[15];return n[0].setComponents(M-p,O-A,ne-k,Pe-te).normalize(),n[1].setComponents(M+p,O+A,ne+k,Pe+te).normalize(),n[2].setComponents(M+g,O+C,ne+N,Pe+j).normalize(),n[3].setComponents(M-g,O-C,ne-N,Pe-j).normalize(),n[4].setComponents(M-b,O-F,ne-X,Pe-W).normalize(),n[5].setComponents(M+b,O+F,ne+X,Pe+W).normalize(),this}intersectsObject(i){const n=i.geometry;return n.boundingSphere===null&&n.computeBoundingSphere(),Mh.copy(n.boundingSphere).applyMatrix4(i.matrixWorld),this.intersectsSphere(Mh)}intersectsSprite(i){return Mh.center.set(0,0,0),Mh.radius=.7071067811865476,Mh.applyMatrix4(i.matrixWorld),this.intersectsSphere(Mh)}intersectsSphere(i){const n=this.planes,u=i.center,p=-i.radius;for(let g=0;g<6;g++)if(n[g].distanceToPoint(u)<p)return!1;return!0}intersectsBox(i){const n=this.planes;for(let u=0;u<6;u++){const p=n[u];if(rp.x=p.normal.x>0?i.max.x:i.min.x,rp.y=p.normal.y>0?i.max.y:i.min.y,rp.z=p.normal.z>0?i.max.z:i.min.z,p.distanceToPoint(rp)<0)return!1}return!0}containsPoint(i){const n=this.planes;for(let u=0;u<6;u++)if(n[u].distanceToPoint(i)<0)return!1;return!0}}function fy(){let r=null,i=!1,n=null,u=null;function p(g,b){n(g,b),u=r.requestAnimationFrame(p)}return{start:function(){i!==!0&&n!==null&&(u=r.requestAnimationFrame(p),i=!0)},stop:function(){r.cancelAnimationFrame(u),i=!1},setAnimationLoop:function(g){n=g},setContext:function(g){r=g}}}function ap(r,i){const n=i.isWebGL2,u=new WeakMap;function p(C,F){const O=C.array,k=C.usage,N=r.createBuffer();r.bindBuffer(F,N),r.bufferData(F,O,k),C.onUploadCallback();let X=5126;return O instanceof Float32Array?X=5126:O instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):O instanceof Uint16Array?X=5123:O instanceof Int16Array?X=5122:O instanceof Uint32Array?X=5125:O instanceof Int32Array?X=5124:O instanceof Int8Array?X=5120:O instanceof Uint8Array&&(X=5121),{buffer:N,type:X,bytesPerElement:O.BYTES_PER_ELEMENT,version:C.version}}function g(C,F,O){const k=F.array,N=F.updateRange;r.bindBuffer(O,C),N.count===-1?r.bufferSubData(O,0,k):(n?r.bufferSubData(O,N.offset*k.BYTES_PER_ELEMENT,k,N.offset,N.count):r.bufferSubData(O,N.offset*k.BYTES_PER_ELEMENT,k.subarray(N.offset,N.offset+N.count)),N.count=-1)}function b(C){return C.isInterleavedBufferAttribute&&(C=C.data),u.get(C)}function M(C){C.isInterleavedBufferAttribute&&(C=C.data);const F=u.get(C);F&&(r.deleteBuffer(F.buffer),u.delete(C))}function A(C,F){if(C.isGLBufferAttribute){var O=u.get(C);(!O||O.version<C.version)&&u.set(C,{buffer:C.buffer,type:C.type,bytesPerElement:C.elementSize,version:C.version});return}C.isInterleavedBufferAttribute&&(C=C.data);const k=u.get(C);k===void 0?u.set(C,p(C,F)):k.version<C.version&&(g(k.buffer,C,F),k.version=C.version)}return{get:b,remove:M,update:A}}class g_ extends hs{constructor(i,n,u,p){super(),this.type="PlaneBufferGeometry",this.parameters={width:i,height:n,widthSegments:u,heightSegments:p},i=i||1,n=n||1;const g=i/2,b=n/2,M=Math.floor(u)||1,A=Math.floor(p)||1,C=M+1,F=A+1,O=i/M,k=n/A,N=[],X=[],ne=[],te=[];for(let j=0;j<F;j++){const W=j*k-b;for(let Pe=0;Pe<C;Pe++){const Re=Pe*O-g;X.push(Re,-W,0),ne.push(0,0,1),te.push(Pe/M),te.push(1-j/A)}}for(let j=0;j<A;j++)for(let W=0;W<M;W++){const Pe=W+C*j,Re=W+C*(j+1),Ne=W+1+C*(j+1),de=W+1+C*j;N.push(Pe,Re,de),N.push(Re,Ne,de)}this.setIndex(N),this.setAttribute("position",new is(X,3)),this.setAttribute("normal",new is(ne,3)),this.setAttribute("uv",new is(te,2))}}var v_=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,dy=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,py=`#ifdef ALPHATEST
	if ( diffuseColor.a < ALPHATEST ) discard;
#endif`,y_=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );
	#endif
#endif`,x_=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,Vf="vec3 transformed = vec3( position );",my=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,__=`vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	return vec2( -1.04, 1.04 ) * a004 + r.zw;
}
float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
#if defined ( PHYSICALLY_CORRECT_LIGHTS )
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
#else
	if( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
		return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );
	}
	return 1.0;
#endif
}
vec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {
	float fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );
	return ( 1.0 - specularColor ) * fresnel + specularColor;
}
vec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {
	float fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );
	vec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;
	return Fr * fresnel + F0;
}
float G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	float gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	return 1.0 / ( gl * gv );
}
float G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( incidentLight.direction + viewDir );
	float dotNL = saturate( dot( normal, incidentLight.direction ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( G * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
vec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	return specularColor * brdf.x + brdf.y;
}
void BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
	float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
	vec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	vec3 FssEss = F * brdf.x + brdf.y;
	float Ess = brdf.x + brdf.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );
	float dotNH = saturate( dot( geometry.normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
float GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {
	return ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );
}
float BlinnExponentToGGXRoughness( const in float blinnExponent ) {
	return sqrt( 2.0 / ( blinnExponent + 2.0 ) );
}
#if defined( USE_SHEEN )
float D_Charlie(float roughness, float NoH) {
	float invAlpha = 1.0 / roughness;
	float cos2h = NoH * NoH;
	float sin2h = max(1.0 - cos2h, 0.0078125);	return (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);
}
float V_Neubelt(float NoV, float NoL) {
	return saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));
}
vec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {
	vec3 N = geometry.normal;
	vec3 V = geometry.viewDir;
	vec3 H = normalize( V + L );
	float dotNH = saturate( dot( N, H ) );
	return specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );
}
#endif`,b_=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 );
		fDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,w_=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,M_=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,Nc=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,op=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,S_=`#ifdef USE_COLOR
	diffuseColor.rgb *= vColor;
#endif`,E_=`#ifdef USE_COLOR
	varying vec3 vColor;
#endif`,T_=`#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,bl=`#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor.xyz *= color.xyz;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,A_=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement(a) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract(sin(sn) * c);
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
vec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	float distance = dot( planeNormal, point - pointOnPlane );
	return - distance * planeNormal + point;
}
float sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return sign( dot( point - pointOnPlane, planeNormal ) );
}
vec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,L_=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_maxMipLevel 8.0
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_maxTileSize 256.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		float texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );
		vec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );
		vec2 f = fract( uv );
		uv += 0.5 - f;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		if ( mipInt < cubeUV_maxMipLevel ) {
			uv.y += 2.0 * cubeUV_maxTileSize;
		}
		uv.y += filterInt * 2.0 * cubeUV_minTileSize;
		uv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );
		uv *= texelSize;
		vec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.x += texelSize;
		vec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.y += texelSize;
		vec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.x -= texelSize;
		vec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		vec3 tm = mix( tl, tr, f.x );
		vec3 bm = mix( bl, br, f.x );
		return mix( tm, bm, f.y );
	}
	#define r0 1.0
	#define v0 0.339
	#define m0 - 2.0
	#define r1 0.8
	#define v1 0.276
	#define m1 - 1.0
	#define r4 0.4
	#define v4 0.046
	#define m4 2.0
	#define r5 0.305
	#define v5 0.016
	#define m5 3.0
	#define r6 0.21
	#define v6 0.0038
	#define m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= r1 ) {
			mip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;
		} else if ( roughness >= r4 ) {
			mip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;
		} else if ( roughness >= r5 ) {
			mip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;
		} else if ( roughness >= r6 ) {
			mip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,C_=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,P_=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,R_=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,tg=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,D_=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,O_="gl_FragColor = linearToOutputTexel( gl_FragColor );",I_=`
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 GammaToLinear( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );
}
vec4 LinearToGamma( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );
}
vec4 sRGBToLinear( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 RGBEToLinear( in vec4 value ) {
	return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );
}
vec4 LinearToRGBE( in vec4 value ) {
	float maxComponent = max( max( value.r, value.g ), value.b );
	float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );
	return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );
}
vec4 RGBMToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * value.a * maxRange, 1.0 );
}
vec4 LinearToRGBM( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float M = clamp( maxRGB / maxRange, 0.0, 1.0 );
	M = ceil( M * 255.0 ) / 255.0;
	return vec4( value.rgb / ( M * maxRange ), M );
}
vec4 RGBDToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );
}
vec4 LinearToRGBD( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float D = max( maxRange / maxRGB, 1.0 );
	D = clamp( floor( D ) / 255.0, 0.0, 1.0 );
	return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );
}
const mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );
vec4 LinearToLogLuv( in vec4 value ) {
	vec3 Xp_Y_XYZp = cLogLuvM * value.rgb;
	Xp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );
	vec4 vResult;
	vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;
	float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;
	vResult.w = fract( Le );
	vResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;
	return vResult;
}
const mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );
vec4 LogLuvToLinear( in vec4 value ) {
	float Le = value.z * 255.0 + value.w;
	vec3 Xp_Y_XYZp;
	Xp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );
	Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;
	Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;
	vec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;
	return vec4( max( vRGB, 0.0 ), 1.0 );
}`,ng=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifndef ENVMAP_TYPE_CUBE_UV
		envColor = envMapTexelToLinear( envColor );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,N_=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform int maxMipLevel;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,gy=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,vy=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,F_=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,yy=`#ifdef USE_FOG
	fogDepth = - mvPosition.z;
#endif`,xy=`#ifdef USE_FOG
	varying float fogDepth;
#endif`,lp=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, fogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,Wf=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float fogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,B_=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return texture2D( gradientMap, coord ).rgb;
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,_y=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel= texture2D( lightMap, vUv2 );
	reflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
#endif`,k_=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,z_=`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
vIndirectFront += getLightProbeIrradiance( lightProbe, geometry );
#ifdef DOUBLE_SIDED
	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );
#endif
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );
		#endif
	}
	#pragma unroll_loop_end
#endif`,U_=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {
	vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	return irradiance;
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		directLight.color = directionalLight.color;
		directLight.direction = directionalLight.direction;
		directLight.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = pointLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		directLight.color = pointLight.color;
		directLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );
		directLight.visible = ( directLight.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = spotLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		float angleCos = dot( directLight.direction, spotLight.direction );
		if ( angleCos > spotLight.coneCos ) {
			float spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );
			directLight.color = spotLight.color;
			directLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );
			directLight.visible = true;
		} else {
			directLight.color = vec3( 0.0 );
			directLight.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {
		float dotNL = dot( geometry.normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			irradiance *= PI;
		#endif
		return irradiance;
	}
#endif`,by=`#if defined( USE_ENVMAP )
	#ifdef ENVMAP_MODE_REFRACTION
		uniform float refractionRatio;
	#endif
	vec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {
		vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );
			#else
				vec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
		#else
			vec4 envMapColor = vec4( 0.0 );
		#endif
		return PI * envMapColor.rgb * envMapIntensity;
	}
	float getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {
		float maxMIPLevelScalar = float( maxMIPLevel );
		float sigma = PI * roughness * roughness / ( 1.0 + roughness );
		float desiredMIPLevel = maxMIPLevelScalar + log2( sigma );
		return clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );
	}
	vec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( -viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
		#else
			vec3 reflectVec = refract( -viewDir, normal, refractionRatio );
		#endif
		reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
		float specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );
			#else
				vec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
		#endif
		return envMapColor.rgb * envMapIntensity;
	}
#endif`,wy=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,My=`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,H_=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,Sy=`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,cp=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;
material.specularRoughness = min( material.specularRoughness, 1.0 );
#ifdef REFLECTIVITY
	material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );
#endif
#ifdef CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheen;
#endif`,Ey=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float specularRoughness;
	vec3 specularColor;
#ifdef CLEARCOAT
	float clearcoat;
	float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	vec3 sheenColor;
#endif
};
#define MAXIMUM_SPECULAR_COEFFICIENT 0.16
#define DEFAULT_SPECULAR_COEFFICIENT 0.04
float clearcoatDHRApprox( const in float roughness, const in float dotNL ) {
	return DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.specularRoughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	#ifdef CLEARCOAT
		float ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = ccDotNL * directLight.color;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			ccIrradiance *= PI;
		#endif
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
		reflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
	#else
		float clearcoatDHR = 0.0;
	#endif
	#ifdef USE_SHEEN
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(
			material.specularRoughness,
			directLight.direction,
			geometry,
			material.sheenColor
		);
	#else
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);
	#endif
	reflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef CLEARCOAT
		float ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		reflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
		float ccDotNL = ccDotNV;
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
	#else
		float clearcoatDHR = 0.0;
	#endif
	float clearcoatInv = 1.0 - clearcoatDHR;
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	BRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );
	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );
	reflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,js=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointDirectLightIrradiance( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotDirectLightIrradiance( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,Ty=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			lightMapIrradiance *= PI;
		#endif
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );
	#ifdef CLEARCOAT
		clearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );
	#endif
#endif`,Fc=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,Cu=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,ig=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,Ay=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,G_=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,V_=`#ifdef USE_MAP
	vec4 texelColor = texture2D( map, vUv );
	texelColor = mapTexelToLinear( texelColor );
	diffuseColor *= texelColor;
#endif`,W_=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,X_=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	vec4 mapTexel = texture2D( map, uv );
	diffuseColor *= mapTexelToLinear( mapTexel );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,q_=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Ly=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,Cy=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,rg=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
	objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
	objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
	objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
#endif`,j_=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifndef USE_MORPHNORMALS
		uniform float morphTargetInfluences[ 8 ];
	#else
		uniform float morphTargetInfluences[ 4 ];
	#endif
#endif`,Y_=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	transformed += morphTarget0 * morphTargetInfluences[ 0 ];
	transformed += morphTarget1 * morphTargetInfluences[ 1 ];
	transformed += morphTarget2 * morphTargetInfluences[ 2 ];
	transformed += morphTarget3 * morphTargetInfluences[ 3 ];
	#ifndef USE_MORPHNORMALS
		transformed += morphTarget4 * morphTargetInfluences[ 4 ];
		transformed += morphTarget5 * morphTargetInfluences[ 5 ];
		transformed += morphTarget6 * morphTargetInfluences[ 6 ];
		transformed += morphTarget7 * morphTargetInfluences[ 7 ];
	#endif
#endif`,Z_=`#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
			bitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,Py=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( -vViewPosition, normal, mapN );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );
#endif`,J_=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		float scale = sign( st1.t * st0.s - st0.t * st1.s );
		vec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );
		vec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );
		vec3 N = normalize( surf_norm );
		mat3 tsn = mat3( S, T, N );
		mapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		return normalize( tsn * mapN );
	}
#endif`,Ry=`#ifdef CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,$_=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );
	#endif
#endif`,up=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,hp=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return (( near + viewZ ) * far ) / (( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,K_=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,Sh=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,Xf=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,Q_=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,eb=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,fp=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,sg=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,dp=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,pp=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;
	#endif
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,Dy=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,Oy=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,tb=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	#ifdef BONE_TEXTURE
		uniform highp sampler2D boneTexture;
		uniform int boneTextureSize;
		mat4 getBoneMatrix( const in float i ) {
			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );
			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );
			y = dy * ( y + 0.5 );
			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
			mat4 bone = mat4( v1, v2, v3, v4 );
			return bone;
		}
	#else
		uniform mat4 boneMatrices[ MAX_BONES ];
		mat4 getBoneMatrix( const in float i ) {
			mat4 bone = boneMatrices[ int(i) ];
			return bone;
		}
	#endif
#endif`,nb=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,Eh=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,ag=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,ib=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,rb=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,sb=`#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,mp=`#ifdef USE_TRANSMISSIONMAP
	totalTransmission *= texture2D( transmissionMap, vUv ).r;
#endif`,Iy=`#ifdef USE_TRANSMISSIONMAP
	uniform sampler2D transmissionMap;
#endif`,ab=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,ob=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,Ny=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,lb=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,cb=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,og=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,ub=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,hb=`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,fb=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,db=`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,pb=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Bc=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,Fy=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,gp=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,By=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,kc=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	vec4 texColor = texture2D( tEquirect, sampleUV );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,mb=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,gb=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,vb=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,lg=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
	
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,yb=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <skinbase_vertex>
	#ifdef USE_ENVMAP
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,xb=`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,cg=`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,vp=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
		matcapColor = matcapTexelToLinear( matcapColor );
	#else
		vec4 matcapColor = vec4( 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,ug=`#define MATCAP
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#ifndef FLAT_SHADED
		vNormal = normalize( transformedNormal );
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,_b=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,bb=`#define TOON
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,ky=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,zy=`#define PHONG
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,wb=`#define STANDARD
#ifdef PHYSICAL
	#define REFLECTIVITY
	#define CLEARCOAT
	#define TRANSMISSION
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef TRANSMISSION
	uniform float transmission;
#endif
#ifdef REFLECTIVITY
	uniform float reflectivity;
#endif
#ifdef CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheen;
#endif
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <transmissionmap_pars_fragment>
#include <bsdfs>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <lights_physical_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#ifdef TRANSMISSION
		float totalTransmission = transmission;
	#endif
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <transmissionmap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#ifdef TRANSMISSION
		diffuseColor.a *= mix( saturate( 1. - totalTransmission + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) ), 1.0, metalness );
	#endif
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Mb=`#define STANDARD
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Sb=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <packing>
#include <uv_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
}`,Eb=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,Tb=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Uy=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,Ab=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,Lb=`#include <common>
#include <fog_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <begin_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Hy=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,Cb=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`;const Ar={alphamap_fragment:v_,alphamap_pars_fragment:dy,alphatest_fragment:py,aomap_fragment:y_,aomap_pars_fragment:x_,begin_vertex:Vf,beginnormal_vertex:my,bsdfs:__,bumpmap_pars_fragment:b_,clipping_planes_fragment:w_,clipping_planes_pars_fragment:M_,clipping_planes_pars_vertex:Nc,clipping_planes_vertex:op,color_fragment:S_,color_pars_fragment:E_,color_pars_vertex:T_,color_vertex:bl,common:A_,cube_uv_reflection_fragment:L_,defaultnormal_vertex:C_,displacementmap_pars_vertex:P_,displacementmap_vertex:R_,emissivemap_fragment:tg,emissivemap_pars_fragment:D_,encodings_fragment:O_,encodings_pars_fragment:I_,envmap_fragment:ng,envmap_common_pars_fragment:N_,envmap_pars_fragment:gy,envmap_pars_vertex:vy,envmap_physical_pars_fragment:by,envmap_vertex:F_,fog_vertex:yy,fog_pars_vertex:xy,fog_fragment:lp,fog_pars_fragment:Wf,gradientmap_pars_fragment:B_,lightmap_fragment:_y,lightmap_pars_fragment:k_,lights_lambert_vertex:z_,lights_pars_begin:U_,lights_toon_fragment:wy,lights_toon_pars_fragment:My,lights_phong_fragment:H_,lights_phong_pars_fragment:Sy,lights_physical_fragment:cp,lights_physical_pars_fragment:Ey,lights_fragment_begin:js,lights_fragment_maps:Ty,lights_fragment_end:Fc,logdepthbuf_fragment:Cu,logdepthbuf_pars_fragment:ig,logdepthbuf_pars_vertex:Ay,logdepthbuf_vertex:G_,map_fragment:V_,map_pars_fragment:W_,map_particle_fragment:X_,map_particle_pars_fragment:q_,metalnessmap_fragment:Ly,metalnessmap_pars_fragment:Cy,morphnormal_vertex:rg,morphtarget_pars_vertex:j_,morphtarget_vertex:Y_,normal_fragment_begin:Z_,normal_fragment_maps:Py,normalmap_pars_fragment:J_,clearcoat_normal_fragment_begin:Ry,clearcoat_normal_fragment_maps:$_,clearcoat_pars_fragment:up,packing:hp,premultiplied_alpha_fragment:K_,project_vertex:Sh,dithering_fragment:Xf,dithering_pars_fragment:Q_,roughnessmap_fragment:eb,roughnessmap_pars_fragment:fp,shadowmap_pars_fragment:sg,shadowmap_pars_vertex:dp,shadowmap_vertex:pp,shadowmask_pars_fragment:Dy,skinbase_vertex:Oy,skinning_pars_vertex:tb,skinning_vertex:nb,skinnormal_vertex:Eh,specularmap_fragment:ag,specularmap_pars_fragment:ib,tonemapping_fragment:rb,tonemapping_pars_fragment:sb,transmissionmap_fragment:mp,transmissionmap_pars_fragment:Iy,uv_pars_fragment:ab,uv_pars_vertex:ob,uv_vertex:Ny,uv2_pars_fragment:lb,uv2_pars_vertex:cb,uv2_vertex:og,worldpos_vertex:ub,background_frag:hb,background_vert:fb,cube_frag:db,cube_vert:pb,depth_frag:Bc,depth_vert:Fy,distanceRGBA_frag:gp,distanceRGBA_vert:By,equirect_frag:kc,equirect_vert:mb,linedashed_frag:gb,linedashed_vert:vb,meshbasic_frag:lg,meshbasic_vert:yb,meshlambert_frag:xb,meshlambert_vert:cg,meshmatcap_frag:vp,meshmatcap_vert:ug,meshtoon_frag:_b,meshtoon_vert:bb,meshphong_frag:ky,meshphong_vert:zy,meshphysical_frag:wb,meshphysical_vert:Mb,normal_frag:Sb,normal_vert:Eb,points_frag:Tb,points_vert:Uy,shadow_frag:Ab,shadow_vert:Lb,sprite_frag:Hy,sprite_vert:Cb},ui={common:{diffuse:{value:new Mi(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Ja},uv2Transform:{value:new Ja},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new vn(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Mi(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Mi(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Ja}},sprite:{diffuse:{value:new Mi(15658734)},opacity:{value:1},center:{value:new vn(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Ja}}},wl={basic:{uniforms:_a([ui.common,ui.specularmap,ui.envmap,ui.aomap,ui.lightmap,ui.fog]),vertexShader:Ar.meshbasic_vert,fragmentShader:Ar.meshbasic_frag},lambert:{uniforms:_a([ui.common,ui.specularmap,ui.envmap,ui.aomap,ui.lightmap,ui.emissivemap,ui.fog,ui.lights,{emissive:{value:new Mi(0)}}]),vertexShader:Ar.meshlambert_vert,fragmentShader:Ar.meshlambert_frag},phong:{uniforms:_a([ui.common,ui.specularmap,ui.envmap,ui.aomap,ui.lightmap,ui.emissivemap,ui.bumpmap,ui.normalmap,ui.displacementmap,ui.fog,ui.lights,{emissive:{value:new Mi(0)},specular:{value:new Mi(1118481)},shininess:{value:30}}]),vertexShader:Ar.meshphong_vert,fragmentShader:Ar.meshphong_frag},standard:{uniforms:_a([ui.common,ui.envmap,ui.aomap,ui.lightmap,ui.emissivemap,ui.bumpmap,ui.normalmap,ui.displacementmap,ui.roughnessmap,ui.metalnessmap,ui.fog,ui.lights,{emissive:{value:new Mi(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Ar.meshphysical_vert,fragmentShader:Ar.meshphysical_frag},toon:{uniforms:_a([ui.common,ui.aomap,ui.lightmap,ui.emissivemap,ui.bumpmap,ui.normalmap,ui.displacementmap,ui.gradientmap,ui.fog,ui.lights,{emissive:{value:new Mi(0)}}]),vertexShader:Ar.meshtoon_vert,fragmentShader:Ar.meshtoon_frag},matcap:{uniforms:_a([ui.common,ui.bumpmap,ui.normalmap,ui.displacementmap,ui.fog,{matcap:{value:null}}]),vertexShader:Ar.meshmatcap_vert,fragmentShader:Ar.meshmatcap_frag},points:{uniforms:_a([ui.points,ui.fog]),vertexShader:Ar.points_vert,fragmentShader:Ar.points_frag},dashed:{uniforms:_a([ui.common,ui.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Ar.linedashed_vert,fragmentShader:Ar.linedashed_frag},depth:{uniforms:_a([ui.common,ui.displacementmap]),vertexShader:Ar.depth_vert,fragmentShader:Ar.depth_frag},normal:{uniforms:_a([ui.common,ui.bumpmap,ui.normalmap,ui.displacementmap,{opacity:{value:1}}]),vertexShader:Ar.normal_vert,fragmentShader:Ar.normal_frag},sprite:{uniforms:_a([ui.sprite,ui.fog]),vertexShader:Ar.sprite_vert,fragmentShader:Ar.sprite_frag},background:{uniforms:{uvTransform:{value:new Ja},t2D:{value:null}},vertexShader:Ar.background_vert,fragmentShader:Ar.background_frag},cube:{uniforms:_a([ui.envmap,{opacity:{value:1}}]),vertexShader:Ar.cube_vert,fragmentShader:Ar.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Ar.equirect_vert,fragmentShader:Ar.equirect_frag},distanceRGBA:{uniforms:_a([ui.common,ui.displacementmap,{referencePosition:{value:new De},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Ar.distanceRGBA_vert,fragmentShader:Ar.distanceRGBA_frag},shadow:{uniforms:_a([ui.lights,ui.fog,{color:{value:new Mi(0)},opacity:{value:1}}]),vertexShader:Ar.shadow_vert,fragmentShader:Ar.shadow_frag}};wl.physical={uniforms:_a([wl.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new vn(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new Mi(0)},transmission:{value:0},transmissionMap:{value:null}}]),vertexShader:Ar.meshphysical_vert,fragmentShader:Ar.meshphysical_frag};function Pb(r,i,n,u,p){const g=new Mi(0);let b=0,M,A,C=null,F=0,O=null;function k(X,ne,te,j){let W=ne.isScene===!0?ne.background:null;W&&W.isTexture&&(W=i.get(W));const Pe=r.xr,Re=Pe.getSession&&Pe.getSession();Re&&Re.environmentBlendMode==="additive"&&(W=null),W===null?N(g,b):W&&W.isColor&&(N(W,1),j=!0),(r.autoClear||j)&&r.clear(r.autoClearColor,r.autoClearDepth,r.autoClearStencil),W&&(W.isCubeTexture||W.isWebGLCubeRenderTarget||W.mapping===Er)?(A===void 0&&(A=new Ca(new eg(1,1,1),new Fa({name:"BackgroundCubeMaterial",uniforms:Lu(wl.cube.uniforms),vertexShader:wl.cube.vertexShader,fragmentShader:wl.cube.fragmentShader,side:It,depthTest:!1,depthWrite:!1,fog:!1})),A.geometry.deleteAttribute("normal"),A.geometry.deleteAttribute("uv"),A.onBeforeRender=function(Ne,de,$e){this.matrixWorld.copyPosition($e.matrixWorld)},Object.defineProperty(A.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),u.update(A)),W.isWebGLCubeRenderTarget&&(W=W.texture),A.material.uniforms.envMap.value=W,A.material.uniforms.flipEnvMap.value=W.isCubeTexture&&W._needsFlipEnvMap?-1:1,(C!==W||F!==W.version||O!==r.toneMapping)&&(A.material.needsUpdate=!0,C=W,F=W.version,O=r.toneMapping),X.unshift(A,A.geometry,A.material,0,0,null)):W&&W.isTexture&&(M===void 0&&(M=new Ca(new g_(2,2),new Fa({name:"BackgroundMaterial",uniforms:Lu(wl.background.uniforms),vertexShader:wl.background.vertexShader,fragmentShader:wl.background.fragmentShader,side:St,depthTest:!1,depthWrite:!1,fog:!1})),M.geometry.deleteAttribute("normal"),Object.defineProperty(M.material,"map",{get:function(){return this.uniforms.t2D.value}}),u.update(M)),M.material.uniforms.t2D.value=W,W.matrixAutoUpdate===!0&&W.updateMatrix(),M.material.uniforms.uvTransform.value.copy(W.matrix),(C!==W||F!==W.version||O!==r.toneMapping)&&(M.material.needsUpdate=!0,C=W,F=W.version,O=r.toneMapping),X.unshift(M,M.geometry,M.material,0,0,null))}function N(X,ne){n.buffers.color.setClear(X.r,X.g,X.b,ne,p)}return{getClearColor:function(){return g},setClearColor:function(X,ne){g.set(X),b=ne!==void 0?ne:1,N(g,b)},getClearAlpha:function(){return b},setClearAlpha:function(X){b=X,N(g,b)},render:k}}function Rb(r,i,n,u){const p=r.getParameter(34921),g=u.isWebGL2?null:i.get("OES_vertex_array_object"),b=u.isWebGL2||g!==null,M={},A=ne(null);let C=A;function F(rt,je,Ve,ht,ft){let Wt=!1;if(b){const An=X(ht,Ve,je);C!==An&&(C=An,k(C.object)),Wt=te(ht,ft),Wt&&j(ht,ft)}else{const An=je.wireframe===!0;(C.geometry!==ht.id||C.program!==Ve.id||C.wireframe!==An)&&(C.geometry=ht.id,C.program=Ve.id,C.wireframe=An,Wt=!0)}rt.isInstancedMesh===!0&&(Wt=!0),ft!==null&&n.update(ft,34963),Wt&&($e(rt,je,Ve,ht),ft!==null&&r.bindBuffer(34963,n.get(ft).buffer))}function O(){return u.isWebGL2?r.createVertexArray():g.createVertexArrayOES()}function k(rt){return u.isWebGL2?r.bindVertexArray(rt):g.bindVertexArrayOES(rt)}function N(rt){return u.isWebGL2?r.deleteVertexArray(rt):g.deleteVertexArrayOES(rt)}function X(rt,je,Ve){const ht=Ve.wireframe===!0;let ft=M[rt.id];ft===void 0&&(ft={},M[rt.id]=ft);let Wt=ft[je.id];Wt===void 0&&(Wt={},ft[je.id]=Wt);let An=Wt[ht];return An===void 0&&(An=ne(O()),Wt[ht]=An),An}function ne(rt){const je=[],Ve=[],ht=[];for(let ft=0;ft<p;ft++)je[ft]=0,Ve[ft]=0,ht[ft]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:je,enabledAttributes:Ve,attributeDivisors:ht,object:rt,attributes:{},index:null}}function te(rt,je){const Ve=C.attributes,ht=rt.attributes;if(Object.keys(Ve).length!==Object.keys(ht).length)return!0;for(const ft in ht){const Wt=Ve[ft],An=ht[ft];if(Wt===void 0||Wt.attribute!==An||Wt.data!==An.data)return!0}return C.index!==je}function j(rt,je){const Ve={},ht=rt.attributes;for(const ft in ht){const Wt=ht[ft],An={};An.attribute=Wt,Wt.data&&(An.data=Wt.data),Ve[ft]=An}C.attributes=Ve,C.index=je}function W(){const rt=C.newAttributes;for(let je=0,Ve=rt.length;je<Ve;je++)rt[je]=0}function Pe(rt){Re(rt,0)}function Re(rt,je){const Ve=C.newAttributes,ht=C.enabledAttributes,ft=C.attributeDivisors;Ve[rt]=1,ht[rt]===0&&(r.enableVertexAttribArray(rt),ht[rt]=1),ft[rt]!==je&&((u.isWebGL2?r:i.get("ANGLE_instanced_arrays"))[u.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](rt,je),ft[rt]=je)}function Ne(){const rt=C.newAttributes,je=C.enabledAttributes;for(let Ve=0,ht=je.length;Ve<ht;Ve++)je[Ve]!==rt[Ve]&&(r.disableVertexAttribArray(Ve),je[Ve]=0)}function de(rt,je,Ve,ht,ft,Wt){u.isWebGL2===!0&&(Ve===5124||Ve===5125)?r.vertexAttribIPointer(rt,je,Ve,ft,Wt):r.vertexAttribPointer(rt,je,Ve,ht,ft,Wt)}function $e(rt,je,Ve,ht){if(u.isWebGL2===!1&&(rt.isInstancedMesh||ht.isInstancedBufferGeometry)&&i.get("ANGLE_instanced_arrays")===null)return;W();const ft=ht.attributes,Wt=Ve.getAttributes(),An=je.defaultAttributeValues;for(const Vt in Wt){const Dn=Wt[Vt];if(Dn>=0){const Ci=ft[Vt];if(Ci!==void 0){const vi=Ci.normalized,he=Ci.itemSize,K=n.get(Ci);if(K===void 0)continue;const Fe=K.buffer,me=K.type,Le=K.bytesPerElement;if(Ci.isInterleavedBufferAttribute){const Be=Ci.data,Ye=Be.stride,ke=Ci.offset;Be&&Be.isInstancedInterleavedBuffer?(Re(Dn,Be.meshPerAttribute),ht._maxInstanceCount===void 0&&(ht._maxInstanceCount=Be.meshPerAttribute*Be.count)):Pe(Dn),r.bindBuffer(34962,Fe),de(Dn,he,me,vi,Ye*Le,ke*Le)}else Ci.isInstancedBufferAttribute?(Re(Dn,Ci.meshPerAttribute),ht._maxInstanceCount===void 0&&(ht._maxInstanceCount=Ci.meshPerAttribute*Ci.count)):Pe(Dn),r.bindBuffer(34962,Fe),de(Dn,he,me,vi,0,0)}else if(Vt==="instanceMatrix"){const vi=n.get(rt.instanceMatrix);if(vi===void 0)continue;const he=vi.buffer,K=vi.type;Re(Dn+0,1),Re(Dn+1,1),Re(Dn+2,1),Re(Dn+3,1),r.bindBuffer(34962,he),r.vertexAttribPointer(Dn+0,4,K,!1,64,0),r.vertexAttribPointer(Dn+1,4,K,!1,64,16),r.vertexAttribPointer(Dn+2,4,K,!1,64,32),r.vertexAttribPointer(Dn+3,4,K,!1,64,48)}else if(Vt==="instanceColor"){const vi=n.get(rt.instanceColor);if(vi===void 0)continue;const he=vi.buffer,K=vi.type;Re(Dn,1),r.bindBuffer(34962,he),r.vertexAttribPointer(Dn,3,K,!1,12,0)}else if(An!==void 0){const vi=An[Vt];if(vi!==void 0)switch(vi.length){case 2:r.vertexAttrib2fv(Dn,vi);break;case 3:r.vertexAttrib3fv(Dn,vi);break;case 4:r.vertexAttrib4fv(Dn,vi);break;default:r.vertexAttrib1fv(Dn,vi)}}}}Ne()}function Gt(){_t();for(const rt in M){const je=M[rt];for(const Ve in je){const ht=je[Ve];for(const ft in ht)N(ht[ft].object),delete ht[ft];delete je[Ve]}delete M[rt]}}function dt(rt){if(M[rt.id]===void 0)return;const je=M[rt.id];for(const Ve in je){const ht=je[Ve];for(const ft in ht)N(ht[ft].object),delete ht[ft];delete je[Ve]}delete M[rt.id]}function an(rt){for(const je in M){const Ve=M[je];if(Ve[rt.id]===void 0)continue;const ht=Ve[rt.id];for(const ft in ht)N(ht[ft].object),delete ht[ft];delete Ve[rt.id]}}function _t(){et(),C!==A&&(C=A,k(C.object))}function et(){A.geometry=null,A.program=null,A.wireframe=!1}return{setup:F,reset:_t,resetDefaultState:et,dispose:Gt,releaseStatesOfGeometry:dt,releaseStatesOfProgram:an,initAttributes:W,enableAttribute:Pe,disableUnusedAttributes:Ne}}function Gy(r,i,n,u){const p=u.isWebGL2;let g;function b(C){g=C}function M(C,F){r.drawArrays(g,C,F),n.update(F,g,1)}function A(C,F,O){if(O===0)return;let k,N;if(p)k=r,N="drawArraysInstanced";else if(k=i.get("ANGLE_instanced_arrays"),N="drawArraysInstancedANGLE",k===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}k[N](g,C,F,O),n.update(F,g,O)}this.setMode=b,this.render=M,this.renderInstances=A}function Db(r,i,n){let u;function p(){if(u!==void 0)return u;const de=i.get("EXT_texture_filter_anisotropic");return de!==null?u=r.getParameter(de.MAX_TEXTURE_MAX_ANISOTROPY_EXT):u=0,u}function g(de){if(de==="highp"){if(r.getShaderPrecisionFormat(35633,36338).precision>0&&r.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";de="mediump"}return de==="mediump"&&r.getShaderPrecisionFormat(35633,36337).precision>0&&r.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const b=typeof WebGL2RenderingContext<"u"&&r instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&r instanceof WebGL2ComputeRenderingContext;let M=n.precision!==void 0?n.precision:"highp";const A=g(M);A!==M&&(console.warn("THREE.WebGLRenderer:",M,"not supported, using",A,"instead."),M=A);const C=n.logarithmicDepthBuffer===!0,F=r.getParameter(34930),O=r.getParameter(35660),k=r.getParameter(3379),N=r.getParameter(34076),X=r.getParameter(34921),ne=r.getParameter(36347),te=r.getParameter(36348),j=r.getParameter(36349),W=O>0,Pe=b||!!i.get("OES_texture_float"),Re=W&&Pe,Ne=b?r.getParameter(36183):0;return{isWebGL2:b,getMaxAnisotropy:p,getMaxPrecision:g,precision:M,logarithmicDepthBuffer:C,maxTextures:F,maxVertexTextures:O,maxTextureSize:k,maxCubemapSize:N,maxAttributes:X,maxVertexUniforms:ne,maxVaryings:te,maxFragmentUniforms:j,vertexTextures:W,floatFragmentTextures:Pe,floatVertexTextures:Re,maxSamples:Ne}}function Vy(r){const i=this;let n=null,u=0,p=!1,g=!1;const b=new Ka,M=new Ja,A={value:null,needsUpdate:!1};this.uniform=A,this.numPlanes=0,this.numIntersection=0,this.init=function(O,k,N){const X=O.length!==0||k||u!==0||p;return p=k,n=F(O,N,0),u=O.length,X},this.beginShadows=function(){g=!0,F(null)},this.endShadows=function(){g=!1,C()},this.setState=function(O,k,N){const X=O.clippingPlanes,ne=O.clipIntersection,te=O.clipShadows,j=r.get(O);if(!p||X===null||X.length===0||g&&!te)g?F(null):C();else{const W=g?0:u,Pe=W*4;let Re=j.clippingState||null;A.value=Re,Re=F(X,k,Pe,N);for(let Ne=0;Ne!==Pe;++Ne)Re[Ne]=n[Ne];j.clippingState=Re,this.numIntersection=ne?this.numPlanes:0,this.numPlanes+=W}};function C(){A.value!==n&&(A.value=n,A.needsUpdate=u>0),i.numPlanes=u,i.numIntersection=0}function F(O,k,N,X){const ne=O!==null?O.length:0;let te=null;if(ne!==0){if(te=A.value,X!==!0||te===null){const j=N+ne*4,W=k.matrixWorldInverse;M.getNormalMatrix(W),(te===null||te.length<j)&&(te=new Float32Array(j));for(let Pe=0,Re=N;Pe!==ne;++Pe,Re+=4)b.copy(O[Pe]).applyMatrix4(W,M),b.normal.toArray(te,Re),te[Re+3]=b.constant}A.value=te,A.needsUpdate=!0}return i.numPlanes=ne,i.numIntersection=0,te}}function hg(r){let i=new WeakMap;function n(g,b){return b===_i?g.mapping=xt:b===Hr&&(g.mapping=sn),g}function u(g){if(g&&g.isTexture){const b=g.mapping;if(b===_i||b===Hr)if(i.has(g)){const M=i.get(g).texture;return n(M,g.mapping)}else{const M=g.image;if(M&&M.height>0){const A=r.getRenderList(),C=r.getRenderTarget(),F=r.getRenderState(),O=new _l(M.height/2);return O.fromEquirectangularTexture(r,g),i.set(g,O),r.setRenderTarget(C),r.setRenderList(A),r.setRenderState(F),n(O.texture,g.mapping)}else return null}}return g}function p(){i=new WeakMap}return{get:u,dispose:p}}function Wy(r){const i={};return{has:function(n){if(i[n]!==void 0)return i[n]!==null;let u;switch(n){case"WEBGL_depth_texture":u=r.getExtension("WEBGL_depth_texture")||r.getExtension("MOZ_WEBGL_depth_texture")||r.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":u=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":u=r.getExtension("WEBGL_compressed_texture_s3tc")||r.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||r.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":u=r.getExtension("WEBGL_compressed_texture_pvrtc")||r.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:u=r.getExtension(n)}return i[n]=u,u!==null},get:function(n){return this.has(n)||console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),i[n]}}}function Ob(r,i,n,u){const p=new WeakMap,g=new WeakMap;function b(O){const k=O.target,N=p.get(k);N.index!==null&&i.remove(N.index);for(const ne in N.attributes)i.remove(N.attributes[ne]);k.removeEventListener("dispose",b),p.delete(k);const X=g.get(N);X&&(i.remove(X),g.delete(N)),u.releaseStatesOfGeometry(k),k.isInstancedBufferGeometry===!0&&delete k._maxInstanceCount,n.memory.geometries--}function M(O,k){let N=p.get(k);return N||(k.addEventListener("dispose",b),k.isBufferGeometry?N=k:k.isGeometry&&(k._bufferGeometry===void 0&&(k._bufferGeometry=new hs().setFromObject(O)),N=k._bufferGeometry),p.set(k,N),n.memory.geometries++,N)}function A(O){const k=O.attributes;for(const X in k)i.update(k[X],34962);const N=O.morphAttributes;for(const X in N){const ne=N[X];for(let te=0,j=ne.length;te<j;te++)i.update(ne[te],34962)}}function C(O){const k=[],N=O.index,X=O.attributes.position;let ne=0;if(N!==null){const W=N.array;ne=N.version;for(let Pe=0,Re=W.length;Pe<Re;Pe+=3){const Ne=W[Pe+0],de=W[Pe+1],$e=W[Pe+2];k.push(Ne,de,de,$e,$e,Ne)}}else{const W=X.array;ne=X.version;for(let Pe=0,Re=W.length/3-1;Pe<Re;Pe+=3){const Ne=Pe+0,de=Pe+1,$e=Pe+2;k.push(Ne,de,de,$e,$e,Ne)}}const te=new(uy(k)>65535?Nf:If)(k,1);te.version=ne;const j=g.get(O);j&&i.remove(j),g.set(O,te)}function F(O){const k=g.get(O);if(k){const N=O.index;N!==null&&k.version<N.version&&C(O)}else C(O);return g.get(O)}return{get:M,update:A,getWireframeAttribute:F}}function Ib(r,i,n,u){const p=u.isWebGL2;let g;function b(k){g=k}let M,A;function C(k){M=k.type,A=k.bytesPerElement}function F(k,N){r.drawElements(g,N,M,k*A),n.update(N,g,1)}function O(k,N,X){if(X===0)return;let ne,te;if(p)ne=r,te="drawElementsInstanced";else if(ne=i.get("ANGLE_instanced_arrays"),te="drawElementsInstancedANGLE",ne===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}ne[te](g,N,M,k*A,X),n.update(N,g,X)}this.setMode=b,this.setIndex=C,this.render=F,this.renderInstances=O}function Xy(r){const i={geometries:0,textures:0},n={frame:0,calls:0,triangles:0,points:0,lines:0};function u(g,b,M){switch(n.calls++,b){case 4:n.triangles+=M*(g/3);break;case 1:n.lines+=M*(g/2);break;case 3:n.lines+=M*(g-1);break;case 2:n.lines+=M*g;break;case 0:n.points+=M*g;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",b);break}}function p(){n.frame++,n.calls=0,n.triangles=0,n.points=0,n.lines=0}return{memory:i,render:n,programs:null,autoReset:!0,reset:p,update:u}}function qy(r,i){return r[0]-i[0]}function Nb(r,i){return Math.abs(i[1])-Math.abs(r[1])}function fg(r){const i={},n=new Float32Array(8),u=[];for(let g=0;g<8;g++)u[g]=[g,0];function p(g,b,M,A){const C=g.morphTargetInfluences,F=C===void 0?0:C.length;let O=i[b.id];if(O===void 0){O=[];for(let te=0;te<F;te++)O[te]=[te,0];i[b.id]=O}for(let te=0;te<F;te++){const j=O[te];j[0]=te,j[1]=C[te]}O.sort(Nb);for(let te=0;te<8;te++)te<F&&O[te][1]?(u[te][0]=O[te][0],u[te][1]=O[te][1]):(u[te][0]=Number.MAX_SAFE_INTEGER,u[te][1]=0);u.sort(qy);const k=M.morphTargets&&b.morphAttributes.position,N=M.morphNormals&&b.morphAttributes.normal;let X=0;for(let te=0;te<8;te++){const j=u[te],W=j[0],Pe=j[1];W!==Number.MAX_SAFE_INTEGER&&Pe?(k&&b.getAttribute("morphTarget"+te)!==k[W]&&b.setAttribute("morphTarget"+te,k[W]),N&&b.getAttribute("morphNormal"+te)!==N[W]&&b.setAttribute("morphNormal"+te,N[W]),n[te]=Pe,X+=Pe):(k&&b.getAttribute("morphTarget"+te)!==void 0&&b.deleteAttribute("morphTarget"+te),N&&b.getAttribute("morphNormal"+te)!==void 0&&b.deleteAttribute("morphNormal"+te),n[te]=0)}const ne=b.morphTargetsRelative?1:1-X;A.getUniforms().setValue(r,"morphTargetBaseInfluence",ne),A.getUniforms().setValue(r,"morphTargetInfluences",n)}return{update:p}}function jy(r,i,n,u){let p=new WeakMap;function g(M){const A=u.render.frame,C=M.geometry,F=i.get(M,C);return p.get(F)!==A&&(C.isGeometry&&F.updateFromObject(M),i.update(F),p.set(F,A)),M.isInstancedMesh&&(n.update(M.instanceMatrix,34962),M.instanceColor!==null&&n.update(M.instanceColor,34962)),F}function b(){p=new WeakMap}return{update:g,dispose:b}}function qf(r,i,n,u){gs.call(this,null),this.image={data:r||null,width:i||1,height:n||1,depth:u||1},this.magFilter=Kr,this.minFilter=Kr,this.wrapR=$r,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}qf.prototype=Object.create(gs.prototype),qf.prototype.constructor=qf,qf.prototype.isDataTexture2DArray=!0;function Th(r,i,n,u){gs.call(this,null),this.image={data:r||null,width:i||1,height:n||1,depth:u||1},this.magFilter=Kr,this.minFilter=Kr,this.wrapR=$r,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}Th.prototype=Object.create(gs.prototype),Th.prototype.constructor=Th,Th.prototype.isDataTexture3D=!0;const Yy=new gs,dg=new qf,Fb=new Th,jf=new Ic,Ah=[],Jo=[],Ml=new Float32Array(16),Zy=new Float32Array(9),pg=new Float32Array(4);function Lh(r,i,n){const u=r[0];if(u<=0||u>0)return r;const p=i*n;let g=Ah[p];if(g===void 0&&(g=new Float32Array(p),Ah[p]=g),i!==0){u.toArray(g,0);for(let b=1,M=0;b!==i;++b)M+=n,r[b].toArray(g,M)}return g}function No(r,i){if(r.length!==i.length)return!1;for(let n=0,u=r.length;n<u;n++)if(r[n]!==i[n])return!1;return!0}function _o(r,i){for(let n=0,u=i.length;n<u;n++)r[n]=i[n]}function mg(r,i){let n=Jo[i];n===void 0&&(n=new Int32Array(i),Jo[i]=n);for(let u=0;u!==i;++u)n[u]=r.allocateTextureUnit();return n}function Bb(r,i){const n=this.cache;n[0]!==i&&(r.uniform1f(this.addr,i),n[0]=i)}function kb(r,i){const n=this.cache;if(i.x!==void 0)(n[0]!==i.x||n[1]!==i.y)&&(r.uniform2f(this.addr,i.x,i.y),n[0]=i.x,n[1]=i.y);else{if(No(n,i))return;r.uniform2fv(this.addr,i),_o(n,i)}}function Jy(r,i){const n=this.cache;if(i.x!==void 0)(n[0]!==i.x||n[1]!==i.y||n[2]!==i.z)&&(r.uniform3f(this.addr,i.x,i.y,i.z),n[0]=i.x,n[1]=i.y,n[2]=i.z);else if(i.r!==void 0)(n[0]!==i.r||n[1]!==i.g||n[2]!==i.b)&&(r.uniform3f(this.addr,i.r,i.g,i.b),n[0]=i.r,n[1]=i.g,n[2]=i.b);else{if(No(n,i))return;r.uniform3fv(this.addr,i),_o(n,i)}}function yp(r,i){const n=this.cache;if(i.x!==void 0)(n[0]!==i.x||n[1]!==i.y||n[2]!==i.z||n[3]!==i.w)&&(r.uniform4f(this.addr,i.x,i.y,i.z,i.w),n[0]=i.x,n[1]=i.y,n[2]=i.z,n[3]=i.w);else{if(No(n,i))return;r.uniform4fv(this.addr,i),_o(n,i)}}function $y(r,i){const n=this.cache,u=i.elements;if(u===void 0){if(No(n,i))return;r.uniformMatrix2fv(this.addr,!1,i),_o(n,i)}else{if(No(n,u))return;pg.set(u),r.uniformMatrix2fv(this.addr,!1,pg),_o(n,u)}}function zb(r,i){const n=this.cache,u=i.elements;if(u===void 0){if(No(n,i))return;r.uniformMatrix3fv(this.addr,!1,i),_o(n,i)}else{if(No(n,u))return;Zy.set(u),r.uniformMatrix3fv(this.addr,!1,Zy),_o(n,u)}}function Ky(r,i){const n=this.cache,u=i.elements;if(u===void 0){if(No(n,i))return;r.uniformMatrix4fv(this.addr,!1,i),_o(n,i)}else{if(No(n,u))return;Ml.set(u),r.uniformMatrix4fv(this.addr,!1,Ml),_o(n,u)}}function gg(r,i,n){const u=this.cache,p=n.allocateTextureUnit();u[0]!==p&&(r.uniform1i(this.addr,p),u[0]=p),n.safeSetTexture2D(i||Yy,p)}function Qy(r,i,n){const u=this.cache,p=n.allocateTextureUnit();u[0]!==p&&(r.uniform1i(this.addr,p),u[0]=p),n.setTexture2DArray(i||dg,p)}function Ub(r,i,n){const u=this.cache,p=n.allocateTextureUnit();u[0]!==p&&(r.uniform1i(this.addr,p),u[0]=p),n.setTexture3D(i||Fb,p)}function Hb(r,i,n){const u=this.cache,p=n.allocateTextureUnit();u[0]!==p&&(r.uniform1i(this.addr,p),u[0]=p),n.safeSetTextureCube(i||jf,p)}function Gb(r,i){const n=this.cache;n[0]!==i&&(r.uniform1i(this.addr,i),n[0]=i)}function xp(r,i){const n=this.cache;No(n,i)||(r.uniform2iv(this.addr,i),_o(n,i))}function Vb(r,i){const n=this.cache;No(n,i)||(r.uniform3iv(this.addr,i),_o(n,i))}function e0(r,i){const n=this.cache;No(n,i)||(r.uniform4iv(this.addr,i),_o(n,i))}function _p(r,i){const n=this.cache;n[0]!==i&&(r.uniform1ui(this.addr,i),n[0]=i)}function vg(r){switch(r){case 5126:return Bb;case 35664:return kb;case 35665:return Jy;case 35666:return yp;case 35674:return $y;case 35675:return zb;case 35676:return Ky;case 5124:case 35670:return Gb;case 35667:case 35671:return xp;case 35668:case 35672:return Vb;case 35669:case 35673:return e0;case 5125:return _p;case 35678:case 36198:case 36298:case 36306:case 35682:return gg;case 35679:case 36299:case 36307:return Ub;case 35680:case 36300:case 36308:case 36293:return Hb;case 36289:case 36303:case 36311:case 36292:return Qy}}function t0(r,i){r.uniform1fv(this.addr,i)}function Wb(r,i){r.uniform1iv(this.addr,i)}function yg(r,i){r.uniform2iv(this.addr,i)}function xg(r,i){r.uniform3iv(this.addr,i)}function Xb(r,i){r.uniform4iv(this.addr,i)}function n0(r,i){const n=Lh(i,this.size,2);r.uniform2fv(this.addr,n)}function qb(r,i){const n=Lh(i,this.size,3);r.uniform3fv(this.addr,n)}function jb(r,i){const n=Lh(i,this.size,4);r.uniform4fv(this.addr,n)}function Yb(r,i){const n=Lh(i,this.size,4);r.uniformMatrix2fv(this.addr,!1,n)}function Zb(r,i){const n=Lh(i,this.size,9);r.uniformMatrix3fv(this.addr,!1,n)}function Jb(r,i){const n=Lh(i,this.size,16);r.uniformMatrix4fv(this.addr,!1,n)}function $b(r,i,n){const u=i.length,p=mg(n,u);r.uniform1iv(this.addr,p);for(let g=0;g!==u;++g)n.safeSetTexture2D(i[g]||Yy,p[g])}function i0(r,i,n){const u=i.length,p=mg(n,u);r.uniform1iv(this.addr,p);for(let g=0;g!==u;++g)n.safeSetTextureCube(i[g]||jf,p[g])}function Kb(r){switch(r){case 5126:return t0;case 35664:return n0;case 35665:return qb;case 35666:return jb;case 35674:return Yb;case 35675:return Zb;case 35676:return Jb;case 5124:case 35670:return Wb;case 35667:case 35671:return yg;case 35668:case 35672:return xg;case 35669:case 35673:return Xb;case 35678:case 36198:case 36298:case 36306:case 35682:return $b;case 35680:case 36300:case 36308:case 36293:return i0}}function bp(r,i,n){this.id=r,this.addr=n,this.cache=[],this.setValue=vg(i.type)}function r0(r,i,n){this.id=r,this.addr=n,this.cache=[],this.size=i.size,this.setValue=Kb(i.type)}r0.prototype.updateCache=function(r){const i=this.cache;r instanceof Float32Array&&i.length!==r.length&&(this.cache=new Float32Array(r.length)),_o(i,r)};function Ch(r){this.id=r,this.seq=[],this.map={}}Ch.prototype.setValue=function(r,i,n){const u=this.seq;for(let p=0,g=u.length;p!==g;++p){const b=u[p];b.setValue(r,i[b.id],n)}};const Ph=/([\w\d_]+)(\])?(\[|\.)?/g;function Wa(r,i){r.seq.push(i),r.map[i.id]=i}function Qb(r,i,n){const u=r.name,p=u.length;for(Ph.lastIndex=0;;){const g=Ph.exec(u),b=Ph.lastIndex;let M=g[1];const A=g[2]==="]",C=g[3];if(A&&(M=M|0),C===void 0||C==="["&&b+2===p){Wa(n,C===void 0?new bp(M,r,i):new r0(M,r,i));break}else{let O=n.map[M];O===void 0&&(O=new Ch(M),Wa(n,O)),n=O}}}function Yl(r,i){this.seq=[],this.map={};const n=r.getProgramParameter(i,35718);for(let u=0;u<n;++u){const p=r.getActiveUniform(i,u),g=r.getUniformLocation(i,p.name);Qb(p,g,this)}}Yl.prototype.setValue=function(r,i,n,u){const p=this.map[i];p!==void 0&&p.setValue(r,n,u)},Yl.prototype.setOptional=function(r,i,n){const u=i[n];u!==void 0&&this.setValue(r,n,u)},Yl.upload=function(r,i,n,u){for(let p=0,g=i.length;p!==g;++p){const b=i[p],M=n[b.id];M.needsUpdate!==!1&&b.setValue(r,M.value,u)}},Yl.seqWithValue=function(r,i){const n=[];for(let u=0,p=r.length;u!==p;++u){const g=r[u];g.id in i&&n.push(g)}return n};function _g(r,i,n){const u=r.createShader(i);return r.shaderSource(u,n),r.compileShader(u),u}let ew=0;function tw(r){const i=r.split(`
`);for(let n=0;n<i.length;n++)i[n]=n+1+": "+i[n];return i.join(`
`)}function bg(r){switch(r){case Bl:return["Linear","( value )"];case ph:return["sRGB","( value )"];case Sf:return["RGBE","( value )"];case Ud:return["RGBM","( value, 7.0 )"];case Qv:return["RGBM","( value, 16.0 )"];case a_:return["RGBD","( value, 256.0 )"];case Bm:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case zd:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",r),["Linear","( value )"]}}function s0(r,i,n){const u=r.getShaderParameter(i,35713),p=r.getShaderInfoLog(i).trim();if(u&&p==="")return"";const g=r.getShaderSource(i);return"THREE.WebGLShader: gl.getShaderInfoLog() "+n+`
`+p+tw(g)}function Rh(r,i){const n=bg(i);return"vec4 "+r+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function Yf(r,i){const n=bg(i);return"vec4 "+r+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function wp(r,i){let n;switch(i){case jr:n="Linear";break;case Si:n="Reinhard";break;case or:n="OptimizedCineon";break;case ns:n="ACESFilmic";break;case rr:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",i),n="Linear"}return"vec3 "+r+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function wg(r){return[r.extensionDerivatives||r.envMapCubeUV||r.bumpMap||r.tangentSpaceNormalMap||r.clearcoatNormalMap||r.flatShading||r.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(r.extensionFragDepth||r.logarithmicDepthBuffer)&&r.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",r.extensionDrawBuffers&&r.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(r.extensionShaderTextureLOD||r.envMap)&&r.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(o).join(`
`)}function a0(r){const i=[];for(const n in r){const u=r[n];u!==!1&&i.push("#define "+n+" "+u)}return i.join(`
`)}function h(r,i){const n={},u=r.getProgramParameter(i,35721);for(let p=0;p<u;p++){const b=r.getActiveAttrib(i,p).name;n[b]=r.getAttribLocation(i,b)}return n}function o(r){return r!==""}function c(r,i){return r.replace(/NUM_DIR_LIGHTS/g,i.numDirLights).replace(/NUM_SPOT_LIGHTS/g,i.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,i.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,i.numPointLights).replace(/NUM_HEMI_LIGHTS/g,i.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,i.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,i.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,i.numPointLightShadows)}function d(r,i){return r.replace(/NUM_CLIPPING_PLANES/g,i.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,i.numClippingPlanes-i.numClipIntersection)}const m=/^[ \t]*#include +<([\w\d./]+)>/gm;function y(r){return r.replace(m,_)}function _(r,i){const n=Ar[i];if(n===void 0)throw new Error("Can not resolve #include <"+i+">");return y(n)}const T=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,D=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function U(r){return r.replace(D,Q).replace(T,Y)}function Y(r,i,n,u){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),Q(r,i,n,u)}function Q(r,i,n,u){let p="";for(let g=parseInt(i);g<parseInt(n);g++)p+=u.replace(/\[\s*i\s*\]/g,"[ "+g+" ]").replace(/UNROLLED_LOOP_INDEX/g,g);return p}function fe(r){let i="precision "+r.precision+` float;
precision `+r.precision+" int;";return r.precision==="highp"?i+=`
#define HIGH_PRECISION`:r.precision==="mediump"?i+=`
#define MEDIUM_PRECISION`:r.precision==="lowp"&&(i+=`
#define LOW_PRECISION`),i}function Te(r){let i="SHADOWMAP_TYPE_BASIC";return r.shadowMapType===wt?i="SHADOWMAP_TYPE_PCF":r.shadowMapType===kt?i="SHADOWMAP_TYPE_PCF_SOFT":r.shadowMapType===mt&&(i="SHADOWMAP_TYPE_VSM"),i}function Ue(r){let i="ENVMAP_TYPE_CUBE";if(r.envMap)switch(r.envMapMode){case xt:case sn:i="ENVMAP_TYPE_CUBE";break;case Er:case ci:i="ENVMAP_TYPE_CUBE_UV";break}return i}function it(r){let i="ENVMAP_MODE_REFLECTION";if(r.envMap)switch(r.envMapMode){case sn:case ci:i="ENVMAP_MODE_REFRACTION";break}return i}function vt(r){let i="ENVMAP_BLENDING_NONE";if(r.envMap)switch(r.combine){case jt:i="ENVMAP_BLENDING_MULTIPLY";break;case pn:i="ENVMAP_BLENDING_MIX";break;case ki:i="ENVMAP_BLENDING_ADD";break}return i}function Lt(r,i,n,u){const p=r.getContext(),g=n.defines;let b=n.vertexShader,M=n.fragmentShader;const A=Te(n),C=Ue(n),F=it(n),O=vt(n),k=r.gammaFactor>0?r.gammaFactor:1,N=n.isWebGL2?"":wg(n),X=a0(g),ne=p.createProgram();let te,j,W=n.glslVersion?"#version "+n.glslVersion+`
`:"";n.isRawShaderMaterial?(te=[X].filter(o).join(`
`),te.length>0&&(te+=`
`),j=[N,X].filter(o).join(`
`),j.length>0&&(j+=`
`)):(te=[fe(n),"#define SHADER_NAME "+n.shaderName,X,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+k,"#define MAX_BONES "+n.maxBones,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+F:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&n.flatShading===!1?"#define USE_MORPHNORMALS":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+A:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#ifdef USE_COLOR","	attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(o).join(`
`),j=[N,fe(n),"#define SHADER_NAME "+n.shaderName,X,n.alphaTest?"#define ALPHATEST "+n.alphaTest+(n.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+k,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+C:"",n.envMap?"#define "+F:"",n.envMap?"#define "+O:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.sheen?"#define USE_SHEEN":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+A:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(n.extensionShaderTextureLOD||n.envMap)&&n.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==Ai?"#define TONE_MAPPING":"",n.toneMapping!==Ai?Ar.tonemapping_pars_fragment:"",n.toneMapping!==Ai?wp("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",Ar.encodings_pars_fragment,n.map?Rh("mapTexelToLinear",n.mapEncoding):"",n.matcap?Rh("matcapTexelToLinear",n.matcapEncoding):"",n.envMap?Rh("envMapTexelToLinear",n.envMapEncoding):"",n.emissiveMap?Rh("emissiveMapTexelToLinear",n.emissiveMapEncoding):"",n.lightMap?Rh("lightMapTexelToLinear",n.lightMapEncoding):"",Yf("linearToOutputTexel",n.outputEncoding),n.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"",`
`].filter(o).join(`
`)),b=y(b),b=c(b,n),b=d(b,n),M=y(M),M=c(M,n),M=d(M,n),b=U(b),M=U(M),n.isWebGL2&&n.isRawShaderMaterial!==!0&&(W=`#version 300 es
`,te=["#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+te,j=["#define varying in",n.glslVersion===Hm?"":"out highp vec4 pc_fragColor;",n.glslVersion===Hm?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+j);const Pe=W+te+b,Re=W+j+M,Ne=_g(p,35633,Pe),de=_g(p,35632,Re);if(p.attachShader(ne,Ne),p.attachShader(ne,de),n.index0AttributeName!==void 0?p.bindAttribLocation(ne,0,n.index0AttributeName):n.morphTargets===!0&&p.bindAttribLocation(ne,0,"position"),p.linkProgram(ne),r.debug.checkShaderErrors){const dt=p.getProgramInfoLog(ne).trim(),an=p.getShaderInfoLog(Ne).trim(),_t=p.getShaderInfoLog(de).trim();let et=!0,rt=!0;if(p.getProgramParameter(ne,35714)===!1){et=!1;const je=s0(p,Ne,"vertex"),Ve=s0(p,de,"fragment");console.error("THREE.WebGLProgram: shader error: ",p.getError(),"35715",p.getProgramParameter(ne,35715),"gl.getProgramInfoLog",dt,je,Ve)}else dt!==""?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",dt):(an===""||_t==="")&&(rt=!1);rt&&(this.diagnostics={runnable:et,programLog:dt,vertexShader:{log:an,prefix:te},fragmentShader:{log:_t,prefix:j}})}p.deleteShader(Ne),p.deleteShader(de);let $e;this.getUniforms=function(){return $e===void 0&&($e=new Yl(p,ne)),$e};let Gt;return this.getAttributes=function(){return Gt===void 0&&(Gt=h(p,ne)),Gt},this.destroy=function(){u.releaseStatesOfProgram(this),p.deleteProgram(ne),this.program=void 0},this.name=n.shaderName,this.id=ew++,this.cacheKey=i,this.usedTimes=1,this.program=ne,this.vertexShader=Ne,this.fragmentShader=de,this}function Vn(r,i,n,u,p,g){const b=[],M=u.isWebGL2,A=u.logarithmicDepthBuffer,C=u.floatVertexTextures,F=u.maxVertexUniforms,O=u.vertexTextures;let k=u.precision;const N={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},X=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmissionMap"];function ne(de){const Gt=de.skeleton.bones;if(C)return 1024;{const an=Math.floor((F-20)/4),_t=Math.min(an,Gt.length);return _t<Gt.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+Gt.length+" bones. This GPU supports "+_t+"."),0):_t}}function te(de){let $e;return de?de.isTexture?$e=de.encoding:de.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),$e=de.texture.encoding):$e=Bl,$e}function j(de,$e,Gt,dt,an){const _t=dt.fog,et=de.isMeshStandardMaterial?dt.environment:null,rt=i.get(de.envMap||et),je=N[de.type],Ve=an.isSkinnedMesh?ne(an):0;de.precision!==null&&(k=u.getMaxPrecision(de.precision),k!==de.precision&&console.warn("THREE.WebGLProgram.getParameters:",de.precision,"not supported, using",k,"instead."));let ht,ft;if(je){const Vt=wl[je];ht=Vt.vertexShader,ft=Vt.fragmentShader}else ht=de.vertexShader,ft=de.fragmentShader;const Wt=r.getRenderTarget();return{isWebGL2:M,shaderID:je,shaderName:de.type,vertexShader:ht,fragmentShader:ft,defines:de.defines,isRawShaderMaterial:de.isRawShaderMaterial===!0,glslVersion:de.glslVersion,precision:k,instancing:an.isInstancedMesh===!0,instancingColor:an.isInstancedMesh===!0&&an.instanceColor!==null,supportsVertexTextures:O,outputEncoding:Wt!==null?te(Wt.texture):r.outputEncoding,map:!!de.map,mapEncoding:te(de.map),matcap:!!de.matcap,matcapEncoding:te(de.matcap),envMap:!!rt,envMapMode:rt&&rt.mapping,envMapEncoding:te(rt),envMapCubeUV:!!rt&&(rt.mapping===Er||rt.mapping===ci),lightMap:!!de.lightMap,lightMapEncoding:te(de.lightMap),aoMap:!!de.aoMap,emissiveMap:!!de.emissiveMap,emissiveMapEncoding:te(de.emissiveMap),bumpMap:!!de.bumpMap,normalMap:!!de.normalMap,objectSpaceNormalMap:de.normalMapType===km,tangentSpaceNormalMap:de.normalMapType===mu,clearcoatMap:!!de.clearcoatMap,clearcoatRoughnessMap:!!de.clearcoatRoughnessMap,clearcoatNormalMap:!!de.clearcoatNormalMap,displacementMap:!!de.displacementMap,roughnessMap:!!de.roughnessMap,metalnessMap:!!de.metalnessMap,specularMap:!!de.specularMap,alphaMap:!!de.alphaMap,gradientMap:!!de.gradientMap,sheen:!!de.sheen,transmissionMap:!!de.transmissionMap,combine:de.combine,vertexTangents:de.normalMap&&de.vertexTangents,vertexColors:de.vertexColors,vertexUvs:!!de.map||!!de.bumpMap||!!de.normalMap||!!de.specularMap||!!de.alphaMap||!!de.emissiveMap||!!de.roughnessMap||!!de.metalnessMap||!!de.clearcoatMap||!!de.clearcoatRoughnessMap||!!de.clearcoatNormalMap||!!de.displacementMap||!!de.transmissionMap,uvsVertexOnly:!(!!de.map||!!de.bumpMap||!!de.normalMap||!!de.specularMap||!!de.alphaMap||!!de.emissiveMap||!!de.roughnessMap||!!de.metalnessMap||!!de.clearcoatNormalMap||!!de.transmissionMap)&&!!de.displacementMap,fog:!!_t,useFog:de.fog,fogExp2:_t&&_t.isFogExp2,flatShading:de.flatShading,sizeAttenuation:de.sizeAttenuation,logarithmicDepthBuffer:A,skinning:de.skinning&&Ve>0,maxBones:Ve,useVertexTexture:C,morphTargets:de.morphTargets,morphNormals:de.morphNormals,maxMorphTargets:r.maxMorphTargets,maxMorphNormals:r.maxMorphNormals,numDirLights:$e.directional.length,numPointLights:$e.point.length,numSpotLights:$e.spot.length,numRectAreaLights:$e.rectArea.length,numHemiLights:$e.hemi.length,numDirLightShadows:$e.directionalShadowMap.length,numPointLightShadows:$e.pointShadowMap.length,numSpotLightShadows:$e.spotShadowMap.length,numClippingPlanes:g.numPlanes,numClipIntersection:g.numIntersection,dithering:de.dithering,shadowMapEnabled:r.shadowMap.enabled&&Gt.length>0,shadowMapType:r.shadowMap.type,toneMapping:de.toneMapped?r.toneMapping:Ai,physicallyCorrectLights:r.physicallyCorrectLights,premultipliedAlpha:de.premultipliedAlpha,alphaTest:de.alphaTest,doubleSided:de.side===Tn,flipSided:de.side===It,depthPacking:de.depthPacking!==void 0?de.depthPacking:!1,index0AttributeName:de.index0AttributeName,extensionDerivatives:de.extensions&&de.extensions.derivatives,extensionFragDepth:de.extensions&&de.extensions.fragDepth,extensionDrawBuffers:de.extensions&&de.extensions.drawBuffers,extensionShaderTextureLOD:de.extensions&&de.extensions.shaderTextureLOD,rendererExtensionFragDepth:M||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:M||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:M||n.has("EXT_shader_texture_lod"),customProgramCacheKey:de.customProgramCacheKey()}}function W(de){const $e=[];if(de.shaderID?$e.push(de.shaderID):($e.push(de.fragmentShader),$e.push(de.vertexShader)),de.defines!==void 0)for(const Gt in de.defines)$e.push(Gt),$e.push(de.defines[Gt]);if(de.isRawShaderMaterial===!1){for(let Gt=0;Gt<X.length;Gt++)$e.push(de[X[Gt]]);$e.push(r.outputEncoding),$e.push(r.gammaFactor)}return $e.push(de.customProgramCacheKey),$e.join()}function Pe(de){const $e=N[de.type];let Gt;if($e){const dt=wl[$e];Gt=p_.clone(dt.uniforms)}else Gt=de.uniforms;return Gt}function Re(de,$e){let Gt;for(let dt=0,an=b.length;dt<an;dt++){const _t=b[dt];if(_t.cacheKey===$e){Gt=_t,++Gt.usedTimes;break}}return Gt===void 0&&(Gt=new Lt(r,$e,de,p),b.push(Gt)),Gt}function Ne(de){if(--de.usedTimes===0){const $e=b.indexOf(de);b[$e]=b[b.length-1],b.pop(),de.destroy()}}return{getParameters:j,getProgramCacheKey:W,getUniforms:Pe,acquireProgram:Re,releaseProgram:Ne,programs:b}}function zn(){let r=new WeakMap;function i(g){let b=r.get(g);return b===void 0&&(b={},r.set(g,b)),b}function n(g){r.delete(g)}function u(g,b,M){r.get(g)[b]=M}function p(){r=new WeakMap}return{get:i,remove:n,update:u,dispose:p}}function yn(r,i){return r.groupOrder!==i.groupOrder?r.groupOrder-i.groupOrder:r.renderOrder!==i.renderOrder?r.renderOrder-i.renderOrder:r.program!==i.program?r.program.id-i.program.id:r.material.id!==i.material.id?r.material.id-i.material.id:r.z!==i.z?r.z-i.z:r.id-i.id}function Wn(r,i){return r.groupOrder!==i.groupOrder?r.groupOrder-i.groupOrder:r.renderOrder!==i.renderOrder?r.renderOrder-i.renderOrder:r.z!==i.z?i.z-r.z:r.id-i.id}function pi(r){const i=[];let n=0;const u=[],p=[],g={id:-1};function b(){n=0,u.length=0,p.length=0}function M(k,N,X,ne,te,j){let W=i[n];const Pe=r.get(X);return W===void 0?(W={id:k.id,object:k,geometry:N,material:X,program:Pe.program||g,groupOrder:ne,renderOrder:k.renderOrder,z:te,group:j},i[n]=W):(W.id=k.id,W.object=k,W.geometry=N,W.material=X,W.program=Pe.program||g,W.groupOrder=ne,W.renderOrder=k.renderOrder,W.z=te,W.group=j),n++,W}function A(k,N,X,ne,te,j){const W=M(k,N,X,ne,te,j);(X.transparent===!0?p:u).push(W)}function C(k,N,X,ne,te,j){const W=M(k,N,X,ne,te,j);(X.transparent===!0?p:u).unshift(W)}function F(k,N){u.length>1&&u.sort(k||yn),p.length>1&&p.sort(N||Wn)}function O(){for(let k=n,N=i.length;k<N;k++){const X=i[k];if(X.id===null)break;X.id=null,X.object=null,X.geometry=null,X.material=null,X.program=null,X.group=null}}return{opaque:u,transparent:p,init:b,push:A,unshift:C,finish:O,sort:F}}function wi(r){let i=new WeakMap;function n(p,g){const b=i.get(p);let M;return b===void 0?(M=new pi(r),i.set(p,new WeakMap),i.get(p).set(g,M)):(M=b.get(g),M===void 0&&(M=new pi(r),b.set(g,M))),M}function u(){i=new WeakMap}return{get:n,dispose:u}}function Vi(){const r={};return{get:function(i){if(r[i.id]!==void 0)return r[i.id];let n;switch(i.type){case"DirectionalLight":n={direction:new De,color:new Mi};break;case"SpotLight":n={position:new De,direction:new De,color:new Mi,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new De,color:new Mi,distance:0,decay:0};break;case"HemisphereLight":n={direction:new De,skyColor:new Mi,groundColor:new Mi};break;case"RectAreaLight":n={color:new Mi,position:new De,halfWidth:new De,halfHeight:new De};break}return r[i.id]=n,n}}}function Lr(){const r={};return{get:function(i){if(r[i.id]!==void 0)return r[i.id];let n;switch(i.type){case"DirectionalLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new vn};break;case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new vn};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new vn,shadowCameraNear:1,shadowCameraFar:1e3};break}return r[i.id]=n,n}}}let Br=0;function Rs(r,i){return(i.castShadow?1:0)-(r.castShadow?1:0)}function Gr(){const r=new Vi,i=Lr(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let M=0;M<9;M++)n.probe.push(new De);const u=new De,p=new yr,g=new yr;function b(M,A,C){let F=0,O=0,k=0;for(let $e=0;$e<9;$e++)n.probe[$e].set(0,0,0);let N=0,X=0,ne=0,te=0,j=0,W=0,Pe=0,Re=0;const Ne=C.matrixWorldInverse;M.sort(Rs);for(let $e=0,Gt=M.length;$e<Gt;$e++){const dt=M[$e],an=dt.color,_t=dt.intensity,et=dt.distance,rt=dt.shadow&&dt.shadow.map?dt.shadow.map.texture:null;if(dt.isAmbientLight)F+=an.r*_t,O+=an.g*_t,k+=an.b*_t;else if(dt.isLightProbe)for(let je=0;je<9;je++)n.probe[je].addScaledVector(dt.sh.coefficients[je],_t);else if(dt.isDirectionalLight){const je=r.get(dt);if(je.color.copy(dt.color).multiplyScalar(dt.intensity),je.direction.setFromMatrixPosition(dt.matrixWorld),u.setFromMatrixPosition(dt.target.matrixWorld),je.direction.sub(u),je.direction.transformDirection(Ne),dt.castShadow){const Ve=dt.shadow,ht=i.get(dt);ht.shadowBias=Ve.bias,ht.shadowNormalBias=Ve.normalBias,ht.shadowRadius=Ve.radius,ht.shadowMapSize=Ve.mapSize,n.directionalShadow[N]=ht,n.directionalShadowMap[N]=rt,n.directionalShadowMatrix[N]=dt.shadow.matrix,W++}n.directional[N]=je,N++}else if(dt.isSpotLight){const je=r.get(dt);if(je.position.setFromMatrixPosition(dt.matrixWorld),je.position.applyMatrix4(Ne),je.color.copy(an).multiplyScalar(_t),je.distance=et,je.direction.setFromMatrixPosition(dt.matrixWorld),u.setFromMatrixPosition(dt.target.matrixWorld),je.direction.sub(u),je.direction.transformDirection(Ne),je.coneCos=Math.cos(dt.angle),je.penumbraCos=Math.cos(dt.angle*(1-dt.penumbra)),je.decay=dt.decay,dt.castShadow){const Ve=dt.shadow,ht=i.get(dt);ht.shadowBias=Ve.bias,ht.shadowNormalBias=Ve.normalBias,ht.shadowRadius=Ve.radius,ht.shadowMapSize=Ve.mapSize,n.spotShadow[ne]=ht,n.spotShadowMap[ne]=rt,n.spotShadowMatrix[ne]=dt.shadow.matrix,Re++}n.spot[ne]=je,ne++}else if(dt.isRectAreaLight){const je=r.get(dt);je.color.copy(an).multiplyScalar(_t),je.position.setFromMatrixPosition(dt.matrixWorld),je.position.applyMatrix4(Ne),g.identity(),p.copy(dt.matrixWorld),p.premultiply(Ne),g.extractRotation(p),je.halfWidth.set(dt.width*.5,0,0),je.halfHeight.set(0,dt.height*.5,0),je.halfWidth.applyMatrix4(g),je.halfHeight.applyMatrix4(g),n.rectArea[te]=je,te++}else if(dt.isPointLight){const je=r.get(dt);if(je.position.setFromMatrixPosition(dt.matrixWorld),je.position.applyMatrix4(Ne),je.color.copy(dt.color).multiplyScalar(dt.intensity),je.distance=dt.distance,je.decay=dt.decay,dt.castShadow){const Ve=dt.shadow,ht=i.get(dt);ht.shadowBias=Ve.bias,ht.shadowNormalBias=Ve.normalBias,ht.shadowRadius=Ve.radius,ht.shadowMapSize=Ve.mapSize,ht.shadowCameraNear=Ve.camera.near,ht.shadowCameraFar=Ve.camera.far,n.pointShadow[X]=ht,n.pointShadowMap[X]=rt,n.pointShadowMatrix[X]=dt.shadow.matrix,Pe++}n.point[X]=je,X++}else if(dt.isHemisphereLight){const je=r.get(dt);je.direction.setFromMatrixPosition(dt.matrixWorld),je.direction.transformDirection(Ne),je.direction.normalize(),je.skyColor.copy(dt.color).multiplyScalar(_t),je.groundColor.copy(dt.groundColor).multiplyScalar(_t),n.hemi[j]=je,j++}}te>0&&(n.rectAreaLTC1=ui.LTC_1,n.rectAreaLTC2=ui.LTC_2),n.ambient[0]=F,n.ambient[1]=O,n.ambient[2]=k;const de=n.hash;(de.directionalLength!==N||de.pointLength!==X||de.spotLength!==ne||de.rectAreaLength!==te||de.hemiLength!==j||de.numDirectionalShadows!==W||de.numPointShadows!==Pe||de.numSpotShadows!==Re)&&(n.directional.length=N,n.spot.length=ne,n.rectArea.length=te,n.point.length=X,n.hemi.length=j,n.directionalShadow.length=W,n.directionalShadowMap.length=W,n.pointShadow.length=Pe,n.pointShadowMap.length=Pe,n.spotShadow.length=Re,n.spotShadowMap.length=Re,n.directionalShadowMatrix.length=W,n.pointShadowMatrix.length=Pe,n.spotShadowMatrix.length=Re,de.directionalLength=N,de.pointLength=X,de.spotLength=ne,de.rectAreaLength=te,de.hemiLength=j,de.numDirectionalShadows=W,de.numPointShadows=Pe,de.numSpotShadows=Re,n.version=Br++)}return{setup:b,state:n}}function pa(){const r=new Gr,i=[],n=[];function u(){i.length=0,n.length=0}function p(A){i.push(A)}function g(A){n.push(A)}function b(A){r.setup(i,n,A)}return{init:u,state:{lightsArray:i,shadowsArray:n,lights:r},setupLights:b,pushLight:p,pushShadow:g}}function Xa(){let r=new WeakMap;function i(u,p){let g;return r.has(u)===!1?(g=new pa,r.set(u,new WeakMap),r.get(u).set(p,g)):r.get(u).has(p)===!1?(g=new pa,r.get(u).set(p,g)):g=r.get(u).get(p),g}function n(){r=new WeakMap}return{get:i,dispose:n}}function hr(r){Yi.call(this),this.type="MeshDepthMaterial",this.depthPacking=pu,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(r)}hr.prototype=Object.create(Yi.prototype),hr.prototype.constructor=hr,hr.prototype.isMeshDepthMaterial=!0,hr.prototype.copy=function(r){return Yi.prototype.copy.call(this,r),this.depthPacking=r.depthPacking,this.skinning=r.skinning,this.morphTargets=r.morphTargets,this.map=r.map,this.alphaMap=r.alphaMap,this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this};function Yr(r){Yi.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new De,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(r)}Yr.prototype=Object.create(Yi.prototype),Yr.prototype.constructor=Yr,Yr.prototype.isMeshDistanceMaterial=!0,Yr.prototype.copy=function(r){return Yi.prototype.copy.call(this,r),this.referencePosition.copy(r.referencePosition),this.nearDistance=r.nearDistance,this.farDistance=r.farDistance,this.skinning=r.skinning,this.morphTargets=r.morphTargets,this.map=r.map,this.alphaMap=r.alphaMap,this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this};var Zf=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	float mean = 0.0;
	float squared_mean = 0.0;
	float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );
	for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {
		#ifdef HORIZONAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, i ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean * HALF_SAMPLE_RATE;
	squared_mean = squared_mean * HALF_SAMPLE_RATE;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`,Pu=`void main() {
	gl_Position = vec4( position, 1.0 );
}`;function Dh(r,i,n){let u=new sp;const p=new vn,g=new vn,b=new vs,M=[],A=[],C={},F={0:It,1:St,2:Tn},O=new Fa({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new vn},radius:{value:4}},vertexShader:Pu,fragmentShader:Zf}),k=O.clone();k.defines.HORIZONAL_PASS=1;const N=new hs;N.setAttribute("position",new sr(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const X=new Ca(N,O),ne=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=wt,this.render=function(Ne,de,$e){if(ne.enabled===!1||ne.autoUpdate===!1&&ne.needsUpdate===!1||Ne.length===0)return;const Gt=r.getRenderTarget(),dt=r.getActiveCubeFace(),an=r.getActiveMipmapLevel(),_t=r.state;_t.setBlending(cn),_t.buffers.color.setClear(1,1,1,1),_t.buffers.depth.setTest(!0),_t.setScissorTest(!1);for(let et=0,rt=Ne.length;et<rt;et++){const je=Ne[et],Ve=je.shadow;if(Ve===void 0){console.warn("THREE.WebGLShadowMap:",je,"has no shadow.");continue}if(Ve.autoUpdate===!1&&Ve.needsUpdate===!1)continue;p.copy(Ve.mapSize);const ht=Ve.getFrameExtents();if(p.multiply(ht),g.copy(Ve.mapSize),(p.x>n||p.y>n)&&(p.x>n&&(g.x=Math.floor(n/ht.x),p.x=g.x*ht.x,Ve.mapSize.x=g.x),p.y>n&&(g.y=Math.floor(n/ht.y),p.y=g.y*ht.y,Ve.mapSize.y=g.y)),Ve.map===null&&!Ve.isPointLightShadow&&this.type===mt){const Wt={minFilter:ti,magFilter:ti,format:vr};Ve.map=new qo(p.x,p.y,Wt),Ve.map.texture.name=je.name+".shadowMap",Ve.mapPass=new qo(p.x,p.y,Wt),Ve.camera.updateProjectionMatrix()}if(Ve.map===null){const Wt={minFilter:Kr,magFilter:Kr,format:vr};Ve.map=new qo(p.x,p.y,Wt),Ve.map.texture.name=je.name+".shadowMap",Ve.camera.updateProjectionMatrix()}r.setRenderTarget(Ve.map),r.clear();const ft=Ve.getViewportCount();for(let Wt=0;Wt<ft;Wt++){const An=Ve.getViewport(Wt);b.set(g.x*An.x,g.y*An.y,g.x*An.z,g.y*An.w),_t.viewport(b),Ve.updateMatrices(je,Wt),u=Ve.getFrustum(),Re(de,$e,Ve.camera,je,this.type)}!Ve.isPointLightShadow&&this.type===mt&&te(Ve,$e),Ve.needsUpdate=!1}ne.needsUpdate=!1,r.setRenderTarget(Gt,dt,an)};function te(Ne,de){const $e=i.update(X);O.uniforms.shadow_pass.value=Ne.map.texture,O.uniforms.resolution.value=Ne.mapSize,O.uniforms.radius.value=Ne.radius,r.setRenderTarget(Ne.mapPass),r.clear(),r.renderBufferDirect(de,null,$e,O,X,null),k.uniforms.shadow_pass.value=Ne.mapPass.texture,k.uniforms.resolution.value=Ne.mapSize,k.uniforms.radius.value=Ne.radius,r.setRenderTarget(Ne.map),r.clear(),r.renderBufferDirect(de,null,$e,k,X,null)}function j(Ne,de,$e){const Gt=Ne<<0|de<<1|$e<<2;let dt=M[Gt];return dt===void 0&&(dt=new hr({depthPacking:o_,morphTargets:Ne,skinning:de}),M[Gt]=dt),dt}function W(Ne,de,$e){const Gt=Ne<<0|de<<1|$e<<2;let dt=A[Gt];return dt===void 0&&(dt=new Yr({morphTargets:Ne,skinning:de}),A[Gt]=dt),dt}function Pe(Ne,de,$e,Gt,dt,an,_t){let et=null,rt=j,je=Ne.customDepthMaterial;if(Gt.isPointLight===!0&&(rt=W,je=Ne.customDistanceMaterial),je===void 0){let Ve=!1;$e.morphTargets===!0&&(Ve=de.morphAttributes&&de.morphAttributes.position&&de.morphAttributes.position.length>0);let ht=!1;Ne.isSkinnedMesh===!0&&($e.skinning===!0?ht=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",Ne));const ft=Ne.isInstancedMesh===!0;et=rt(Ve,ht,ft)}else et=je;if(r.localClippingEnabled&&$e.clipShadows===!0&&$e.clippingPlanes.length!==0){const Ve=et.uuid,ht=$e.uuid;let ft=C[Ve];ft===void 0&&(ft={},C[Ve]=ft);let Wt=ft[ht];Wt===void 0&&(Wt=et.clone(),ft[ht]=Wt),et=Wt}return et.visible=$e.visible,et.wireframe=$e.wireframe,_t===mt?et.side=$e.shadowSide!==null?$e.shadowSide:$e.side:et.side=$e.shadowSide!==null?$e.shadowSide:F[$e.side],et.clipShadows=$e.clipShadows,et.clippingPlanes=$e.clippingPlanes,et.clipIntersection=$e.clipIntersection,et.wireframeLinewidth=$e.wireframeLinewidth,et.linewidth=$e.linewidth,Gt.isPointLight===!0&&et.isMeshDistanceMaterial===!0&&(et.referencePosition.setFromMatrixPosition(Gt.matrixWorld),et.nearDistance=dt,et.farDistance=an),et}function Re(Ne,de,$e,Gt,dt){if(Ne.visible===!1)return;if(Ne.layers.test(de.layers)&&(Ne.isMesh||Ne.isLine||Ne.isPoints)&&(Ne.castShadow||Ne.receiveShadow&&dt===mt)&&(!Ne.frustumCulled||u.intersectsObject(Ne))){Ne.modelViewMatrix.multiplyMatrices($e.matrixWorldInverse,Ne.matrixWorld);const et=i.update(Ne),rt=Ne.material;if(Array.isArray(rt)){const je=et.groups;for(let Ve=0,ht=je.length;Ve<ht;Ve++){const ft=je[Ve],Wt=rt[ft.materialIndex];if(Wt&&Wt.visible){const An=Pe(Ne,et,Wt,Gt,$e.near,$e.far,dt);r.renderBufferDirect($e,null,et,An,Ne,ft)}}}else if(rt.visible){const je=Pe(Ne,et,rt,Gt,$e.near,$e.far,dt);r.renderBufferDirect($e,null,et,je,Ne,null)}}const _t=Ne.children;for(let et=0,rt=_t.length;et<rt;et++)Re(_t[et],de,$e,Gt,dt)}}function Mp(r,i,n){const u=n.isWebGL2;function p(){let Ce=!1;const Pt=new vs;let Kt=null;const qn=new vs(0,0,0,0);return{setMask:function(xn){Kt!==xn&&!Ce&&(r.colorMask(xn,xn,xn,xn),Kt=xn)},setLocked:function(xn){Ce=xn},setClear:function(xn,Oe,Ht,Kn,hn){hn===!0&&(xn*=Kn,Oe*=Kn,Ht*=Kn),Pt.set(xn,Oe,Ht,Kn),qn.equals(Pt)===!1&&(r.clearColor(xn,Oe,Ht,Kn),qn.copy(Pt))},reset:function(){Ce=!1,Kt=null,qn.set(-1,0,0,0)}}}function g(){let Ce=!1,Pt=null,Kt=null,qn=null;return{setTest:function(xn){xn?Vt(2929):Dn(2929)},setMask:function(xn){Pt!==xn&&!Ce&&(r.depthMask(xn),Pt=xn)},setFunc:function(xn){if(Kt!==xn){if(xn)switch(xn){case Qi:r.depthFunc(512);break;case Bi:r.depthFunc(519);break;case ni:r.depthFunc(513);break;case li:r.depthFunc(515);break;case at:r.depthFunc(514);break;case Ge:r.depthFunc(518);break;case ct:r.depthFunc(516);break;case Cn:r.depthFunc(517);break;default:r.depthFunc(515)}else r.depthFunc(515);Kt=xn}},setLocked:function(xn){Ce=xn},setClear:function(xn){qn!==xn&&(r.clearDepth(xn),qn=xn)},reset:function(){Ce=!1,Pt=null,Kt=null,qn=null}}}function b(){let Ce=!1,Pt=null,Kt=null,qn=null,xn=null,Oe=null,Ht=null,Kn=null,hn=null;return{setTest:function(jn){Ce||(jn?Vt(2960):Dn(2960))},setMask:function(jn){Pt!==jn&&!Ce&&(r.stencilMask(jn),Pt=jn)},setFunc:function(jn,er,ts){(Kt!==jn||qn!==er||xn!==ts)&&(r.stencilFunc(jn,er,ts),Kt=jn,qn=er,xn=ts)},setOp:function(jn,er,ts){(Oe!==jn||Ht!==er||Kn!==ts)&&(r.stencilOp(jn,er,ts),Oe=jn,Ht=er,Kn=ts)},setLocked:function(jn){Ce=jn},setClear:function(jn){hn!==jn&&(r.clearStencil(jn),hn=jn)},reset:function(){Ce=!1,Pt=null,Kt=null,qn=null,xn=null,Oe=null,Ht=null,Kn=null,hn=null}}}const M=new p,A=new g,C=new b;let F={},O=null,k=null,N=null,X=null,ne=null,te=null,j=null,W=null,Pe=null,Re=!1,Ne=null,de=null,$e=null,Gt=null,dt=null;const an=r.getParameter(35661);let _t=!1,et=0;const rt=r.getParameter(7938);rt.indexOf("WebGL")!==-1?(et=parseFloat(/^WebGL\ ([0-9])/.exec(rt)[1]),_t=et>=1):rt.indexOf("OpenGL ES")!==-1&&(et=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(rt)[1]),_t=et>=2);let je=null,Ve={};const ht=new vs,ft=new vs;function Wt(Ce,Pt,Kt){const qn=new Uint8Array(4),xn=r.createTexture();r.bindTexture(Ce,xn),r.texParameteri(Ce,10241,9728),r.texParameteri(Ce,10240,9728);for(let Oe=0;Oe<Kt;Oe++)r.texImage2D(Pt+Oe,0,6408,1,1,0,6408,5121,qn);return xn}const An={};An[3553]=Wt(3553,3553,1),An[34067]=Wt(34067,34069,6),M.setClear(0,0,0,1),A.setClear(1),C.setClear(0),Vt(2929),A.setFunc(li),me(!1),Le(Xe),Vt(2884),K(cn);function Vt(Ce){F[Ce]!==!0&&(r.enable(Ce),F[Ce]=!0)}function Dn(Ce){F[Ce]!==!1&&(r.disable(Ce),F[Ce]=!1)}function Ci(Ce){return O!==Ce?(r.useProgram(Ce),O=Ce,!0):!1}const vi={[Xn]:32774,[zt]:32778,[Ln]:32779};if(u)vi[Nn]=32775,vi[Tt]=32776;else{const Ce=i.get("EXT_blend_minmax");Ce!==null&&(vi[Nn]=Ce.MIN_EXT,vi[Tt]=Ce.MAX_EXT)}const he={[_n]:0,[Ut]:1,[ce]:768,[$t]:770,[Rr]:776,[ir]:774,[Gn]:772,[At]:769,[wn]:771,[Oi]:775,[yi]:773};function K(Ce,Pt,Kt,qn,xn,Oe,Ht,Kn){if(Ce===cn){k&&(Dn(3042),k=!1);return}if(k||(Vt(3042),k=!0),Ce!==Gi){if(Ce!==N||Kn!==Re){if((X!==Xn||j!==Xn)&&(r.blendEquation(32774),X=Xn,j=Xn),Kn)switch(Ce){case nn:r.blendFuncSeparate(1,771,1,771);break;case di:r.blendFunc(1,1);break;case Ri:r.blendFuncSeparate(0,0,769,771);break;case Ti:r.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",Ce);break}else switch(Ce){case nn:r.blendFuncSeparate(770,771,1,771);break;case di:r.blendFunc(770,1);break;case Ri:r.blendFunc(0,769);break;case Ti:r.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",Ce);break}ne=null,te=null,W=null,Pe=null,N=Ce,Re=Kn}return}xn=xn||Pt,Oe=Oe||Kt,Ht=Ht||qn,(Pt!==X||xn!==j)&&(r.blendEquationSeparate(vi[Pt],vi[xn]),X=Pt,j=xn),(Kt!==ne||qn!==te||Oe!==W||Ht!==Pe)&&(r.blendFuncSeparate(he[Kt],he[qn],he[Oe],he[Ht]),ne=Kt,te=qn,W=Oe,Pe=Ht),N=Ce,Re=null}function Fe(Ce,Pt){Ce.side===Tn?Dn(2884):Vt(2884);let Kt=Ce.side===It;Pt&&(Kt=!Kt),me(Kt),Ce.blending===nn&&Ce.transparent===!1?K(cn):K(Ce.blending,Ce.blendEquation,Ce.blendSrc,Ce.blendDst,Ce.blendEquationAlpha,Ce.blendSrcAlpha,Ce.blendDstAlpha,Ce.premultipliedAlpha),A.setFunc(Ce.depthFunc),A.setTest(Ce.depthTest),A.setMask(Ce.depthWrite),M.setMask(Ce.colorWrite);const qn=Ce.stencilWrite;C.setTest(qn),qn&&(C.setMask(Ce.stencilWriteMask),C.setFunc(Ce.stencilFunc,Ce.stencilRef,Ce.stencilFuncMask),C.setOp(Ce.stencilFail,Ce.stencilZFail,Ce.stencilZPass)),Ye(Ce.polygonOffset,Ce.polygonOffsetFactor,Ce.polygonOffsetUnits)}function me(Ce){Ne!==Ce&&(Ce?r.frontFace(2304):r.frontFace(2305),Ne=Ce)}function Le(Ce){Ce!==Ee?(Vt(2884),Ce!==de&&(Ce===Xe?r.cullFace(1029):Ce===pt?r.cullFace(1028):r.cullFace(1032))):Dn(2884),de=Ce}function Be(Ce){Ce!==$e&&(_t&&r.lineWidth(Ce),$e=Ce)}function Ye(Ce,Pt,Kt){Ce?(Vt(32823),(Gt!==Pt||dt!==Kt)&&(r.polygonOffset(Pt,Kt),Gt=Pt,dt=Kt)):Dn(32823)}function ke(Ce){Ce?Vt(3089):Dn(3089)}function He(Ce){Ce===void 0&&(Ce=33984+an-1),je!==Ce&&(r.activeTexture(Ce),je=Ce)}function Je(Ce,Pt){je===null&&He();let Kt=Ve[je];Kt===void 0&&(Kt={type:void 0,texture:void 0},Ve[je]=Kt),(Kt.type!==Ce||Kt.texture!==Pt)&&(r.bindTexture(Ce,Pt||An[Ce]),Kt.type=Ce,Kt.texture=Pt)}function ot(){const Ce=Ve[je];Ce!==void 0&&Ce.type!==void 0&&(r.bindTexture(Ce.type,null),Ce.type=void 0,Ce.texture=void 0)}function bt(){try{r.compressedTexImage2D.apply(r,arguments)}catch(Ce){console.error("THREE.WebGLState:",Ce)}}function Mt(){try{r.texImage2D.apply(r,arguments)}catch(Ce){console.error("THREE.WebGLState:",Ce)}}function ue(){try{r.texImage3D.apply(r,arguments)}catch(Ce){console.error("THREE.WebGLState:",Ce)}}function oe(Ce){ht.equals(Ce)===!1&&(r.scissor(Ce.x,Ce.y,Ce.z,Ce.w),ht.copy(Ce))}function lt(Ce){ft.equals(Ce)===!1&&(r.viewport(Ce.x,Ce.y,Ce.z,Ce.w),ft.copy(Ce))}function yt(){F={},je=null,Ve={},O=null,N=null,Ne=null,de=null,M.reset(),A.reset(),C.reset()}return{buffers:{color:M,depth:A,stencil:C},enable:Vt,disable:Dn,useProgram:Ci,setBlending:K,setMaterial:Fe,setFlipSided:me,setCullFace:Le,setLineWidth:Be,setPolygonOffset:Ye,setScissorTest:ke,activeTexture:He,bindTexture:Je,unbindTexture:ot,compressedTexImage2D:bt,texImage2D:Mt,texImage3D:ue,scissor:oe,viewport:lt,reset:yt}}function Oh(r,i,n,u,p,g,b){const M=p.isWebGL2,A=p.maxTextures,C=p.maxCubemapSize,F=p.maxTextureSize,O=p.maxSamples,k=new WeakMap;let N,X=!1;try{X=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function ne(ue,oe){return X?new OffscreenCanvas(ue,oe):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function te(ue,oe,lt,yt){let Ce=1;if((ue.width>yt||ue.height>yt)&&(Ce=yt/Math.max(ue.width,ue.height)),Ce<1||oe===!0)if(typeof HTMLImageElement<"u"&&ue instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&ue instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&ue instanceof ImageBitmap){const Pt=oe?fr.floorPowerOfTwo:Math.floor,Kt=Pt(Ce*ue.width),qn=Pt(Ce*ue.height);N===void 0&&(N=ne(Kt,qn));const xn=lt?ne(Kt,qn):N;return xn.width=Kt,xn.height=qn,xn.getContext("2d").drawImage(ue,0,0,Kt,qn),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+ue.width+"x"+ue.height+") to ("+Kt+"x"+qn+")."),xn}else return"data"in ue&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+ue.width+"x"+ue.height+")."),ue;return ue}function j(ue){return fr.isPowerOfTwo(ue.width)&&fr.isPowerOfTwo(ue.height)}function W(ue){return M?!1:ue.wrapS!==$r||ue.wrapT!==$r||ue.minFilter!==Kr&&ue.minFilter!==ti}function Pe(ue,oe){return ue.generateMipmaps&&oe&&ue.minFilter!==Kr&&ue.minFilter!==ti}function Re(ue,oe,lt,yt){r.generateMipmap(ue);const Ce=u.get(oe);Ce.__maxMipLevel=Math.log(Math.max(lt,yt))*Math.LOG2E}function Ne(ue,oe,lt){if(M===!1)return oe;if(ue!==null){if(r[ue]!==void 0)return r[ue];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+ue+"'")}let yt=oe;return oe===6403&&(lt===5126&&(yt=33326),lt===5131&&(yt=33325),lt===5121&&(yt=33321)),oe===6407&&(lt===5126&&(yt=34837),lt===5131&&(yt=34843),lt===5121&&(yt=32849)),oe===6408&&(lt===5126&&(yt=34836),lt===5131&&(yt=34842),lt===5121&&(yt=32856)),(yt===33325||yt===33326||yt===34842||yt===34836)&&i.get("EXT_color_buffer_float"),yt}function de(ue){return ue===Kr||ue===Na||ue===tn?9728:9729}function $e(ue){const oe=ue.target;oe.removeEventListener("dispose",$e),dt(oe),oe.isVideoTexture&&k.delete(oe),b.memory.textures--}function Gt(ue){const oe=ue.target;oe.removeEventListener("dispose",Gt),an(oe),b.memory.textures--}function dt(ue){const oe=u.get(ue);oe.__webglInit!==void 0&&(r.deleteTexture(oe.__webglTexture),u.remove(ue))}function an(ue){const oe=u.get(ue),lt=u.get(ue.texture);if(!!ue){if(lt.__webglTexture!==void 0&&r.deleteTexture(lt.__webglTexture),ue.depthTexture&&ue.depthTexture.dispose(),ue.isWebGLCubeRenderTarget)for(let yt=0;yt<6;yt++)r.deleteFramebuffer(oe.__webglFramebuffer[yt]),oe.__webglDepthbuffer&&r.deleteRenderbuffer(oe.__webglDepthbuffer[yt]);else r.deleteFramebuffer(oe.__webglFramebuffer),oe.__webglDepthbuffer&&r.deleteRenderbuffer(oe.__webglDepthbuffer),oe.__webglMultisampledFramebuffer&&r.deleteFramebuffer(oe.__webglMultisampledFramebuffer),oe.__webglColorRenderbuffer&&r.deleteRenderbuffer(oe.__webglColorRenderbuffer),oe.__webglDepthRenderbuffer&&r.deleteRenderbuffer(oe.__webglDepthRenderbuffer);u.remove(ue.texture),u.remove(ue)}}let _t=0;function et(){_t=0}function rt(){const ue=_t;return ue>=A&&console.warn("THREE.WebGLTextures: Trying to use "+ue+" texture units while this GPU supports only "+A),_t+=1,ue}function je(ue,oe){const lt=u.get(ue);if(ue.isVideoTexture&&He(ue),ue.version>0&&lt.__version!==ue.version){const yt=ue.image;if(yt===void 0)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else if(yt.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Ci(lt,ue,oe);return}}n.activeTexture(33984+oe),n.bindTexture(3553,lt.__webglTexture)}function Ve(ue,oe){const lt=u.get(ue);if(ue.version>0&&lt.__version!==ue.version){Ci(lt,ue,oe);return}n.activeTexture(33984+oe),n.bindTexture(35866,lt.__webglTexture)}function ht(ue,oe){const lt=u.get(ue);if(ue.version>0&&lt.__version!==ue.version){Ci(lt,ue,oe);return}n.activeTexture(33984+oe),n.bindTexture(32879,lt.__webglTexture)}function ft(ue,oe){const lt=u.get(ue);if(ue.version>0&&lt.__version!==ue.version){vi(lt,ue,oe);return}n.activeTexture(33984+oe),n.bindTexture(34067,lt.__webglTexture)}const Wt={[cr]:10497,[$r]:33071,[Lo]:33648},An={[Kr]:9728,[Na]:9984,[tn]:9986,[ti]:9729,[$n]:9985,[es]:9987};function Vt(ue,oe,lt){lt?(r.texParameteri(ue,10242,Wt[oe.wrapS]),r.texParameteri(ue,10243,Wt[oe.wrapT]),(ue===32879||ue===35866)&&r.texParameteri(ue,32882,Wt[oe.wrapR]),r.texParameteri(ue,10240,An[oe.magFilter]),r.texParameteri(ue,10241,An[oe.minFilter])):(r.texParameteri(ue,10242,33071),r.texParameteri(ue,10243,33071),(ue===32879||ue===35866)&&r.texParameteri(ue,32882,33071),(oe.wrapS!==$r||oe.wrapT!==$r)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),r.texParameteri(ue,10240,de(oe.magFilter)),r.texParameteri(ue,10241,de(oe.minFilter)),oe.minFilter!==Kr&&oe.minFilter!==ti&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));const yt=i.get("EXT_texture_filter_anisotropic");if(yt){if(oe.type===Tr&&i.get("OES_texture_float_linear")===null||oe.type===ur&&(M||i.get("OES_texture_half_float_linear"))===null)return;(oe.anisotropy>1||u.get(oe).__currentAnisotropy)&&(r.texParameterf(ue,yt.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(oe.anisotropy,p.getMaxAnisotropy())),u.get(oe).__currentAnisotropy=oe.anisotropy)}}function Dn(ue,oe){ue.__webglInit===void 0&&(ue.__webglInit=!0,oe.addEventListener("dispose",$e),ue.__webglTexture=r.createTexture(),b.memory.textures++)}function Ci(ue,oe,lt){let yt=3553;oe.isDataTexture2DArray&&(yt=35866),oe.isDataTexture3D&&(yt=32879),Dn(ue,oe),n.activeTexture(33984+lt),n.bindTexture(yt,ue.__webglTexture),r.pixelStorei(37440,oe.flipY),r.pixelStorei(37441,oe.premultiplyAlpha),r.pixelStorei(3317,oe.unpackAlignment);const Ce=W(oe)&&j(oe.image)===!1,Pt=te(oe.image,Ce,!1,F),Kt=j(Pt)||M,qn=g.convert(oe.format);let xn=g.convert(oe.type),Oe=Ne(oe.internalFormat,qn,xn);Vt(yt,oe,Kt);let Ht;const Kn=oe.mipmaps;if(oe.isDepthTexture)Oe=6402,M?oe.type===Tr?Oe=36012:oe.type===Dr?Oe=33190:oe.type===ah?Oe=35056:Oe=33189:oe.type===Tr&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),oe.format===hu&&Oe===6402&&oe.type!==ha&&oe.type!==Dr&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),oe.type=ha,xn=g.convert(oe.type)),oe.format===dl&&Oe===6402&&(Oe=34041,oe.type!==ah&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),oe.type=ah,xn=g.convert(oe.type))),n.texImage2D(3553,0,Oe,Pt.width,Pt.height,0,qn,xn,null);else if(oe.isDataTexture)if(Kn.length>0&&Kt){for(let hn=0,jn=Kn.length;hn<jn;hn++)Ht=Kn[hn],n.texImage2D(3553,hn,Oe,Ht.width,Ht.height,0,qn,xn,Ht.data);oe.generateMipmaps=!1,ue.__maxMipLevel=Kn.length-1}else n.texImage2D(3553,0,Oe,Pt.width,Pt.height,0,qn,xn,Pt.data),ue.__maxMipLevel=0;else if(oe.isCompressedTexture){for(let hn=0,jn=Kn.length;hn<jn;hn++)Ht=Kn[hn],oe.format!==vr&&oe.format!==Or?qn!==null?n.compressedTexImage2D(3553,hn,Oe,Ht.width,Ht.height,0,Ht.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(3553,hn,Oe,Ht.width,Ht.height,0,qn,xn,Ht.data);ue.__maxMipLevel=Kn.length-1}else if(oe.isDataTexture2DArray)n.texImage3D(35866,0,Oe,Pt.width,Pt.height,Pt.depth,0,qn,xn,Pt.data),ue.__maxMipLevel=0;else if(oe.isDataTexture3D)n.texImage3D(32879,0,Oe,Pt.width,Pt.height,Pt.depth,0,qn,xn,Pt.data),ue.__maxMipLevel=0;else if(Kn.length>0&&Kt){for(let hn=0,jn=Kn.length;hn<jn;hn++)Ht=Kn[hn],n.texImage2D(3553,hn,Oe,qn,xn,Ht);oe.generateMipmaps=!1,ue.__maxMipLevel=Kn.length-1}else n.texImage2D(3553,0,Oe,qn,xn,Pt),ue.__maxMipLevel=0;Pe(oe,Kt)&&Re(yt,oe,Pt.width,Pt.height),ue.__version=oe.version,oe.onUpdate&&oe.onUpdate(oe)}function vi(ue,oe,lt){if(oe.image.length!==6)return;Dn(ue,oe),n.activeTexture(33984+lt),n.bindTexture(34067,ue.__webglTexture),r.pixelStorei(37440,oe.flipY);const yt=oe&&(oe.isCompressedTexture||oe.image[0].isCompressedTexture),Ce=oe.image[0]&&oe.image[0].isDataTexture,Pt=[];for(let hn=0;hn<6;hn++)!yt&&!Ce?Pt[hn]=te(oe.image[hn],!1,!0,C):Pt[hn]=Ce?oe.image[hn].image:oe.image[hn];const Kt=Pt[0],qn=j(Kt)||M,xn=g.convert(oe.format),Oe=g.convert(oe.type),Ht=Ne(oe.internalFormat,xn,Oe);Vt(34067,oe,qn);let Kn;if(yt){for(let hn=0;hn<6;hn++){Kn=Pt[hn].mipmaps;for(let jn=0;jn<Kn.length;jn++){const er=Kn[jn];oe.format!==vr&&oe.format!==Or?xn!==null?n.compressedTexImage2D(34069+hn,jn,Ht,er.width,er.height,0,er.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(34069+hn,jn,Ht,er.width,er.height,0,xn,Oe,er.data)}}ue.__maxMipLevel=Kn.length-1}else{Kn=oe.mipmaps;for(let hn=0;hn<6;hn++)if(Ce){n.texImage2D(34069+hn,0,Ht,Pt[hn].width,Pt[hn].height,0,xn,Oe,Pt[hn].data);for(let jn=0;jn<Kn.length;jn++){const ts=Kn[jn].image[hn].image;n.texImage2D(34069+hn,jn+1,Ht,ts.width,ts.height,0,xn,Oe,ts.data)}}else{n.texImage2D(34069+hn,0,Ht,xn,Oe,Pt[hn]);for(let jn=0;jn<Kn.length;jn++){const er=Kn[jn];n.texImage2D(34069+hn,jn+1,Ht,xn,Oe,er.image[hn])}}ue.__maxMipLevel=Kn.length}Pe(oe,qn)&&Re(34067,oe,Kt.width,Kt.height),ue.__version=oe.version,oe.onUpdate&&oe.onUpdate(oe)}function he(ue,oe,lt,yt){const Ce=g.convert(oe.texture.format),Pt=g.convert(oe.texture.type),Kt=Ne(oe.texture.internalFormat,Ce,Pt);n.texImage2D(yt,0,Kt,oe.width,oe.height,0,Ce,Pt,null),r.bindFramebuffer(36160,ue),r.framebufferTexture2D(36160,lt,yt,u.get(oe.texture).__webglTexture,0),r.bindFramebuffer(36160,null)}function K(ue,oe,lt){if(r.bindRenderbuffer(36161,ue),oe.depthBuffer&&!oe.stencilBuffer){let yt=33189;if(lt){const Ce=oe.depthTexture;Ce&&Ce.isDepthTexture&&(Ce.type===Tr?yt=36012:Ce.type===Dr&&(yt=33190));const Pt=ke(oe);r.renderbufferStorageMultisample(36161,Pt,yt,oe.width,oe.height)}else r.renderbufferStorage(36161,yt,oe.width,oe.height);r.framebufferRenderbuffer(36160,36096,36161,ue)}else if(oe.depthBuffer&&oe.stencilBuffer){if(lt){const yt=ke(oe);r.renderbufferStorageMultisample(36161,yt,35056,oe.width,oe.height)}else r.renderbufferStorage(36161,34041,oe.width,oe.height);r.framebufferRenderbuffer(36160,33306,36161,ue)}else{const yt=g.convert(oe.texture.format),Ce=g.convert(oe.texture.type),Pt=Ne(oe.texture.internalFormat,yt,Ce);if(lt){const Kt=ke(oe);r.renderbufferStorageMultisample(36161,Kt,Pt,oe.width,oe.height)}else r.renderbufferStorage(36161,Pt,oe.width,oe.height)}r.bindRenderbuffer(36161,null)}function Fe(ue,oe){if(oe&&oe.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(r.bindFramebuffer(36160,ue),!(oe.depthTexture&&oe.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!u.get(oe.depthTexture).__webglTexture||oe.depthTexture.image.width!==oe.width||oe.depthTexture.image.height!==oe.height)&&(oe.depthTexture.image.width=oe.width,oe.depthTexture.image.height=oe.height,oe.depthTexture.needsUpdate=!0),je(oe.depthTexture,0);const yt=u.get(oe.depthTexture).__webglTexture;if(oe.depthTexture.format===hu)r.framebufferTexture2D(36160,36096,3553,yt,0);else if(oe.depthTexture.format===dl)r.framebufferTexture2D(36160,33306,3553,yt,0);else throw new Error("Unknown depthTexture format")}function me(ue){const oe=u.get(ue),lt=ue.isWebGLCubeRenderTarget===!0;if(ue.depthTexture){if(lt)throw new Error("target.depthTexture not supported in Cube render targets");Fe(oe.__webglFramebuffer,ue)}else if(lt){oe.__webglDepthbuffer=[];for(let yt=0;yt<6;yt++)r.bindFramebuffer(36160,oe.__webglFramebuffer[yt]),oe.__webglDepthbuffer[yt]=r.createRenderbuffer(),K(oe.__webglDepthbuffer[yt],ue,!1)}else r.bindFramebuffer(36160,oe.__webglFramebuffer),oe.__webglDepthbuffer=r.createRenderbuffer(),K(oe.__webglDepthbuffer,ue,!1);r.bindFramebuffer(36160,null)}function Le(ue){const oe=u.get(ue),lt=u.get(ue.texture);ue.addEventListener("dispose",Gt),lt.__webglTexture=r.createTexture(),b.memory.textures++;const yt=ue.isWebGLCubeRenderTarget===!0,Ce=ue.isWebGLMultisampleRenderTarget===!0,Pt=j(ue)||M;if(M&&ue.texture.format===Or&&(ue.texture.type===Tr||ue.texture.type===ur)&&(ue.texture.format=vr,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),yt){oe.__webglFramebuffer=[];for(let Kt=0;Kt<6;Kt++)oe.__webglFramebuffer[Kt]=r.createFramebuffer()}else if(oe.__webglFramebuffer=r.createFramebuffer(),Ce)if(M){oe.__webglMultisampledFramebuffer=r.createFramebuffer(),oe.__webglColorRenderbuffer=r.createRenderbuffer(),r.bindRenderbuffer(36161,oe.__webglColorRenderbuffer);const Kt=g.convert(ue.texture.format),qn=g.convert(ue.texture.type),xn=Ne(ue.texture.internalFormat,Kt,qn),Oe=ke(ue);r.renderbufferStorageMultisample(36161,Oe,xn,ue.width,ue.height),r.bindFramebuffer(36160,oe.__webglMultisampledFramebuffer),r.framebufferRenderbuffer(36160,36064,36161,oe.__webglColorRenderbuffer),r.bindRenderbuffer(36161,null),ue.depthBuffer&&(oe.__webglDepthRenderbuffer=r.createRenderbuffer(),K(oe.__webglDepthRenderbuffer,ue,!0)),r.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(yt){n.bindTexture(34067,lt.__webglTexture),Vt(34067,ue.texture,Pt);for(let Kt=0;Kt<6;Kt++)he(oe.__webglFramebuffer[Kt],ue,36064,34069+Kt);Pe(ue.texture,Pt)&&Re(34067,ue.texture,ue.width,ue.height),n.bindTexture(34067,null)}else n.bindTexture(3553,lt.__webglTexture),Vt(3553,ue.texture,Pt),he(oe.__webglFramebuffer,ue,36064,3553),Pe(ue.texture,Pt)&&Re(3553,ue.texture,ue.width,ue.height),n.bindTexture(3553,null);ue.depthBuffer&&me(ue)}function Be(ue){const oe=ue.texture,lt=j(ue)||M;if(Pe(oe,lt)){const yt=ue.isWebGLCubeRenderTarget?34067:3553,Ce=u.get(oe).__webglTexture;n.bindTexture(yt,Ce),Re(yt,oe,ue.width,ue.height),n.bindTexture(yt,null)}}function Ye(ue){if(ue.isWebGLMultisampleRenderTarget)if(M){const oe=u.get(ue);r.bindFramebuffer(36008,oe.__webglMultisampledFramebuffer),r.bindFramebuffer(36009,oe.__webglFramebuffer);const lt=ue.width,yt=ue.height;let Ce=16384;ue.depthBuffer&&(Ce|=256),ue.stencilBuffer&&(Ce|=1024),r.blitFramebuffer(0,0,lt,yt,0,0,lt,yt,Ce,9728),r.bindFramebuffer(36160,oe.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")}function ke(ue){return M&&ue.isWebGLMultisampleRenderTarget?Math.min(O,ue.samples):0}function He(ue){const oe=b.render.frame;k.get(ue)!==oe&&(k.set(ue,oe),ue.update())}let Je=!1,ot=!1;function bt(ue,oe){ue&&ue.isWebGLRenderTarget&&(Je===!1&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),Je=!0),ue=ue.texture),je(ue,oe)}function Mt(ue,oe){ue&&ue.isWebGLCubeRenderTarget&&(ot===!1&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),ot=!0),ue=ue.texture),ft(ue,oe)}this.allocateTextureUnit=rt,this.resetTextureUnits=et,this.setTexture2D=je,this.setTexture2DArray=Ve,this.setTexture3D=ht,this.setTextureCube=ft,this.setupRenderTarget=Le,this.updateRenderTargetMipmap=Be,this.updateMultisampleRenderTarget=Ye,this.safeSetTexture2D=bt,this.safeSetTextureCube=Mt}function Jf(r,i,n){const u=n.isWebGL2;function p(g){let b;if(g===os)return 5121;if(g===Ws)return 32819;if(g===ho)return 32820;if(g===gr)return 33635;if(g===Ls)return 5120;if(g===Ga)return 5122;if(g===ha)return 5123;if(g===kv)return 5124;if(g===Dr)return 5125;if(g===Tr)return 5126;if(g===ur)return u?5131:(b=i.get("OES_texture_half_float"),b!==null?b.HALF_FLOAT_OES:null);if(g===Tm)return 6406;if(g===Or)return 6407;if(g===vr)return 6408;if(g===vf)return 6409;if(g===yf)return 6410;if(g===hu)return 6402;if(g===dl)return 34041;if(g===oh)return 6403;if(g===Uv)return 36244;if(g===Hv)return 33319;if(g===Mc)return 33320;if(g===Id)return 36248;if(g===fo)return 36249;if(g===pl||g===Am||g===Sc||g===Nd)if(b=i.get("WEBGL_compressed_texture_s3tc"),b!==null){if(g===pl)return b.COMPRESSED_RGB_S3TC_DXT1_EXT;if(g===Am)return b.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(g===Sc)return b.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(g===Nd)return b.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(g===lh||g===Fd||g===Ir||g===Cs)if(b=i.get("WEBGL_compressed_texture_pvrtc"),b!==null){if(g===lh)return b.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(g===Fd)return b.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(g===Ir)return b.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(g===Cs)return b.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(g===us)return b=i.get("WEBGL_compressed_texture_etc1"),b!==null?b.COMPRESSED_RGB_ETC1_WEBGL:null;if((g===Lm||g===ch)&&(b=i.get("WEBGL_compressed_texture_etc"),b!==null)){if(g===Lm)return b.COMPRESSED_RGB8_ETC2;if(g===ch)return b.COMPRESSED_RGBA8_ETC2_EAC}if(g===Gv||g===Xs||g===uh||g===Cm||g===po||g===Xo||g===Pm||g===Vv||g===fu||g===hh||g===Wv||g===Rm||g===Co||g===Bd||g===Xv||g===kd||g===qv||g===Po||g===xf||g===fa||g===jv||g===Yv||g===_f||g===Zv||g===Ec||g===Om||g===bf||g===Tc)return b=i.get("WEBGL_compressed_texture_astc"),b!==null?g:null;if(g===Dm)return b=i.get("EXT_texture_compression_bptc"),b!==null?g:null;if(g===ah)return u?34042:(b=i.get("WEBGL_depth_texture"),b!==null?b.UNSIGNED_INT_24_8_WEBGL:null)}return{convert:p}}function Ru(r){ba.call(this),this.cameras=r||[]}Ru.prototype=Object.assign(Object.create(ba.prototype),{constructor:Ru,isArrayCamera:!0});function $o(){Ni.call(this),this.type="Group"}$o.prototype=Object.assign(Object.create(Ni.prototype),{constructor:$o,isGroup:!0});function Du(){this._targetRay=null,this._grip=null,this._hand=null}Object.assign(Du.prototype,{constructor:Du,getHandSpace:function(){if(this._hand===null&&(this._hand=new $o,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints=[],this._hand.inputState={pinching:!1},window.XRHand))for(let r=0;r<=window.XRHand.LITTLE_PHALANX_TIP;r++){const i=new $o;i.matrixAutoUpdate=!1,i.visible=!1,this._hand.joints.push(i),this._hand.add(i)}return this._hand},getTargetRaySpace:function(){return this._targetRay===null&&(this._targetRay=new $o,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return this._grip===null&&(this._grip=new $o,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(r){return this._targetRay!==null&&this._targetRay.dispatchEvent(r),this._grip!==null&&this._grip.dispatchEvent(r),this._hand!==null&&this._hand.dispatchEvent(r),this},disconnect:function(r){return this.dispatchEvent({type:"disconnected",data:r}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this},update:function(r,i,n){let u=null,p=null,g=null;const b=this._targetRay,M=this._grip,A=this._hand;if(r)if(A&&r.hand){g=!0;for(let C=0;C<=window.XRHand.LITTLE_PHALANX_TIP;C++)if(r.hand[C]){const F=i.getJointPose(r.hand[C],n),O=A.joints[C];F!==null&&(O.matrix.fromArray(F.transform.matrix),O.matrix.decompose(O.position,O.rotation,O.scale),O.jointRadius=F.radius),O.visible=F!==null;const k=A.joints[window.XRHand.INDEX_PHALANX_TIP],N=A.joints[window.XRHand.THUMB_PHALANX_TIP],X=k.position.distanceTo(N.position),ne=.02,te=.005;A.inputState.pinching&&X>ne+te?(A.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:r.handedness,target:this})):!A.inputState.pinching&&X<=ne-te&&(A.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:r.handedness,target:this}))}}else b!==null&&(u=i.getPose(r.targetRaySpace,n),u!==null&&(b.matrix.fromArray(u.transform.matrix),b.matrix.decompose(b.position,b.rotation,b.scale))),M!==null&&r.gripSpace&&(p=i.getPose(r.gripSpace,n),p!==null&&(M.matrix.fromArray(p.transform.matrix),M.matrix.decompose(M.position,M.rotation,M.scale)));return b!==null&&(b.visible=u!==null),M!==null&&(M.visible=p!==null),A!==null&&(A.visible=g!==null),this}});function rS(r,i){const n=this;let u=null,p=1,g=null,b="local-floor",M=null;const A=[],C=new Map,F=new ba;F.layers.enable(1),F.viewport=new vs;const O=new ba;O.layers.enable(2),O.viewport=new vs;const k=[F,O],N=new Ru;N.layers.enable(1),N.layers.enable(2);let X=null,ne=null;this.enabled=!1,this.isPresenting=!1,this.getController=function(_t){let et=A[_t];return et===void 0&&(et=new Du,A[_t]=et),et.getTargetRaySpace()},this.getControllerGrip=function(_t){let et=A[_t];return et===void 0&&(et=new Du,A[_t]=et),et.getGripSpace()},this.getHand=function(_t){let et=A[_t];return et===void 0&&(et=new Du,A[_t]=et),et.getHandSpace()};function te(_t){const et=C.get(_t.inputSource);et&&et.dispatchEvent({type:_t.type,data:_t.inputSource})}function j(){C.forEach(function(_t,et){_t.disconnect(et)}),C.clear(),r.setFramebuffer(null),r.setRenderTarget(r.getRenderTarget()),an.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function W(_t){g=_t,an.setContext(u),an.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}this.setFramebufferScaleFactor=function(_t){p=_t,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(_t){b=_t,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return g},this.getSession=function(){return u},this.setSession=function(_t){if(u=_t,u!==null){u.addEventListener("select",te),u.addEventListener("selectstart",te),u.addEventListener("selectend",te),u.addEventListener("squeeze",te),u.addEventListener("squeezestart",te),u.addEventListener("squeezeend",te),u.addEventListener("end",j);const et=i.getContextAttributes();et.xrCompatible!==!0&&i.makeXRCompatible();const rt={antialias:et.antialias,alpha:et.alpha,depth:et.depth,stencil:et.stencil,framebufferScaleFactor:p},je=new XRWebGLLayer(u,i,rt);u.updateRenderState({baseLayer:je}),u.requestReferenceSpace(b).then(W),u.addEventListener("inputsourceschange",Pe)}};function Pe(_t){const et=u.inputSources;for(let rt=0;rt<A.length;rt++)C.set(et[rt],A[rt]);for(let rt=0;rt<_t.removed.length;rt++){const je=_t.removed[rt],Ve=C.get(je);Ve&&(Ve.dispatchEvent({type:"disconnected",data:je}),C.delete(je))}for(let rt=0;rt<_t.added.length;rt++){const je=_t.added[rt],Ve=C.get(je);Ve&&Ve.dispatchEvent({type:"connected",data:je})}}const Re=new De,Ne=new De;function de(_t,et,rt){Re.setFromMatrixPosition(et.matrixWorld),Ne.setFromMatrixPosition(rt.matrixWorld);const je=Re.distanceTo(Ne),Ve=et.projectionMatrix.elements,ht=rt.projectionMatrix.elements,ft=Ve[14]/(Ve[10]-1),Wt=Ve[14]/(Ve[10]+1),An=(Ve[9]+1)/Ve[5],Vt=(Ve[9]-1)/Ve[5],Dn=(Ve[8]-1)/Ve[0],Ci=(ht[8]+1)/ht[0],vi=ft*Dn,he=ft*Ci,K=je/(-Dn+Ci),Fe=K*-Dn;et.matrixWorld.decompose(_t.position,_t.quaternion,_t.scale),_t.translateX(Fe),_t.translateZ(K),_t.matrixWorld.compose(_t.position,_t.quaternion,_t.scale),_t.matrixWorldInverse.getInverse(_t.matrixWorld);const me=ft+K,Le=Wt+K,Be=vi-Fe,Ye=he+(je-Fe),ke=An*Wt/Le*me,He=Vt*Wt/Le*me;_t.projectionMatrix.makePerspective(Be,Ye,ke,He,me,Le)}function $e(_t,et){et===null?_t.matrixWorld.copy(_t.matrix):_t.matrixWorld.multiplyMatrices(et.matrixWorld,_t.matrix),_t.matrixWorldInverse.getInverse(_t.matrixWorld)}this.getCamera=function(_t){N.near=O.near=F.near=_t.near,N.far=O.far=F.far=_t.far,(X!==N.near||ne!==N.far)&&(u.updateRenderState({depthNear:N.near,depthFar:N.far}),X=N.near,ne=N.far);const et=_t.parent,rt=N.cameras;$e(N,et);for(let Ve=0;Ve<rt.length;Ve++)$e(rt[Ve],et);_t.matrixWorld.copy(N.matrixWorld);const je=_t.children;for(let Ve=0,ht=je.length;Ve<ht;Ve++)je[Ve].updateMatrixWorld(!0);return rt.length===2?de(N,F,O):N.projectionMatrix.copy(F.projectionMatrix),N};let Gt=null;function dt(_t,et){if(M=et.getViewerPose(g),M!==null){const je=M.views,Ve=u.renderState.baseLayer;r.setFramebuffer(Ve.framebuffer);let ht=!1;je.length!==N.cameras.length&&(N.cameras.length=0,ht=!0);for(let ft=0;ft<je.length;ft++){const Wt=je[ft],An=Ve.getViewport(Wt),Vt=k[ft];Vt.matrix.fromArray(Wt.transform.matrix),Vt.projectionMatrix.fromArray(Wt.projectionMatrix),Vt.viewport.set(An.x,An.y,An.width,An.height),ft===0&&N.matrix.copy(Vt.matrix),ht===!0&&N.cameras.push(Vt)}}const rt=u.inputSources;for(let je=0;je<A.length;je++){const Ve=A[je],ht=rt[je];Ve.update(ht,et,g)}Gt&&Gt(_t,et)}const an=new fy;an.setAnimationLoop(dt),this.setAnimationLoop=function(_t){Gt=_t},this.dispose=function(){}}Object.assign(rS.prototype,go.prototype);function QE(r){function i(j,W){j.fogColor.value.copy(W.color),W.isFog?(j.fogNear.value=W.near,j.fogFar.value=W.far):W.isFogExp2&&(j.fogDensity.value=W.density)}function n(j,W,Pe,Re){W.isMeshBasicMaterial?u(j,W):W.isMeshLambertMaterial?(u(j,W),A(j,W)):W.isMeshToonMaterial?(u(j,W),F(j,W)):W.isMeshPhongMaterial?(u(j,W),C(j,W)):W.isMeshStandardMaterial?(u(j,W),W.isMeshPhysicalMaterial?k(j,W):O(j,W)):W.isMeshMatcapMaterial?(u(j,W),N(j,W)):W.isMeshDepthMaterial?(u(j,W),X(j,W)):W.isMeshDistanceMaterial?(u(j,W),ne(j,W)):W.isMeshNormalMaterial?(u(j,W),te(j,W)):W.isLineBasicMaterial?(p(j,W),W.isLineDashedMaterial&&g(j,W)):W.isPointsMaterial?b(j,W,Pe,Re):W.isSpriteMaterial?M(j,W):W.isShadowMaterial?(j.color.value.copy(W.color),j.opacity.value=W.opacity):W.isShaderMaterial&&(W.uniformsNeedUpdate=!1)}function u(j,W){j.opacity.value=W.opacity,W.color&&j.diffuse.value.copy(W.color),W.emissive&&j.emissive.value.copy(W.emissive).multiplyScalar(W.emissiveIntensity),W.map&&(j.map.value=W.map),W.alphaMap&&(j.alphaMap.value=W.alphaMap),W.specularMap&&(j.specularMap.value=W.specularMap);const Pe=r.get(W).envMap;if(Pe){j.envMap.value=Pe,j.flipEnvMap.value=Pe.isCubeTexture&&Pe._needsFlipEnvMap?-1:1,j.reflectivity.value=W.reflectivity,j.refractionRatio.value=W.refractionRatio;const de=r.get(Pe).__maxMipLevel;de!==void 0&&(j.maxMipLevel.value=de)}W.lightMap&&(j.lightMap.value=W.lightMap,j.lightMapIntensity.value=W.lightMapIntensity),W.aoMap&&(j.aoMap.value=W.aoMap,j.aoMapIntensity.value=W.aoMapIntensity);let Re;W.map?Re=W.map:W.specularMap?Re=W.specularMap:W.displacementMap?Re=W.displacementMap:W.normalMap?Re=W.normalMap:W.bumpMap?Re=W.bumpMap:W.roughnessMap?Re=W.roughnessMap:W.metalnessMap?Re=W.metalnessMap:W.alphaMap?Re=W.alphaMap:W.emissiveMap?Re=W.emissiveMap:W.clearcoatMap?Re=W.clearcoatMap:W.clearcoatNormalMap?Re=W.clearcoatNormalMap:W.clearcoatRoughnessMap&&(Re=W.clearcoatRoughnessMap),Re!==void 0&&(Re.isWebGLRenderTarget&&(Re=Re.texture),Re.matrixAutoUpdate===!0&&Re.updateMatrix(),j.uvTransform.value.copy(Re.matrix));let Ne;W.aoMap?Ne=W.aoMap:W.lightMap&&(Ne=W.lightMap),Ne!==void 0&&(Ne.isWebGLRenderTarget&&(Ne=Ne.texture),Ne.matrixAutoUpdate===!0&&Ne.updateMatrix(),j.uv2Transform.value.copy(Ne.matrix))}function p(j,W){j.diffuse.value.copy(W.color),j.opacity.value=W.opacity}function g(j,W){j.dashSize.value=W.dashSize,j.totalSize.value=W.dashSize+W.gapSize,j.scale.value=W.scale}function b(j,W,Pe,Re){j.diffuse.value.copy(W.color),j.opacity.value=W.opacity,j.size.value=W.size*Pe,j.scale.value=Re*.5,W.map&&(j.map.value=W.map),W.alphaMap&&(j.alphaMap.value=W.alphaMap);let Ne;W.map?Ne=W.map:W.alphaMap&&(Ne=W.alphaMap),Ne!==void 0&&(Ne.matrixAutoUpdate===!0&&Ne.updateMatrix(),j.uvTransform.value.copy(Ne.matrix))}function M(j,W){j.diffuse.value.copy(W.color),j.opacity.value=W.opacity,j.rotation.value=W.rotation,W.map&&(j.map.value=W.map),W.alphaMap&&(j.alphaMap.value=W.alphaMap);let Pe;W.map?Pe=W.map:W.alphaMap&&(Pe=W.alphaMap),Pe!==void 0&&(Pe.matrixAutoUpdate===!0&&Pe.updateMatrix(),j.uvTransform.value.copy(Pe.matrix))}function A(j,W){W.emissiveMap&&(j.emissiveMap.value=W.emissiveMap)}function C(j,W){j.specular.value.copy(W.specular),j.shininess.value=Math.max(W.shininess,1e-4),W.emissiveMap&&(j.emissiveMap.value=W.emissiveMap),W.bumpMap&&(j.bumpMap.value=W.bumpMap,j.bumpScale.value=W.bumpScale,W.side===It&&(j.bumpScale.value*=-1)),W.normalMap&&(j.normalMap.value=W.normalMap,j.normalScale.value.copy(W.normalScale),W.side===It&&j.normalScale.value.negate()),W.displacementMap&&(j.displacementMap.value=W.displacementMap,j.displacementScale.value=W.displacementScale,j.displacementBias.value=W.displacementBias)}function F(j,W){W.gradientMap&&(j.gradientMap.value=W.gradientMap),W.emissiveMap&&(j.emissiveMap.value=W.emissiveMap),W.bumpMap&&(j.bumpMap.value=W.bumpMap,j.bumpScale.value=W.bumpScale,W.side===It&&(j.bumpScale.value*=-1)),W.normalMap&&(j.normalMap.value=W.normalMap,j.normalScale.value.copy(W.normalScale),W.side===It&&j.normalScale.value.negate()),W.displacementMap&&(j.displacementMap.value=W.displacementMap,j.displacementScale.value=W.displacementScale,j.displacementBias.value=W.displacementBias)}function O(j,W){j.roughness.value=W.roughness,j.metalness.value=W.metalness,W.roughnessMap&&(j.roughnessMap.value=W.roughnessMap),W.metalnessMap&&(j.metalnessMap.value=W.metalnessMap),W.emissiveMap&&(j.emissiveMap.value=W.emissiveMap),W.bumpMap&&(j.bumpMap.value=W.bumpMap,j.bumpScale.value=W.bumpScale,W.side===It&&(j.bumpScale.value*=-1)),W.normalMap&&(j.normalMap.value=W.normalMap,j.normalScale.value.copy(W.normalScale),W.side===It&&j.normalScale.value.negate()),W.displacementMap&&(j.displacementMap.value=W.displacementMap,j.displacementScale.value=W.displacementScale,j.displacementBias.value=W.displacementBias),r.get(W).envMap&&(j.envMapIntensity.value=W.envMapIntensity)}function k(j,W){O(j,W),j.reflectivity.value=W.reflectivity,j.clearcoat.value=W.clearcoat,j.clearcoatRoughness.value=W.clearcoatRoughness,W.sheen&&j.sheen.value.copy(W.sheen),W.clearcoatMap&&(j.clearcoatMap.value=W.clearcoatMap),W.clearcoatRoughnessMap&&(j.clearcoatRoughnessMap.value=W.clearcoatRoughnessMap),W.clearcoatNormalMap&&(j.clearcoatNormalScale.value.copy(W.clearcoatNormalScale),j.clearcoatNormalMap.value=W.clearcoatNormalMap,W.side===It&&j.clearcoatNormalScale.value.negate()),j.transmission.value=W.transmission,W.transmissionMap&&(j.transmissionMap.value=W.transmissionMap)}function N(j,W){W.matcap&&(j.matcap.value=W.matcap),W.bumpMap&&(j.bumpMap.value=W.bumpMap,j.bumpScale.value=W.bumpScale,W.side===It&&(j.bumpScale.value*=-1)),W.normalMap&&(j.normalMap.value=W.normalMap,j.normalScale.value.copy(W.normalScale),W.side===It&&j.normalScale.value.negate()),W.displacementMap&&(j.displacementMap.value=W.displacementMap,j.displacementScale.value=W.displacementScale,j.displacementBias.value=W.displacementBias)}function X(j,W){W.displacementMap&&(j.displacementMap.value=W.displacementMap,j.displacementScale.value=W.displacementScale,j.displacementBias.value=W.displacementBias)}function ne(j,W){W.displacementMap&&(j.displacementMap.value=W.displacementMap,j.displacementScale.value=W.displacementScale,j.displacementBias.value=W.displacementBias),j.referencePosition.value.copy(W.referencePosition),j.nearDistance.value=W.nearDistance,j.farDistance.value=W.farDistance}function te(j,W){W.bumpMap&&(j.bumpMap.value=W.bumpMap,j.bumpScale.value=W.bumpScale,W.side===It&&(j.bumpScale.value*=-1)),W.normalMap&&(j.normalMap.value=W.normalMap,j.normalScale.value.copy(W.normalScale),W.side===It&&j.normalScale.value.negate()),W.displacementMap&&(j.displacementMap.value=W.displacementMap,j.displacementScale.value=W.displacementScale,j.displacementBias.value=W.displacementBias)}return{refreshFogUniforms:i,refreshMaterialUniforms:n}}function o0(r){r=r||{};const i=r.canvas!==void 0?r.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),n=r.context!==void 0?r.context:null,u=r.alpha!==void 0?r.alpha:!1,p=r.depth!==void 0?r.depth:!0,g=r.stencil!==void 0?r.stencil:!0,b=r.antialias!==void 0?r.antialias:!1,M=r.premultipliedAlpha!==void 0?r.premultipliedAlpha:!0,A=r.preserveDrawingBuffer!==void 0?r.preserveDrawingBuffer:!1,C=r.powerPreference!==void 0?r.powerPreference:"default",F=r.failIfMajorPerformanceCaveat!==void 0?r.failIfMajorPerformanceCaveat:!1;let O=null,k=null;this.domElement=i,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=Bl,this.physicallyCorrectLights=!1,this.toneMapping=Ai,this.toneMappingExposure=1,this.maxMorphTargets=8,this.maxMorphNormals=4;const N=this;let X=!1,ne=null,te=0,j=0,W=null,Pe=null,Re=-1,Ne=null,de=null;const $e=new vs,Gt=new vs;let dt=null,an=i.width,_t=i.height,et=1,rt=null,je=null;const Ve=new vs(0,0,an,_t),ht=new vs(0,0,an,_t);let ft=!1;const Wt=new sp;let An=!1,Vt=!1;const Dn=new yr,Ci=new De,vi={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function he(){return W===null?et:1}let K=n;function Fe(ye,Dt){for(let Rt=0;Rt<ye.length;Rt++){const rn=ye[Rt],Qn=i.getContext(rn,Dt);if(Qn!==null)return Qn}return null}try{const ye={alpha:u,depth:p,stencil:g,antialias:b,premultipliedAlpha:M,preserveDrawingBuffer:A,powerPreference:C,failIfMajorPerformanceCaveat:F};if(i.addEventListener("webglcontextlost",er,!1),i.addEventListener("webglcontextrestored",ts,!1),K===null){const Dt=["webgl2","webgl","experimental-webgl"];if(N.isWebGL1Renderer===!0&&Dt.shift(),K=Fe(Dt,ye),K===null)throw Fe(Dt)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}K.getShaderPrecisionFormat===void 0&&(K.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(ye){throw console.error("THREE.WebGLRenderer: "+ye.message),ye}let me,Le,Be,Ye,ke,He,Je,ot,bt,Mt,ue,oe,lt,yt,Ce,Pt,Kt,qn,xn,Oe,Ht;function Kn(){me=new Wy(K),Le=new Db(K,me,r),Le.isWebGL2===!1&&(me.get("WEBGL_depth_texture"),me.get("OES_texture_float"),me.get("OES_texture_half_float"),me.get("OES_texture_half_float_linear"),me.get("OES_standard_derivatives"),me.get("OES_element_index_uint"),me.get("OES_vertex_array_object"),me.get("ANGLE_instanced_arrays")),me.get("OES_texture_float_linear"),Oe=new Jf(K,me,Le),Be=new Mp(K,me,Le),Be.scissor(Gt.copy(ht).multiplyScalar(et).floor()),Be.viewport($e.copy(Ve).multiplyScalar(et).floor()),Ye=new Xy(K),ke=new zn,He=new Oh(K,me,Be,ke,Le,Oe,Ye),Je=new hg(N),ot=new ap(K,Le),Ht=new Rb(K,me,ot,Le),bt=new Ob(K,ot,Ye,Ht),Mt=new jy(K,bt,ot,Ye),Kt=new fg(K),Ce=new Vy(ke),ue=new Vn(N,Je,me,Le,Ht,Ce),oe=new QE(ke),lt=new wi(ke),yt=new Xa,Pt=new Pb(N,Je,Be,Mt,M),qn=new Gy(K,me,Ye,Le),xn=new Ib(K,me,Ye,Le),Ye.programs=ue.programs,N.capabilities=Le,N.extensions=me,N.properties=ke,N.renderLists=lt,N.state=Be,N.info=Ye}Kn();const hn=new rS(N,K);this.xr=hn;const jn=new Dh(N,Mt,Le.maxTextureSize);this.shadowMap=jn,this.getContext=function(){return K},this.getContextAttributes=function(){return K.getContextAttributes()},this.forceContextLoss=function(){const ye=me.get("WEBGL_lose_context");ye&&ye.loseContext()},this.forceContextRestore=function(){const ye=me.get("WEBGL_lose_context");ye&&ye.restoreContext()},this.getPixelRatio=function(){return et},this.setPixelRatio=function(ye){ye!==void 0&&(et=ye,this.setSize(an,_t,!1))},this.getSize=function(ye){return ye===void 0&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),ye=new vn),ye.set(an,_t)},this.setSize=function(ye,Dt,Rt){if(hn.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}an=ye,_t=Dt,i.width=Math.floor(ye*et),i.height=Math.floor(Dt*et),Rt!==!1&&(i.style.width=ye+"px",i.style.height=Dt+"px"),this.setViewport(0,0,ye,Dt)},this.getDrawingBufferSize=function(ye){return ye===void 0&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),ye=new vn),ye.set(an*et,_t*et).floor()},this.setDrawingBufferSize=function(ye,Dt,Rt){an=ye,_t=Dt,et=Rt,i.width=Math.floor(ye*Rt),i.height=Math.floor(Dt*Rt),this.setViewport(0,0,ye,Dt)},this.getCurrentViewport=function(ye){return ye===void 0&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),ye=new vs),ye.copy($e)},this.getViewport=function(ye){return ye.copy(Ve)},this.setViewport=function(ye,Dt,Rt,rn){ye.isVector4?Ve.set(ye.x,ye.y,ye.z,ye.w):Ve.set(ye,Dt,Rt,rn),Be.viewport($e.copy(Ve).multiplyScalar(et).floor())},this.getScissor=function(ye){return ye.copy(ht)},this.setScissor=function(ye,Dt,Rt,rn){ye.isVector4?ht.set(ye.x,ye.y,ye.z,ye.w):ht.set(ye,Dt,Rt,rn),Be.scissor(Gt.copy(ht).multiplyScalar(et).floor())},this.getScissorTest=function(){return ft},this.setScissorTest=function(ye){Be.setScissorTest(ft=ye)},this.setOpaqueSort=function(ye){rt=ye},this.setTransparentSort=function(ye){je=ye},this.getClearColor=function(){return Pt.getClearColor()},this.setClearColor=function(){Pt.setClearColor.apply(Pt,arguments)},this.getClearAlpha=function(){return Pt.getClearAlpha()},this.setClearAlpha=function(){Pt.setClearAlpha.apply(Pt,arguments)},this.clear=function(ye,Dt,Rt){let rn=0;(ye===void 0||ye)&&(rn|=16384),(Dt===void 0||Dt)&&(rn|=256),(Rt===void 0||Rt)&&(rn|=1024),K.clear(rn)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){i.removeEventListener("webglcontextlost",er,!1),i.removeEventListener("webglcontextrestored",ts,!1),lt.dispose(),yt.dispose(),ke.dispose(),Je.dispose(),Mt.dispose(),Ht.dispose(),hn.dispose(),xs.stop()};function er(ye){ye.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),X=!0}function ts(){console.log("THREE.WebGLRenderer: Context Restored."),X=!1,Kn()}function wa(ye){const Dt=ye.target;Dt.removeEventListener("dispose",wa),zs(Dt)}function zs(ye){Ra(ye),ke.remove(ye)}function Ra(ye){const Dt=ke.get(ye).program;Dt!==void 0&&ue.releaseProgram(Dt)}function ec(ye,Dt){ye.render(function(Rt){N.renderBufferImmediate(Rt,Dt)})}this.renderBufferImmediate=function(ye,Dt){Ht.initAttributes();const Rt=ke.get(ye);ye.hasPositions&&!Rt.position&&(Rt.position=K.createBuffer()),ye.hasNormals&&!Rt.normal&&(Rt.normal=K.createBuffer()),ye.hasUvs&&!Rt.uv&&(Rt.uv=K.createBuffer()),ye.hasColors&&!Rt.color&&(Rt.color=K.createBuffer());const rn=Dt.getAttributes();ye.hasPositions&&(K.bindBuffer(34962,Rt.position),K.bufferData(34962,ye.positionArray,35048),Ht.enableAttribute(rn.position),K.vertexAttribPointer(rn.position,3,5126,!1,0,0)),ye.hasNormals&&(K.bindBuffer(34962,Rt.normal),K.bufferData(34962,ye.normalArray,35048),Ht.enableAttribute(rn.normal),K.vertexAttribPointer(rn.normal,3,5126,!1,0,0)),ye.hasUvs&&(K.bindBuffer(34962,Rt.uv),K.bufferData(34962,ye.uvArray,35048),Ht.enableAttribute(rn.uv),K.vertexAttribPointer(rn.uv,2,5126,!1,0,0)),ye.hasColors&&(K.bindBuffer(34962,Rt.color),K.bufferData(34962,ye.colorArray,35048),Ht.enableAttribute(rn.color),K.vertexAttribPointer(rn.color,3,5126,!1,0,0)),Ht.disableUnusedAttributes(),K.drawArrays(4,0,ye.count),ye.count=0},this.renderBufferDirect=function(ye,Dt,Rt,rn,Qn,ar){Dt===null&&(Dt=vi);const dr=Qn.isMesh&&Qn.matrixWorld.determinant()<0,Mr=io(ye,Dt,rn,Qn);Be.setMaterial(rn,dr);let tr=Rt.index;const Os=Rt.attributes.position;if(tr===null){if(Os===void 0||Os.count===0)return}else if(tr.count===0)return;let Is=1;rn.wireframe===!0&&(tr=bt.getWireframeAttribute(Rt),Is=2),(rn.morphTargets||rn.morphNormals)&&Kt.update(Qn,Rt,rn,Mr),Ht.setup(Qn,rn,Mr,Rt,tr);let Ii,Vr=qn;tr!==null&&(Ii=ot.get(tr),Vr=xn,Vr.setIndex(Ii));const oa=tr!==null?tr.count:Os.count,Wr=Rt.drawRange.start*Is,Us=Rt.drawRange.count*Is,Zs=ar!==null?ar.start*Is:0,tc=ar!==null?ar.count*Is:1/0,ma=Math.max(Wr,Zs),nc=Math.min(oa,Wr+Us,Zs+tc)-1,la=Math.max(0,nc-ma+1);if(la!==0){if(Qn.isMesh)rn.wireframe===!0?(Be.setLineWidth(rn.wireframeLinewidth*he()),Vr.setMode(1)):Vr.setMode(4);else if(Qn.isLine){let ic=rn.linewidth;ic===void 0&&(ic=1),Be.setLineWidth(ic*he()),Qn.isLineSegments?Vr.setMode(1):Qn.isLineLoop?Vr.setMode(2):Vr.setMode(3)}else Qn.isPoints?Vr.setMode(0):Qn.isSprite&&Vr.setMode(4);if(Qn.isInstancedMesh)Vr.renderInstances(ma,la,Qn.count);else if(Rt.isInstancedBufferGeometry){const ic=Math.min(Rt.instanceCount,Rt._maxInstanceCount);Vr.renderInstances(ma,la,ic)}else Vr.render(ma,la)}},this.compile=function(ye,Dt){k=yt.get(ye,Dt),k.init(),ye.traverse(function(rn){rn.isLight&&(k.pushLight(rn),rn.castShadow&&k.pushShadow(rn))}),k.setupLights(Dt);const Rt=new WeakMap;ye.traverse(function(rn){const Qn=rn.material;if(Qn)if(Array.isArray(Qn))for(let ar=0;ar<Qn.length;ar++){const dr=Qn[ar];Rt.has(dr)===!1&&(ta(dr,ye,rn),Rt.set(dr))}else Rt.has(Qn)===!1&&(ta(Qn,ye,rn),Rt.set(Qn))})};let to=null;function Ds(ye){hn.isPresenting||to&&to(ye)}const xs=new fy;xs.setAnimationLoop(Ds),typeof window<"u"&&xs.setContext(window),this.setAnimationLoop=function(ye){to=ye,hn.setAnimationLoop(ye),ye===null?xs.stop():xs.start()},this.render=function(ye,Dt){let Rt,rn;if(arguments[2]!==void 0&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),Rt=arguments[2]),arguments[3]!==void 0&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),rn=arguments[3]),Dt!==void 0&&Dt.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(X===!0)return;Ht.resetDefaultState(),Re=-1,Ne=null,ye.autoUpdate===!0&&ye.updateMatrixWorld(),Dt.parent===null&&Dt.updateMatrixWorld(),hn.enabled===!0&&hn.isPresenting===!0&&(Dt=hn.getCamera(Dt)),ye.isScene===!0&&ye.onBeforeRender(N,ye,Dt,Rt||W),k=yt.get(ye,Dt),k.init(),Dn.multiplyMatrices(Dt.projectionMatrix,Dt.matrixWorldInverse),Wt.setFromProjectionMatrix(Dn),Vt=this.localClippingEnabled,An=Ce.init(this.clippingPlanes,Vt,Dt),O=lt.get(ye,Dt),O.init(),tl(ye,Dt,0,N.sortObjects),O.finish(),N.sortObjects===!0&&O.sort(rt,je),An===!0&&Ce.beginShadows();const Qn=k.state.shadowsArray;jn.render(Qn,ye,Dt),k.setupLights(Dt),An===!0&&Ce.endShadows(),this.info.autoReset===!0&&this.info.reset(),Rt!==void 0&&this.setRenderTarget(Rt),Pt.render(O,ye,Dt,rn);const ar=O.opaque,dr=O.transparent;ar.length>0&&no(ar,ye,Dt),dr.length>0&&no(dr,ye,Dt),ye.isScene===!0&&ye.onAfterRender(N,ye,Dt),W!==null&&(He.updateRenderTargetMipmap(W),He.updateMultisampleRenderTarget(W)),Be.buffers.depth.setTest(!0),Be.buffers.depth.setMask(!0),Be.buffers.color.setMask(!0),Be.setPolygonOffset(!1),O=null,k=null};function tl(ye,Dt,Rt,rn){if(ye.visible===!1)return;if(ye.layers.test(Dt.layers)){if(ye.isGroup)Rt=ye.renderOrder;else if(ye.isLOD)ye.autoUpdate===!0&&ye.update(Dt);else if(ye.isLight)k.pushLight(ye),ye.castShadow&&k.pushShadow(ye);else if(ye.isSprite){if(!ye.frustumCulled||Wt.intersectsSprite(ye)){rn&&Ci.setFromMatrixPosition(ye.matrixWorld).applyMatrix4(Dn);const dr=Mt.update(ye),Mr=ye.material;Mr.visible&&O.push(ye,dr,Mr,Rt,Ci.z,null)}}else if(ye.isImmediateRenderObject)rn&&Ci.setFromMatrixPosition(ye.matrixWorld).applyMatrix4(Dn),O.push(ye,null,ye.material,Rt,Ci.z,null);else if((ye.isMesh||ye.isLine||ye.isPoints)&&(ye.isSkinnedMesh&&ye.skeleton.frame!==Ye.render.frame&&(ye.skeleton.update(),ye.skeleton.frame=Ye.render.frame),!ye.frustumCulled||Wt.intersectsObject(ye))){rn&&Ci.setFromMatrixPosition(ye.matrixWorld).applyMatrix4(Dn);const dr=Mt.update(ye),Mr=ye.material;if(Array.isArray(Mr)){const tr=dr.groups;for(let Os=0,Is=tr.length;Os<Is;Os++){const Ii=tr[Os],Vr=Mr[Ii.materialIndex];Vr&&Vr.visible&&O.push(ye,dr,Vr,Rt,Ci.z,Ii)}}else Mr.visible&&O.push(ye,dr,Mr,Rt,Ci.z,null)}}const ar=ye.children;for(let dr=0,Mr=ar.length;dr<Mr;dr++)tl(ar[dr],Dt,Rt,rn)}function no(ye,Dt,Rt){const rn=Dt.isScene===!0?Dt.overrideMaterial:null;for(let Qn=0,ar=ye.length;Qn<ar;Qn++){const dr=ye[Qn],Mr=dr.object,tr=dr.geometry,Os=rn===null?dr.material:rn,Is=dr.group;if(Rt.isArrayCamera){de=Rt;const Ii=Rt.cameras;for(let Vr=0,oa=Ii.length;Vr<oa;Vr++){const Wr=Ii[Vr];Mr.layers.test(Wr.layers)&&(Be.viewport($e.copy(Wr.viewport)),k.setupLights(Wr),El(Mr,Dt,Wr,tr,Os,Is))}}else de=null,El(Mr,Dt,Rt,tr,Os,Is)}}function El(ye,Dt,Rt,rn,Qn,ar){if(ye.onBeforeRender(N,Dt,Rt,rn,Qn,ar),k=yt.get(Dt,de||Rt),ye.modelViewMatrix.multiplyMatrices(Rt.matrixWorldInverse,ye.matrixWorld),ye.normalMatrix.getNormalMatrix(ye.modelViewMatrix),ye.isImmediateRenderObject){const dr=io(Rt,Dt,Qn,ye);Be.setMaterial(Qn),Ht.reset(),ec(ye,dr)}else N.renderBufferDirect(Rt,Dt,rn,Qn,ye,ar);ye.onAfterRender(N,Dt,Rt,rn,Qn,ar),k=yt.get(Dt,de||Rt)}function ta(ye,Dt,Rt){Dt.isScene!==!0&&(Dt=vi);const rn=ke.get(ye),Qn=k.state.lights,ar=k.state.shadowsArray,dr=Qn.state.version,Mr=ue.getParameters(ye,Qn.state,ar,Dt,Rt),tr=ue.getProgramCacheKey(Mr);let Os=rn.program,Is=!0;if(Os===void 0)ye.addEventListener("dispose",wa);else if(Os.cacheKey!==tr)Ra(ye);else if(rn.lightsStateVersion!==dr)Is=!1;else if(Mr.shaderID!==void 0){const Wr=ye.isMeshStandardMaterial?Dt.environment:null;rn.envMap=Je.get(ye.envMap||Wr);return}else Is=!1;Is&&(Mr.uniforms=ue.getUniforms(ye),ye.onBeforeCompile(Mr,N),Os=ue.acquireProgram(Mr,tr),rn.program=Os,rn.uniforms=Mr.uniforms,rn.outputEncoding=Mr.outputEncoding);const Ii=rn.uniforms;(!ye.isShaderMaterial&&!ye.isRawShaderMaterial||ye.clipping===!0)&&(rn.numClippingPlanes=Ce.numPlanes,rn.numIntersection=Ce.numIntersection,Ii.clippingPlanes=Ce.uniform),rn.environment=ye.isMeshStandardMaterial?Dt.environment:null,rn.fog=Dt.fog,rn.envMap=Je.get(ye.envMap||rn.environment),rn.needsLights=nl(ye),rn.lightsStateVersion=dr,rn.needsLights&&(Ii.ambientLightColor.value=Qn.state.ambient,Ii.lightProbe.value=Qn.state.probe,Ii.directionalLights.value=Qn.state.directional,Ii.directionalLightShadows.value=Qn.state.directionalShadow,Ii.spotLights.value=Qn.state.spot,Ii.spotLightShadows.value=Qn.state.spotShadow,Ii.rectAreaLights.value=Qn.state.rectArea,Ii.ltc_1.value=Qn.state.rectAreaLTC1,Ii.ltc_2.value=Qn.state.rectAreaLTC2,Ii.pointLights.value=Qn.state.point,Ii.pointLightShadows.value=Qn.state.pointShadow,Ii.hemisphereLights.value=Qn.state.hemi,Ii.directionalShadowMap.value=Qn.state.directionalShadowMap,Ii.directionalShadowMatrix.value=Qn.state.directionalShadowMatrix,Ii.spotShadowMap.value=Qn.state.spotShadowMap,Ii.spotShadowMatrix.value=Qn.state.spotShadowMatrix,Ii.pointShadowMap.value=Qn.state.pointShadowMap,Ii.pointShadowMatrix.value=Qn.state.pointShadowMatrix);const Vr=rn.program.getUniforms(),oa=Yl.seqWithValue(Vr.seq,Ii);rn.uniformsList=oa}function io(ye,Dt,Rt,rn){Dt.isScene!==!0&&(Dt=vi),He.resetTextureUnits();const Qn=Dt.fog,ar=Rt.isMeshStandardMaterial?Dt.environment:null,dr=W===null?N.outputEncoding:W.texture.encoding,Mr=Je.get(Rt.envMap||ar),tr=ke.get(Rt),Os=k.state.lights;if(An===!0&&(Vt===!0||ye!==Ne)){const Zs=ye===Ne&&Rt.id===Re;Ce.setState(Rt,ye,Zs)}Rt.version===tr.__version?(Rt.fog&&tr.fog!==Qn||tr.environment!==ar||tr.needsLights&&tr.lightsStateVersion!==Os.state.version||tr.numClippingPlanes!==void 0&&(tr.numClippingPlanes!==Ce.numPlanes||tr.numIntersection!==Ce.numIntersection)||tr.outputEncoding!==dr||tr.envMap!==Mr)&&ta(Rt,Dt,rn):(ta(Rt,Dt,rn),tr.__version=Rt.version);let Is=!1,Ii=!1,Vr=!1;const oa=tr.program,Wr=oa.getUniforms(),Us=tr.uniforms;if(Be.useProgram(oa.program)&&(Is=!0,Ii=!0,Vr=!0),Rt.id!==Re&&(Re=Rt.id,Ii=!0),Is||Ne!==ye){if(Wr.setValue(K,"projectionMatrix",ye.projectionMatrix),Le.logarithmicDepthBuffer&&Wr.setValue(K,"logDepthBufFC",2/(Math.log(ye.far+1)/Math.LN2)),Ne!==ye&&(Ne=ye,Ii=!0,Vr=!0),Rt.isShaderMaterial||Rt.isMeshPhongMaterial||Rt.isMeshToonMaterial||Rt.isMeshStandardMaterial||Rt.envMap){const Zs=Wr.map.cameraPosition;Zs!==void 0&&Zs.setValue(K,Ci.setFromMatrixPosition(ye.matrixWorld))}(Rt.isMeshPhongMaterial||Rt.isMeshToonMaterial||Rt.isMeshLambertMaterial||Rt.isMeshBasicMaterial||Rt.isMeshStandardMaterial||Rt.isShaderMaterial)&&Wr.setValue(K,"isOrthographic",ye.isOrthographicCamera===!0),(Rt.isMeshPhongMaterial||Rt.isMeshToonMaterial||Rt.isMeshLambertMaterial||Rt.isMeshBasicMaterial||Rt.isMeshStandardMaterial||Rt.isShaderMaterial||Rt.isShadowMaterial||Rt.skinning)&&Wr.setValue(K,"viewMatrix",ye.matrixWorldInverse)}if(Rt.skinning){Wr.setOptional(K,rn,"bindMatrix"),Wr.setOptional(K,rn,"bindMatrixInverse");const Zs=rn.skeleton;if(Zs){const tc=Zs.bones;if(Le.floatVertexTextures){if(Zs.boneTexture===void 0){let ma=Math.sqrt(tc.length*4);ma=fr.ceilPowerOfTwo(ma),ma=Math.max(ma,4);const nc=new Float32Array(ma*ma*4);nc.set(Zs.boneMatrices);const la=new wh(nc,ma,ma,vr,Tr);Zs.boneMatrices=nc,Zs.boneTexture=la,Zs.boneTextureSize=ma}Wr.setValue(K,"boneTexture",Zs.boneTexture,He),Wr.setValue(K,"boneTextureSize",Zs.boneTextureSize)}else Wr.setOptional(K,Zs,"boneMatrices")}}return(Ii||tr.receiveShadow!==rn.receiveShadow)&&(tr.receiveShadow=rn.receiveShadow,Wr.setValue(K,"receiveShadow",rn.receiveShadow)),Ii&&(Wr.setValue(K,"toneMappingExposure",N.toneMappingExposure),tr.needsLights&&bo(Us,Vr),Qn&&Rt.fog&&oe.refreshFogUniforms(Us,Qn),oe.refreshMaterialUniforms(Us,Rt,et,_t),Yl.upload(K,tr.uniformsList,Us,He)),Rt.isShaderMaterial&&Rt.uniformsNeedUpdate===!0&&(Yl.upload(K,tr.uniformsList,Us,He),Rt.uniformsNeedUpdate=!1),Rt.isSpriteMaterial&&Wr.setValue(K,"center",rn.center),Wr.setValue(K,"modelViewMatrix",rn.modelViewMatrix),Wr.setValue(K,"normalMatrix",rn.normalMatrix),Wr.setValue(K,"modelMatrix",rn.matrixWorld),oa}function bo(ye,Dt){ye.ambientLightColor.needsUpdate=Dt,ye.lightProbe.needsUpdate=Dt,ye.directionalLights.needsUpdate=Dt,ye.directionalLightShadows.needsUpdate=Dt,ye.pointLights.needsUpdate=Dt,ye.pointLightShadows.needsUpdate=Dt,ye.spotLights.needsUpdate=Dt,ye.spotLightShadows.needsUpdate=Dt,ye.rectAreaLights.needsUpdate=Dt,ye.hemisphereLights.needsUpdate=Dt}function nl(ye){return ye.isMeshLambertMaterial||ye.isMeshToonMaterial||ye.isMeshPhongMaterial||ye.isMeshStandardMaterial||ye.isShadowMaterial||ye.isShaderMaterial&&ye.lights===!0}this.setFramebuffer=function(ye){ne!==ye&&W===null&&K.bindFramebuffer(36160,ye),ne=ye},this.getActiveCubeFace=function(){return te},this.getActiveMipmapLevel=function(){return j},this.getRenderList=function(){return O},this.setRenderList=function(ye){O=ye},this.getRenderState=function(){return k},this.setRenderState=function(ye){k=ye},this.getRenderTarget=function(){return W},this.setRenderTarget=function(ye,Dt=0,Rt=0){W=ye,te=Dt,j=Rt,ye&&ke.get(ye).__webglFramebuffer===void 0&&He.setupRenderTarget(ye);let rn=ne,Qn=!1;if(ye){const ar=ke.get(ye).__webglFramebuffer;ye.isWebGLCubeRenderTarget?(rn=ar[Dt],Qn=!0):ye.isWebGLMultisampleRenderTarget?rn=ke.get(ye).__webglMultisampledFramebuffer:rn=ar,$e.copy(ye.viewport),Gt.copy(ye.scissor),dt=ye.scissorTest}else $e.copy(Ve).multiplyScalar(et).floor(),Gt.copy(ht).multiplyScalar(et).floor(),dt=ft;if(Pe!==rn&&(K.bindFramebuffer(36160,rn),Pe=rn),Be.viewport($e),Be.scissor(Gt),Be.setScissorTest(dt),Qn){const ar=ke.get(ye.texture);K.framebufferTexture2D(36160,36064,34069+Dt,ar.__webglTexture,Rt)}},this.readRenderTargetPixels=function(ye,Dt,Rt,rn,Qn,ar,dr){if(!(ye&&ye.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Mr=ke.get(ye).__webglFramebuffer;if(ye.isWebGLCubeRenderTarget&&dr!==void 0&&(Mr=Mr[dr]),Mr){let tr=!1;Mr!==Pe&&(K.bindFramebuffer(36160,Mr),tr=!0);try{const Os=ye.texture,Is=Os.format,Ii=Os.type;if(Is!==vr&&Oe.convert(Is)!==K.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(Ii!==os&&Oe.convert(Ii)!==K.getParameter(35738)&&!(Ii===Tr&&(Le.isWebGL2||me.get("OES_texture_float")||me.get("WEBGL_color_buffer_float")))&&!(Ii===ur&&(Le.isWebGL2?me.get("EXT_color_buffer_float"):me.get("EXT_color_buffer_half_float")))){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}K.checkFramebufferStatus(36160)===36053?Dt>=0&&Dt<=ye.width-rn&&Rt>=0&&Rt<=ye.height-Qn&&K.readPixels(Dt,Rt,rn,Qn,Oe.convert(Is),Oe.convert(Ii),ar):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{tr&&K.bindFramebuffer(36160,Pe)}}},this.copyFramebufferToTexture=function(ye,Dt,Rt){Rt===void 0&&(Rt=0);const rn=Math.pow(2,-Rt),Qn=Math.floor(Dt.image.width*rn),ar=Math.floor(Dt.image.height*rn),dr=Oe.convert(Dt.format);He.setTexture2D(Dt,0),K.copyTexImage2D(3553,Rt,dr,ye.x,ye.y,Qn,ar,0),Be.unbindTexture()},this.copyTextureToTexture=function(ye,Dt,Rt,rn){rn===void 0&&(rn=0);const Qn=Dt.image.width,ar=Dt.image.height,dr=Oe.convert(Rt.format),Mr=Oe.convert(Rt.type);He.setTexture2D(Rt,0),K.pixelStorei(37440,Rt.flipY),K.pixelStorei(37441,Rt.premultiplyAlpha),K.pixelStorei(3317,Rt.unpackAlignment),Dt.isDataTexture?K.texSubImage2D(3553,rn,ye.x,ye.y,Qn,ar,dr,Mr,Dt.image.data):Dt.isCompressedTexture?K.compressedTexSubImage2D(3553,rn,ye.x,ye.y,Dt.mipmaps[0].width,Dt.mipmaps[0].height,dr,Dt.mipmaps[0].data):K.texSubImage2D(3553,rn,ye.x,ye.y,dr,Mr,Dt.image),rn===0&&Rt.generateMipmaps&&K.generateMipmap(3553),Be.unbindTexture()},this.initTexture=function(ye){He.setTexture2D(ye,0),Be.unbindTexture()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function sS(r){o0.call(this,r)}sS.prototype=Object.assign(Object.create(o0.prototype),{constructor:sS,isWebGL1Renderer:!0});class eT extends Ni{constructor(){super(),Object.defineProperty(this,"isScene",{value:!0}),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(i,n){return super.copy(i,n),i.background!==null&&(this.background=i.background.clone()),i.environment!==null&&(this.environment=i.environment.clone()),i.fog!==null&&(this.fog=i.fog.clone()),i.overrideMaterial!==null&&(this.overrideMaterial=i.overrideMaterial.clone()),this.autoUpdate=i.autoUpdate,this.matrixAutoUpdate=i.matrixAutoUpdate,this}toJSON(i){const n=super.toJSON(i);return this.background!==null&&(n.object.background=this.background.toJSON(i)),this.environment!==null&&(n.object.environment=this.environment.toJSON(i)),this.fog!==null&&(n.object.fog=this.fog.toJSON()),n}}function Ko(r,i){this.array=r,this.stride=i,this.count=r!==void 0?r.length/i:0,this.usage=Ef,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=fr.generateUUID()}Object.defineProperty(Ko.prototype,"needsUpdate",{set:function(r){r===!0&&this.version++}}),Object.assign(Ko.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(r){return this.usage=r,this},copy:function(r){return this.array=new r.array.constructor(r.array),this.count=r.count,this.stride=r.stride,this.usage=r.usage,this},copyAt:function(r,i,n){r*=this.stride,n*=i.stride;for(let u=0,p=this.stride;u<p;u++)this.array[r+u]=i.array[n+u];return this},set:function(r,i){return i===void 0&&(i=0),this.array.set(r,i),this},clone:function(r){r.arrayBuffers===void 0&&(r.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=fr.generateUUID()),r.arrayBuffers[this.array.buffer._uuid]===void 0&&(r.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const i=new this.array.constructor(r.arrayBuffers[this.array.buffer._uuid]),n=new Ko(i,this.stride);return n.setUsage(this.usage),n},onUpload:function(r){return this.onUploadCallback=r,this},toJSON:function(r){return r.arrayBuffers===void 0&&(r.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=fr.generateUUID()),r.arrayBuffers[this.array.buffer._uuid]===void 0&&(r.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}});const $f=new De;function Ih(r,i,n,u){this.name="",this.data=r,this.itemSize=i,this.offset=n,this.normalized=u===!0}Object.defineProperties(Ih.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}},needsUpdate:{set:function(r){this.data.needsUpdate=r}}}),Object.assign(Ih.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(r){for(let i=0,n=this.data.count;i<n;i++)$f.x=this.getX(i),$f.y=this.getY(i),$f.z=this.getZ(i),$f.applyMatrix4(r),this.setXYZ(i,$f.x,$f.y,$f.z);return this},setX:function(r,i){return this.data.array[r*this.data.stride+this.offset]=i,this},setY:function(r,i){return this.data.array[r*this.data.stride+this.offset+1]=i,this},setZ:function(r,i){return this.data.array[r*this.data.stride+this.offset+2]=i,this},setW:function(r,i){return this.data.array[r*this.data.stride+this.offset+3]=i,this},getX:function(r){return this.data.array[r*this.data.stride+this.offset]},getY:function(r){return this.data.array[r*this.data.stride+this.offset+1]},getZ:function(r){return this.data.array[r*this.data.stride+this.offset+2]},getW:function(r){return this.data.array[r*this.data.stride+this.offset+3]},setXY:function(r,i,n){return r=r*this.data.stride+this.offset,this.data.array[r+0]=i,this.data.array[r+1]=n,this},setXYZ:function(r,i,n,u){return r=r*this.data.stride+this.offset,this.data.array[r+0]=i,this.data.array[r+1]=n,this.data.array[r+2]=u,this},setXYZW:function(r,i,n,u,p){return r=r*this.data.stride+this.offset,this.data.array[r+0]=i,this.data.array[r+1]=n,this.data.array[r+2]=u,this.data.array[r+3]=p,this},clone:function(r){if(r===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const i=[];for(let n=0;n<this.count;n++){const u=n*this.data.stride+this.offset;for(let p=0;p<this.itemSize;p++)i.push(this.data.array[u+p])}return new sr(new this.array.constructor(i),this.itemSize,this.normalized)}else return r.interleavedBuffers===void 0&&(r.interleavedBuffers={}),r.interleavedBuffers[this.data.uuid]===void 0&&(r.interleavedBuffers[this.data.uuid]=this.data.clone(r)),new Ih(r.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)},toJSON:function(r){if(r===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const i=[];for(let n=0;n<this.count;n++){const u=n*this.data.stride+this.offset;for(let p=0;p<this.itemSize;p++)i.push(this.data.array[u+p])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:i,normalized:this.normalized}}else return r.interleavedBuffers===void 0&&(r.interleavedBuffers={}),r.interleavedBuffers[this.data.uuid]===void 0&&(r.interleavedBuffers[this.data.uuid]=this.data.toJSON(r)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}});function Kf(r){Yi.call(this),this.type="SpriteMaterial",this.color=new Mi(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(r)}Kf.prototype=Object.create(Yi.prototype),Kf.prototype.constructor=Kf,Kf.prototype.isSpriteMaterial=!0,Kf.prototype.copy=function(r){return Yi.prototype.copy.call(this,r),this.color.copy(r.color),this.map=r.map,this.alphaMap=r.alphaMap,this.rotation=r.rotation,this.sizeAttenuation=r.sizeAttenuation,this};let Sp;const Mg=new De,Ep=new De,Tp=new De,Ap=new vn,Sg=new vn,aS=new yr,l0=new De,Eg=new De,c0=new De,oS=new vn,nw=new vn,lS=new vn;function cS(r){if(Ni.call(this),this.type="Sprite",Sp===void 0){Sp=new hs;const i=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new Ko(i,5);Sp.setIndex([0,1,2,0,2,3]),Sp.setAttribute("position",new Ih(n,3,0,!1)),Sp.setAttribute("uv",new Ih(n,2,3,!1))}this.geometry=Sp,this.material=r!==void 0?r:new Kf,this.center=new vn(.5,.5)}cS.prototype=Object.assign(Object.create(Ni.prototype),{constructor:cS,isSprite:!0,raycast:function(r,i){r.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Ep.setFromMatrixScale(this.matrixWorld),aS.copy(r.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(r.camera.matrixWorldInverse,this.matrixWorld),Tp.setFromMatrixPosition(this.modelViewMatrix),r.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Ep.multiplyScalar(-Tp.z);const n=this.material.rotation;let u,p;n!==0&&(p=Math.cos(n),u=Math.sin(n));const g=this.center;u0(l0.set(-.5,-.5,0),Tp,g,Ep,u,p),u0(Eg.set(.5,-.5,0),Tp,g,Ep,u,p),u0(c0.set(.5,.5,0),Tp,g,Ep,u,p),oS.set(0,0),nw.set(1,0),lS.set(1,1);let b=r.ray.intersectTriangle(l0,Eg,c0,!1,Mg);if(b===null&&(u0(Eg.set(-.5,.5,0),Tp,g,Ep,u,p),nw.set(0,1),b=r.ray.intersectTriangle(l0,c0,Eg,!1,Mg),b===null))return;const M=r.ray.origin.distanceTo(Mg);M<r.near||M>r.far||i.push({distance:M,point:Mg.clone(),uv:xa.getUV(Mg,l0,Eg,c0,oS,nw,lS,new vn),face:null,object:this})},copy:function(r){return Ni.prototype.copy.call(this,r),r.center!==void 0&&this.center.copy(r.center),this.material=r.material,this}});function u0(r,i,n,u,p,g){Ap.subVectors(r,n).addScalar(.5).multiply(u),p!==void 0?(Sg.x=g*Ap.x-p*Ap.y,Sg.y=p*Ap.x+g*Ap.y):Sg.copy(Ap),r.copy(i),r.x+=Sg.x,r.y+=Sg.y,r.applyMatrix4(aS)}const h0=new De,uS=new De;function iw(){Ni.call(this),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}iw.prototype=Object.assign(Object.create(Ni.prototype),{constructor:iw,isLOD:!0,copy:function(r){Ni.prototype.copy.call(this,r,!1);const i=r.levels;for(let n=0,u=i.length;n<u;n++){const p=i[n];this.addLevel(p.object.clone(),p.distance)}return this.autoUpdate=r.autoUpdate,this},addLevel:function(r,i){i===void 0&&(i=0),i=Math.abs(i);const n=this.levels;let u;for(u=0;u<n.length&&!(i<n[u].distance);u++);return n.splice(u,0,{distance:i,object:r}),this.add(r),this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function(r){const i=this.levels;if(i.length>0){let n,u;for(n=1,u=i.length;n<u&&!(r<i[n].distance);n++);return i[n-1].object}return null},raycast:function(r,i){if(this.levels.length>0){h0.setFromMatrixPosition(this.matrixWorld);const u=r.ray.origin.distanceTo(h0);this.getObjectForDistance(u).raycast(r,i)}},update:function(r){const i=this.levels;if(i.length>1){h0.setFromMatrixPosition(r.matrixWorld),uS.setFromMatrixPosition(this.matrixWorld);const n=h0.distanceTo(uS)/r.zoom;i[0].object.visible=!0;let u,p;for(u=1,p=i.length;u<p&&n>=i[u].distance;u++)i[u-1].object.visible=!1,i[u].object.visible=!0;for(this._currentLevel=u-1;u<p;u++)i[u].object.visible=!1}},toJSON:function(r){const i=Ni.prototype.toJSON.call(this,r);this.autoUpdate===!1&&(i.object.autoUpdate=!1),i.object.levels=[];const n=this.levels;for(let u=0,p=n.length;u<p;u++){const g=n[u];i.object.levels.push({object:g.object.uuid,distance:g.distance})}return i}});function f0(r,i){r&&r.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),Ca.call(this,r,i),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new yr,this.bindMatrixInverse=new yr}f0.prototype=Object.assign(Object.create(Ca.prototype),{constructor:f0,isSkinnedMesh:!0,copy:function(r){return Ca.prototype.copy.call(this,r),this.bindMode=r.bindMode,this.bindMatrix.copy(r.bindMatrix),this.bindMatrixInverse.copy(r.bindMatrixInverse),this.skeleton=r.skeleton,this},bind:function(r,i){this.skeleton=r,i===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),i=this.matrixWorld),this.bindMatrix.copy(i),this.bindMatrixInverse.getInverse(i)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){const r=new vs,i=this.geometry.attributes.skinWeight;for(let n=0,u=i.count;n<u;n++){r.x=i.getX(n),r.y=i.getY(n),r.z=i.getZ(n),r.w=i.getW(n);const p=1/r.manhattanLength();p!==1/0?r.multiplyScalar(p):r.set(1,0,0,0),i.setXYZW(n,r.x,r.y,r.z,r.w)}},updateMatrixWorld:function(r){Ca.prototype.updateMatrixWorld.call(this,r),this.bindMode==="attached"?this.bindMatrixInverse.getInverse(this.matrixWorld):this.bindMode==="detached"?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},boneTransform:function(){const r=new De,i=new vs,n=new vs,u=new De,p=new yr;return function(g,b){const M=this.skeleton,A=this.geometry;i.fromBufferAttribute(A.attributes.skinIndex,g),n.fromBufferAttribute(A.attributes.skinWeight,g),r.fromBufferAttribute(A.attributes.position,g).applyMatrix4(this.bindMatrix),b.set(0,0,0);for(let C=0;C<4;C++){const F=n.getComponent(C);if(F!==0){const O=i.getComponent(C);p.multiplyMatrices(M.bones[O].matrixWorld,M.boneInverses[O]),b.addScaledVector(u.copy(r).applyMatrix4(p),F)}}return b.applyMatrix4(this.bindMatrixInverse)}}()});const hS=new yr,tT=new yr;function d0(r,i){if(r=r||[],this.bones=r.slice(0),this.boneMatrices=new Float32Array(this.bones.length*16),this.frame=-1,i===void 0)this.calculateInverses();else if(this.bones.length===i.length)this.boneInverses=i.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(let n=0,u=this.bones.length;n<u;n++)this.boneInverses.push(new yr)}}Object.assign(d0.prototype,{calculateInverses:function(){this.boneInverses=[];for(let r=0,i=this.bones.length;r<i;r++){const n=new yr;this.bones[r]&&n.getInverse(this.bones[r].matrixWorld),this.boneInverses.push(n)}},pose:function(){for(let r=0,i=this.bones.length;r<i;r++){const n=this.bones[r];n&&n.matrixWorld.getInverse(this.boneInverses[r])}for(let r=0,i=this.bones.length;r<i;r++){const n=this.bones[r];n&&(n.parent&&n.parent.isBone?(n.matrix.getInverse(n.parent.matrixWorld),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}},update:function(){const r=this.bones,i=this.boneInverses,n=this.boneMatrices,u=this.boneTexture;for(let p=0,g=r.length;p<g;p++){const b=r[p]?r[p].matrixWorld:tT;hS.multiplyMatrices(b,i[p]),hS.toArray(n,p*16)}u!==void 0&&(u.needsUpdate=!0)},clone:function(){return new d0(this.bones,this.boneInverses)},getBoneByName:function(r){for(let i=0,n=this.bones.length;i<n;i++){const u=this.bones[i];if(u.name===r)return u}},dispose:function(){this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=void 0)}});function rw(){Ni.call(this),this.type="Bone"}rw.prototype=Object.assign(Object.create(Ni.prototype),{constructor:rw,isBone:!0});const fS=new yr,dS=new yr,p0=[],Tg=new Ca;function pS(r,i,n){Ca.call(this,r,i),this.instanceMatrix=new sr(new Float32Array(n*16),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1}pS.prototype=Object.assign(Object.create(Ca.prototype),{constructor:pS,isInstancedMesh:!0,copy:function(r){return Ca.prototype.copy.call(this,r),this.instanceMatrix.copy(r.instanceMatrix),this.count=r.count,this},setColorAt:function(r,i){this.instanceColor===null&&(this.instanceColor=new sr(new Float32Array(this.count*3),3)),i.toArray(this.instanceColor.array,r*3)},getMatrixAt:function(r,i){i.fromArray(this.instanceMatrix.array,r*16)},raycast:function(r,i){const n=this.matrixWorld,u=this.count;if(Tg.geometry=this.geometry,Tg.material=this.material,Tg.material!==void 0)for(let p=0;p<u;p++){this.getMatrixAt(p,fS),dS.multiplyMatrices(n,fS),Tg.matrixWorld=dS,Tg.raycast(r,p0);for(let g=0,b=p0.length;g<b;g++){const M=p0[g];M.instanceId=p,M.object=this,i.push(M)}p0.length=0}},setMatrixAt:function(r,i){i.toArray(this.instanceMatrix.array,r*16)},updateMorphTargets:function(){}});function Qo(r){Yi.call(this),this.type="LineBasicMaterial",this.color=new Mi(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.morphTargets=!1,this.setValues(r)}Qo.prototype=Object.create(Yi.prototype),Qo.prototype.constructor=Qo,Qo.prototype.isLineBasicMaterial=!0,Qo.prototype.copy=function(r){return Yi.prototype.copy.call(this,r),this.color.copy(r.color),this.linewidth=r.linewidth,this.linecap=r.linecap,this.linejoin=r.linejoin,this.morphTargets=r.morphTargets,this};const mS=new De,gS=new De,vS=new yr,m0=new Mu,g0=new zl;function Qf(r,i,n){n===1&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),Ni.call(this),this.type="Line",this.geometry=r!==void 0?r:new hs,this.material=i!==void 0?i:new Qo,this.updateMorphTargets()}Qf.prototype=Object.assign(Object.create(Ni.prototype),{constructor:Qf,isLine:!0,copy:function(r){return Ni.prototype.copy.call(this,r),this.material=r.material,this.geometry=r.geometry,this},computeLineDistances:function(){const r=this.geometry;if(r.isBufferGeometry)if(r.index===null){const i=r.attributes.position,n=[0];for(let u=1,p=i.count;u<p;u++)mS.fromBufferAttribute(i,u-1),gS.fromBufferAttribute(i,u),n[u]=n[u-1],n[u]+=mS.distanceTo(gS);r.setAttribute("lineDistance",new is(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(r.isGeometry){const i=r.vertices,n=r.lineDistances;n[0]=0;for(let u=1,p=i.length;u<p;u++)n[u]=n[u-1],n[u]+=i[u-1].distanceTo(i[u])}return this},raycast:function(r,i){const n=this.geometry,u=this.matrixWorld,p=r.params.Line.threshold;if(n.boundingSphere===null&&n.computeBoundingSphere(),g0.copy(n.boundingSphere),g0.applyMatrix4(u),g0.radius+=p,r.ray.intersectsSphere(g0)===!1)return;vS.getInverse(u),m0.copy(r.ray).applyMatrix4(vS);const g=p/((this.scale.x+this.scale.y+this.scale.z)/3),b=g*g,M=new De,A=new De,C=new De,F=new De,O=this.isLineSegments?2:1;if(n.isBufferGeometry){const k=n.index,X=n.attributes.position;if(k!==null){const ne=k.array;for(let te=0,j=ne.length-1;te<j;te+=O){const W=ne[te],Pe=ne[te+1];if(M.fromBufferAttribute(X,W),A.fromBufferAttribute(X,Pe),m0.distanceSqToSegment(M,A,F,C)>b)continue;F.applyMatrix4(this.matrixWorld);const Ne=r.ray.origin.distanceTo(F);Ne<r.near||Ne>r.far||i.push({distance:Ne,point:C.clone().applyMatrix4(this.matrixWorld),index:te,face:null,faceIndex:null,object:this})}}else for(let ne=0,te=X.count-1;ne<te;ne+=O){if(M.fromBufferAttribute(X,ne),A.fromBufferAttribute(X,ne+1),m0.distanceSqToSegment(M,A,F,C)>b)continue;F.applyMatrix4(this.matrixWorld);const W=r.ray.origin.distanceTo(F);W<r.near||W>r.far||i.push({distance:W,point:C.clone().applyMatrix4(this.matrixWorld),index:ne,face:null,faceIndex:null,object:this})}}else if(n.isGeometry){const k=n.vertices,N=k.length;for(let X=0;X<N-1;X+=O){if(m0.distanceSqToSegment(k[X],k[X+1],F,C)>b)continue;F.applyMatrix4(this.matrixWorld);const te=r.ray.origin.distanceTo(F);te<r.near||te>r.far||i.push({distance:te,point:C.clone().applyMatrix4(this.matrixWorld),index:X,face:null,faceIndex:null,object:this})}}},updateMorphTargets:function(){const r=this.geometry;if(r.isBufferGeometry){const i=r.morphAttributes,n=Object.keys(i);if(n.length>0){const u=i[n[0]];if(u!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let p=0,g=u.length;p<g;p++){const b=u[p].name||String(p);this.morphTargetInfluences.push(0),this.morphTargetDictionary[b]=p}}}}else{const i=r.morphTargets;i!==void 0&&i.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});const v0=new De,y0=new De;function Ag(r,i){Qf.call(this,r,i),this.type="LineSegments"}Ag.prototype=Object.assign(Object.create(Qf.prototype),{constructor:Ag,isLineSegments:!0,computeLineDistances:function(){const r=this.geometry;if(r.isBufferGeometry)if(r.index===null){const i=r.attributes.position,n=[];for(let u=0,p=i.count;u<p;u+=2)v0.fromBufferAttribute(i,u),y0.fromBufferAttribute(i,u+1),n[u]=u===0?0:n[u-1],n[u+1]=n[u]+v0.distanceTo(y0);r.setAttribute("lineDistance",new is(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(r.isGeometry){const i=r.vertices,n=r.lineDistances;for(let u=0,p=i.length;u<p;u+=2)v0.copy(i[u]),y0.copy(i[u+1]),n[u]=u===0?0:n[u-1],n[u+1]=n[u]+v0.distanceTo(y0)}return this}});function sw(r,i){Qf.call(this,r,i),this.type="LineLoop"}sw.prototype=Object.assign(Object.create(Qf.prototype),{constructor:sw,isLineLoop:!0});function Nh(r){Yi.call(this),this.type="PointsMaterial",this.color=new Mi(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(r)}Nh.prototype=Object.create(Yi.prototype),Nh.prototype.constructor=Nh,Nh.prototype.isPointsMaterial=!0,Nh.prototype.copy=function(r){return Yi.prototype.copy.call(this,r),this.color.copy(r.color),this.map=r.map,this.alphaMap=r.alphaMap,this.size=r.size,this.sizeAttenuation=r.sizeAttenuation,this.morphTargets=r.morphTargets,this};const yS=new yr,aw=new Mu,x0=new zl,_0=new De;function ow(r,i){Ni.call(this),this.type="Points",this.geometry=r!==void 0?r:new hs,this.material=i!==void 0?i:new Nh,this.updateMorphTargets()}ow.prototype=Object.assign(Object.create(Ni.prototype),{constructor:ow,isPoints:!0,copy:function(r){return Ni.prototype.copy.call(this,r),this.material=r.material,this.geometry=r.geometry,this},raycast:function(r,i){const n=this.geometry,u=this.matrixWorld,p=r.params.Points.threshold;if(n.boundingSphere===null&&n.computeBoundingSphere(),x0.copy(n.boundingSphere),x0.applyMatrix4(u),x0.radius+=p,r.ray.intersectsSphere(x0)===!1)return;yS.getInverse(u),aw.copy(r.ray).applyMatrix4(yS);const g=p/((this.scale.x+this.scale.y+this.scale.z)/3),b=g*g;if(n.isBufferGeometry){const M=n.index,C=n.attributes.position;if(M!==null){const F=M.array;for(let O=0,k=F.length;O<k;O++){const N=F[O];_0.fromBufferAttribute(C,N),lw(_0,N,b,u,r,i,this)}}else for(let F=0,O=C.count;F<O;F++)_0.fromBufferAttribute(C,F),lw(_0,F,b,u,r,i,this)}else{const M=n.vertices;for(let A=0,C=M.length;A<C;A++)lw(M[A],A,b,u,r,i,this)}},updateMorphTargets:function(){const r=this.geometry;if(r.isBufferGeometry){const i=r.morphAttributes,n=Object.keys(i);if(n.length>0){const u=i[n[0]];if(u!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let p=0,g=u.length;p<g;p++){const b=u[p].name||String(p);this.morphTargetInfluences.push(0),this.morphTargetDictionary[b]=p}}}}else{const i=r.morphTargets;i!==void 0&&i.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});function lw(r,i,n,u,p,g,b){const M=aw.distanceSqToPoint(r);if(M<n){const A=new De;aw.closestPointToPoint(r,A),A.applyMatrix4(u);const C=p.ray.origin.distanceTo(A);if(C<p.near||C>p.far)return;g.push({distance:C,distanceToRay:Math.sqrt(M),point:A,index:i,face:null,object:b})}}function xS(r,i,n,u,p,g,b,M,A){gs.call(this,r,i,n,u,p,g,b,M,A),this.format=b!==void 0?b:Or,this.minFilter=g!==void 0?g:ti,this.magFilter=p!==void 0?p:ti,this.generateMipmaps=!1;const C=this;function F(){C.needsUpdate=!0,r.requestVideoFrameCallback(F)}"requestVideoFrameCallback"in r&&r.requestVideoFrameCallback(F)}xS.prototype=Object.assign(Object.create(gs.prototype),{constructor:xS,isVideoTexture:!0,update:function(){const r=this.image;"requestVideoFrameCallback"in r===!1&&r.readyState>=r.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}});function Lg(r,i,n,u,p,g,b,M,A,C,F,O){gs.call(this,null,g,b,M,A,C,u,p,F,O),this.image={width:i,height:n},this.mipmaps=r,this.flipY=!1,this.generateMipmaps=!1}Lg.prototype=Object.create(gs.prototype),Lg.prototype.constructor=Lg,Lg.prototype.isCompressedTexture=!0;function Cg(r,i,n,u,p,g,b,M,A){gs.call(this,r,i,n,u,p,g,b,M,A),this.needsUpdate=!0}Cg.prototype=Object.create(gs.prototype),Cg.prototype.constructor=Cg,Cg.prototype.isCanvasTexture=!0;function b0(r,i,n,u,p,g,b,M,A,C){if(C=C!==void 0?C:hu,C!==hu&&C!==dl)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");n===void 0&&C===hu&&(n=ha),n===void 0&&C===dl&&(n=ah),gs.call(this,null,u,p,g,b,M,C,n,A),this.image={width:r,height:i},this.magFilter=b!==void 0?b:Kr,this.minFilter=M!==void 0?M:Kr,this.flipY=!1,this.generateMipmaps=!1}b0.prototype=Object.create(gs.prototype),b0.prototype.constructor=b0,b0.prototype.isDepthTexture=!0;let nT=0;const zc=new yr,cw=new Ni,w0=new De;function Zl(){Object.defineProperty(this,"id",{value:nT+=2}),this.uuid=fr.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}Zl.prototype=Object.assign(Object.create(go.prototype),{constructor:Zl,isGeometry:!0,applyMatrix4:function(r){const i=new Ja().getNormalMatrix(r);for(let n=0,u=this.vertices.length;n<u;n++)this.vertices[n].applyMatrix4(r);for(let n=0,u=this.faces.length;n<u;n++){const p=this.faces[n];p.normal.applyMatrix3(i).normalize();for(let g=0,b=p.vertexNormals.length;g<b;g++)p.vertexNormals[g].applyMatrix3(i).normalize()}return this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(r){return zc.makeRotationX(r),this.applyMatrix4(zc),this},rotateY:function(r){return zc.makeRotationY(r),this.applyMatrix4(zc),this},rotateZ:function(r){return zc.makeRotationZ(r),this.applyMatrix4(zc),this},translate:function(r,i,n){return zc.makeTranslation(r,i,n),this.applyMatrix4(zc),this},scale:function(r,i,n){return zc.makeScale(r,i,n),this.applyMatrix4(zc),this},lookAt:function(r){return cw.lookAt(r),cw.updateMatrix(),this.applyMatrix4(cw.matrix),this},fromBufferGeometry:function(r){const i=this,n=r.index!==null?r.index:void 0,u=r.attributes;if(u.position===void 0)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;const p=u.position,g=u.normal,b=u.color,M=u.uv,A=u.uv2;A!==void 0&&(this.faceVertexUvs[1]=[]);for(let O=0;O<p.count;O++)i.vertices.push(new De().fromBufferAttribute(p,O)),b!==void 0&&i.colors.push(new Mi().fromBufferAttribute(b,O));function C(O,k,N,X){const ne=b===void 0?[]:[i.colors[O].clone(),i.colors[k].clone(),i.colors[N].clone()],te=g===void 0?[]:[new De().fromBufferAttribute(g,O),new De().fromBufferAttribute(g,k),new De().fromBufferAttribute(g,N)],j=new Yd(O,k,N,te,ne,X);i.faces.push(j),M!==void 0&&i.faceVertexUvs[0].push([new vn().fromBufferAttribute(M,O),new vn().fromBufferAttribute(M,k),new vn().fromBufferAttribute(M,N)]),A!==void 0&&i.faceVertexUvs[1].push([new vn().fromBufferAttribute(A,O),new vn().fromBufferAttribute(A,k),new vn().fromBufferAttribute(A,N)])}const F=r.groups;if(F.length>0)for(let O=0;O<F.length;O++){const k=F[O],N=k.start,X=k.count;for(let ne=N,te=N+X;ne<te;ne+=3)n!==void 0?C(n.getX(ne),n.getX(ne+1),n.getX(ne+2),k.materialIndex):C(ne,ne+1,ne+2,k.materialIndex)}else if(n!==void 0)for(let O=0;O<n.count;O+=3)C(n.getX(O),n.getX(O+1),n.getX(O+2));else for(let O=0;O<p.count;O+=3)C(O,O+1,O+2);return this.computeFaceNormals(),r.boundingBox!==null&&(this.boundingBox=r.boundingBox.clone()),r.boundingSphere!==null&&(this.boundingSphere=r.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(w0).negate(),this.translate(w0.x,w0.y,w0.z),this},normalize:function(){this.computeBoundingSphere();const r=this.boundingSphere.center,i=this.boundingSphere.radius,n=i===0?1:1/i,u=new yr;return u.set(n,0,0,-n*r.x,0,n,0,-n*r.y,0,0,n,-n*r.z,0,0,0,1),this.applyMatrix4(u),this},computeFaceNormals:function(){const r=new De,i=new De;for(let n=0,u=this.faces.length;n<u;n++){const p=this.faces[n],g=this.vertices[p.a],b=this.vertices[p.b],M=this.vertices[p.c];r.subVectors(M,b),i.subVectors(g,b),r.cross(i),r.normalize(),p.normal.copy(r)}},computeVertexNormals:function(r){r===void 0&&(r=!0);const i=new Array(this.vertices.length);for(let n=0,u=this.vertices.length;n<u;n++)i[n]=new De;if(r){const n=new De,u=new De;for(let p=0,g=this.faces.length;p<g;p++){const b=this.faces[p],M=this.vertices[b.a],A=this.vertices[b.b],C=this.vertices[b.c];n.subVectors(C,A),u.subVectors(M,A),n.cross(u),i[b.a].add(n),i[b.b].add(n),i[b.c].add(n)}}else{this.computeFaceNormals();for(let n=0,u=this.faces.length;n<u;n++){const p=this.faces[n];i[p.a].add(p.normal),i[p.b].add(p.normal),i[p.c].add(p.normal)}}for(let n=0,u=this.vertices.length;n<u;n++)i[n].normalize();for(let n=0,u=this.faces.length;n<u;n++){const p=this.faces[n],g=p.vertexNormals;g.length===3?(g[0].copy(i[p.a]),g[1].copy(i[p.b]),g[2].copy(i[p.c])):(g[0]=i[p.a].clone(),g[1]=i[p.b].clone(),g[2]=i[p.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){this.computeFaceNormals();for(let r=0,i=this.faces.length;r<i;r++){const n=this.faces[r],u=n.vertexNormals;u.length===3?(u[0].copy(n.normal),u[1].copy(n.normal),u[2].copy(n.normal)):(u[0]=n.normal.clone(),u[1]=n.normal.clone(),u[2]=n.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){for(let i=0,n=this.faces.length;i<n;i++){const u=this.faces[i];u.__originalFaceNormal?u.__originalFaceNormal.copy(u.normal):u.__originalFaceNormal=u.normal.clone(),u.__originalVertexNormals||(u.__originalVertexNormals=[]);for(let p=0,g=u.vertexNormals.length;p<g;p++)u.__originalVertexNormals[p]?u.__originalVertexNormals[p].copy(u.vertexNormals[p]):u.__originalVertexNormals[p]=u.vertexNormals[p].clone()}const r=new Zl;r.faces=this.faces;for(let i=0,n=this.morphTargets.length;i<n;i++){if(!this.morphNormals[i]){this.morphNormals[i]={},this.morphNormals[i].faceNormals=[],this.morphNormals[i].vertexNormals=[];const p=this.morphNormals[i].faceNormals,g=this.morphNormals[i].vertexNormals;for(let b=0,M=this.faces.length;b<M;b++){const A=new De,C={a:new De,b:new De,c:new De};p.push(A),g.push(C)}}const u=this.morphNormals[i];r.vertices=this.morphTargets[i].vertices,r.computeFaceNormals(),r.computeVertexNormals();for(let p=0,g=this.faces.length;p<g;p++){const b=this.faces[p],M=u.faceNormals[p],A=u.vertexNormals[p];M.copy(b.normal),A.a.copy(b.vertexNormals[0]),A.b.copy(b.vertexNormals[1]),A.c.copy(b.vertexNormals[2])}}for(let i=0,n=this.faces.length;i<n;i++){const u=this.faces[i];u.normal=u.__originalFaceNormal,u.vertexNormals=u.__originalVertexNormals}},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new Ps),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){this.boundingSphere===null&&(this.boundingSphere=new zl),this.boundingSphere.setFromPoints(this.vertices)},merge:function(r,i,n){if(!(r&&r.isGeometry)){console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",r);return}let u;const p=this.vertices.length,g=this.vertices,b=r.vertices,M=this.faces,A=r.faces,C=this.colors,F=r.colors;n===void 0&&(n=0),i!==void 0&&(u=new Ja().getNormalMatrix(i));for(let O=0,k=b.length;O<k;O++){const X=b[O].clone();i!==void 0&&X.applyMatrix4(i),g.push(X)}for(let O=0,k=F.length;O<k;O++)C.push(F[O].clone());for(let O=0,k=A.length;O<k;O++){const N=A[O];let X,ne;const te=N.vertexNormals,j=N.vertexColors,W=new Yd(N.a+p,N.b+p,N.c+p);W.normal.copy(N.normal),u!==void 0&&W.normal.applyMatrix3(u).normalize();for(let Pe=0,Re=te.length;Pe<Re;Pe++)X=te[Pe].clone(),u!==void 0&&X.applyMatrix3(u).normalize(),W.vertexNormals.push(X);W.color.copy(N.color);for(let Pe=0,Re=j.length;Pe<Re;Pe++)ne=j[Pe],W.vertexColors.push(ne.clone());W.materialIndex=N.materialIndex+n,M.push(W)}for(let O=0,k=r.faceVertexUvs.length;O<k;O++){const N=r.faceVertexUvs[O];this.faceVertexUvs[O]===void 0&&(this.faceVertexUvs[O]=[]);for(let X=0,ne=N.length;X<ne;X++){const te=N[X],j=[];for(let W=0,Pe=te.length;W<Pe;W++)j.push(te[W].clone());this.faceVertexUvs[O].push(j)}}},mergeMesh:function(r){if(!(r&&r.isMesh)){console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",r);return}r.matrixAutoUpdate&&r.updateMatrix(),this.merge(r.geometry,r.matrix)},mergeVertices:function(){const r={},i=[],n=[],p=Math.pow(10,4);for(let M=0,A=this.vertices.length;M<A;M++){const C=this.vertices[M],F=Math.round(C.x*p)+"_"+Math.round(C.y*p)+"_"+Math.round(C.z*p);r[F]===void 0?(r[F]=M,i.push(this.vertices[M]),n[M]=i.length-1):n[M]=n[r[F]]}const g=[];for(let M=0,A=this.faces.length;M<A;M++){const C=this.faces[M];C.a=n[C.a],C.b=n[C.b],C.c=n[C.c];const F=[C.a,C.b,C.c];for(let O=0;O<3;O++)if(F[O]===F[(O+1)%3]){g.push(M);break}}for(let M=g.length-1;M>=0;M--){const A=g[M];this.faces.splice(A,1);for(let C=0,F=this.faceVertexUvs.length;C<F;C++)this.faceVertexUvs[C].splice(A,1)}const b=this.vertices.length-i.length;return this.vertices=i,b},setFromPoints:function(r){this.vertices=[];for(let i=0,n=r.length;i<n;i++){const u=r[i];this.vertices.push(new De(u.x,u.y,u.z||0))}return this},sortFacesByMaterialIndex:function(){const r=this.faces,i=r.length;for(let M=0;M<i;M++)r[M]._id=M;function n(M,A){return M.materialIndex-A.materialIndex}r.sort(n);const u=this.faceVertexUvs[0],p=this.faceVertexUvs[1];let g,b;u&&u.length===i&&(g=[]),p&&p.length===i&&(b=[]);for(let M=0;M<i;M++){const A=r[M]._id;g&&g.push(u[A]),b&&b.push(p[A])}g&&(this.faceVertexUvs[0]=g),b&&(this.faceVertexUvs[1]=b)},toJSON:function(){const r={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.parameters!==void 0){const N=this.parameters;for(const X in N)N[X]!==void 0&&(r[X]=N[X]);return r}const i=[];for(let N=0;N<this.vertices.length;N++){const X=this.vertices[N];i.push(X.x,X.y,X.z)}const n=[],u=[],p={},g=[],b={},M=[],A={};for(let N=0;N<this.faces.length;N++){const X=this.faces[N],ne=!0,te=!1,j=this.faceVertexUvs[0][N]!==void 0,W=X.normal.length()>0,Pe=X.vertexNormals.length>0,Re=X.color.r!==1||X.color.g!==1||X.color.b!==1,Ne=X.vertexColors.length>0;let de=0;if(de=C(de,0,0),de=C(de,1,ne),de=C(de,2,te),de=C(de,3,j),de=C(de,4,W),de=C(de,5,Pe),de=C(de,6,Re),de=C(de,7,Ne),n.push(de),n.push(X.a,X.b,X.c),n.push(X.materialIndex),j){const $e=this.faceVertexUvs[0][N];n.push(k($e[0]),k($e[1]),k($e[2]))}if(W&&n.push(F(X.normal)),Pe){const $e=X.vertexNormals;n.push(F($e[0]),F($e[1]),F($e[2]))}if(Re&&n.push(O(X.color)),Ne){const $e=X.vertexColors;n.push(O($e[0]),O($e[1]),O($e[2]))}}function C(N,X,ne){return ne?N|1<<X:N&~(1<<X)}function F(N){const X=N.x.toString()+N.y.toString()+N.z.toString();return p[X]!==void 0||(p[X]=u.length/3,u.push(N.x,N.y,N.z)),p[X]}function O(N){const X=N.r.toString()+N.g.toString()+N.b.toString();return b[X]!==void 0||(b[X]=g.length,g.push(N.getHex())),b[X]}function k(N){const X=N.x.toString()+N.y.toString();return A[X]!==void 0||(A[X]=M.length/2,M.push(N.x,N.y)),A[X]}return r.data={},r.data.vertices=i,r.data.normals=u,g.length>0&&(r.data.colors=g),M.length>0&&(r.data.uvs=[M]),r.data.faces=n,r},clone:function(){return new Zl().copy(this)},copy:function(r){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=r.name;const i=r.vertices;for(let O=0,k=i.length;O<k;O++)this.vertices.push(i[O].clone());const n=r.colors;for(let O=0,k=n.length;O<k;O++)this.colors.push(n[O].clone());const u=r.faces;for(let O=0,k=u.length;O<k;O++)this.faces.push(u[O].clone());for(let O=0,k=r.faceVertexUvs.length;O<k;O++){const N=r.faceVertexUvs[O];this.faceVertexUvs[O]===void 0&&(this.faceVertexUvs[O]=[]);for(let X=0,ne=N.length;X<ne;X++){const te=N[X],j=[];for(let W=0,Pe=te.length;W<Pe;W++){const Re=te[W];j.push(Re.clone())}this.faceVertexUvs[O].push(j)}}const p=r.morphTargets;for(let O=0,k=p.length;O<k;O++){const N={};if(N.name=p[O].name,p[O].vertices!==void 0){N.vertices=[];for(let X=0,ne=p[O].vertices.length;X<ne;X++)N.vertices.push(p[O].vertices[X].clone())}if(p[O].normals!==void 0){N.normals=[];for(let X=0,ne=p[O].normals.length;X<ne;X++)N.normals.push(p[O].normals[X].clone())}this.morphTargets.push(N)}const g=r.morphNormals;for(let O=0,k=g.length;O<k;O++){const N={};if(g[O].vertexNormals!==void 0){N.vertexNormals=[];for(let X=0,ne=g[O].vertexNormals.length;X<ne;X++){const te=g[O].vertexNormals[X],j={};j.a=te.a.clone(),j.b=te.b.clone(),j.c=te.c.clone(),N.vertexNormals.push(j)}}if(g[O].faceNormals!==void 0){N.faceNormals=[];for(let X=0,ne=g[O].faceNormals.length;X<ne;X++)N.faceNormals.push(g[O].faceNormals[X].clone())}this.morphNormals.push(N)}const b=r.skinWeights;for(let O=0,k=b.length;O<k;O++)this.skinWeights.push(b[O].clone());const M=r.skinIndices;for(let O=0,k=M.length;O<k;O++)this.skinIndices.push(M[O].clone());const A=r.lineDistances;for(let O=0,k=A.length;O<k;O++)this.lineDistances.push(A[O]);const C=r.boundingBox;C!==null&&(this.boundingBox=C.clone());const F=r.boundingSphere;return F!==null&&(this.boundingSphere=F.clone()),this.elementsNeedUpdate=r.elementsNeedUpdate,this.verticesNeedUpdate=r.verticesNeedUpdate,this.uvsNeedUpdate=r.uvsNeedUpdate,this.normalsNeedUpdate=r.normalsNeedUpdate,this.colorsNeedUpdate=r.colorsNeedUpdate,this.lineDistancesNeedUpdate=r.lineDistancesNeedUpdate,this.groupsNeedUpdate=r.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),new De,new De,new De,new xa;const iT={triangulate:function(r,i,n){n=n||2;const u=i&&i.length,p=u?i[0]*n:r.length;let g=_S(r,0,p,n,!0);const b=[];if(!g||g.next===g.prev)return b;let M,A,C,F,O,k,N;if(u&&(g=lT(r,i,g,n)),r.length>80*n){M=C=r[0],A=F=r[1];for(let X=n;X<p;X+=n)O=r[X],k=r[X+1],O<M&&(M=O),k<A&&(A=k),O>C&&(C=O),k>F&&(F=k);N=Math.max(C-M,F-A),N=N!==0?1/N:0}return Pg(g,b,n,M,A,N),b}};function _S(r,i,n,u,p){let g,b;if(p===xT(r,i,n,u)>0)for(g=i;g<n;g+=u)b=MS(g,r[g],r[g+1],b);else for(g=n-u;g>=i;g-=u)b=MS(g,r[g],r[g+1],b);return b&&M0(b,b.next)&&(Dg(b),b=b.next),b}function Fh(r,i){if(!r)return r;i||(i=r);let n=r,u;do if(u=!1,!n.steiner&&(M0(n,n.next)||ea(n.prev,n,n.next)===0)){if(Dg(n),n=i=n.prev,n===n.next)break;u=!0}else n=n.next;while(u||n!==i);return i}function Pg(r,i,n,u,p,g,b){if(!r)return;!b&&g&&dT(r,u,p,g);let M=r,A,C;for(;r.prev!==r.next;){if(A=r.prev,C=r.next,g?sT(r,u,p,g):rT(r)){i.push(A.i/n),i.push(r.i/n),i.push(C.i/n),Dg(r),r=C.next,M=C.next;continue}if(r=C,r===M){b?b===1?(r=aT(Fh(r),i,n),Pg(r,i,n,u,p,g,2)):b===2&&oT(r,i,n,u,p,g):Pg(Fh(r),i,n,u,p,g,1);break}}}function rT(r){const i=r.prev,n=r,u=r.next;if(ea(i,n,u)>=0)return!1;let p=r.next.next;for(;p!==r.prev;){if(Lp(i.x,i.y,n.x,n.y,u.x,u.y,p.x,p.y)&&ea(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function sT(r,i,n,u){const p=r.prev,g=r,b=r.next;if(ea(p,g,b)>=0)return!1;const M=p.x<g.x?p.x<b.x?p.x:b.x:g.x<b.x?g.x:b.x,A=p.y<g.y?p.y<b.y?p.y:b.y:g.y<b.y?g.y:b.y,C=p.x>g.x?p.x>b.x?p.x:b.x:g.x>b.x?g.x:b.x,F=p.y>g.y?p.y>b.y?p.y:b.y:g.y>b.y?g.y:b.y,O=uw(M,A,i,n,u),k=uw(C,F,i,n,u);let N=r.prevZ,X=r.nextZ;for(;N&&N.z>=O&&X&&X.z<=k;){if(N!==r.prev&&N!==r.next&&Lp(p.x,p.y,g.x,g.y,b.x,b.y,N.x,N.y)&&ea(N.prev,N,N.next)>=0||(N=N.prevZ,X!==r.prev&&X!==r.next&&Lp(p.x,p.y,g.x,g.y,b.x,b.y,X.x,X.y)&&ea(X.prev,X,X.next)>=0))return!1;X=X.nextZ}for(;N&&N.z>=O;){if(N!==r.prev&&N!==r.next&&Lp(p.x,p.y,g.x,g.y,b.x,b.y,N.x,N.y)&&ea(N.prev,N,N.next)>=0)return!1;N=N.prevZ}for(;X&&X.z<=k;){if(X!==r.prev&&X!==r.next&&Lp(p.x,p.y,g.x,g.y,b.x,b.y,X.x,X.y)&&ea(X.prev,X,X.next)>=0)return!1;X=X.nextZ}return!0}function aT(r,i,n){let u=r;do{const p=u.prev,g=u.next.next;!M0(p,g)&&bS(p,u,u.next,g)&&Rg(p,g)&&Rg(g,p)&&(i.push(p.i/n),i.push(u.i/n),i.push(g.i/n),Dg(u),Dg(u.next),u=r=g),u=u.next}while(u!==r);return Fh(u)}function oT(r,i,n,u,p,g){let b=r;do{let M=b.next.next;for(;M!==b.prev;){if(b.i!==M.i&&gT(b,M)){let A=wS(b,M);b=Fh(b,b.next),A=Fh(A,A.next),Pg(b,i,n,u,p,g),Pg(A,i,n,u,p,g);return}M=M.next}b=b.next}while(b!==r)}function lT(r,i,n,u){const p=[];let g,b,M,A,C;for(g=0,b=i.length;g<b;g++)M=i[g]*u,A=g<b-1?i[g+1]*u:r.length,C=_S(r,M,A,u,!1),C===C.next&&(C.steiner=!0),p.push(mT(C));for(p.sort(cT),g=0;g<p.length;g++)uT(p[g],n),n=Fh(n,n.next);return n}function cT(r,i){return r.x-i.x}function uT(r,i){if(i=hT(r,i),i){const n=wS(i,r);Fh(i,i.next),Fh(n,n.next)}}function hT(r,i){let n=i;const u=r.x,p=r.y;let g=-1/0,b;do{if(p<=n.y&&p>=n.next.y&&n.next.y!==n.y){const k=n.x+(p-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(k<=u&&k>g){if(g=k,k===u){if(p===n.y)return n;if(p===n.next.y)return n.next}b=n.x<n.next.x?n:n.next}}n=n.next}while(n!==i);if(!b)return null;if(u===g)return b;const M=b,A=b.x,C=b.y;let F=1/0,O;n=b;do u>=n.x&&n.x>=A&&u!==n.x&&Lp(p<C?u:g,p,A,C,p<C?g:u,p,n.x,n.y)&&(O=Math.abs(p-n.y)/(u-n.x),Rg(n,r)&&(O<F||O===F&&(n.x>b.x||n.x===b.x&&fT(b,n)))&&(b=n,F=O)),n=n.next;while(n!==M);return b}function fT(r,i){return ea(r.prev,r,i.prev)<0&&ea(i.next,r,r.next)<0}function dT(r,i,n,u){let p=r;do p.z===null&&(p.z=uw(p.x,p.y,i,n,u)),p.prevZ=p.prev,p.nextZ=p.next,p=p.next;while(p!==r);p.prevZ.nextZ=null,p.prevZ=null,pT(p)}function pT(r){let i,n,u,p,g,b,M,A,C=1;do{for(n=r,r=null,g=null,b=0;n;){for(b++,u=n,M=0,i=0;i<C&&(M++,u=u.nextZ,!!u);i++);for(A=C;M>0||A>0&&u;)M!==0&&(A===0||!u||n.z<=u.z)?(p=n,n=n.nextZ,M--):(p=u,u=u.nextZ,A--),g?g.nextZ=p:r=p,p.prevZ=g,g=p;n=u}g.nextZ=null,C*=2}while(b>1);return r}function uw(r,i,n,u,p){return r=32767*(r-n)*p,i=32767*(i-u)*p,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,r|i<<1}function mT(r){let i=r,n=r;do(i.x<n.x||i.x===n.x&&i.y<n.y)&&(n=i),i=i.next;while(i!==r);return n}function Lp(r,i,n,u,p,g,b,M){return(p-b)*(i-M)-(r-b)*(g-M)>=0&&(r-b)*(u-M)-(n-b)*(i-M)>=0&&(n-b)*(g-M)-(p-b)*(u-M)>=0}function gT(r,i){return r.next.i!==i.i&&r.prev.i!==i.i&&!vT(r,i)&&(Rg(r,i)&&Rg(i,r)&&yT(r,i)&&(ea(r.prev,r,i.prev)||ea(r,i.prev,i))||M0(r,i)&&ea(r.prev,r,r.next)>0&&ea(i.prev,i,i.next)>0)}function ea(r,i,n){return(i.y-r.y)*(n.x-i.x)-(i.x-r.x)*(n.y-i.y)}function M0(r,i){return r.x===i.x&&r.y===i.y}function bS(r,i,n,u){const p=E0(ea(r,i,n)),g=E0(ea(r,i,u)),b=E0(ea(n,u,r)),M=E0(ea(n,u,i));return!!(p!==g&&b!==M||p===0&&S0(r,n,i)||g===0&&S0(r,u,i)||b===0&&S0(n,r,u)||M===0&&S0(n,i,u))}function S0(r,i,n){return i.x<=Math.max(r.x,n.x)&&i.x>=Math.min(r.x,n.x)&&i.y<=Math.max(r.y,n.y)&&i.y>=Math.min(r.y,n.y)}function E0(r){return r>0?1:r<0?-1:0}function vT(r,i){let n=r;do{if(n.i!==r.i&&n.next.i!==r.i&&n.i!==i.i&&n.next.i!==i.i&&bS(n,n.next,r,i))return!0;n=n.next}while(n!==r);return!1}function Rg(r,i){return ea(r.prev,r,r.next)<0?ea(r,i,r.next)>=0&&ea(r,r.prev,i)>=0:ea(r,i,r.prev)<0||ea(r,r.next,i)<0}function yT(r,i){let n=r,u=!1;const p=(r.x+i.x)/2,g=(r.y+i.y)/2;do n.y>g!=n.next.y>g&&n.next.y!==n.y&&p<(n.next.x-n.x)*(g-n.y)/(n.next.y-n.y)+n.x&&(u=!u),n=n.next;while(n!==r);return u}function wS(r,i){const n=new hw(r.i,r.x,r.y),u=new hw(i.i,i.x,i.y),p=r.next,g=i.prev;return r.next=i,i.prev=r,n.next=p,p.prev=n,u.next=n,n.prev=u,g.next=u,u.prev=g,u}function MS(r,i,n,u){const p=new hw(r,i,n);return u?(p.next=u.next,p.prev=u,u.next.prev=p,u.next=p):(p.prev=p,p.next=p),p}function Dg(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function hw(r,i,n){this.i=r,this.x=i,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function xT(r,i,n,u){let p=0;for(let g=i,b=n-u;g<n;g+=u)p+=(r[b]-r[g])*(r[g+1]+r[b+1]),b=g;return p}const Bh={area:function(r){const i=r.length;let n=0;for(let u=i-1,p=0;p<i;u=p++)n+=r[u].x*r[p].y-r[p].x*r[u].y;return n*.5},isClockWise:function(r){return Bh.area(r)<0},triangulateShape:function(r,i){const n=[],u=[],p=[];SS(r),ES(n,r);let g=r.length;i.forEach(SS);for(let M=0;M<i.length;M++)u.push(g),g+=i[M].length,ES(n,i[M]);const b=iT.triangulate(n,u);for(let M=0;M<b.length;M+=3)p.push(b.slice(M,M+3));return p}};function SS(r){const i=r.length;i>2&&r[i-1].equals(r[0])&&r.pop()}function ES(r,i){for(let n=0;n<i.length;n++)r.push(i[n].x),r.push(i[n].y)}class TS extends hs{constructor(i,n){super(),this.type="ExtrudeBufferGeometry",this.parameters={shapes:i,options:n},i=Array.isArray(i)?i:[i];const u=this,p=[],g=[];for(let M=0,A=i.length;M<A;M++){const C=i[M];b(C)}this.setAttribute("position",new is(p,3)),this.setAttribute("uv",new is(g,2)),this.computeVertexNormals();function b(M){const A=[],C=n.curveSegments!==void 0?n.curveSegments:12,F=n.steps!==void 0?n.steps:1;let O=n.depth!==void 0?n.depth:100,k=n.bevelEnabled!==void 0?n.bevelEnabled:!0,N=n.bevelThickness!==void 0?n.bevelThickness:6,X=n.bevelSize!==void 0?n.bevelSize:N-2,ne=n.bevelOffset!==void 0?n.bevelOffset:0,te=n.bevelSegments!==void 0?n.bevelSegments:3;const j=n.extrudePath,W=n.UVGenerator!==void 0?n.UVGenerator:_T;n.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),O=n.amount);let Pe,Re=!1,Ne,de,$e,Gt;j&&(Pe=j.getSpacedPoints(F),Re=!0,k=!1,Ne=j.computeFrenetFrames(F,!1),de=new De,$e=new De,Gt=new De),k||(te=0,N=0,X=0,ne=0);const dt=M.extractPoints(C);let an=dt.shape;const _t=dt.holes;if(!Bh.isClockWise(an)){an=an.reverse();for(let He=0,Je=_t.length;He<Je;He++){const ot=_t[He];Bh.isClockWise(ot)&&(_t[He]=ot.reverse())}}const rt=Bh.triangulateShape(an,_t),je=an;for(let He=0,Je=_t.length;He<Je;He++){const ot=_t[He];an=an.concat(ot)}function Ve(He,Je,ot){return Je||console.error("THREE.ExtrudeGeometry: vec does not exist"),Je.clone().multiplyScalar(ot).add(He)}const ht=an.length,ft=rt.length;function Wt(He,Je,ot){let bt,Mt,ue;const oe=He.x-Je.x,lt=He.y-Je.y,yt=ot.x-He.x,Ce=ot.y-He.y,Pt=oe*oe+lt*lt,Kt=oe*Ce-lt*yt;if(Math.abs(Kt)>Number.EPSILON){const qn=Math.sqrt(Pt),xn=Math.sqrt(yt*yt+Ce*Ce),Oe=Je.x-lt/qn,Ht=Je.y+oe/qn,Kn=ot.x-Ce/xn,hn=ot.y+yt/xn,jn=((Kn-Oe)*Ce-(hn-Ht)*yt)/(oe*Ce-lt*yt);bt=Oe+oe*jn-He.x,Mt=Ht+lt*jn-He.y;const er=bt*bt+Mt*Mt;if(er<=2)return new vn(bt,Mt);ue=Math.sqrt(er/2)}else{let qn=!1;oe>Number.EPSILON?yt>Number.EPSILON&&(qn=!0):oe<-Number.EPSILON?yt<-Number.EPSILON&&(qn=!0):Math.sign(lt)===Math.sign(Ce)&&(qn=!0),qn?(bt=-lt,Mt=oe,ue=Math.sqrt(Pt)):(bt=oe,Mt=lt,ue=Math.sqrt(Pt/2))}return new vn(bt/ue,Mt/ue)}const An=[];for(let He=0,Je=je.length,ot=Je-1,bt=He+1;He<Je;He++,ot++,bt++)ot===Je&&(ot=0),bt===Je&&(bt=0),An[He]=Wt(je[He],je[ot],je[bt]);const Vt=[];let Dn,Ci=An.concat();for(let He=0,Je=_t.length;He<Je;He++){const ot=_t[He];Dn=[];for(let bt=0,Mt=ot.length,ue=Mt-1,oe=bt+1;bt<Mt;bt++,ue++,oe++)ue===Mt&&(ue=0),oe===Mt&&(oe=0),Dn[bt]=Wt(ot[bt],ot[ue],ot[oe]);Vt.push(Dn),Ci=Ci.concat(Dn)}for(let He=0;He<te;He++){const Je=He/te,ot=N*Math.cos(Je*Math.PI/2),bt=X*Math.sin(Je*Math.PI/2)+ne;for(let Mt=0,ue=je.length;Mt<ue;Mt++){const oe=Ve(je[Mt],An[Mt],bt);me(oe.x,oe.y,-ot)}for(let Mt=0,ue=_t.length;Mt<ue;Mt++){const oe=_t[Mt];Dn=Vt[Mt];for(let lt=0,yt=oe.length;lt<yt;lt++){const Ce=Ve(oe[lt],Dn[lt],bt);me(Ce.x,Ce.y,-ot)}}}const vi=X+ne;for(let He=0;He<ht;He++){const Je=k?Ve(an[He],Ci[He],vi):an[He];Re?($e.copy(Ne.normals[0]).multiplyScalar(Je.x),de.copy(Ne.binormals[0]).multiplyScalar(Je.y),Gt.copy(Pe[0]).add($e).add(de),me(Gt.x,Gt.y,Gt.z)):me(Je.x,Je.y,0)}for(let He=1;He<=F;He++)for(let Je=0;Je<ht;Je++){const ot=k?Ve(an[Je],Ci[Je],vi):an[Je];Re?($e.copy(Ne.normals[He]).multiplyScalar(ot.x),de.copy(Ne.binormals[He]).multiplyScalar(ot.y),Gt.copy(Pe[He]).add($e).add(de),me(Gt.x,Gt.y,Gt.z)):me(ot.x,ot.y,O/F*He)}for(let He=te-1;He>=0;He--){const Je=He/te,ot=N*Math.cos(Je*Math.PI/2),bt=X*Math.sin(Je*Math.PI/2)+ne;for(let Mt=0,ue=je.length;Mt<ue;Mt++){const oe=Ve(je[Mt],An[Mt],bt);me(oe.x,oe.y,O+ot)}for(let Mt=0,ue=_t.length;Mt<ue;Mt++){const oe=_t[Mt];Dn=Vt[Mt];for(let lt=0,yt=oe.length;lt<yt;lt++){const Ce=Ve(oe[lt],Dn[lt],bt);Re?me(Ce.x,Ce.y+Pe[F-1].y,Pe[F-1].x+ot):me(Ce.x,Ce.y,O+ot)}}}he(),K();function he(){const He=p.length/3;if(k){let Je=0,ot=ht*Je;for(let bt=0;bt<ft;bt++){const Mt=rt[bt];Le(Mt[2]+ot,Mt[1]+ot,Mt[0]+ot)}Je=F+te*2,ot=ht*Je;for(let bt=0;bt<ft;bt++){const Mt=rt[bt];Le(Mt[0]+ot,Mt[1]+ot,Mt[2]+ot)}}else{for(let Je=0;Je<ft;Je++){const ot=rt[Je];Le(ot[2],ot[1],ot[0])}for(let Je=0;Je<ft;Je++){const ot=rt[Je];Le(ot[0]+ht*F,ot[1]+ht*F,ot[2]+ht*F)}}u.addGroup(He,p.length/3-He,0)}function K(){const He=p.length/3;let Je=0;Fe(je,Je),Je+=je.length;for(let ot=0,bt=_t.length;ot<bt;ot++){const Mt=_t[ot];Fe(Mt,Je),Je+=Mt.length}u.addGroup(He,p.length/3-He,1)}function Fe(He,Je){let ot=He.length;for(;--ot>=0;){const bt=ot;let Mt=ot-1;Mt<0&&(Mt=He.length-1);for(let ue=0,oe=F+te*2;ue<oe;ue++){const lt=ht*ue,yt=ht*(ue+1),Ce=Je+bt+lt,Pt=Je+Mt+lt,Kt=Je+Mt+yt,qn=Je+bt+yt;Be(Ce,Pt,Kt,qn)}}}function me(He,Je,ot){A.push(He),A.push(Je),A.push(ot)}function Le(He,Je,ot){Ye(He),Ye(Je),Ye(ot);const bt=p.length/3,Mt=W.generateTopUV(u,p,bt-3,bt-2,bt-1);ke(Mt[0]),ke(Mt[1]),ke(Mt[2])}function Be(He,Je,ot,bt){Ye(He),Ye(Je),Ye(bt),Ye(Je),Ye(ot),Ye(bt);const Mt=p.length/3,ue=W.generateSideWallUV(u,p,Mt-6,Mt-3,Mt-2,Mt-1);ke(ue[0]),ke(ue[1]),ke(ue[3]),ke(ue[1]),ke(ue[2]),ke(ue[3])}function Ye(He){p.push(A[He*3+0]),p.push(A[He*3+1]),p.push(A[He*3+2])}function ke(He){g.push(He.x),g.push(He.y)}}}toJSON(){const i=hs.prototype.toJSON.call(this),n=this.parameters.shapes,u=this.parameters.options;return bT(n,u,i)}}const _T={generateTopUV:function(r,i,n,u,p){const g=i[n*3],b=i[n*3+1],M=i[u*3],A=i[u*3+1],C=i[p*3],F=i[p*3+1];return[new vn(g,b),new vn(M,A),new vn(C,F)]},generateSideWallUV:function(r,i,n,u,p,g){const b=i[n*3],M=i[n*3+1],A=i[n*3+2],C=i[u*3],F=i[u*3+1],O=i[u*3+2],k=i[p*3],N=i[p*3+1],X=i[p*3+2],ne=i[g*3],te=i[g*3+1],j=i[g*3+2];return Math.abs(M-F)<.01?[new vn(b,1-A),new vn(C,1-O),new vn(k,1-X),new vn(ne,1-j)]:[new vn(M,1-A),new vn(F,1-O),new vn(N,1-X),new vn(te,1-j)]}};function bT(r,i,n){if(n.shapes=[],Array.isArray(r))for(let u=0,p=r.length;u<p;u++){const g=r[u];n.shapes.push(g.uuid)}else n.shapes.push(r.uuid);return i.extrudePath!==void 0&&(n.options.extrudePath=i.extrudePath.toJSON()),n}class wT extends Zl{constructor(i,n){super(),this.type="ExtrudeGeometry",this.parameters={shapes:i,options:n},this.fromBufferGeometry(new TS(i,n)),this.mergeVertices()}toJSON(){const i=super.toJSON(),n=this.parameters.shapes,u=this.parameters.options;return MT(n,u,i)}}function MT(r,i,n){if(n.shapes=[],Array.isArray(r))for(let u=0,p=r.length;u<p;u++){const g=r[u];n.shapes.push(g.uuid)}else n.shapes.push(r.uuid);return i.extrudePath!==void 0&&(n.options.extrudePath=i.extrudePath.toJSON()),n}function T0(r,i,n){hs.call(this),this.type="ParametricBufferGeometry",this.parameters={func:r,slices:i,stacks:n};const u=[],p=[],g=[],b=[],M=1e-5,A=new De,C=new De,F=new De,O=new De,k=new De;r.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");const N=i+1;for(let X=0;X<=n;X++){const ne=X/n;for(let te=0;te<=i;te++){const j=te/i;r(j,ne,C),p.push(C.x,C.y,C.z),j-M>=0?(r(j-M,ne,F),O.subVectors(C,F)):(r(j+M,ne,F),O.subVectors(F,C)),ne-M>=0?(r(j,ne-M,F),k.subVectors(C,F)):(r(j,ne+M,F),k.subVectors(F,C)),A.crossVectors(O,k).normalize(),g.push(A.x,A.y,A.z),b.push(j,ne)}}for(let X=0;X<n;X++)for(let ne=0;ne<i;ne++){const te=X*N+ne,j=X*N+ne+1,W=(X+1)*N+ne+1,Pe=(X+1)*N+ne;u.push(te,j,Pe),u.push(j,W,Pe)}this.setIndex(u),this.setAttribute("position",new is(p,3)),this.setAttribute("normal",new is(g,3)),this.setAttribute("uv",new is(b,2))}T0.prototype=Object.create(hs.prototype),T0.prototype.constructor=T0;function fw(r,i,n){Zl.call(this),this.type="ParametricGeometry",this.parameters={func:r,slices:i,stacks:n},this.fromBufferGeometry(new T0(r,i,n)),this.mergeVertices()}fw.prototype=Object.create(Zl.prototype),fw.prototype.constructor=fw;class ST extends hs{constructor(i,n){super(),this.type="ShapeBufferGeometry",this.parameters={shapes:i,curveSegments:n},n=n||12;const u=[],p=[],g=[],b=[];let M=0,A=0;if(Array.isArray(i)===!1)C(i);else for(let F=0;F<i.length;F++)C(i[F]),this.addGroup(M,A,F),M+=A,A=0;this.setIndex(u),this.setAttribute("position",new is(p,3)),this.setAttribute("normal",new is(g,3)),this.setAttribute("uv",new is(b,2));function C(F){const O=p.length/3,k=F.extractPoints(n);let N=k.shape;const X=k.holes;Bh.isClockWise(N)===!1&&(N=N.reverse());for(let te=0,j=X.length;te<j;te++){const W=X[te];Bh.isClockWise(W)===!0&&(X[te]=W.reverse())}const ne=Bh.triangulateShape(N,X);for(let te=0,j=X.length;te<j;te++){const W=X[te];N=N.concat(W)}for(let te=0,j=N.length;te<j;te++){const W=N[te];p.push(W.x,W.y,0),g.push(0,0,1),b.push(W.x,W.y)}for(let te=0,j=ne.length;te<j;te++){const W=ne[te],Pe=W[0]+O,Re=W[1]+O,Ne=W[2]+O;u.push(Pe,Re,Ne),A+=3}}}toJSON(){const i=hs.prototype.toJSON.call(this),n=this.parameters.shapes;return ET(n,i)}}function ET(r,i){if(i.shapes=[],Array.isArray(r))for(let n=0,u=r.length;n<u;n++){const p=r[n];i.shapes.push(p.uuid)}else i.shapes.push(r.uuid);return i}class TT extends Zl{constructor(i,n){super(),this.type="ShapeGeometry",typeof n=="object"&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),n=n.curveSegments),this.parameters={shapes:i,curveSegments:n},this.fromBufferGeometry(new ST(i,n)),this.mergeVertices()}toJSON(){const i=Zl.prototype.toJSON.call(this),n=this.parameters.shapes;return AT(n,i)}}function AT(r,i){if(i.shapes=[],Array.isArray(r))for(let n=0,u=r.length;n<u;n++){const p=r[n];i.shapes.push(p.uuid)}else i.shapes.push(r.uuid);return i}function Cp(r){Yi.call(this),this.type="ShadowMaterial",this.color=new Mi(0),this.transparent=!0,this.setValues(r)}Cp.prototype=Object.create(Yi.prototype),Cp.prototype.constructor=Cp,Cp.prototype.isShadowMaterial=!0,Cp.prototype.copy=function(r){return Yi.prototype.copy.call(this,r),this.color.copy(r.color),this};function Og(r){Fa.call(this,r),this.type="RawShaderMaterial"}Og.prototype=Object.create(Fa.prototype),Og.prototype.constructor=Og,Og.prototype.isRawShaderMaterial=!0;function Fo(r){Yi.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Mi(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Mi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=mu,this.normalScale=new vn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.vertexTangents=!1,this.setValues(r)}Fo.prototype=Object.create(Yi.prototype),Fo.prototype.constructor=Fo,Fo.prototype.isMeshStandardMaterial=!0,Fo.prototype.copy=function(r){return Yi.prototype.copy.call(this,r),this.defines={STANDARD:""},this.color.copy(r.color),this.roughness=r.roughness,this.metalness=r.metalness,this.map=r.map,this.lightMap=r.lightMap,this.lightMapIntensity=r.lightMapIntensity,this.aoMap=r.aoMap,this.aoMapIntensity=r.aoMapIntensity,this.emissive.copy(r.emissive),this.emissiveMap=r.emissiveMap,this.emissiveIntensity=r.emissiveIntensity,this.bumpMap=r.bumpMap,this.bumpScale=r.bumpScale,this.normalMap=r.normalMap,this.normalMapType=r.normalMapType,this.normalScale.copy(r.normalScale),this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this.roughnessMap=r.roughnessMap,this.metalnessMap=r.metalnessMap,this.alphaMap=r.alphaMap,this.envMap=r.envMap,this.envMapIntensity=r.envMapIntensity,this.refractionRatio=r.refractionRatio,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.wireframeLinecap=r.wireframeLinecap,this.wireframeLinejoin=r.wireframeLinejoin,this.skinning=r.skinning,this.morphTargets=r.morphTargets,this.morphNormals=r.morphNormals,this.vertexTangents=r.vertexTangents,this};function Ou(r){Fo.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new vn(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,Object.defineProperty(this,"ior",{get:function(){return(1+.4*this.reflectivity)/(1-.4*this.reflectivity)},set:function(i){this.reflectivity=fr.clamp(2.5*(i-1)/(i+1),0,1)}}),this.sheen=null,this.transmission=0,this.transmissionMap=null,this.setValues(r)}Ou.prototype=Object.create(Fo.prototype),Ou.prototype.constructor=Ou,Ou.prototype.isMeshPhysicalMaterial=!0,Ou.prototype.copy=function(r){return Fo.prototype.copy.call(this,r),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=r.clearcoat,this.clearcoatMap=r.clearcoatMap,this.clearcoatRoughness=r.clearcoatRoughness,this.clearcoatRoughnessMap=r.clearcoatRoughnessMap,this.clearcoatNormalMap=r.clearcoatNormalMap,this.clearcoatNormalScale.copy(r.clearcoatNormalScale),this.reflectivity=r.reflectivity,r.sheen?this.sheen=(this.sheen||new Mi).copy(r.sheen):this.sheen=null,this.transmission=r.transmission,this.transmissionMap=r.transmissionMap,this};function ed(r){Yi.call(this),this.type="MeshPhongMaterial",this.color=new Mi(16777215),this.specular=new Mi(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Mi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=mu,this.normalScale=new vn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=jt,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(r)}ed.prototype=Object.create(Yi.prototype),ed.prototype.constructor=ed,ed.prototype.isMeshPhongMaterial=!0,ed.prototype.copy=function(r){return Yi.prototype.copy.call(this,r),this.color.copy(r.color),this.specular.copy(r.specular),this.shininess=r.shininess,this.map=r.map,this.lightMap=r.lightMap,this.lightMapIntensity=r.lightMapIntensity,this.aoMap=r.aoMap,this.aoMapIntensity=r.aoMapIntensity,this.emissive.copy(r.emissive),this.emissiveMap=r.emissiveMap,this.emissiveIntensity=r.emissiveIntensity,this.bumpMap=r.bumpMap,this.bumpScale=r.bumpScale,this.normalMap=r.normalMap,this.normalMapType=r.normalMapType,this.normalScale.copy(r.normalScale),this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this.specularMap=r.specularMap,this.alphaMap=r.alphaMap,this.envMap=r.envMap,this.combine=r.combine,this.reflectivity=r.reflectivity,this.refractionRatio=r.refractionRatio,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.wireframeLinecap=r.wireframeLinecap,this.wireframeLinejoin=r.wireframeLinejoin,this.skinning=r.skinning,this.morphTargets=r.morphTargets,this.morphNormals=r.morphNormals,this};function Pp(r){Yi.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Mi(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Mi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=mu,this.normalScale=new vn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(r)}Pp.prototype=Object.create(Yi.prototype),Pp.prototype.constructor=Pp,Pp.prototype.isMeshToonMaterial=!0,Pp.prototype.copy=function(r){return Yi.prototype.copy.call(this,r),this.color.copy(r.color),this.map=r.map,this.gradientMap=r.gradientMap,this.lightMap=r.lightMap,this.lightMapIntensity=r.lightMapIntensity,this.aoMap=r.aoMap,this.aoMapIntensity=r.aoMapIntensity,this.emissive.copy(r.emissive),this.emissiveMap=r.emissiveMap,this.emissiveIntensity=r.emissiveIntensity,this.bumpMap=r.bumpMap,this.bumpScale=r.bumpScale,this.normalMap=r.normalMap,this.normalMapType=r.normalMapType,this.normalScale.copy(r.normalScale),this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this.alphaMap=r.alphaMap,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.wireframeLinecap=r.wireframeLinecap,this.wireframeLinejoin=r.wireframeLinejoin,this.skinning=r.skinning,this.morphTargets=r.morphTargets,this.morphNormals=r.morphNormals,this};function Rp(r){Yi.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=mu,this.normalScale=new vn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(r)}Rp.prototype=Object.create(Yi.prototype),Rp.prototype.constructor=Rp,Rp.prototype.isMeshNormalMaterial=!0,Rp.prototype.copy=function(r){return Yi.prototype.copy.call(this,r),this.bumpMap=r.bumpMap,this.bumpScale=r.bumpScale,this.normalMap=r.normalMap,this.normalMapType=r.normalMapType,this.normalScale.copy(r.normalScale),this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.skinning=r.skinning,this.morphTargets=r.morphTargets,this.morphNormals=r.morphNormals,this};function Dp(r){Yi.call(this),this.type="MeshLambertMaterial",this.color=new Mi(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Mi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=jt,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(r)}Dp.prototype=Object.create(Yi.prototype),Dp.prototype.constructor=Dp,Dp.prototype.isMeshLambertMaterial=!0,Dp.prototype.copy=function(r){return Yi.prototype.copy.call(this,r),this.color.copy(r.color),this.map=r.map,this.lightMap=r.lightMap,this.lightMapIntensity=r.lightMapIntensity,this.aoMap=r.aoMap,this.aoMapIntensity=r.aoMapIntensity,this.emissive.copy(r.emissive),this.emissiveMap=r.emissiveMap,this.emissiveIntensity=r.emissiveIntensity,this.specularMap=r.specularMap,this.alphaMap=r.alphaMap,this.envMap=r.envMap,this.combine=r.combine,this.reflectivity=r.reflectivity,this.refractionRatio=r.refractionRatio,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.wireframeLinecap=r.wireframeLinecap,this.wireframeLinejoin=r.wireframeLinejoin,this.skinning=r.skinning,this.morphTargets=r.morphTargets,this.morphNormals=r.morphNormals,this};function Op(r){Yi.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Mi(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=mu,this.normalScale=new vn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(r)}Op.prototype=Object.create(Yi.prototype),Op.prototype.constructor=Op,Op.prototype.isMeshMatcapMaterial=!0,Op.prototype.copy=function(r){return Yi.prototype.copy.call(this,r),this.defines={MATCAP:""},this.color.copy(r.color),this.matcap=r.matcap,this.map=r.map,this.bumpMap=r.bumpMap,this.bumpScale=r.bumpScale,this.normalMap=r.normalMap,this.normalMapType=r.normalMapType,this.normalScale.copy(r.normalScale),this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this.alphaMap=r.alphaMap,this.skinning=r.skinning,this.morphTargets=r.morphTargets,this.morphNormals=r.morphNormals,this};function Ip(r){Qo.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(r)}Ip.prototype=Object.create(Qo.prototype),Ip.prototype.constructor=Ip,Ip.prototype.isLineDashedMaterial=!0,Ip.prototype.copy=function(r){return Qo.prototype.copy.call(this,r),this.scale=r.scale,this.dashSize=r.dashSize,this.gapSize=r.gapSize,this};var LT=Object.freeze({__proto__:null,ShadowMaterial:Cp,SpriteMaterial:Kf,RawShaderMaterial:Og,ShaderMaterial:Fa,PointsMaterial:Nh,MeshPhysicalMaterial:Ou,MeshStandardMaterial:Fo,MeshPhongMaterial:ed,MeshToonMaterial:Pp,MeshNormalMaterial:Rp,MeshLambertMaterial:Dp,MeshDepthMaterial:hr,MeshDistanceMaterial:Yr,MeshBasicMaterial:yo,MeshMatcapMaterial:Op,LineDashedMaterial:Ip,LineBasicMaterial:Qo,Material:Yi});const Ys={arraySlice:function(r,i,n){return Ys.isTypedArray(r)?new r.constructor(r.subarray(i,n!==void 0?n:r.length)):r.slice(i,n)},convertArray:function(r,i,n){return!r||!n&&r.constructor===i?r:typeof i.BYTES_PER_ELEMENT=="number"?new i(r):Array.prototype.slice.call(r)},isTypedArray:function(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)},getKeyframeOrder:function(r){function i(p,g){return r[p]-r[g]}const n=r.length,u=new Array(n);for(let p=0;p!==n;++p)u[p]=p;return u.sort(i),u},sortedArray:function(r,i,n){const u=r.length,p=new r.constructor(u);for(let g=0,b=0;b!==u;++g){const M=n[g]*i;for(let A=0;A!==i;++A)p[b++]=r[M+A]}return p},flattenJSON:function(r,i,n,u){let p=1,g=r[0];for(;g!==void 0&&g[u]===void 0;)g=r[p++];if(g===void 0)return;let b=g[u];if(b!==void 0)if(Array.isArray(b))do b=g[u],b!==void 0&&(i.push(g.time),n.push.apply(n,b)),g=r[p++];while(g!==void 0);else if(b.toArray!==void 0)do b=g[u],b!==void 0&&(i.push(g.time),b.toArray(n,n.length)),g=r[p++];while(g!==void 0);else do b=g[u],b!==void 0&&(i.push(g.time),n.push(b)),g=r[p++];while(g!==void 0)},subclip:function(r,i,n,u,p){p=p||30;const g=r.clone();g.name=i;const b=[];for(let A=0;A<g.tracks.length;++A){const C=g.tracks[A],F=C.getValueSize(),O=[],k=[];for(let N=0;N<C.times.length;++N){const X=C.times[N]*p;if(!(X<n||X>=u)){O.push(C.times[N]);for(let ne=0;ne<F;++ne)k.push(C.values[N*F+ne])}}O.length!==0&&(C.times=Ys.convertArray(O,C.times.constructor),C.values=Ys.convertArray(k,C.values.constructor),b.push(C))}g.tracks=b;let M=1/0;for(let A=0;A<g.tracks.length;++A)M>g.tracks[A].times[0]&&(M=g.tracks[A].times[0]);for(let A=0;A<g.tracks.length;++A)g.tracks[A].shift(-1*M);return g.resetDuration(),g},makeClipAdditive:function(r,i,n,u){i===void 0&&(i=0),n===void 0&&(n=r),(u===void 0||u<=0)&&(u=30);const p=n.tracks.length,g=i/u;for(let b=0;b<p;++b){const M=n.tracks[b],A=M.ValueTypeName;if(A==="bool"||A==="string")continue;const C=r.tracks.find(function(j){return j.name===M.name&&j.ValueTypeName===A});if(C===void 0)continue;let F=0;const O=M.getValueSize();M.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(F=O/3);let k=0;const N=C.getValueSize();C.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(k=N/3);const X=M.times.length-1;let ne;if(g<=M.times[0]){const j=F,W=O-F;ne=Ys.arraySlice(M.values,j,W)}else if(g>=M.times[X]){const j=X*O+F,W=j+O-F;ne=Ys.arraySlice(M.values,j,W)}else{const j=M.createInterpolant(),W=F,Pe=O-F;j.evaluate(g),ne=Ys.arraySlice(j.resultBuffer,W,Pe)}A==="quaternion"&&new Va().fromArray(ne).normalize().conjugate().toArray(ne);const te=C.times.length;for(let j=0;j<te;++j){const W=j*N+k;if(A==="quaternion")Va.multiplyQuaternionsFlat(C.values,W,ne,0,C.values,W);else{const Pe=N-k*2;for(let Re=0;Re<Pe;++Re)C.values[W+Re]-=ne[Re]}}}return r.blendMode=Nm,r}};function Bo(r,i,n,u){this.parameterPositions=r,this._cachedIndex=0,this.resultBuffer=u!==void 0?u:new i.constructor(n),this.sampleValues=i,this.valueSize=n}Object.assign(Bo.prototype,{evaluate:function(r){const i=this.parameterPositions;let n=this._cachedIndex,u=i[n],p=i[n-1];e:{t:{let g;n:{i:if(!(r<u)){for(let b=n+2;;){if(u===void 0){if(r<p)break i;return n=i.length,this._cachedIndex=n,this.afterEnd_(n-1,r,p)}if(n===b)break;if(p=u,u=i[++n],r<u)break t}g=i.length;break n}if(!(r>=p)){const b=i[1];r<b&&(n=2,p=b);for(let M=n-2;;){if(p===void 0)return this._cachedIndex=0,this.beforeStart_(0,r,u);if(n===M)break;if(u=p,p=i[--n-1],r>=p)break t}g=n,n=0;break n}break e}for(;n<g;){const b=n+g>>>1;r<i[b]?g=b:n=b+1}if(u=i[n],p=i[n-1],p===void 0)return this._cachedIndex=0,this.beforeStart_(0,r,u);if(u===void 0)return n=i.length,this._cachedIndex=n,this.afterEnd_(n-1,p,r)}this._cachedIndex=n,this.intervalChanged_(n,p,u)}return this.interpolate_(n,p,r,u)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(r){const i=this.resultBuffer,n=this.sampleValues,u=this.valueSize,p=r*u;for(let g=0;g!==u;++g)i[g]=n[p+g];return i},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(Bo.prototype,{beforeStart_:Bo.prototype.copySampleValue_,afterEnd_:Bo.prototype.copySampleValue_});function dw(r,i,n,u){Bo.call(this,r,i,n,u),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}dw.prototype=Object.assign(Object.create(Bo.prototype),{constructor:dw,DefaultSettings_:{endingStart:dh,endingEnd:dh},intervalChanged_:function(r,i,n){const u=this.parameterPositions;let p=r-2,g=r+1,b=u[p],M=u[g];if(b===void 0)switch(this.getSettings_().endingStart){case ml:p=r,b=2*i-n;break;case du:p=u.length-2,b=i+u[p]-u[p+1];break;default:p=r,b=n}if(M===void 0)switch(this.getSettings_().endingEnd){case ml:g=r,M=2*n-i;break;case du:g=1,M=n+u[1]-u[0];break;default:g=r-1,M=i}const A=(n-i)*.5,C=this.valueSize;this._weightPrev=A/(i-b),this._weightNext=A/(M-n),this._offsetPrev=p*C,this._offsetNext=g*C},interpolate_:function(r,i,n,u){const p=this.resultBuffer,g=this.sampleValues,b=this.valueSize,M=r*b,A=M-b,C=this._offsetPrev,F=this._offsetNext,O=this._weightPrev,k=this._weightNext,N=(n-i)/(u-i),X=N*N,ne=X*N,te=-O*ne+2*O*X-O*N,j=(1+O)*ne+(-1.5-2*O)*X+(-.5+O)*N+1,W=(-1-k)*ne+(1.5+k)*X+.5*N,Pe=k*ne-k*X;for(let Re=0;Re!==b;++Re)p[Re]=te*g[C+Re]+j*g[A+Re]+W*g[M+Re]+Pe*g[F+Re];return p}});function A0(r,i,n,u){Bo.call(this,r,i,n,u)}A0.prototype=Object.assign(Object.create(Bo.prototype),{constructor:A0,interpolate_:function(r,i,n,u){const p=this.resultBuffer,g=this.sampleValues,b=this.valueSize,M=r*b,A=M-b,C=(n-i)/(u-i),F=1-C;for(let O=0;O!==b;++O)p[O]=g[A+O]*F+g[M+O]*C;return p}});function pw(r,i,n,u){Bo.call(this,r,i,n,u)}pw.prototype=Object.assign(Object.create(Bo.prototype),{constructor:pw,interpolate_:function(r){return this.copySampleValue_(r-1)}});function Qa(r,i,n,u){if(r===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(i===void 0||i.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+r);this.name=r,this.times=Ys.convertArray(i,this.TimeBufferType),this.values=Ys.convertArray(n,this.ValueBufferType),this.setInterpolation(u||this.DefaultInterpolation)}Object.assign(Qa,{toJSON:function(r){const i=r.constructor;let n;if(i.toJSON!==void 0)n=i.toJSON(r);else{n={name:r.name,times:Ys.convertArray(r.times,Array),values:Ys.convertArray(r.values,Array)};const u=r.getInterpolation();u!==r.DefaultInterpolation&&(n.interpolation=u)}return n.type=r.ValueTypeName,n}}),Object.assign(Qa.prototype,{constructor:Qa,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:mo,InterpolantFactoryMethodDiscrete:function(r){return new pw(this.times,this.values,this.getValueSize(),r)},InterpolantFactoryMethodLinear:function(r){return new A0(this.times,this.values,this.getValueSize(),r)},InterpolantFactoryMethodSmooth:function(r){return new dw(this.times,this.values,this.getValueSize(),r)},setInterpolation:function(r){let i;switch(r){case fh:i=this.InterpolantFactoryMethodDiscrete;break;case mo:i=this.InterpolantFactoryMethodLinear;break;case Im:i=this.InterpolantFactoryMethodSmooth;break}if(i===void 0){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(r!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=i,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return fh;case this.InterpolantFactoryMethodLinear:return mo;case this.InterpolantFactoryMethodSmooth:return Im}},getValueSize:function(){return this.values.length/this.times.length},shift:function(r){if(r!==0){const i=this.times;for(let n=0,u=i.length;n!==u;++n)i[n]+=r}return this},scale:function(r){if(r!==1){const i=this.times;for(let n=0,u=i.length;n!==u;++n)i[n]*=r}return this},trim:function(r,i){const n=this.times,u=n.length;let p=0,g=u-1;for(;p!==u&&n[p]<r;)++p;for(;g!==-1&&n[g]>i;)--g;if(++g,p!==0||g!==u){p>=g&&(g=Math.max(g,1),p=g-1);const b=this.getValueSize();this.times=Ys.arraySlice(n,p,g),this.values=Ys.arraySlice(this.values,p*b,g*b)}return this},validate:function(){let r=!0;const i=this.getValueSize();i-Math.floor(i)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),r=!1);const n=this.times,u=this.values,p=n.length;p===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),r=!1);let g=null;for(let b=0;b!==p;b++){const M=n[b];if(typeof M=="number"&&isNaN(M)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,b,M),r=!1;break}if(g!==null&&g>M){console.error("THREE.KeyframeTrack: Out of order keys.",this,b,M,g),r=!1;break}g=M}if(u!==void 0&&Ys.isTypedArray(u))for(let b=0,M=u.length;b!==M;++b){const A=u[b];if(isNaN(A)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,b,A),r=!1;break}}return r},optimize:function(){const r=Ys.arraySlice(this.times),i=Ys.arraySlice(this.values),n=this.getValueSize(),u=this.getInterpolation()===Im,p=r.length-1;let g=1;for(let b=1;b<p;++b){let M=!1;const A=r[b],C=r[b+1];if(A!==C&&(b!==1||A!==A[0]))if(u)M=!0;else{const F=b*n,O=F-n,k=F+n;for(let N=0;N!==n;++N){const X=i[F+N];if(X!==i[O+N]||X!==i[k+N]){M=!0;break}}}if(M){if(b!==g){r[g]=r[b];const F=b*n,O=g*n;for(let k=0;k!==n;++k)i[O+k]=i[F+k]}++g}}if(p>0){r[g]=r[p];for(let b=p*n,M=g*n,A=0;A!==n;++A)i[M+A]=i[b+A];++g}return g!==r.length?(this.times=Ys.arraySlice(r,0,g),this.values=Ys.arraySlice(i,0,g*n)):(this.times=r,this.values=i),this},clone:function(){const r=Ys.arraySlice(this.times,0),i=Ys.arraySlice(this.values,0),n=this.constructor,u=new n(this.name,r,i);return u.createInterpolant=this.createInterpolant,u}});function mw(r,i,n){Qa.call(this,r,i,n)}mw.prototype=Object.assign(Object.create(Qa.prototype),{constructor:mw,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:fh,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});function gw(r,i,n,u){Qa.call(this,r,i,n,u)}gw.prototype=Object.assign(Object.create(Qa.prototype),{constructor:gw,ValueTypeName:"color"});function Np(r,i,n,u){Qa.call(this,r,i,n,u)}Np.prototype=Object.assign(Object.create(Qa.prototype),{constructor:Np,ValueTypeName:"number"});function vw(r,i,n,u){Bo.call(this,r,i,n,u)}vw.prototype=Object.assign(Object.create(Bo.prototype),{constructor:vw,interpolate_:function(r,i,n,u){const p=this.resultBuffer,g=this.sampleValues,b=this.valueSize,M=(n-i)/(u-i);let A=r*b;for(let C=A+b;A!==C;A+=4)Va.slerpFlat(p,0,g,A-b,g,A,M);return p}});function Ig(r,i,n,u){Qa.call(this,r,i,n,u)}Ig.prototype=Object.assign(Object.create(Qa.prototype),{constructor:Ig,ValueTypeName:"quaternion",DefaultInterpolation:mo,InterpolantFactoryMethodLinear:function(r){return new vw(this.times,this.values,this.getValueSize(),r)},InterpolantFactoryMethodSmooth:void 0});function yw(r,i,n,u){Qa.call(this,r,i,n,u)}yw.prototype=Object.assign(Object.create(Qa.prototype),{constructor:yw,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:fh,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});function Fp(r,i,n,u){Qa.call(this,r,i,n,u)}Fp.prototype=Object.assign(Object.create(Qa.prototype),{constructor:Fp,ValueTypeName:"vector"});function Jl(r,i,n,u){this.name=r,this.tracks=n,this.duration=i!==void 0?i:-1,this.blendMode=u!==void 0?u:Ro,this.uuid=fr.generateUUID(),this.duration<0&&this.resetDuration()}function CT(r){switch(r.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Np;case"vector":case"vector2":case"vector3":case"vector4":return Fp;case"color":return gw;case"quaternion":return Ig;case"bool":case"boolean":return mw;case"string":return yw}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+r)}function PT(r){if(r.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const i=CT(r.type);if(r.times===void 0){const n=[],u=[];Ys.flattenJSON(r.keys,n,u,"value"),r.times=n,r.values=u}return i.parse!==void 0?i.parse(r):new i(r.name,r.times,r.values,r.interpolation)}Object.assign(Jl,{parse:function(r){const i=[],n=r.tracks,u=1/(r.fps||1);for(let p=0,g=n.length;p!==g;++p)i.push(PT(n[p]).scale(u));return new Jl(r.name,r.duration,i,r.blendMode)},toJSON:function(r){const i=[],n=r.tracks,u={name:r.name,duration:r.duration,tracks:i,uuid:r.uuid,blendMode:r.blendMode};for(let p=0,g=n.length;p!==g;++p)i.push(Qa.toJSON(n[p]));return u},CreateFromMorphTargetSequence:function(r,i,n,u){const p=i.length,g=[];for(let b=0;b<p;b++){let M=[],A=[];M.push((b+p-1)%p,b,(b+1)%p),A.push(0,1,0);const C=Ys.getKeyframeOrder(M);M=Ys.sortedArray(M,1,C),A=Ys.sortedArray(A,1,C),!u&&M[0]===0&&(M.push(p),A.push(A[0])),g.push(new Np(".morphTargetInfluences["+i[b].name+"]",M,A).scale(1/n))}return new Jl(r,-1,g)},findByName:function(r,i){let n=r;if(!Array.isArray(r)){const u=r;n=u.geometry&&u.geometry.animations||u.animations}for(let u=0;u<n.length;u++)if(n[u].name===i)return n[u];return null},CreateClipsFromMorphTargetSequences:function(r,i,n){const u={},p=/^([\w-]*?)([\d]+)$/;for(let b=0,M=r.length;b<M;b++){const A=r[b],C=A.name.match(p);if(C&&C.length>1){const F=C[1];let O=u[F];O||(u[F]=O=[]),O.push(A)}}const g=[];for(const b in u)g.push(Jl.CreateFromMorphTargetSequence(b,u[b],i,n));return g},parseAnimation:function(r,i){if(!r)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(F,O,k,N,X){if(k.length!==0){const ne=[],te=[];Ys.flattenJSON(k,ne,te,N),ne.length!==0&&X.push(new F(O,ne,te))}},u=[],p=r.name||"default",g=r.fps||30,b=r.blendMode;let M=r.length||-1;const A=r.hierarchy||[];for(let F=0;F<A.length;F++){const O=A[F].keys;if(!(!O||O.length===0))if(O[0].morphTargets){const k={};let N;for(N=0;N<O.length;N++)if(O[N].morphTargets)for(let X=0;X<O[N].morphTargets.length;X++)k[O[N].morphTargets[X]]=-1;for(const X in k){const ne=[],te=[];for(let j=0;j!==O[N].morphTargets.length;++j){const W=O[N];ne.push(W.time),te.push(W.morphTarget===X?1:0)}u.push(new Np(".morphTargetInfluence["+X+"]",ne,te))}M=k.length*(g||1)}else{const k=".bones["+i[F].name+"]";n(Fp,k+".position",O,"pos",u),n(Ig,k+".quaternion",O,"rot",u),n(Fp,k+".scale",O,"scl",u)}}return u.length===0?null:new Jl(p,M,u,b)}}),Object.assign(Jl.prototype,{resetDuration:function(){const r=this.tracks;let i=0;for(let n=0,u=r.length;n!==u;++n){const p=this.tracks[n];i=Math.max(i,p.times[p.times.length-1])}return this.duration=i,this},trim:function(){for(let r=0;r<this.tracks.length;r++)this.tracks[r].trim(0,this.duration);return this},validate:function(){let r=!0;for(let i=0;i<this.tracks.length;i++)r=r&&this.tracks[i].validate();return r},optimize:function(){for(let r=0;r<this.tracks.length;r++)this.tracks[r].optimize();return this},clone:function(){const r=[];for(let i=0;i<this.tracks.length;i++)r.push(this.tracks[i].clone());return new Jl(this.name,this.duration,r,this.blendMode)}});const Bp={enabled:!1,files:{},add:function(r,i){this.enabled!==!1&&(this.files[r]=i)},get:function(r){if(this.enabled!==!1)return this.files[r]},remove:function(r){delete this.files[r]},clear:function(){this.files={}}};function RT(r,i,n){const u=this;let p=!1,g=0,b=0,M;const A=[];this.onStart=void 0,this.onLoad=r,this.onProgress=i,this.onError=n,this.itemStart=function(C){b++,p===!1&&u.onStart!==void 0&&u.onStart(C,g,b),p=!0},this.itemEnd=function(C){g++,u.onProgress!==void 0&&u.onProgress(C,g,b),g===b&&(p=!1,u.onLoad!==void 0&&u.onLoad())},this.itemError=function(C){u.onError!==void 0&&u.onError(C)},this.resolveURL=function(C){return M?M(C):C},this.setURLModifier=function(C){return M=C,this},this.addHandler=function(C,F){return A.push(C,F),this},this.removeHandler=function(C){const F=A.indexOf(C);return F!==-1&&A.splice(F,2),this},this.getHandler=function(C){for(let F=0,O=A.length;F<O;F+=2){const k=A[F],N=A[F+1];if(k.global&&(k.lastIndex=0),k.test(C))return N}return null}}const DT=new RT;function ys(r){this.manager=r!==void 0?r:DT,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}Object.assign(ys.prototype,{load:function(){},loadAsync:function(r,i){const n=this;return new Promise(function(u,p){n.load(r,u,i,p)})},parse:function(){},setCrossOrigin:function(r){return this.crossOrigin=r,this},setWithCredentials:function(r){return this.withCredentials=r,this},setPath:function(r){return this.path=r,this},setResourcePath:function(r){return this.resourcePath=r,this},setRequestHeader:function(r){return this.requestHeader=r,this}});const $l={};function Kl(r){ys.call(this,r)}Kl.prototype=Object.assign(Object.create(ys.prototype),{constructor:Kl,load:function(r,i,n,u){r===void 0&&(r=""),this.path!==void 0&&(r=this.path+r),r=this.manager.resolveURL(r);const p=this,g=Bp.get(r);if(g!==void 0)return p.manager.itemStart(r),setTimeout(function(){i&&i(g),p.manager.itemEnd(r)},0),g;if($l[r]!==void 0){$l[r].push({onLoad:i,onProgress:n,onError:u});return}const b=/^data:(.*?)(;base64)?,(.*)$/,M=r.match(b);let A;if(M){const C=M[1],F=!!M[2];let O=M[3];O=decodeURIComponent(O),F&&(O=atob(O));try{let k;const N=(this.responseType||"").toLowerCase();switch(N){case"arraybuffer":case"blob":const X=new Uint8Array(O.length);for(let te=0;te<O.length;te++)X[te]=O.charCodeAt(te);N==="blob"?k=new Blob([X.buffer],{type:C}):k=X.buffer;break;case"document":k=new DOMParser().parseFromString(O,C);break;case"json":k=JSON.parse(O);break;default:k=O;break}setTimeout(function(){i&&i(k),p.manager.itemEnd(r)},0)}catch(k){setTimeout(function(){u&&u(k),p.manager.itemError(r),p.manager.itemEnd(r)},0)}}else{$l[r]=[],$l[r].push({onLoad:i,onProgress:n,onError:u}),A=new XMLHttpRequest,A.open("GET",r,!0),A.addEventListener("load",function(C){const F=this.response,O=$l[r];if(delete $l[r],this.status===200||this.status===0){this.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),Bp.add(r,F);for(let k=0,N=O.length;k<N;k++){const X=O[k];X.onLoad&&X.onLoad(F)}p.manager.itemEnd(r)}else{for(let k=0,N=O.length;k<N;k++){const X=O[k];X.onError&&X.onError(C)}p.manager.itemError(r),p.manager.itemEnd(r)}},!1),A.addEventListener("progress",function(C){const F=$l[r];for(let O=0,k=F.length;O<k;O++){const N=F[O];N.onProgress&&N.onProgress(C)}},!1),A.addEventListener("error",function(C){const F=$l[r];delete $l[r];for(let O=0,k=F.length;O<k;O++){const N=F[O];N.onError&&N.onError(C)}p.manager.itemError(r),p.manager.itemEnd(r)},!1),A.addEventListener("abort",function(C){const F=$l[r];delete $l[r];for(let O=0,k=F.length;O<k;O++){const N=F[O];N.onError&&N.onError(C)}p.manager.itemError(r),p.manager.itemEnd(r)},!1),this.responseType!==void 0&&(A.responseType=this.responseType),this.withCredentials!==void 0&&(A.withCredentials=this.withCredentials),A.overrideMimeType&&A.overrideMimeType(this.mimeType!==void 0?this.mimeType:"text/plain");for(const C in this.requestHeader)A.setRequestHeader(C,this.requestHeader[C]);A.send(null)}return p.manager.itemStart(r),A},setResponseType:function(r){return this.responseType=r,this},setMimeType:function(r){return this.mimeType=r,this}});function AS(r){ys.call(this,r)}AS.prototype=Object.assign(Object.create(ys.prototype),{constructor:AS,load:function(r,i,n,u){const p=this,g=new Kl(p.manager);g.setPath(p.path),g.setRequestHeader(p.requestHeader),g.setWithCredentials(p.withCredentials),g.load(r,function(b){try{i(p.parse(JSON.parse(b)))}catch(M){u?u(M):console.error(M),p.manager.itemError(r)}},n,u)},parse:function(r){const i=[];for(let n=0;n<r.length;n++){const u=Jl.parse(r[n]);i.push(u)}return i}});function LS(r){ys.call(this,r)}LS.prototype=Object.assign(Object.create(ys.prototype),{constructor:LS,load:function(r,i,n,u){const p=this,g=[],b=new Lg;b.image=g;const M=new Kl(this.manager);M.setPath(this.path),M.setResponseType("arraybuffer"),M.setRequestHeader(this.requestHeader),M.setWithCredentials(p.withCredentials);let A=0;function C(F){M.load(r[F],function(O){const k=p.parse(O,!0);g[F]={width:k.width,height:k.height,format:k.format,mipmaps:k.mipmaps},A+=1,A===6&&(k.mipmapCount===1&&(b.minFilter=ti),b.format=k.format,b.needsUpdate=!0,i&&i(b))},n,u)}if(Array.isArray(r))for(let F=0,O=r.length;F<O;++F)C(F);else M.load(r,function(F){const O=p.parse(F,!0);if(O.isCubemap){const k=O.mipmaps.length/O.mipmapCount;for(let N=0;N<k;N++){g[N]={mipmaps:[]};for(let X=0;X<O.mipmapCount;X++)g[N].mipmaps.push(O.mipmaps[N*O.mipmapCount+X]),g[N].format=O.format,g[N].width=O.width,g[N].height=O.height}}else b.image.width=O.width,b.image.height=O.height,b.mipmaps=O.mipmaps;O.mipmapCount===1&&(b.minFilter=ti),b.format=O.format,b.needsUpdate=!0,i&&i(b)},n,u);return b}});function L0(r){ys.call(this,r)}L0.prototype=Object.assign(Object.create(ys.prototype),{constructor:L0,load:function(r,i,n,u){this.path!==void 0&&(r=this.path+r),r=this.manager.resolveURL(r);const p=this,g=Bp.get(r);if(g!==void 0)return p.manager.itemStart(r),setTimeout(function(){i&&i(g),p.manager.itemEnd(r)},0),g;const b=document.createElementNS("http://www.w3.org/1999/xhtml","img");function M(){b.removeEventListener("load",M,!1),b.removeEventListener("error",A,!1),Bp.add(r,this),i&&i(this),p.manager.itemEnd(r)}function A(C){b.removeEventListener("load",M,!1),b.removeEventListener("error",A,!1),u&&u(C),p.manager.itemError(r),p.manager.itemEnd(r)}return b.addEventListener("load",M,!1),b.addEventListener("error",A,!1),r.substr(0,5)!=="data:"&&this.crossOrigin!==void 0&&(b.crossOrigin=this.crossOrigin),p.manager.itemStart(r),b.src=r,b}});function xw(r){ys.call(this,r)}xw.prototype=Object.assign(Object.create(ys.prototype),{constructor:xw,load:function(r,i,n,u){const p=new Ic,g=new L0(this.manager);g.setCrossOrigin(this.crossOrigin),g.setPath(this.path);let b=0;function M(A){g.load(r[A],function(C){p.images[A]=C,b++,b===6&&(p.needsUpdate=!0,i&&i(p))},void 0,u)}for(let A=0;A<r.length;++A)M(A);return p}});function Ng(r){ys.call(this,r)}Ng.prototype=Object.assign(Object.create(ys.prototype),{constructor:Ng,load:function(r,i,n,u){const p=this,g=new wh,b=new Kl(this.manager);return b.setResponseType("arraybuffer"),b.setRequestHeader(this.requestHeader),b.setPath(this.path),b.setWithCredentials(p.withCredentials),b.load(r,function(M){const A=p.parse(M);!A||(A.image!==void 0?g.image=A.image:A.data!==void 0&&(g.image.width=A.width,g.image.height=A.height,g.image.data=A.data),g.wrapS=A.wrapS!==void 0?A.wrapS:$r,g.wrapT=A.wrapT!==void 0?A.wrapT:$r,g.magFilter=A.magFilter!==void 0?A.magFilter:ti,g.minFilter=A.minFilter!==void 0?A.minFilter:ti,g.anisotropy=A.anisotropy!==void 0?A.anisotropy:1,A.format!==void 0&&(g.format=A.format),A.type!==void 0&&(g.type=A.type),A.mipmaps!==void 0&&(g.mipmaps=A.mipmaps,g.minFilter=es),A.mipmapCount===1&&(g.minFilter=ti),g.needsUpdate=!0,i&&i(g,A))},n,u),g}});function C0(r){ys.call(this,r)}C0.prototype=Object.assign(Object.create(ys.prototype),{constructor:C0,load:function(r,i,n,u){const p=new gs,g=new L0(this.manager);return g.setCrossOrigin(this.crossOrigin),g.setPath(this.path),g.load(r,function(b){p.image=b;const M=r.search(/\.jpe?g($|\?)/i)>0||r.search(/^data\:image\/jpeg/)===0;p.format=M?Or:vr,p.needsUpdate=!0,i!==void 0&&i(p)},n,u),p}});function Wi(){this.type="Curve",this.arcLengthDivisions=200}Object.assign(Wi.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(r,i){const n=this.getUtoTmapping(r);return this.getPoint(n,i)},getPoints:function(r){r===void 0&&(r=5);const i=[];for(let n=0;n<=r;n++)i.push(this.getPoint(n/r));return i},getSpacedPoints:function(r){r===void 0&&(r=5);const i=[];for(let n=0;n<=r;n++)i.push(this.getPointAt(n/r));return i},getLength:function(){const r=this.getLengths();return r[r.length-1]},getLengths:function(r){if(r===void 0&&(r=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===r+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const i=[];let n,u=this.getPoint(0),p=0;i.push(0);for(let g=1;g<=r;g++)n=this.getPoint(g/r),p+=n.distanceTo(u),i.push(p),u=n;return this.cacheArcLengths=i,i},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(r,i){const n=this.getLengths();let u=0;const p=n.length;let g;i?g=i:g=r*n[p-1];let b=0,M=p-1,A;for(;b<=M;)if(u=Math.floor(b+(M-b)/2),A=n[u]-g,A<0)b=u+1;else if(A>0)M=u-1;else{M=u;break}if(u=M,n[u]===g)return u/(p-1);const C=n[u],O=n[u+1]-C,k=(g-C)/O;return(u+k)/(p-1)},getTangent:function(r,i){let u=r-1e-4,p=r+1e-4;u<0&&(u=0),p>1&&(p=1);const g=this.getPoint(u),b=this.getPoint(p),M=i||(g.isVector2?new vn:new De);return M.copy(b).sub(g).normalize(),M},getTangentAt:function(r,i){const n=this.getUtoTmapping(r);return this.getTangent(n,i)},computeFrenetFrames:function(r,i){const n=new De,u=[],p=[],g=[],b=new De,M=new yr;for(let k=0;k<=r;k++){const N=k/r;u[k]=this.getTangentAt(N,new De),u[k].normalize()}p[0]=new De,g[0]=new De;let A=Number.MAX_VALUE;const C=Math.abs(u[0].x),F=Math.abs(u[0].y),O=Math.abs(u[0].z);C<=A&&(A=C,n.set(1,0,0)),F<=A&&(A=F,n.set(0,1,0)),O<=A&&n.set(0,0,1),b.crossVectors(u[0],n).normalize(),p[0].crossVectors(u[0],b),g[0].crossVectors(u[0],p[0]);for(let k=1;k<=r;k++){if(p[k]=p[k-1].clone(),g[k]=g[k-1].clone(),b.crossVectors(u[k-1],u[k]),b.length()>Number.EPSILON){b.normalize();const N=Math.acos(fr.clamp(u[k-1].dot(u[k]),-1,1));p[k].applyMatrix4(M.makeRotationAxis(b,N))}g[k].crossVectors(u[k],p[k])}if(i===!0){let k=Math.acos(fr.clamp(p[0].dot(p[r]),-1,1));k/=r,u[0].dot(b.crossVectors(p[0],p[r]))>0&&(k=-k);for(let N=1;N<=r;N++)p[N].applyMatrix4(M.makeRotationAxis(u[N],k*N)),g[N].crossVectors(u[N],p[N])}return{tangents:u,normals:p,binormals:g}},clone:function(){return new this.constructor().copy(this)},copy:function(r){return this.arcLengthDivisions=r.arcLengthDivisions,this},toJSON:function(){const r={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return r.arcLengthDivisions=this.arcLengthDivisions,r.type=this.type,r},fromJSON:function(r){return this.arcLengthDivisions=r.arcLengthDivisions,this}});function Sl(r,i,n,u,p,g,b,M){Wi.call(this),this.type="EllipseCurve",this.aX=r||0,this.aY=i||0,this.xRadius=n||1,this.yRadius=u||1,this.aStartAngle=p||0,this.aEndAngle=g||2*Math.PI,this.aClockwise=b||!1,this.aRotation=M||0}Sl.prototype=Object.create(Wi.prototype),Sl.prototype.constructor=Sl,Sl.prototype.isEllipseCurve=!0,Sl.prototype.getPoint=function(r,i){const n=i||new vn,u=Math.PI*2;let p=this.aEndAngle-this.aStartAngle;const g=Math.abs(p)<Number.EPSILON;for(;p<0;)p+=u;for(;p>u;)p-=u;p<Number.EPSILON&&(g?p=0:p=u),this.aClockwise===!0&&!g&&(p===u?p=-u:p=p-u);const b=this.aStartAngle+r*p;let M=this.aX+this.xRadius*Math.cos(b),A=this.aY+this.yRadius*Math.sin(b);if(this.aRotation!==0){const C=Math.cos(this.aRotation),F=Math.sin(this.aRotation),O=M-this.aX,k=A-this.aY;M=O*C-k*F+this.aX,A=O*F+k*C+this.aY}return n.set(M,A)},Sl.prototype.copy=function(r){return Wi.prototype.copy.call(this,r),this.aX=r.aX,this.aY=r.aY,this.xRadius=r.xRadius,this.yRadius=r.yRadius,this.aStartAngle=r.aStartAngle,this.aEndAngle=r.aEndAngle,this.aClockwise=r.aClockwise,this.aRotation=r.aRotation,this},Sl.prototype.toJSON=function(){const r=Wi.prototype.toJSON.call(this);return r.aX=this.aX,r.aY=this.aY,r.xRadius=this.xRadius,r.yRadius=this.yRadius,r.aStartAngle=this.aStartAngle,r.aEndAngle=this.aEndAngle,r.aClockwise=this.aClockwise,r.aRotation=this.aRotation,r},Sl.prototype.fromJSON=function(r){return Wi.prototype.fromJSON.call(this,r),this.aX=r.aX,this.aY=r.aY,this.xRadius=r.xRadius,this.yRadius=r.yRadius,this.aStartAngle=r.aStartAngle,this.aEndAngle=r.aEndAngle,this.aClockwise=r.aClockwise,this.aRotation=r.aRotation,this};function Fg(r,i,n,u,p,g){Sl.call(this,r,i,n,n,u,p,g),this.type="ArcCurve"}Fg.prototype=Object.create(Sl.prototype),Fg.prototype.constructor=Fg,Fg.prototype.isArcCurve=!0;function _w(){let r=0,i=0,n=0,u=0;function p(g,b,M,A){r=g,i=M,n=-3*g+3*b-2*M-A,u=2*g-2*b+M+A}return{initCatmullRom:function(g,b,M,A,C){p(b,M,C*(M-g),C*(A-b))},initNonuniformCatmullRom:function(g,b,M,A,C,F,O){let k=(b-g)/C-(M-g)/(C+F)+(M-b)/F,N=(M-b)/F-(A-b)/(F+O)+(A-M)/O;k*=F,N*=F,p(b,M,k,N)},calc:function(g){const b=g*g,M=b*g;return r+i*g+n*b+u*M}}}const P0=new De,bw=new _w,ww=new _w,Mw=new _w;function Ql(r,i,n,u){Wi.call(this),this.type="CatmullRomCurve3",this.points=r||[],this.closed=i||!1,this.curveType=n||"centripetal",this.tension=u!==void 0?u:.5}Ql.prototype=Object.create(Wi.prototype),Ql.prototype.constructor=Ql,Ql.prototype.isCatmullRomCurve3=!0,Ql.prototype.getPoint=function(r,i){const n=i||new De,u=this.points,p=u.length,g=(p-(this.closed?0:1))*r;let b=Math.floor(g),M=g-b;this.closed?b+=b>0?0:(Math.floor(Math.abs(b)/p)+1)*p:M===0&&b===p-1&&(b=p-2,M=1);let A,C;this.closed||b>0?A=u[(b-1)%p]:(P0.subVectors(u[0],u[1]).add(u[0]),A=P0);const F=u[b%p],O=u[(b+1)%p];if(this.closed||b+2<p?C=u[(b+2)%p]:(P0.subVectors(u[p-1],u[p-2]).add(u[p-1]),C=P0),this.curveType==="centripetal"||this.curveType==="chordal"){const k=this.curveType==="chordal"?.5:.25;let N=Math.pow(A.distanceToSquared(F),k),X=Math.pow(F.distanceToSquared(O),k),ne=Math.pow(O.distanceToSquared(C),k);X<1e-4&&(X=1),N<1e-4&&(N=X),ne<1e-4&&(ne=X),bw.initNonuniformCatmullRom(A.x,F.x,O.x,C.x,N,X,ne),ww.initNonuniformCatmullRom(A.y,F.y,O.y,C.y,N,X,ne),Mw.initNonuniformCatmullRom(A.z,F.z,O.z,C.z,N,X,ne)}else this.curveType==="catmullrom"&&(bw.initCatmullRom(A.x,F.x,O.x,C.x,this.tension),ww.initCatmullRom(A.y,F.y,O.y,C.y,this.tension),Mw.initCatmullRom(A.z,F.z,O.z,C.z,this.tension));return n.set(bw.calc(M),ww.calc(M),Mw.calc(M)),n},Ql.prototype.copy=function(r){Wi.prototype.copy.call(this,r),this.points=[];for(let i=0,n=r.points.length;i<n;i++){const u=r.points[i];this.points.push(u.clone())}return this.closed=r.closed,this.curveType=r.curveType,this.tension=r.tension,this},Ql.prototype.toJSON=function(){const r=Wi.prototype.toJSON.call(this);r.points=[];for(let i=0,n=this.points.length;i<n;i++){const u=this.points[i];r.points.push(u.toArray())}return r.closed=this.closed,r.curveType=this.curveType,r.tension=this.tension,r},Ql.prototype.fromJSON=function(r){Wi.prototype.fromJSON.call(this,r),this.points=[];for(let i=0,n=r.points.length;i<n;i++){const u=r.points[i];this.points.push(new De().fromArray(u))}return this.closed=r.closed,this.curveType=r.curveType,this.tension=r.tension,this};function CS(r,i,n,u,p){const g=(u-i)*.5,b=(p-n)*.5,M=r*r,A=r*M;return(2*n-2*u+g+b)*A+(-3*n+3*u-2*g-b)*M+g*r+n}function OT(r,i){const n=1-r;return n*n*i}function IT(r,i){return 2*(1-r)*r*i}function NT(r,i){return r*r*i}function Bg(r,i,n,u){return OT(r,i)+IT(r,n)+NT(r,u)}function FT(r,i){const n=1-r;return n*n*n*i}function BT(r,i){const n=1-r;return 3*n*n*r*i}function kT(r,i){return 3*(1-r)*r*r*i}function zT(r,i){return r*r*r*i}function kg(r,i,n,u,p){return FT(r,i)+BT(r,n)+kT(r,u)+zT(r,p)}function Uc(r,i,n,u){Wi.call(this),this.type="CubicBezierCurve",this.v0=r||new vn,this.v1=i||new vn,this.v2=n||new vn,this.v3=u||new vn}Uc.prototype=Object.create(Wi.prototype),Uc.prototype.constructor=Uc,Uc.prototype.isCubicBezierCurve=!0,Uc.prototype.getPoint=function(r,i){const n=i||new vn,u=this.v0,p=this.v1,g=this.v2,b=this.v3;return n.set(kg(r,u.x,p.x,g.x,b.x),kg(r,u.y,p.y,g.y,b.y)),n},Uc.prototype.copy=function(r){return Wi.prototype.copy.call(this,r),this.v0.copy(r.v0),this.v1.copy(r.v1),this.v2.copy(r.v2),this.v3.copy(r.v3),this},Uc.prototype.toJSON=function(){const r=Wi.prototype.toJSON.call(this);return r.v0=this.v0.toArray(),r.v1=this.v1.toArray(),r.v2=this.v2.toArray(),r.v3=this.v3.toArray(),r},Uc.prototype.fromJSON=function(r){return Wi.prototype.fromJSON.call(this,r),this.v0.fromArray(r.v0),this.v1.fromArray(r.v1),this.v2.fromArray(r.v2),this.v3.fromArray(r.v3),this};function Iu(r,i,n,u){Wi.call(this),this.type="CubicBezierCurve3",this.v0=r||new De,this.v1=i||new De,this.v2=n||new De,this.v3=u||new De}Iu.prototype=Object.create(Wi.prototype),Iu.prototype.constructor=Iu,Iu.prototype.isCubicBezierCurve3=!0,Iu.prototype.getPoint=function(r,i){const n=i||new De,u=this.v0,p=this.v1,g=this.v2,b=this.v3;return n.set(kg(r,u.x,p.x,g.x,b.x),kg(r,u.y,p.y,g.y,b.y),kg(r,u.z,p.z,g.z,b.z)),n},Iu.prototype.copy=function(r){return Wi.prototype.copy.call(this,r),this.v0.copy(r.v0),this.v1.copy(r.v1),this.v2.copy(r.v2),this.v3.copy(r.v3),this},Iu.prototype.toJSON=function(){const r=Wi.prototype.toJSON.call(this);return r.v0=this.v0.toArray(),r.v1=this.v1.toArray(),r.v2=this.v2.toArray(),r.v3=this.v3.toArray(),r},Iu.prototype.fromJSON=function(r){return Wi.prototype.fromJSON.call(this,r),this.v0.fromArray(r.v0),this.v1.fromArray(r.v1),this.v2.fromArray(r.v2),this.v3.fromArray(r.v3),this};function el(r,i){Wi.call(this),this.type="LineCurve",this.v1=r||new vn,this.v2=i||new vn}el.prototype=Object.create(Wi.prototype),el.prototype.constructor=el,el.prototype.isLineCurve=!0,el.prototype.getPoint=function(r,i){const n=i||new vn;return r===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(r).add(this.v1)),n},el.prototype.getPointAt=function(r,i){return this.getPoint(r,i)},el.prototype.getTangent=function(r,i){const n=i||new vn;return n.copy(this.v2).sub(this.v1).normalize(),n},el.prototype.copy=function(r){return Wi.prototype.copy.call(this,r),this.v1.copy(r.v1),this.v2.copy(r.v2),this},el.prototype.toJSON=function(){const r=Wi.prototype.toJSON.call(this);return r.v1=this.v1.toArray(),r.v2=this.v2.toArray(),r},el.prototype.fromJSON=function(r){return Wi.prototype.fromJSON.call(this,r),this.v1.fromArray(r.v1),this.v2.fromArray(r.v2),this};function Hc(r,i){Wi.call(this),this.type="LineCurve3",this.v1=r||new De,this.v2=i||new De}Hc.prototype=Object.create(Wi.prototype),Hc.prototype.constructor=Hc,Hc.prototype.isLineCurve3=!0,Hc.prototype.getPoint=function(r,i){const n=i||new De;return r===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(r).add(this.v1)),n},Hc.prototype.getPointAt=function(r,i){return this.getPoint(r,i)},Hc.prototype.copy=function(r){return Wi.prototype.copy.call(this,r),this.v1.copy(r.v1),this.v2.copy(r.v2),this},Hc.prototype.toJSON=function(){const r=Wi.prototype.toJSON.call(this);return r.v1=this.v1.toArray(),r.v2=this.v2.toArray(),r},Hc.prototype.fromJSON=function(r){return Wi.prototype.fromJSON.call(this,r),this.v1.fromArray(r.v1),this.v2.fromArray(r.v2),this};function Gc(r,i,n){Wi.call(this),this.type="QuadraticBezierCurve",this.v0=r||new vn,this.v1=i||new vn,this.v2=n||new vn}Gc.prototype=Object.create(Wi.prototype),Gc.prototype.constructor=Gc,Gc.prototype.isQuadraticBezierCurve=!0,Gc.prototype.getPoint=function(r,i){const n=i||new vn,u=this.v0,p=this.v1,g=this.v2;return n.set(Bg(r,u.x,p.x,g.x),Bg(r,u.y,p.y,g.y)),n},Gc.prototype.copy=function(r){return Wi.prototype.copy.call(this,r),this.v0.copy(r.v0),this.v1.copy(r.v1),this.v2.copy(r.v2),this},Gc.prototype.toJSON=function(){const r=Wi.prototype.toJSON.call(this);return r.v0=this.v0.toArray(),r.v1=this.v1.toArray(),r.v2=this.v2.toArray(),r},Gc.prototype.fromJSON=function(r){return Wi.prototype.fromJSON.call(this,r),this.v0.fromArray(r.v0),this.v1.fromArray(r.v1),this.v2.fromArray(r.v2),this};function Nu(r,i,n){Wi.call(this),this.type="QuadraticBezierCurve3",this.v0=r||new De,this.v1=i||new De,this.v2=n||new De}Nu.prototype=Object.create(Wi.prototype),Nu.prototype.constructor=Nu,Nu.prototype.isQuadraticBezierCurve3=!0,Nu.prototype.getPoint=function(r,i){const n=i||new De,u=this.v0,p=this.v1,g=this.v2;return n.set(Bg(r,u.x,p.x,g.x),Bg(r,u.y,p.y,g.y),Bg(r,u.z,p.z,g.z)),n},Nu.prototype.copy=function(r){return Wi.prototype.copy.call(this,r),this.v0.copy(r.v0),this.v1.copy(r.v1),this.v2.copy(r.v2),this},Nu.prototype.toJSON=function(){const r=Wi.prototype.toJSON.call(this);return r.v0=this.v0.toArray(),r.v1=this.v1.toArray(),r.v2=this.v2.toArray(),r},Nu.prototype.fromJSON=function(r){return Wi.prototype.fromJSON.call(this,r),this.v0.fromArray(r.v0),this.v1.fromArray(r.v1),this.v2.fromArray(r.v2),this};function Vc(r){Wi.call(this),this.type="SplineCurve",this.points=r||[]}Vc.prototype=Object.create(Wi.prototype),Vc.prototype.constructor=Vc,Vc.prototype.isSplineCurve=!0,Vc.prototype.getPoint=function(r,i){const n=i||new vn,u=this.points,p=(u.length-1)*r,g=Math.floor(p),b=p-g,M=u[g===0?g:g-1],A=u[g],C=u[g>u.length-2?u.length-1:g+1],F=u[g>u.length-3?u.length-1:g+2];return n.set(CS(b,M.x,A.x,C.x,F.x),CS(b,M.y,A.y,C.y,F.y)),n},Vc.prototype.copy=function(r){Wi.prototype.copy.call(this,r),this.points=[];for(let i=0,n=r.points.length;i<n;i++){const u=r.points[i];this.points.push(u.clone())}return this},Vc.prototype.toJSON=function(){const r=Wi.prototype.toJSON.call(this);r.points=[];for(let i=0,n=this.points.length;i<n;i++){const u=this.points[i];r.points.push(u.toArray())}return r},Vc.prototype.fromJSON=function(r){Wi.prototype.fromJSON.call(this,r),this.points=[];for(let i=0,n=r.points.length;i<n;i++){const u=r.points[i];this.points.push(new vn().fromArray(u))}return this};var UT=Object.freeze({__proto__:null,ArcCurve:Fg,CatmullRomCurve3:Ql,CubicBezierCurve:Uc,CubicBezierCurve3:Iu,EllipseCurve:Sl,LineCurve:el,LineCurve3:Hc,QuadraticBezierCurve:Gc,QuadraticBezierCurve3:Nu,SplineCurve:Vc});function kh(){Wi.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}kh.prototype=Object.assign(Object.create(Wi.prototype),{constructor:kh,add:function(r){this.curves.push(r)},closePath:function(){const r=this.curves[0].getPoint(0),i=this.curves[this.curves.length-1].getPoint(1);r.equals(i)||this.curves.push(new el(i,r))},getPoint:function(r){const i=r*this.getLength(),n=this.getCurveLengths();let u=0;for(;u<n.length;){if(n[u]>=i){const p=n[u]-i,g=this.curves[u],b=g.getLength(),M=b===0?0:1-p/b;return g.getPointAt(M)}u++}return null},getLength:function(){const r=this.getCurveLengths();return r[r.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const r=[];let i=0;for(let n=0,u=this.curves.length;n<u;n++)i+=this.curves[n].getLength(),r.push(i);return this.cacheLengths=r,r},getSpacedPoints:function(r){r===void 0&&(r=40);const i=[];for(let n=0;n<=r;n++)i.push(this.getPoint(n/r));return this.autoClose&&i.push(i[0]),i},getPoints:function(r){r=r||12;const i=[];let n;for(let u=0,p=this.curves;u<p.length;u++){const g=p[u],b=g&&g.isEllipseCurve?r*2:g&&(g.isLineCurve||g.isLineCurve3)?1:g&&g.isSplineCurve?r*g.points.length:r,M=g.getPoints(b);for(let A=0;A<M.length;A++){const C=M[A];n&&n.equals(C)||(i.push(C),n=C)}}return this.autoClose&&i.length>1&&!i[i.length-1].equals(i[0])&&i.push(i[0]),i},copy:function(r){Wi.prototype.copy.call(this,r),this.curves=[];for(let i=0,n=r.curves.length;i<n;i++){const u=r.curves[i];this.curves.push(u.clone())}return this.autoClose=r.autoClose,this},toJSON:function(){const r=Wi.prototype.toJSON.call(this);r.autoClose=this.autoClose,r.curves=[];for(let i=0,n=this.curves.length;i<n;i++){const u=this.curves[i];r.curves.push(u.toJSON())}return r},fromJSON:function(r){Wi.prototype.fromJSON.call(this,r),this.autoClose=r.autoClose,this.curves=[];for(let i=0,n=r.curves.length;i<n;i++){const u=r.curves[i];this.curves.push(new UT[u.type]().fromJSON(u))}return this}});function Wc(r){kh.call(this),this.type="Path",this.currentPoint=new vn,r&&this.setFromPoints(r)}Wc.prototype=Object.assign(Object.create(kh.prototype),{constructor:Wc,setFromPoints:function(r){this.moveTo(r[0].x,r[0].y);for(let i=1,n=r.length;i<n;i++)this.lineTo(r[i].x,r[i].y);return this},moveTo:function(r,i){return this.currentPoint.set(r,i),this},lineTo:function(r,i){const n=new el(this.currentPoint.clone(),new vn(r,i));return this.curves.push(n),this.currentPoint.set(r,i),this},quadraticCurveTo:function(r,i,n,u){const p=new Gc(this.currentPoint.clone(),new vn(r,i),new vn(n,u));return this.curves.push(p),this.currentPoint.set(n,u),this},bezierCurveTo:function(r,i,n,u,p,g){const b=new Uc(this.currentPoint.clone(),new vn(r,i),new vn(n,u),new vn(p,g));return this.curves.push(b),this.currentPoint.set(p,g),this},splineThru:function(r){const i=[this.currentPoint.clone()].concat(r),n=new Vc(i);return this.curves.push(n),this.currentPoint.copy(r[r.length-1]),this},arc:function(r,i,n,u,p,g){const b=this.currentPoint.x,M=this.currentPoint.y;return this.absarc(r+b,i+M,n,u,p,g),this},absarc:function(r,i,n,u,p,g){return this.absellipse(r,i,n,n,u,p,g),this},ellipse:function(r,i,n,u,p,g,b,M){const A=this.currentPoint.x,C=this.currentPoint.y;return this.absellipse(r+A,i+C,n,u,p,g,b,M),this},absellipse:function(r,i,n,u,p,g,b,M){const A=new Sl(r,i,n,u,p,g,b,M);if(this.curves.length>0){const F=A.getPoint(0);F.equals(this.currentPoint)||this.lineTo(F.x,F.y)}this.curves.push(A);const C=A.getPoint(1);return this.currentPoint.copy(C),this},copy:function(r){return kh.prototype.copy.call(this,r),this.currentPoint.copy(r.currentPoint),this},toJSON:function(){const r=kh.prototype.toJSON.call(this);return r.currentPoint=this.currentPoint.toArray(),r},fromJSON:function(r){return kh.prototype.fromJSON.call(this,r),this.currentPoint.fromArray(r.currentPoint),this}});function kp(r){Wc.call(this,r),this.uuid=fr.generateUUID(),this.type="Shape",this.holes=[]}kp.prototype=Object.assign(Object.create(Wc.prototype),{constructor:kp,getPointsHoles:function(r){const i=[];for(let n=0,u=this.holes.length;n<u;n++)i[n]=this.holes[n].getPoints(r);return i},extractPoints:function(r){return{shape:this.getPoints(r),holes:this.getPointsHoles(r)}},copy:function(r){Wc.prototype.copy.call(this,r),this.holes=[];for(let i=0,n=r.holes.length;i<n;i++){const u=r.holes[i];this.holes.push(u.clone())}return this},toJSON:function(){const r=Wc.prototype.toJSON.call(this);r.uuid=this.uuid,r.holes=[];for(let i=0,n=this.holes.length;i<n;i++){const u=this.holes[i];r.holes.push(u.toJSON())}return r},fromJSON:function(r){Wc.prototype.fromJSON.call(this,r),this.uuid=r.uuid,this.holes=[];for(let i=0,n=r.holes.length;i<n;i++){const u=r.holes[i];this.holes.push(new Wc().fromJSON(u))}return this}});function ks(r,i){Ni.call(this),this.type="Light",this.color=new Mi(r),this.intensity=i!==void 0?i:1}ks.prototype=Object.assign(Object.create(Ni.prototype),{constructor:ks,isLight:!0,copy:function(r){return Ni.prototype.copy.call(this,r),this.color.copy(r.color),this.intensity=r.intensity,this},toJSON:function(r){const i=Ni.prototype.toJSON.call(this,r);return i.object.color=this.color.getHex(),i.object.intensity=this.intensity,this.groundColor!==void 0&&(i.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(i.object.distance=this.distance),this.angle!==void 0&&(i.object.angle=this.angle),this.decay!==void 0&&(i.object.decay=this.decay),this.penumbra!==void 0&&(i.object.penumbra=this.penumbra),this.shadow!==void 0&&(i.object.shadow=this.shadow.toJSON()),i}});function PS(r,i,n){ks.call(this,r,n),this.type="HemisphereLight",this.position.copy(Ni.DefaultUp),this.updateMatrix(),this.groundColor=new Mi(i)}PS.prototype=Object.assign(Object.create(ks.prototype),{constructor:PS,isHemisphereLight:!0,copy:function(r){return ks.prototype.copy.call(this,r),this.groundColor.copy(r.groundColor),this}});function Fu(r){this.camera=r,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new vn(512,512),this.map=null,this.mapPass=null,this.matrix=new yr,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new sp,this._frameExtents=new vn(1,1),this._viewportCount=1,this._viewports=[new vs(0,0,1,1)]}Object.assign(Fu.prototype,{_projScreenMatrix:new yr,_lightPositionWorld:new De,_lookTarget:new De,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(r){const i=this.camera,n=this.matrix,u=this._projScreenMatrix,p=this._lookTarget,g=this._lightPositionWorld;g.setFromMatrixPosition(r.matrixWorld),i.position.copy(g),p.setFromMatrixPosition(r.target.matrixWorld),i.lookAt(p),i.updateMatrixWorld(),u.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(u),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(i.projectionMatrix),n.multiply(i.matrixWorldInverse)},getViewport:function(r){return this._viewports[r]},getFrameExtents:function(){return this._frameExtents},copy:function(r){return this.camera=r.camera.clone(),this.bias=r.bias,this.radius=r.radius,this.mapSize.copy(r.mapSize),this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){const r={};return this.bias!==0&&(r.bias=this.bias),this.normalBias!==0&&(r.normalBias=this.normalBias),this.radius!==1&&(r.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(r.mapSize=this.mapSize.toArray()),r.camera=this.camera.toJSON(!1).object,delete r.camera.matrix,r}});function Sw(){Fu.call(this,new ba(50,1,.5,500)),this.focus=1}Sw.prototype=Object.assign(Object.create(Fu.prototype),{constructor:Sw,isSpotLightShadow:!0,updateMatrices:function(r){const i=this.camera,n=fr.RAD2DEG*2*r.angle*this.focus,u=this.mapSize.width/this.mapSize.height,p=r.distance||i.far;(n!==i.fov||u!==i.aspect||p!==i.far)&&(i.fov=n,i.aspect=u,i.far=p,i.updateProjectionMatrix()),Fu.prototype.updateMatrices.call(this,r)}});function Ew(r,i,n,u,p,g){ks.call(this,r,i),this.type="SpotLight",this.position.copy(Ni.DefaultUp),this.updateMatrix(),this.target=new Ni,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(b){this.intensity=b/Math.PI}}),this.distance=n!==void 0?n:0,this.angle=u!==void 0?u:Math.PI/3,this.penumbra=p!==void 0?p:0,this.decay=g!==void 0?g:1,this.shadow=new Sw}Ew.prototype=Object.assign(Object.create(ks.prototype),{constructor:Ew,isSpotLight:!0,copy:function(r){return ks.prototype.copy.call(this,r),this.distance=r.distance,this.angle=r.angle,this.penumbra=r.penumbra,this.decay=r.decay,this.target=r.target.clone(),this.shadow=r.shadow.clone(),this}});function Tw(){Fu.call(this,new ba(90,1,.5,500)),this._frameExtents=new vn(4,2),this._viewportCount=6,this._viewports=[new vs(2,1,1,1),new vs(0,1,1,1),new vs(3,1,1,1),new vs(1,1,1,1),new vs(3,0,1,1),new vs(1,0,1,1)],this._cubeDirections=[new De(1,0,0),new De(-1,0,0),new De(0,0,1),new De(0,0,-1),new De(0,1,0),new De(0,-1,0)],this._cubeUps=[new De(0,1,0),new De(0,1,0),new De(0,1,0),new De(0,1,0),new De(0,0,1),new De(0,0,-1)]}Tw.prototype=Object.assign(Object.create(Fu.prototype),{constructor:Tw,isPointLightShadow:!0,updateMatrices:function(r,i){i===void 0&&(i=0);const n=this.camera,u=this.matrix,p=this._lightPositionWorld,g=this._lookTarget,b=this._projScreenMatrix;p.setFromMatrixPosition(r.matrixWorld),n.position.copy(p),g.copy(n.position),g.add(this._cubeDirections[i]),n.up.copy(this._cubeUps[i]),n.lookAt(g),n.updateMatrixWorld(),u.makeTranslation(-p.x,-p.y,-p.z),b.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(b)}});function Aw(r,i,n,u){ks.call(this,r,i),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return this.intensity*4*Math.PI},set:function(p){this.intensity=p/(4*Math.PI)}}),this.distance=n!==void 0?n:0,this.decay=u!==void 0?u:1,this.shadow=new Tw}Aw.prototype=Object.assign(Object.create(ks.prototype),{constructor:Aw,isPointLight:!0,copy:function(r){return ks.prototype.copy.call(this,r),this.distance=r.distance,this.decay=r.decay,this.shadow=r.shadow.clone(),this}});function R0(r,i,n,u,p,g){jl.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=r!==void 0?r:-1,this.right=i!==void 0?i:1,this.top=n!==void 0?n:1,this.bottom=u!==void 0?u:-1,this.near=p!==void 0?p:.1,this.far=g!==void 0?g:2e3,this.updateProjectionMatrix()}R0.prototype=Object.assign(Object.create(jl.prototype),{constructor:R0,isOrthographicCamera:!0,copy:function(r,i){return jl.prototype.copy.call(this,r,i),this.left=r.left,this.right=r.right,this.top=r.top,this.bottom=r.bottom,this.near=r.near,this.far=r.far,this.zoom=r.zoom,this.view=r.view===null?null:Object.assign({},r.view),this},setViewOffset:function(r,i,n,u,p,g){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=r,this.view.fullHeight=i,this.view.offsetX=n,this.view.offsetY=u,this.view.width=p,this.view.height=g,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){const r=(this.right-this.left)/(2*this.zoom),i=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,u=(this.top+this.bottom)/2;let p=n-r,g=n+r,b=u+i,M=u-i;if(this.view!==null&&this.view.enabled){const A=(this.right-this.left)/this.view.fullWidth/this.zoom,C=(this.top-this.bottom)/this.view.fullHeight/this.zoom;p+=A*this.view.offsetX,g=p+A*this.view.width,b-=C*this.view.offsetY,M=b-C*this.view.height}this.projectionMatrix.makeOrthographic(p,g,b,M,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(r){const i=Ni.prototype.toJSON.call(this,r);return i.object.zoom=this.zoom,i.object.left=this.left,i.object.right=this.right,i.object.top=this.top,i.object.bottom=this.bottom,i.object.near=this.near,i.object.far=this.far,this.view!==null&&(i.object.view=Object.assign({},this.view)),i}});function Lw(){Fu.call(this,new R0(-5,5,5,-5,.5,500))}Lw.prototype=Object.assign(Object.create(Fu.prototype),{constructor:Lw,isDirectionalLightShadow:!0,updateMatrices:function(r){Fu.prototype.updateMatrices.call(this,r)}});function Cw(r,i){ks.call(this,r,i),this.type="DirectionalLight",this.position.copy(Ni.DefaultUp),this.updateMatrix(),this.target=new Ni,this.shadow=new Lw}Cw.prototype=Object.assign(Object.create(ks.prototype),{constructor:Cw,isDirectionalLight:!0,copy:function(r){return ks.prototype.copy.call(this,r),this.target=r.target.clone(),this.shadow=r.shadow.clone(),this}});function RS(r,i){ks.call(this,r,i),this.type="AmbientLight"}RS.prototype=Object.assign(Object.create(ks.prototype),{constructor:RS,isAmbientLight:!0});function DS(r,i,n,u){ks.call(this,r,i),this.type="RectAreaLight",this.width=n!==void 0?n:10,this.height=u!==void 0?u:10}DS.prototype=Object.assign(Object.create(ks.prototype),{constructor:DS,isRectAreaLight:!0,copy:function(r){return ks.prototype.copy.call(this,r),this.width=r.width,this.height=r.height,this},toJSON:function(r){const i=ks.prototype.toJSON.call(this,r);return i.object.width=this.width,i.object.height=this.height,i}});class HT{constructor(){Object.defineProperty(this,"isSphericalHarmonics3",{value:!0}),this.coefficients=[];for(let i=0;i<9;i++)this.coefficients.push(new De)}set(i){for(let n=0;n<9;n++)this.coefficients[n].copy(i[n]);return this}zero(){for(let i=0;i<9;i++)this.coefficients[i].set(0,0,0);return this}getAt(i,n){const u=i.x,p=i.y,g=i.z,b=this.coefficients;return n.copy(b[0]).multiplyScalar(.282095),n.addScaledVector(b[1],.488603*p),n.addScaledVector(b[2],.488603*g),n.addScaledVector(b[3],.488603*u),n.addScaledVector(b[4],1.092548*(u*p)),n.addScaledVector(b[5],1.092548*(p*g)),n.addScaledVector(b[6],.315392*(3*g*g-1)),n.addScaledVector(b[7],1.092548*(u*g)),n.addScaledVector(b[8],.546274*(u*u-p*p)),n}getIrradianceAt(i,n){const u=i.x,p=i.y,g=i.z,b=this.coefficients;return n.copy(b[0]).multiplyScalar(.886227),n.addScaledVector(b[1],2*.511664*p),n.addScaledVector(b[2],2*.511664*g),n.addScaledVector(b[3],2*.511664*u),n.addScaledVector(b[4],2*.429043*u*p),n.addScaledVector(b[5],2*.429043*p*g),n.addScaledVector(b[6],.743125*g*g-.247708),n.addScaledVector(b[7],2*.429043*u*g),n.addScaledVector(b[8],.429043*(u*u-p*p)),n}add(i){for(let n=0;n<9;n++)this.coefficients[n].add(i.coefficients[n]);return this}addScaledSH(i,n){for(let u=0;u<9;u++)this.coefficients[u].addScaledVector(i.coefficients[u],n);return this}scale(i){for(let n=0;n<9;n++)this.coefficients[n].multiplyScalar(i);return this}lerp(i,n){for(let u=0;u<9;u++)this.coefficients[u].lerp(i.coefficients[u],n);return this}equals(i){for(let n=0;n<9;n++)if(!this.coefficients[n].equals(i.coefficients[n]))return!1;return!0}copy(i){return this.set(i.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(i,n){n===void 0&&(n=0);const u=this.coefficients;for(let p=0;p<9;p++)u[p].fromArray(i,n+p*3);return this}toArray(i,n){i===void 0&&(i=[]),n===void 0&&(n=0);const u=this.coefficients;for(let p=0;p<9;p++)u[p].toArray(i,n+p*3);return i}static getBasisAt(i,n){const u=i.x,p=i.y,g=i.z;n[0]=.282095,n[1]=.488603*p,n[2]=.488603*g,n[3]=.488603*u,n[4]=1.092548*u*p,n[5]=1.092548*p*g,n[6]=.315392*(3*g*g-1),n[7]=1.092548*u*g,n[8]=.546274*(u*u-p*p)}}function Xc(r,i){ks.call(this,void 0,i),this.type="LightProbe",this.sh=r!==void 0?r:new HT}Xc.prototype=Object.assign(Object.create(ks.prototype),{constructor:Xc,isLightProbe:!0,copy:function(r){return ks.prototype.copy.call(this,r),this.sh.copy(r.sh),this},fromJSON:function(r){return this.intensity=r.intensity,this.sh.fromArray(r.sh),this},toJSON:function(r){const i=ks.prototype.toJSON.call(this,r);return i.object.sh=this.sh.toArray(),i}});function OS(r){ys.call(this,r),this.textures={}}OS.prototype=Object.assign(Object.create(ys.prototype),{constructor:OS,load:function(r,i,n,u){const p=this,g=new Kl(p.manager);g.setPath(p.path),g.setRequestHeader(p.requestHeader),g.setWithCredentials(p.withCredentials),g.load(r,function(b){try{i(p.parse(JSON.parse(b)))}catch(M){u?u(M):console.error(M),p.manager.itemError(r)}},n,u)},parse:function(r){const i=this.textures;function n(p){return i[p]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",p),i[p]}const u=new LT[r.type];if(r.uuid!==void 0&&(u.uuid=r.uuid),r.name!==void 0&&(u.name=r.name),r.color!==void 0&&u.color.setHex(r.color),r.roughness!==void 0&&(u.roughness=r.roughness),r.metalness!==void 0&&(u.metalness=r.metalness),r.sheen!==void 0&&(u.sheen=new Mi().setHex(r.sheen)),r.emissive!==void 0&&u.emissive.setHex(r.emissive),r.specular!==void 0&&u.specular.setHex(r.specular),r.shininess!==void 0&&(u.shininess=r.shininess),r.clearcoat!==void 0&&(u.clearcoat=r.clearcoat),r.clearcoatRoughness!==void 0&&(u.clearcoatRoughness=r.clearcoatRoughness),r.fog!==void 0&&(u.fog=r.fog),r.flatShading!==void 0&&(u.flatShading=r.flatShading),r.blending!==void 0&&(u.blending=r.blending),r.combine!==void 0&&(u.combine=r.combine),r.side!==void 0&&(u.side=r.side),r.opacity!==void 0&&(u.opacity=r.opacity),r.transparent!==void 0&&(u.transparent=r.transparent),r.alphaTest!==void 0&&(u.alphaTest=r.alphaTest),r.depthTest!==void 0&&(u.depthTest=r.depthTest),r.depthWrite!==void 0&&(u.depthWrite=r.depthWrite),r.colorWrite!==void 0&&(u.colorWrite=r.colorWrite),r.stencilWrite!==void 0&&(u.stencilWrite=r.stencilWrite),r.stencilWriteMask!==void 0&&(u.stencilWriteMask=r.stencilWriteMask),r.stencilFunc!==void 0&&(u.stencilFunc=r.stencilFunc),r.stencilRef!==void 0&&(u.stencilRef=r.stencilRef),r.stencilFuncMask!==void 0&&(u.stencilFuncMask=r.stencilFuncMask),r.stencilFail!==void 0&&(u.stencilFail=r.stencilFail),r.stencilZFail!==void 0&&(u.stencilZFail=r.stencilZFail),r.stencilZPass!==void 0&&(u.stencilZPass=r.stencilZPass),r.wireframe!==void 0&&(u.wireframe=r.wireframe),r.wireframeLinewidth!==void 0&&(u.wireframeLinewidth=r.wireframeLinewidth),r.wireframeLinecap!==void 0&&(u.wireframeLinecap=r.wireframeLinecap),r.wireframeLinejoin!==void 0&&(u.wireframeLinejoin=r.wireframeLinejoin),r.rotation!==void 0&&(u.rotation=r.rotation),r.linewidth!==1&&(u.linewidth=r.linewidth),r.dashSize!==void 0&&(u.dashSize=r.dashSize),r.gapSize!==void 0&&(u.gapSize=r.gapSize),r.scale!==void 0&&(u.scale=r.scale),r.polygonOffset!==void 0&&(u.polygonOffset=r.polygonOffset),r.polygonOffsetFactor!==void 0&&(u.polygonOffsetFactor=r.polygonOffsetFactor),r.polygonOffsetUnits!==void 0&&(u.polygonOffsetUnits=r.polygonOffsetUnits),r.skinning!==void 0&&(u.skinning=r.skinning),r.morphTargets!==void 0&&(u.morphTargets=r.morphTargets),r.morphNormals!==void 0&&(u.morphNormals=r.morphNormals),r.dithering!==void 0&&(u.dithering=r.dithering),r.vertexTangents!==void 0&&(u.vertexTangents=r.vertexTangents),r.visible!==void 0&&(u.visible=r.visible),r.toneMapped!==void 0&&(u.toneMapped=r.toneMapped),r.userData!==void 0&&(u.userData=r.userData),r.vertexColors!==void 0&&(typeof r.vertexColors=="number"?u.vertexColors=r.vertexColors>0:u.vertexColors=r.vertexColors),r.uniforms!==void 0)for(const p in r.uniforms){const g=r.uniforms[p];switch(u.uniforms[p]={},g.type){case"t":u.uniforms[p].value=n(g.value);break;case"c":u.uniforms[p].value=new Mi().setHex(g.value);break;case"v2":u.uniforms[p].value=new vn().fromArray(g.value);break;case"v3":u.uniforms[p].value=new De().fromArray(g.value);break;case"v4":u.uniforms[p].value=new vs().fromArray(g.value);break;case"m3":u.uniforms[p].value=new Ja().fromArray(g.value);break;case"m4":u.uniforms[p].value=new yr().fromArray(g.value);break;default:u.uniforms[p].value=g.value}}if(r.defines!==void 0&&(u.defines=r.defines),r.vertexShader!==void 0&&(u.vertexShader=r.vertexShader),r.fragmentShader!==void 0&&(u.fragmentShader=r.fragmentShader),r.extensions!==void 0)for(const p in r.extensions)u.extensions[p]=r.extensions[p];if(r.shading!==void 0&&(u.flatShading=r.shading===1),r.size!==void 0&&(u.size=r.size),r.sizeAttenuation!==void 0&&(u.sizeAttenuation=r.sizeAttenuation),r.map!==void 0&&(u.map=n(r.map)),r.matcap!==void 0&&(u.matcap=n(r.matcap)),r.alphaMap!==void 0&&(u.alphaMap=n(r.alphaMap)),r.bumpMap!==void 0&&(u.bumpMap=n(r.bumpMap)),r.bumpScale!==void 0&&(u.bumpScale=r.bumpScale),r.normalMap!==void 0&&(u.normalMap=n(r.normalMap)),r.normalMapType!==void 0&&(u.normalMapType=r.normalMapType),r.normalScale!==void 0){let p=r.normalScale;Array.isArray(p)===!1&&(p=[p,p]),u.normalScale=new vn().fromArray(p)}return r.displacementMap!==void 0&&(u.displacementMap=n(r.displacementMap)),r.displacementScale!==void 0&&(u.displacementScale=r.displacementScale),r.displacementBias!==void 0&&(u.displacementBias=r.displacementBias),r.roughnessMap!==void 0&&(u.roughnessMap=n(r.roughnessMap)),r.metalnessMap!==void 0&&(u.metalnessMap=n(r.metalnessMap)),r.emissiveMap!==void 0&&(u.emissiveMap=n(r.emissiveMap)),r.emissiveIntensity!==void 0&&(u.emissiveIntensity=r.emissiveIntensity),r.specularMap!==void 0&&(u.specularMap=n(r.specularMap)),r.envMap!==void 0&&(u.envMap=n(r.envMap)),r.envMapIntensity!==void 0&&(u.envMapIntensity=r.envMapIntensity),r.reflectivity!==void 0&&(u.reflectivity=r.reflectivity),r.refractionRatio!==void 0&&(u.refractionRatio=r.refractionRatio),r.lightMap!==void 0&&(u.lightMap=n(r.lightMap)),r.lightMapIntensity!==void 0&&(u.lightMapIntensity=r.lightMapIntensity),r.aoMap!==void 0&&(u.aoMap=n(r.aoMap)),r.aoMapIntensity!==void 0&&(u.aoMapIntensity=r.aoMapIntensity),r.gradientMap!==void 0&&(u.gradientMap=n(r.gradientMap)),r.clearcoatMap!==void 0&&(u.clearcoatMap=n(r.clearcoatMap)),r.clearcoatRoughnessMap!==void 0&&(u.clearcoatRoughnessMap=n(r.clearcoatRoughnessMap)),r.clearcoatNormalMap!==void 0&&(u.clearcoatNormalMap=n(r.clearcoatNormalMap)),r.clearcoatNormalScale!==void 0&&(u.clearcoatNormalScale=new vn().fromArray(r.clearcoatNormalScale)),r.transmission!==void 0&&(u.transmission=r.transmission),r.transmissionMap!==void 0&&(u.transmissionMap=n(r.transmissionMap)),u},setTextures:function(r){return this.textures=r,this}});const zp={decodeText:function(r){if(typeof TextDecoder<"u")return new TextDecoder().decode(r);let i="";for(let n=0,u=r.length;n<u;n++)i+=String.fromCharCode(r[n]);try{return decodeURIComponent(escape(i))}catch{return i}},extractUrlBase:function(r){const i=r.lastIndexOf("/");return i===-1?"./":r.substr(0,i+1)}};function D0(){hs.call(this),this.type="InstancedBufferGeometry",this.instanceCount=1/0}D0.prototype=Object.assign(Object.create(hs.prototype),{constructor:D0,isInstancedBufferGeometry:!0,copy:function(r){return hs.prototype.copy.call(this,r),this.instanceCount=r.instanceCount,this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){const r=hs.prototype.toJSON.call(this);return r.instanceCount=this.instanceCount,r.isInstancedBufferGeometry=!0,r}});function Pw(r,i,n,u){typeof n=="number"&&(u=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),sr.call(this,r,i,n),this.meshPerAttribute=u||1}Pw.prototype=Object.assign(Object.create(sr.prototype),{constructor:Pw,isInstancedBufferAttribute:!0,copy:function(r){return sr.prototype.copy.call(this,r),this.meshPerAttribute=r.meshPerAttribute,this},toJSON:function(){const r=sr.prototype.toJSON.call(this);return r.meshPerAttribute=this.meshPerAttribute,r.isInstancedBufferAttribute=!0,r}});function IS(r){ys.call(this,r)}IS.prototype=Object.assign(Object.create(ys.prototype),{constructor:IS,load:function(r,i,n,u){const p=this,g=new Kl(p.manager);g.setPath(p.path),g.setRequestHeader(p.requestHeader),g.setWithCredentials(p.withCredentials),g.load(r,function(b){try{i(p.parse(JSON.parse(b)))}catch(M){u?u(M):console.error(M),p.manager.itemError(r)}},n,u)},parse:function(r){const i={},n={};function u(k,N){if(i[N]!==void 0)return i[N];const ne=k.interleavedBuffers[N],te=p(k,ne.buffer),j=new O0[ne.type](te),W=new Ko(j,ne.stride);return W.uuid=ne.uuid,i[N]=W,W}function p(k,N){if(n[N]!==void 0)return n[N];const ne=k.arrayBuffers[N],te=new Uint32Array(ne).buffer;return n[N]=te,te}const g=r.isInstancedBufferGeometry?new D0:new hs,b=r.data.index;if(b!==void 0){const k=new O0[b.type](b.array);g.setIndex(new sr(k,1))}const M=r.data.attributes;for(const k in M){const N=M[k];let X;if(N.isInterleavedBufferAttribute){const ne=u(r.data,N.data);X=new Ih(ne,N.itemSize,N.offset,N.normalized)}else{const ne=new O0[N.type](N.array),te=N.isInstancedBufferAttribute?Pw:sr;X=new te(ne,N.itemSize,N.normalized)}N.name!==void 0&&(X.name=N.name),g.setAttribute(k,X)}const A=r.data.morphAttributes;if(A)for(const k in A){const N=A[k],X=[];for(let ne=0,te=N.length;ne<te;ne++){const j=N[ne];let W;if(j.isInterleavedBufferAttribute){const Pe=u(r.data,j.data);W=new Ih(Pe,j.itemSize,j.offset,j.normalized)}else{const Pe=new O0[j.type](j.array);W=new sr(Pe,j.itemSize,j.normalized)}j.name!==void 0&&(W.name=j.name),X.push(W)}g.morphAttributes[k]=X}r.data.morphTargetsRelative&&(g.morphTargetsRelative=!0);const F=r.data.groups||r.data.drawcalls||r.data.offsets;if(F!==void 0)for(let k=0,N=F.length;k!==N;++k){const X=F[k];g.addGroup(X.start,X.count,X.materialIndex)}const O=r.data.boundingSphere;if(O!==void 0){const k=new De;O.center!==void 0&&k.fromArray(O.center),g.boundingSphere=new zl(k,O.radius)}return r.name&&(g.name=r.name),r.userData&&(g.userData=r.userData),g}});const O0={Int8Array,Uint8Array,Uint8ClampedArray:typeof Uint8ClampedArray<"u"?Uint8ClampedArray:Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Rw(r){typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),ys.call(this,r),this.options={premultiplyAlpha:"none"}}Rw.prototype=Object.assign(Object.create(ys.prototype),{constructor:Rw,isImageBitmapLoader:!0,setOptions:function(i){return this.options=i,this},load:function(r,i,n,u){r===void 0&&(r=""),this.path!==void 0&&(r=this.path+r),r=this.manager.resolveURL(r);const p=this,g=Bp.get(r);if(g!==void 0)return p.manager.itemStart(r),setTimeout(function(){i&&i(g),p.manager.itemEnd(r)},0),g;const b={};b.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",fetch(r,b).then(function(M){return M.blob()}).then(function(M){return createImageBitmap(M,p.options)}).then(function(M){Bp.add(r,M),i&&i(M),p.manager.itemEnd(r)}).catch(function(M){u&&u(M),p.manager.itemError(r),p.manager.itemEnd(r)}),p.manager.itemStart(r)}});function NS(){this.type="ShapePath",this.color=new Mi,this.subPaths=[],this.currentPath=null}Object.assign(NS.prototype,{moveTo:function(r,i){return this.currentPath=new Wc,this.subPaths.push(this.currentPath),this.currentPath.moveTo(r,i),this},lineTo:function(r,i){return this.currentPath.lineTo(r,i),this},quadraticCurveTo:function(r,i,n,u){return this.currentPath.quadraticCurveTo(r,i,n,u),this},bezierCurveTo:function(r,i,n,u,p,g){return this.currentPath.bezierCurveTo(r,i,n,u,p,g),this},splineThru:function(r){return this.currentPath.splineThru(r),this},toShapes:function(r,i){function n(j){const W=[];for(let Pe=0,Re=j.length;Pe<Re;Pe++){const Ne=j[Pe],de=new kp;de.curves=Ne.curves,W.push(de)}return W}function u(j,W){const Pe=W.length;let Re=!1;for(let Ne=Pe-1,de=0;de<Pe;Ne=de++){let $e=W[Ne],Gt=W[de],dt=Gt.x-$e.x,an=Gt.y-$e.y;if(Math.abs(an)>Number.EPSILON){if(an<0&&($e=W[de],dt=-dt,Gt=W[Ne],an=-an),j.y<$e.y||j.y>Gt.y)continue;if(j.y===$e.y){if(j.x===$e.x)return!0}else{const _t=an*(j.x-$e.x)-dt*(j.y-$e.y);if(_t===0)return!0;if(_t<0)continue;Re=!Re}}else{if(j.y!==$e.y)continue;if(Gt.x<=j.x&&j.x<=$e.x||$e.x<=j.x&&j.x<=Gt.x)return!0}}return Re}const p=Bh.isClockWise,g=this.subPaths;if(g.length===0)return[];if(i===!0)return n(g);let b,M,A;const C=[];if(g.length===1)return M=g[0],A=new kp,A.curves=M.curves,C.push(A),C;let F=!p(g[0].getPoints());F=r?!F:F;const O=[],k=[];let N=[],X=0,ne;k[X]=void 0,N[X]=[];for(let j=0,W=g.length;j<W;j++)M=g[j],ne=M.getPoints(),b=p(ne),b=r?!b:b,b?(!F&&k[X]&&X++,k[X]={s:new kp,p:ne},k[X].s.curves=M.curves,F&&X++,N[X]=[]):N[X].push({h:M,p:ne[0]});if(!k[0])return n(g);if(k.length>1){let j=!1;const W=[];for(let Pe=0,Re=k.length;Pe<Re;Pe++)O[Pe]=[];for(let Pe=0,Re=k.length;Pe<Re;Pe++){const Ne=N[Pe];for(let de=0;de<Ne.length;de++){const $e=Ne[de];let Gt=!0;for(let dt=0;dt<k.length;dt++)u($e.p,k[dt].p)&&(Pe!==dt&&W.push({froms:Pe,tos:dt,hole:de}),Gt?(Gt=!1,O[dt].push($e)):j=!0);Gt&&O[Pe].push($e)}}W.length>0&&(j||(N=O))}let te;for(let j=0,W=k.length;j<W;j++){A=k[j].s,C.push(A),te=N[j];for(let Pe=0,Re=te.length;Pe<Re;Pe++)A.holes.push(te[Pe].h)}return C}});function FS(r){this.type="Font",this.data=r}Object.assign(FS.prototype,{isFont:!0,generateShapes:function(r,i){i===void 0&&(i=100);const n=[],u=GT(r,i,this.data);for(let p=0,g=u.length;p<g;p++)Array.prototype.push.apply(n,u[p].toShapes());return n}});function GT(r,i,n){const u=Array.from?Array.from(r):String(r).split(""),p=i/n.resolution,g=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*p,b=[];let M=0,A=0;for(let C=0;C<u.length;C++){const F=u[C];if(F===`
`)M=0,A-=g;else{const O=VT(F,p,M,A,n);M+=O.offsetX,b.push(O.path)}}return b}function VT(r,i,n,u,p){const g=p.glyphs[r]||p.glyphs["?"];if(!g){console.error('THREE.Font: character "'+r+'" does not exists in font family '+p.familyName+".");return}const b=new NS;let M,A,C,F,O,k,N,X;if(g.o){const ne=g._cachedOutline||(g._cachedOutline=g.o.split(" "));for(let te=0,j=ne.length;te<j;)switch(ne[te++]){case"m":M=ne[te++]*i+n,A=ne[te++]*i+u,b.moveTo(M,A);break;case"l":M=ne[te++]*i+n,A=ne[te++]*i+u,b.lineTo(M,A);break;case"q":C=ne[te++]*i+n,F=ne[te++]*i+u,O=ne[te++]*i+n,k=ne[te++]*i+u,b.quadraticCurveTo(O,k,C,F);break;case"b":C=ne[te++]*i+n,F=ne[te++]*i+u,O=ne[te++]*i+n,k=ne[te++]*i+u,N=ne[te++]*i+n,X=ne[te++]*i+u,b.bezierCurveTo(O,k,N,X,C,F);break}}return{offsetX:g.ha*i,path:b}}function BS(r){ys.call(this,r)}BS.prototype=Object.assign(Object.create(ys.prototype),{constructor:BS,load:function(r,i,n,u){const p=this,g=new Kl(this.manager);g.setPath(this.path),g.setRequestHeader(this.requestHeader),g.setWithCredentials(p.withCredentials),g.load(r,function(b){let M;try{M=JSON.parse(b)}catch{console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),M=JSON.parse(b.substring(65,b.length-2))}const A=p.parse(M);i&&i(A)},n,u)},parse:function(r){return new FS(r)}});let I0;const WT={getContext:function(){return I0===void 0&&(I0=new(window.AudioContext||window.webkitAudioContext)),I0},setContext:function(r){I0=r}};function Dw(r){ys.call(this,r)}Dw.prototype=Object.assign(Object.create(ys.prototype),{constructor:Dw,load:function(r,i,n,u){const p=this,g=new Kl(p.manager);g.setResponseType("arraybuffer"),g.setPath(p.path),g.setRequestHeader(p.requestHeader),g.setWithCredentials(p.withCredentials),g.load(r,function(b){try{const M=b.slice(0);WT.getContext().decodeAudioData(M,function(C){i(C)})}catch(M){u?u(M):console.error(M),p.manager.itemError(r)}},n,u)}});function kS(r,i,n){Xc.call(this,void 0,n);const u=new Mi().set(r),p=new Mi().set(i),g=new De(u.r,u.g,u.b),b=new De(p.r,p.g,p.b),M=Math.sqrt(Math.PI),A=M*Math.sqrt(.75);this.sh.coefficients[0].copy(g).add(b).multiplyScalar(M),this.sh.coefficients[1].copy(g).sub(b).multiplyScalar(A)}kS.prototype=Object.assign(Object.create(Xc.prototype),{constructor:kS,isHemisphereLightProbe:!0,copy:function(r){return Xc.prototype.copy.call(this,r),this},toJSON:function(r){return Xc.prototype.toJSON.call(this,r)}});function zS(r,i){Xc.call(this,void 0,i);const n=new Mi().set(r);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}zS.prototype=Object.assign(Object.create(Xc.prototype),{constructor:zS,isAmbientLightProbe:!0,copy:function(r){return Xc.prototype.copy.call(this,r),this},toJSON:function(r){return Xc.prototype.toJSON.call(this,r)}});const US=new yr,HS=new yr;function XT(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new ba,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new ba,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}Object.assign(XT.prototype,{update:function(r){const i=this._cache;if(i.focus!==r.focus||i.fov!==r.fov||i.aspect!==r.aspect*this.aspect||i.near!==r.near||i.far!==r.far||i.zoom!==r.zoom||i.eyeSep!==this.eyeSep){i.focus=r.focus,i.fov=r.fov,i.aspect=r.aspect*this.aspect,i.near=r.near,i.far=r.far,i.zoom=r.zoom,i.eyeSep=this.eyeSep;const u=r.projectionMatrix.clone(),p=i.eyeSep/2,g=p*i.near/i.focus,b=i.near*Math.tan(fr.DEG2RAD*i.fov*.5)/i.zoom;let M,A;HS.elements[12]=-p,US.elements[12]=p,M=-b*i.aspect+g,A=b*i.aspect+g,u.elements[0]=2*i.near/(A-M),u.elements[8]=(A+M)/(A-M),this.cameraL.projectionMatrix.copy(u),M=-b*i.aspect-g,A=b*i.aspect-g,u.elements[0]=2*i.near/(A-M),u.elements[8]=(A+M)/(A-M),this.cameraR.projectionMatrix.copy(u)}this.cameraL.matrixWorld.copy(r.matrixWorld).multiply(HS),this.cameraR.matrixWorld.copy(r.matrixWorld).multiply(US)}});class qT extends Ni{constructor(i){super(),this.type="Audio",this.listener=i,this.context=i.context,this.gain=this.context.createGain(),this.gain.connect(i.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(i){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=i,this.connect(),this}setMediaElementSource(i){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(i),this.connect(),this}setMediaStreamSource(i){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(i),this.connect(),this}setBuffer(i){return this.buffer=i,this.sourceType="buffer",this.autoplay&&this.play(),this}play(i){if(i===void 0&&(i=0),this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+i;const n=this.context.createBufferSource();return n.buffer=this.buffer,n.loop=this.loop,n.loopStart=this.loopStart,n.loopEnd=this.loopEnd,n.onended=this.onEnded.bind(this),n.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=n,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let i=1,n=this.filters.length;i<n;i++)this.filters[i-1].connect(this.filters[i]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let i=1,n=this.filters.length;i<n;i++)this.filters[i-1].disconnect(this.filters[i]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(i){return i||(i=[]),this._connected===!0?(this.disconnect(),this.filters=i,this.connect()):this.filters=i,this}setDetune(i){if(this.detune=i,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(i){return this.setFilters(i?[i]:[])}setPlaybackRate(i){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=i,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(i){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=i,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(i){return this.loopStart=i,this}setLoopEnd(i){return this.loopEnd=i,this}getVolume(){return this.gain.gain.value}setVolume(i){return this.gain.gain.setTargetAtTime(i,this.context.currentTime,.01),this}}function GS(r,i,n){this.binding=r,this.valueSize=n;let u,p,g;switch(i){case"quaternion":u=this._slerp,p=this._slerpAdditive,g=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(n*6),this._workIndex=5;break;case"string":case"bool":u=this._select,p=this._select,g=this._setAdditiveIdentityOther,this.buffer=new Array(n*5);break;default:u=this._lerp,p=this._lerpAdditive,g=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(n*5)}this._mixBufferRegion=u,this._mixBufferRegionAdditive=p,this._setIdentity=g,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}Object.assign(GS.prototype,{accumulate:function(r,i){const n=this.buffer,u=this.valueSize,p=r*u+u;let g=this.cumulativeWeight;if(g===0){for(let b=0;b!==u;++b)n[p+b]=n[b];g=i}else{g+=i;const b=i/g;this._mixBufferRegion(n,p,0,b,u)}this.cumulativeWeight=g},accumulateAdditive:function(r){const i=this.buffer,n=this.valueSize,u=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(i,u,0,r,n),this.cumulativeWeightAdditive+=r},apply:function(r){const i=this.valueSize,n=this.buffer,u=r*i+i,p=this.cumulativeWeight,g=this.cumulativeWeightAdditive,b=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,p<1){const M=i*this._origIndex;this._mixBufferRegion(n,u,M,1-p,i)}g>0&&this._mixBufferRegionAdditive(n,u,this._addIndex*i,1,i);for(let M=i,A=i+i;M!==A;++M)if(n[M]!==n[M+i]){b.setValue(n,u);break}},saveOriginalState:function(){const r=this.binding,i=this.buffer,n=this.valueSize,u=n*this._origIndex;r.getValue(i,u);for(let p=n,g=u;p!==g;++p)i[p]=i[u+p%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0},restoreOriginalState:function(){const r=this.valueSize*3;this.binding.setValue(this.buffer,r)},_setAdditiveIdentityNumeric:function(){const r=this._addIndex*this.valueSize,i=r+this.valueSize;for(let n=r;n<i;n++)this.buffer[n]=0},_setAdditiveIdentityQuaternion:function(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1},_setAdditiveIdentityOther:function(){const r=this._origIndex*this.valueSize,i=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[i+n]=this.buffer[r+n]},_select:function(r,i,n,u,p){if(u>=.5)for(let g=0;g!==p;++g)r[i+g]=r[n+g]},_slerp:function(r,i,n,u){Va.slerpFlat(r,i,r,i,r,n,u)},_slerpAdditive:function(r,i,n,u,p){const g=this._workIndex*p;Va.multiplyQuaternionsFlat(r,g,r,i,r,n),Va.slerpFlat(r,i,r,i,r,g,u)},_lerp:function(r,i,n,u,p){const g=1-u;for(let b=0;b!==p;++b){const M=i+b;r[M]=r[M]*g+r[n+b]*u}},_lerpAdditive:function(r,i,n,u,p){for(let g=0;g!==p;++g){const b=i+g;r[b]=r[b]+r[n+g]*u}}});const Ow="\\[\\]\\.:\\/",jT=new RegExp("["+Ow+"]","g"),Iw="[^"+Ow+"]",YT="[^"+Ow.replace("\\.","")+"]",ZT=/((?:WC+[\/:])*)/.source.replace("WC",Iw),JT=/(WCOD+)?/.source.replace("WCOD",YT),$T=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Iw),KT=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Iw),QT=new RegExp("^"+ZT+JT+$T+KT+"$"),eA=["material","materials","bones"];function VS(r,i,n){const u=n||eo.parseTrackName(i);this._targetGroup=r,this._bindings=r.subscribe_(i,u)}Object.assign(VS.prototype,{getValue:function(r,i){this.bind();const n=this._targetGroup.nCachedObjects_,u=this._bindings[n];u!==void 0&&u.getValue(r,i)},setValue:function(r,i){const n=this._bindings;for(let u=this._targetGroup.nCachedObjects_,p=n.length;u!==p;++u)n[u].setValue(r,i)},bind:function(){const r=this._bindings;for(let i=this._targetGroup.nCachedObjects_,n=r.length;i!==n;++i)r[i].bind()},unbind:function(){const r=this._bindings;for(let i=this._targetGroup.nCachedObjects_,n=r.length;i!==n;++i)r[i].unbind()}});function eo(r,i,n){this.path=i,this.parsedPath=n||eo.parseTrackName(i),this.node=eo.findNode(r,this.parsedPath.nodeName)||r,this.rootNode=r}Object.assign(eo,{Composite:VS,create:function(r,i,n){return r&&r.isAnimationObjectGroup?new eo.Composite(r,i,n):new eo(r,i,n)},sanitizeNodeName:function(r){return r.replace(/\s/g,"_").replace(jT,"")},parseTrackName:function(r){const i=QT.exec(r);if(!i)throw new Error("PropertyBinding: Cannot parse trackName: "+r);const n={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},u=n.nodeName&&n.nodeName.lastIndexOf(".");if(u!==void 0&&u!==-1){const p=n.nodeName.substring(u+1);eA.indexOf(p)!==-1&&(n.nodeName=n.nodeName.substring(0,u),n.objectName=p)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+r);return n},findNode:function(r,i){if(!i||i===""||i==="."||i===-1||i===r.name||i===r.uuid)return r;if(r.skeleton){const n=r.skeleton.getBoneByName(i);if(n!==void 0)return n}if(r.children){const n=function(p){for(let g=0;g<p.length;g++){const b=p[g];if(b.name===i||b.uuid===i)return b;const M=n(b.children);if(M)return M}return null},u=n(r.children);if(u)return u}return null}}),Object.assign(eo.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(i,n){i[n]=this.node[this.propertyName]},function(i,n){const u=this.resolvedProperty;for(let p=0,g=u.length;p!==g;++p)i[n++]=u[p]},function(i,n){i[n]=this.resolvedProperty[this.propertyIndex]},function(i,n){this.resolvedProperty.toArray(i,n)}],SetterByBindingTypeAndVersioning:[[function(i,n){this.targetObject[this.propertyName]=i[n]},function(i,n){this.targetObject[this.propertyName]=i[n],this.targetObject.needsUpdate=!0},function(i,n){this.targetObject[this.propertyName]=i[n],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(i,n){const u=this.resolvedProperty;for(let p=0,g=u.length;p!==g;++p)u[p]=i[n++]},function(i,n){const u=this.resolvedProperty;for(let p=0,g=u.length;p!==g;++p)u[p]=i[n++];this.targetObject.needsUpdate=!0},function(i,n){const u=this.resolvedProperty;for(let p=0,g=u.length;p!==g;++p)u[p]=i[n++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(i,n){this.resolvedProperty[this.propertyIndex]=i[n]},function(i,n){this.resolvedProperty[this.propertyIndex]=i[n],this.targetObject.needsUpdate=!0},function(i,n){this.resolvedProperty[this.propertyIndex]=i[n],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(i,n){this.resolvedProperty.fromArray(i,n)},function(i,n){this.resolvedProperty.fromArray(i,n),this.targetObject.needsUpdate=!0},function(i,n){this.resolvedProperty.fromArray(i,n),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(i,n){this.bind(),this.getValue(i,n)},setValue:function(i,n){this.bind(),this.setValue(i,n)},bind:function(){let r=this.node;const i=this.parsedPath,n=i.objectName,u=i.propertyName;let p=i.propertyIndex;if(r||(r=eo.findNode(this.rootNode,i.nodeName)||this.rootNode,this.node=r),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!r){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(n){let A=i.objectIndex;switch(n){case"materials":if(!r.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!r.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}r=r.material.materials;break;case"bones":if(!r.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}r=r.skeleton.bones;for(let C=0;C<r.length;C++)if(r[C].name===A){A=C;break}break;default:if(r[n]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}r=r[n]}if(A!==void 0){if(r[A]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,r);return}r=r[A]}}const g=r[u];if(g===void 0){const A=i.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+A+"."+u+" but it wasn't found.",r);return}let b=this.Versioning.None;this.targetObject=r,r.needsUpdate!==void 0?b=this.Versioning.NeedsUpdate:r.matrixWorldNeedsUpdate!==void 0&&(b=this.Versioning.MatrixWorldNeedsUpdate);let M=this.BindingType.Direct;if(p!==void 0){if(u==="morphTargetInfluences"){if(!r.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(r.geometry.isBufferGeometry){if(!r.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}r.morphTargetDictionary[p]!==void 0&&(p=r.morphTargetDictionary[p])}else{console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);return}}M=this.BindingType.ArrayElement,this.resolvedProperty=g,this.propertyIndex=p}else g.fromArray!==void 0&&g.toArray!==void 0?(M=this.BindingType.HasFromToArray,this.resolvedProperty=g):Array.isArray(g)?(M=this.BindingType.EntireArray,this.resolvedProperty=g):this.propertyName=u;this.getValue=this.GetterByBindingType[M],this.setValue=this.SetterByBindingTypeAndVersioning[M][b]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(eo.prototype,{_getValue_unbound:eo.prototype.getValue,_setValue_unbound:eo.prototype.setValue});function tA(){this.uuid=fr.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const r={};this._indicesByUUID=r;for(let n=0,u=arguments.length;n!==u;++n)r[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const i=this;this.stats={objects:{get total(){return i._objects.length},get inUse(){return this.total-i.nCachedObjects_}},get bindingsPerObject(){return i._bindings.length}}}Object.assign(tA.prototype,{isAnimationObjectGroup:!0,add:function(){const r=this._objects,i=this._indicesByUUID,n=this._paths,u=this._parsedPaths,p=this._bindings,g=p.length;let b,M=r.length,A=this.nCachedObjects_;for(let C=0,F=arguments.length;C!==F;++C){const O=arguments[C],k=O.uuid;let N=i[k];if(N===void 0){N=M++,i[k]=N,r.push(O);for(let X=0,ne=g;X!==ne;++X)p[X].push(new eo(O,n[X],u[X]))}else if(N<A){b=r[N];const X=--A,ne=r[X];i[ne.uuid]=N,r[N]=ne,i[k]=X,r[X]=O;for(let te=0,j=g;te!==j;++te){const W=p[te],Pe=W[X];let Re=W[N];W[N]=Pe,Re===void 0&&(Re=new eo(O,n[te],u[te])),W[X]=Re}}else r[N]!==b&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=A},remove:function(){const r=this._objects,i=this._indicesByUUID,n=this._bindings,u=n.length;let p=this.nCachedObjects_;for(let g=0,b=arguments.length;g!==b;++g){const M=arguments[g],A=M.uuid,C=i[A];if(C!==void 0&&C>=p){const F=p++,O=r[F];i[O.uuid]=C,r[C]=O,i[A]=F,r[F]=M;for(let k=0,N=u;k!==N;++k){const X=n[k],ne=X[F],te=X[C];X[C]=ne,X[F]=te}}}this.nCachedObjects_=p},uncache:function(){const r=this._objects,i=this._indicesByUUID,n=this._bindings,u=n.length;let p=this.nCachedObjects_,g=r.length;for(let b=0,M=arguments.length;b!==M;++b){const A=arguments[b],C=A.uuid,F=i[C];if(F!==void 0)if(delete i[C],F<p){const O=--p,k=r[O],N=--g,X=r[N];i[k.uuid]=F,r[F]=k,i[X.uuid]=O,r[O]=X,r.pop();for(let ne=0,te=u;ne!==te;++ne){const j=n[ne],W=j[O],Pe=j[N];j[F]=W,j[O]=Pe,j.pop()}}else{const O=--g,k=r[O];i[k.uuid]=F,r[F]=k,r.pop();for(let N=0,X=u;N!==X;++N){const ne=n[N];ne[F]=ne[O],ne.pop()}}}this.nCachedObjects_=p},subscribe_:function(r,i){const n=this._bindingsIndicesByPath;let u=n[r];const p=this._bindings;if(u!==void 0)return p[u];const g=this._paths,b=this._parsedPaths,M=this._objects,A=M.length,C=this.nCachedObjects_,F=new Array(A);u=p.length,n[r]=u,g.push(r),b.push(i),p.push(F);for(let O=C,k=M.length;O!==k;++O){const N=M[O];F[O]=new eo(N,r,i)}return F},unsubscribe_:function(r){const i=this._bindingsIndicesByPath,n=i[r];if(n!==void 0){const u=this._paths,p=this._parsedPaths,g=this._bindings,b=g.length-1,M=g[b],A=r[b];i[A]=n,g[n]=M,g.pop(),p[n]=p[b],p.pop(),u[n]=u[b],u.pop()}}});class nA{constructor(i,n,u,p){this._mixer=i,this._clip=n,this._localRoot=u||null,this.blendMode=p||n.blendMode;const g=n.tracks,b=g.length,M=new Array(b),A={endingStart:dh,endingEnd:dh};for(let C=0;C!==b;++C){const F=g[C].createInterpolant(null);M[C]=F,F.settings=A}this._interpolantSettings=A,this._interpolants=M,this._propertyBindings=new Array(b),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Mf,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(i){return this._startTime=i,this}setLoop(i,n){return this.loop=i,this.repetitions=n,this}setEffectiveWeight(i){return this.weight=i,this._effectiveWeight=this.enabled?i:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(i){return this._scheduleFading(i,0,1)}fadeOut(i){return this._scheduleFading(i,1,0)}crossFadeFrom(i,n,u){if(i.fadeOut(n),this.fadeIn(n),u){const p=this._clip.duration,g=i._clip.duration,b=g/p,M=p/g;i.warp(1,b,n),this.warp(M,1,n)}return this}crossFadeTo(i,n,u){return i.crossFadeFrom(this,n,u)}stopFading(){const i=this._weightInterpolant;return i!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(i)),this}setEffectiveTimeScale(i){return this.timeScale=i,this._effectiveTimeScale=this.paused?0:i,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(i){return this.timeScale=this._clip.duration/i,this.stopWarping()}syncWith(i){return this.time=i.time,this.timeScale=i.timeScale,this.stopWarping()}halt(i){return this.warp(this._effectiveTimeScale,0,i)}warp(i,n,u){const p=this._mixer,g=p.time,b=this.timeScale;let M=this._timeScaleInterpolant;M===null&&(M=p._lendControlInterpolant(),this._timeScaleInterpolant=M);const A=M.parameterPositions,C=M.sampleValues;return A[0]=g,A[1]=g+u,C[0]=i/b,C[1]=n/b,this}stopWarping(){const i=this._timeScaleInterpolant;return i!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(i)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(i,n,u,p){if(!this.enabled){this._updateWeight(i);return}const g=this._startTime;if(g!==null){const A=(i-g)*u;if(A<0||u===0)return;this._startTime=null,n=u*A}n*=this._updateTimeScale(i);const b=this._updateTime(n),M=this._updateWeight(i);if(M>0){const A=this._interpolants,C=this._propertyBindings;switch(this.blendMode){case Nm:for(let F=0,O=A.length;F!==O;++F)A[F].evaluate(b),C[F].accumulateAdditive(M);break;case Ro:default:for(let F=0,O=A.length;F!==O;++F)A[F].evaluate(b),C[F].accumulate(p,M)}}}_updateWeight(i){let n=0;if(this.enabled){n=this.weight;const u=this._weightInterpolant;if(u!==null){const p=u.evaluate(i)[0];n*=p,i>u.parameterPositions[1]&&(this.stopFading(),p===0&&(this.enabled=!1))}}return this._effectiveWeight=n,n}_updateTimeScale(i){let n=0;if(!this.paused){n=this.timeScale;const u=this._timeScaleInterpolant;u!==null&&(n*=u.evaluate(i)[0],i>u.parameterPositions[1]&&(this.stopWarping(),n===0?this.paused=!0:this.timeScale=n))}return this._effectiveTimeScale=n,n}_updateTime(i){const n=this._clip.duration,u=this.loop;let p=this.time+i,g=this._loopCount;const b=u===Jv;if(i===0)return g===-1?p:b&&(g&1)===1?n-p:p;if(u===wf){g===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(p>=n)p=n;else if(p<0)p=0;else{this.time=p;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=p,this._mixer.dispatchEvent({type:"finished",action:this,direction:i<0?-1:1})}}else{if(g===-1&&(i>=0?(g=0,this._setEndings(!0,this.repetitions===0,b)):this._setEndings(this.repetitions===0,!0,b)),p>=n||p<0){const M=Math.floor(p/n);p-=n*M,g+=Math.abs(M);const A=this.repetitions-g;if(A<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,p=i>0?n:0,this.time=p,this._mixer.dispatchEvent({type:"finished",action:this,direction:i>0?1:-1});else{if(A===1){const C=i<0;this._setEndings(C,!C,b)}else this._setEndings(!1,!1,b);this._loopCount=g,this.time=p,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:M})}}else this.time=p;if(b&&(g&1)===1)return n-p}return p}_setEndings(i,n,u){const p=this._interpolantSettings;u?(p.endingStart=ml,p.endingEnd=ml):(i?p.endingStart=this.zeroSlopeAtStart?ml:dh:p.endingStart=du,n?p.endingEnd=this.zeroSlopeAtEnd?ml:dh:p.endingEnd=du)}_scheduleFading(i,n,u){const p=this._mixer,g=p.time;let b=this._weightInterpolant;b===null&&(b=p._lendControlInterpolant(),this._weightInterpolant=b);const M=b.parameterPositions,A=b.sampleValues;return M[0]=g,A[0]=n,M[1]=g+i,A[1]=u,this}}function WS(r){this._root=r,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}WS.prototype=Object.assign(Object.create(go.prototype),{constructor:WS,_bindAction:function(r,i){const n=r._localRoot||this._root,u=r._clip.tracks,p=u.length,g=r._propertyBindings,b=r._interpolants,M=n.uuid,A=this._bindingsByRootAndName;let C=A[M];C===void 0&&(C={},A[M]=C);for(let F=0;F!==p;++F){const O=u[F],k=O.name;let N=C[k];if(N!==void 0)g[F]=N;else{if(N=g[F],N!==void 0){N._cacheIndex===null&&(++N.referenceCount,this._addInactiveBinding(N,M,k));continue}const X=i&&i._propertyBindings[F].binding.parsedPath;N=new GS(eo.create(n,k,X),O.ValueTypeName,O.getValueSize()),++N.referenceCount,this._addInactiveBinding(N,M,k),g[F]=N}b[F].resultBuffer=N.buffer}},_activateAction:function(r){if(!this._isActiveAction(r)){if(r._cacheIndex===null){const n=(r._localRoot||this._root).uuid,u=r._clip.uuid,p=this._actionsByClip[u];this._bindAction(r,p&&p.knownActions[0]),this._addInactiveAction(r,u,n)}const i=r._propertyBindings;for(let n=0,u=i.length;n!==u;++n){const p=i[n];p.useCount++===0&&(this._lendBinding(p),p.saveOriginalState())}this._lendAction(r)}},_deactivateAction:function(r){if(this._isActiveAction(r)){const i=r._propertyBindings;for(let n=0,u=i.length;n!==u;++n){const p=i[n];--p.useCount===0&&(p.restoreOriginalState(),this._takeBackBinding(p))}this._takeBackAction(r)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const r=this;this.stats={actions:{get total(){return r._actions.length},get inUse(){return r._nActiveActions}},bindings:{get total(){return r._bindings.length},get inUse(){return r._nActiveBindings}},controlInterpolants:{get total(){return r._controlInterpolants.length},get inUse(){return r._nActiveControlInterpolants}}}},_isActiveAction:function(r){const i=r._cacheIndex;return i!==null&&i<this._nActiveActions},_addInactiveAction:function(r,i,n){const u=this._actions,p=this._actionsByClip;let g=p[i];if(g===void 0)g={knownActions:[r],actionByRoot:{}},r._byClipCacheIndex=0,p[i]=g;else{const b=g.knownActions;r._byClipCacheIndex=b.length,b.push(r)}r._cacheIndex=u.length,u.push(r),g.actionByRoot[n]=r},_removeInactiveAction:function(r){const i=this._actions,n=i[i.length-1],u=r._cacheIndex;n._cacheIndex=u,i[u]=n,i.pop(),r._cacheIndex=null;const p=r._clip.uuid,g=this._actionsByClip,b=g[p],M=b.knownActions,A=M[M.length-1],C=r._byClipCacheIndex;A._byClipCacheIndex=C,M[C]=A,M.pop(),r._byClipCacheIndex=null;const F=b.actionByRoot,O=(r._localRoot||this._root).uuid;delete F[O],M.length===0&&delete g[p],this._removeInactiveBindingsForAction(r)},_removeInactiveBindingsForAction:function(r){const i=r._propertyBindings;for(let n=0,u=i.length;n!==u;++n){const p=i[n];--p.referenceCount===0&&this._removeInactiveBinding(p)}},_lendAction:function(r){const i=this._actions,n=r._cacheIndex,u=this._nActiveActions++,p=i[u];r._cacheIndex=u,i[u]=r,p._cacheIndex=n,i[n]=p},_takeBackAction:function(r){const i=this._actions,n=r._cacheIndex,u=--this._nActiveActions,p=i[u];r._cacheIndex=u,i[u]=r,p._cacheIndex=n,i[n]=p},_addInactiveBinding:function(r,i,n){const u=this._bindingsByRootAndName,p=this._bindings;let g=u[i];g===void 0&&(g={},u[i]=g),g[n]=r,r._cacheIndex=p.length,p.push(r)},_removeInactiveBinding:function(r){const i=this._bindings,n=r.binding,u=n.rootNode.uuid,p=n.path,g=this._bindingsByRootAndName,b=g[u],M=i[i.length-1],A=r._cacheIndex;M._cacheIndex=A,i[A]=M,i.pop(),delete b[p],Object.keys(b).length===0&&delete g[u]},_lendBinding:function(r){const i=this._bindings,n=r._cacheIndex,u=this._nActiveBindings++,p=i[u];r._cacheIndex=u,i[u]=r,p._cacheIndex=n,i[n]=p},_takeBackBinding:function(r){const i=this._bindings,n=r._cacheIndex,u=--this._nActiveBindings,p=i[u];r._cacheIndex=u,i[u]=r,p._cacheIndex=n,i[n]=p},_lendControlInterpolant:function(){const r=this._controlInterpolants,i=this._nActiveControlInterpolants++;let n=r[i];return n===void 0&&(n=new A0(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),n.__cacheIndex=i,r[i]=n),n},_takeBackControlInterpolant:function(r){const i=this._controlInterpolants,n=r.__cacheIndex,u=--this._nActiveControlInterpolants,p=i[u];r.__cacheIndex=u,i[u]=r,p.__cacheIndex=n,i[n]=p},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(r,i,n){const u=i||this._root,p=u.uuid;let g=typeof r=="string"?Jl.findByName(u,r):r;const b=g!==null?g.uuid:r,M=this._actionsByClip[b];let A=null;if(n===void 0&&(g!==null?n=g.blendMode:n=Ro),M!==void 0){const F=M.actionByRoot[p];if(F!==void 0&&F.blendMode===n)return F;A=M.knownActions[0],g===null&&(g=A._clip)}if(g===null)return null;const C=new nA(this,g,i,n);return this._bindAction(C,A),this._addInactiveAction(C,b,p),C},existingAction:function(r,i){const n=i||this._root,u=n.uuid,p=typeof r=="string"?Jl.findByName(n,r):r,g=p?p.uuid:r,b=this._actionsByClip[g];return b!==void 0&&b.actionByRoot[u]||null},stopAllAction:function(){const r=this._actions,i=this._nActiveActions;for(let n=i-1;n>=0;--n)r[n].stop();return this},update:function(r){r*=this.timeScale;const i=this._actions,n=this._nActiveActions,u=this.time+=r,p=Math.sign(r),g=this._accuIndex^=1;for(let A=0;A!==n;++A)i[A]._update(u,r,p,g);const b=this._bindings,M=this._nActiveBindings;for(let A=0;A!==M;++A)b[A].apply(g);return this},setTime:function(r){this.time=0;for(let i=0;i<this._actions.length;i++)this._actions[i].time=0;return this.update(r)},getRoot:function(){return this._root},uncacheClip:function(r){const i=this._actions,n=r.uuid,u=this._actionsByClip,p=u[n];if(p!==void 0){const g=p.knownActions;for(let b=0,M=g.length;b!==M;++b){const A=g[b];this._deactivateAction(A);const C=A._cacheIndex,F=i[i.length-1];A._cacheIndex=null,A._byClipCacheIndex=null,F._cacheIndex=C,i[C]=F,i.pop(),this._removeInactiveBindingsForAction(A)}delete u[n]}},uncacheRoot:function(r){const i=r.uuid,n=this._actionsByClip;for(const g in n){const b=n[g].actionByRoot,M=b[i];M!==void 0&&(this._deactivateAction(M),this._removeInactiveAction(M))}const u=this._bindingsByRootAndName,p=u[i];if(p!==void 0)for(const g in p){const b=p[g];b.restoreOriginalState(),this._removeInactiveBinding(b)}},uncacheAction:function(r,i){const n=this.existingAction(r,i);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}});class Nw{constructor(i){typeof i=="string"&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),i=arguments[1]),this.value=i}clone(){return new Nw(this.value.clone===void 0?this.value:this.value.clone())}}function XS(r,i,n){Ko.call(this,r,i),this.meshPerAttribute=n||1}XS.prototype=Object.assign(Object.create(Ko.prototype),{constructor:XS,isInstancedInterleavedBuffer:!0,copy:function(r){return Ko.prototype.copy.call(this,r),this.meshPerAttribute=r.meshPerAttribute,this},clone:function(r){const i=Ko.prototype.clone.call(this,r);return i.meshPerAttribute=this.meshPerAttribute,i},toJSON:function(r){const i=Ko.prototype.toJSON.call(this,r);return i.isInstancedInterleavedBuffer=!0,i.meshPerAttribute=this.meshPerAttribute,i}});function qS(r,i,n,u,p){this.buffer=r,this.type=i,this.itemSize=n,this.elementSize=u,this.count=p,this.version=0}Object.defineProperty(qS.prototype,"needsUpdate",{set:function(r){r===!0&&this.version++}}),Object.assign(qS.prototype,{isGLBufferAttribute:!0,setBuffer:function(r){return this.buffer=r,this},setType:function(r,i){return this.type=r,this.elementSize=i,this},setItemSize:function(r){return this.itemSize=r,this},setCount:function(r){return this.count=r,this}});function jS(r,i,n,u){this.ray=new Mu(r,i),this.near=n||0,this.far=u||1/0,this.camera=null,this.layers=new ty,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function YS(r,i){return r.distance-i.distance}function Fw(r,i,n,u){if(r.layers.test(i.layers)&&r.raycast(i,n),u===!0){const p=r.children;for(let g=0,b=p.length;g<b;g++)Fw(p[g],i,n,!0)}}Object.assign(jS.prototype,{set:function(r,i){this.ray.set(r,i)},setFromCamera:function(r,i){i&&i.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(i.matrixWorld),this.ray.direction.set(r.x,r.y,.5).unproject(i).sub(this.ray.origin).normalize(),this.camera=i):i&&i.isOrthographicCamera?(this.ray.origin.set(r.x,r.y,(i.near+i.far)/(i.near-i.far)).unproject(i),this.ray.direction.set(0,0,-1).transformDirection(i.matrixWorld),this.camera=i):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(r,i,n){const u=n||[];return Fw(r,this,u,i),u.sort(YS),u},intersectObjects:function(r,i,n){const u=n||[];if(Array.isArray(r)===!1)return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),u;for(let p=0,g=r.length;p<g;p++)Fw(r[p],this,u,i);return u.sort(YS),u}});class ZS{constructor(i=1,n=0,u=0){return this.radius=i,this.phi=n,this.theta=u,this}set(i,n,u){return this.radius=i,this.phi=n,this.theta=u,this}clone(){return new this.constructor().copy(this)}copy(i){return this.radius=i.radius,this.phi=i.phi,this.theta=i.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(i){return this.setFromCartesianCoords(i.x,i.y,i.z)}setFromCartesianCoords(i,n,u){return this.radius=Math.sqrt(i*i+n*n+u*u),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(i,u),this.phi=Math.acos(fr.clamp(n/this.radius,-1,1))),this}}const JS=new vn;class iA{constructor(i,n){Object.defineProperty(this,"isBox2",{value:!0}),this.min=i!==void 0?i:new vn(1/0,1/0),this.max=n!==void 0?n:new vn(-1/0,-1/0)}set(i,n){return this.min.copy(i),this.max.copy(n),this}setFromPoints(i){this.makeEmpty();for(let n=0,u=i.length;n<u;n++)this.expandByPoint(i[n]);return this}setFromCenterAndSize(i,n){const u=JS.copy(n).multiplyScalar(.5);return this.min.copy(i).sub(u),this.max.copy(i).add(u),this}clone(){return new this.constructor().copy(this)}copy(i){return this.min.copy(i.min),this.max.copy(i.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(i){return i===void 0&&(console.warn("THREE.Box2: .getCenter() target is now required"),i=new vn),this.isEmpty()?i.set(0,0):i.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(i){return i===void 0&&(console.warn("THREE.Box2: .getSize() target is now required"),i=new vn),this.isEmpty()?i.set(0,0):i.subVectors(this.max,this.min)}expandByPoint(i){return this.min.min(i),this.max.max(i),this}expandByVector(i){return this.min.sub(i),this.max.add(i),this}expandByScalar(i){return this.min.addScalar(-i),this.max.addScalar(i),this}containsPoint(i){return!(i.x<this.min.x||i.x>this.max.x||i.y<this.min.y||i.y>this.max.y)}containsBox(i){return this.min.x<=i.min.x&&i.max.x<=this.max.x&&this.min.y<=i.min.y&&i.max.y<=this.max.y}getParameter(i,n){return n===void 0&&(console.warn("THREE.Box2: .getParameter() target is now required"),n=new vn),n.set((i.x-this.min.x)/(this.max.x-this.min.x),(i.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(i){return!(i.max.x<this.min.x||i.min.x>this.max.x||i.max.y<this.min.y||i.min.y>this.max.y)}clampPoint(i,n){return n===void 0&&(console.warn("THREE.Box2: .clampPoint() target is now required"),n=new vn),n.copy(i).clamp(this.min,this.max)}distanceToPoint(i){return JS.copy(i).clamp(this.min,this.max).sub(i).length()}intersect(i){return this.min.max(i.min),this.max.min(i.max),this}union(i){return this.min.min(i.min),this.max.max(i.max),this}translate(i){return this.min.add(i),this.max.add(i),this}equals(i){return i.min.equals(this.min)&&i.max.equals(this.max)}}function N0(r){Ni.call(this),this.material=r,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}N0.prototype=Object.create(Ni.prototype),N0.prototype.constructor=N0,N0.prototype.isImmediateRenderObject=!0;const zh=new De,F0=new yr,Bw=new yr;class rA extends Ag{constructor(i){const n=$S(i),u=new hs,p=[],g=[],b=new Mi(0,0,1),M=new Mi(0,1,0);for(let C=0;C<n.length;C++){const F=n[C];F.parent&&F.parent.isBone&&(p.push(0,0,0),p.push(0,0,0),g.push(b.r,b.g,b.b),g.push(M.r,M.g,M.b))}u.setAttribute("position",new is(p,3)),u.setAttribute("color",new is(g,3));const A=new Qo({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(u,A),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=i,this.bones=n,this.matrix=i.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(i){const n=this.bones,u=this.geometry,p=u.getAttribute("position");Bw.getInverse(this.root.matrixWorld);for(let g=0,b=0;g<n.length;g++){const M=n[g];M.parent&&M.parent.isBone&&(F0.multiplyMatrices(Bw,M.matrixWorld),zh.setFromMatrixPosition(F0),p.setXYZ(b,zh.x,zh.y,zh.z),F0.multiplyMatrices(Bw,M.parent.matrixWorld),zh.setFromMatrixPosition(F0),p.setXYZ(b+1,zh.x,zh.y,zh.z),b+=2)}u.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(i)}}function $S(r){const i=[];r&&r.isBone&&i.push(r);for(let n=0;n<r.children.length;n++)i.push.apply(i,$S(r.children[n]));return i}class sA extends Ag{constructor(i,n,u,p){i=i||10,n=n||10,u=new Mi(u!==void 0?u:4473924),p=new Mi(p!==void 0?p:8947848);const g=n/2,b=i/n,M=i/2,A=[],C=[];for(let k=0,N=0,X=-M;k<=n;k++,X+=b){A.push(-M,0,X,M,0,X),A.push(X,0,-M,X,0,M);const ne=k===g?u:p;ne.toArray(C,N),N+=3,ne.toArray(C,N),N+=3,ne.toArray(C,N),N+=3,ne.toArray(C,N),N+=3}const F=new hs;F.setAttribute("position",new is(A,3)),F.setAttribute("color",new is(C,3));const O=new Qo({vertexColors:!0,toneMapped:!1});super(F,O),this.type="GridHelper"}}Wi.create=function(r,i){return console.log("THREE.Curve.create() has been deprecated"),r.prototype=Object.create(Wi.prototype),r.prototype.constructor=r,r.prototype.getPoint=i,r},Object.assign(kh.prototype,{createPointsGeometry:function(r){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");const i=this.getPoints(r);return this.createGeometry(i)},createSpacedPointsGeometry:function(r){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");const i=this.getSpacedPoints(r);return this.createGeometry(i)},createGeometry:function(r){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");const i=new Zl;for(let n=0,u=r.length;n<u;n++){const p=r[n];i.vertices.push(new De(p.x,p.y,p.z||0))}return i}}),Object.assign(Wc.prototype,{fromPoints:function(r){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(r)}});function KS(r){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),Ql.call(this,r),this.type="catmullrom"}KS.prototype=Object.create(Ql.prototype),Object.assign(KS.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),sA.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},rA.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(ys.prototype,{extractUrlBase:function(r){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),zp.extractUrlBase(r)}}),ys.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Object.assign(iA.prototype,{center:function(r){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(r)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(r){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(r)},size:function(r){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(r)}}),Object.assign(Ps.prototype,{center:function(r){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(r)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(r){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(r)},isIntersectionSphere:function(r){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(r)},size:function(r){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(r)}}),Object.assign(zl.prototype,{empty:function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()}}),sp.prototype.setFromMatrix=function(r){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(r)},Object.assign(fr,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(r){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),fr.floorPowerOfTwo(r)},nextPowerOfTwo:function(r){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),fr.ceilPowerOfTwo(r)}}),Object.assign(Ja.prototype,{flattenToArrayOffset:function(r,i){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(r,i)},multiplyVector3:function(r){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),r.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(r){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),r.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(yr.prototype,{extractPosition:function(r){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(r)},flattenToArrayOffset:function(r,i){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(r,i)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),new De().setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(r){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(r)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(r){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),r.applyMatrix4(this)},multiplyVector4:function(r){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),r.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(r){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),r.transformDirection(this)},crossVector:function(r){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),r.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(r){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),r.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(r,i,n,u,p,g){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(r,i,u,n,p,g)}}),Ka.prototype.isIntersectionLine=function(r){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(r)},Va.prototype.multiplyVector3=function(r){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),r.applyQuaternion(this)},Object.assign(Mu.prototype,{isIntersectionBox:function(r){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(r)},isIntersectionPlane:function(r){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(r)},isIntersectionSphere:function(r){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(r)}}),Object.assign(xa.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(r,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(r,i)},midpoint:function(r){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(r)},normal:function(r){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(r)},plane:function(r){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(r)}}),Object.assign(xa,{barycoordFromPoint:function(r,i,n,u,p){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),xa.getBarycoord(r,i,n,u,p)},normal:function(r,i,n,u){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),xa.getNormal(r,i,n,u)}}),Object.assign(kp.prototype,{extractAllPoints:function(r){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(r)},extrude:function(r){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new wT(this,r)},makeGeometry:function(r){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new TT(this,r)}}),Object.assign(vn.prototype,{fromAttribute:function(r,i,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(r,i,n)},distanceToManhattan:function(r){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(r)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(De.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(r){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(r)},getScaleFromMatrix:function(r){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(r)},getColumnFromMatrix:function(r,i){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(i,r)},applyProjection:function(r){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(r)},fromAttribute:function(r,i,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(r,i,n)},distanceToManhattan:function(r){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(r)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(vs.prototype,{fromAttribute:function(r,i,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(r,i,n)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Zl.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")},applyMatrix:function(r){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(r)}}),Object.assign(Ni.prototype,{getChildByName:function(r){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(r)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(r,i){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(i,r)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(r){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(r)}}),Object.defineProperties(Ni.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(r){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=r}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.assign(Ca.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}),Object.defineProperties(Ca.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),$v},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Object.defineProperties(iw.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(d0.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),f0.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(Wi.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(r){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=r}}),ba.prototype.setLens=function(r,i){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),i!==void 0&&(this.filmGauge=i),this.setFocalLength(r)},Object.defineProperties(ks.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(r){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=r}},shadowCameraLeft:{set:function(r){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=r}},shadowCameraRight:{set:function(r){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=r}},shadowCameraTop:{set:function(r){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=r}},shadowCameraBottom:{set:function(r){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=r}},shadowCameraNear:{set:function(r){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=r}},shadowCameraFar:{set:function(r){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=r}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(r){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=r}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(r){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=r}},shadowMapHeight:{set:function(r){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=r}}}),Object.defineProperties(sr.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===gu},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(gu)}}}),Object.assign(sr.prototype,{setDynamic:function(r){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(r===!0?gu:Ef),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(hs.prototype,{addIndex:function(r){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(r)},addAttribute:function(r,i){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),!(i&&i.isBufferAttribute)&&!(i&&i.isInterleavedBufferAttribute)?(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(r,new sr(arguments[1],arguments[2]))):r==="index"?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(i),this):this.setAttribute(r,i)},addDrawCall:function(r,i,n){n!==void 0&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(r,i)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(r){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(r)},applyMatrix:function(r){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(r)}}),Object.defineProperties(hs.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(D0.prototype,{maxInstancedCount:{get:function(){return console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount},set:function(r){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount=r}}}),Object.defineProperties(jS.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(r){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=r}}}),Object.defineProperties(Ko.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===gu},set:function(r){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(r)}}}),Object.assign(Ko.prototype,{setDynamic:function(r){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(r===!0?gu:Ef),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(TS.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.assign(eT.prototype,{dispose:function(){console.error("THREE.Scene: .dispose() has been removed.")}}),Object.defineProperties(Nw.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(Yi.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Mi}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(r){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=r===Ft}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(r){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=r}}}),Object.defineProperties(ed.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(Ou.prototype,{transparency:{get:function(){return console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission},set:function(r){console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission=r}}}),Object.defineProperties(Fa.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(r){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=r}}}),Object.assign(o0.prototype,{clearTarget:function(r,i,n,u){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(r),this.clear(i,n,u)},animate:function(r){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(r)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(r){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(r)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Object.defineProperties(o0.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(r){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=r}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(r){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=r}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(r){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=r===!0?ph:Bl}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(Dh.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(qo.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(r){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=r}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(r){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=r}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(r){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=r}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(r){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=r}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(r){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=r}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(r){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=r}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(r){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=r}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(r){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=r}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(r){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=r}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(r){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=r}}}),Object.defineProperties(qT.prototype,{load:{value:function(r){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const i=this;return new Dw().load(r,function(u){i.setBuffer(u)}),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),bh.prototype.updateCubeMap=function(r,i){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(r,i)},kl.crossOrigin=void 0,kl.loadTexture=function(r,i,n,u){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const p=new C0;p.setCrossOrigin(this.crossOrigin);const g=p.load(r,n,void 0,u);return i&&(g.mapping=i),g},kl.loadTextureCube=function(r,i,n,u){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const p=new xw;p.setCrossOrigin(this.crossOrigin);const g=p.load(r,n,void 0,u);return i&&(g.mapping=i),g},kl.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},kl.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Yt}}));var zg=function(r,i){i===void 0&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),i===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=r,this.domElement=i,this.enabled=!0,this.target=new De,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:Pn.ROTATE,MIDDLE:Pn.DOLLY,RIGHT:Pn.PAN},this.touches={ONE:Nt.ROTATE,TWO:Nt.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return C.phi},this.getAzimuthalAngle=function(){return C.theta},this.saveState=function(){n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=function(){n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(u),n.update(),M=b.NONE},this.update=function(){var Oe=new De,Ht=new Va().setFromUnitVectors(r.up,new De(0,1,0)),Kn=Ht.clone().inverse(),hn=new De,jn=new Va,er=2*Math.PI;return function(){var wa=n.object.position;Oe.copy(wa).sub(n.target),Oe.applyQuaternion(Ht),C.setFromVector3(Oe),n.autoRotate&&M===b.NONE&&dt($e()),n.enableDamping?(C.theta+=F.theta*n.dampingFactor,C.phi+=F.phi*n.dampingFactor):(C.theta+=F.theta,C.phi+=F.phi);var zs=n.minAzimuthAngle,Ra=n.maxAzimuthAngle;return isFinite(zs)&&isFinite(Ra)&&(zs<-Math.PI?zs+=er:zs>Math.PI&&(zs-=er),Ra<-Math.PI?Ra+=er:Ra>Math.PI&&(Ra-=er),zs<Ra?C.theta=Math.max(zs,Math.min(Ra,C.theta)):C.theta=C.theta>(zs+Ra)/2?Math.max(zs,C.theta):Math.min(Ra,C.theta)),C.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,C.phi)),C.makeSafe(),C.radius*=O,C.radius=Math.max(n.minDistance,Math.min(n.maxDistance,C.radius)),n.enableDamping===!0?n.target.addScaledVector(k,n.dampingFactor):n.target.add(k),Oe.setFromSpherical(C),Oe.applyQuaternion(Kn),wa.copy(n.target).add(Oe),n.object.lookAt(n.target),n.enableDamping===!0?(F.theta*=1-n.dampingFactor,F.phi*=1-n.dampingFactor,k.multiplyScalar(1-n.dampingFactor)):(F.set(0,0,0),k.set(0,0,0)),O=1,N||hn.distanceToSquared(n.object.position)>A||8*(1-jn.dot(n.object.quaternion))>A?(n.dispatchEvent(u),hn.copy(n.object.position),jn.copy(n.object.quaternion),N=!1,!0):!1}}(),this.dispose=function(){n.domElement.removeEventListener("contextmenu",xn,!1),n.domElement.removeEventListener("pointerdown",ot,!1),n.domElement.removeEventListener("wheel",yt,!1),n.domElement.removeEventListener("touchstart",Pt,!1),n.domElement.removeEventListener("touchend",qn,!1),n.domElement.removeEventListener("touchmove",Kt,!1),n.domElement.ownerDocument.removeEventListener("pointermove",bt,!1),n.domElement.ownerDocument.removeEventListener("pointerup",Mt,!1),n.domElement.removeEventListener("keydown",Ce,!1)};var n=this,u={type:"change"},p={type:"start"},g={type:"end"},b={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},M=b.NONE,A=1e-6,C=new ZS,F=new ZS,O=1,k=new De,N=!1,X=new vn,ne=new vn,te=new vn,j=new vn,W=new vn,Pe=new vn,Re=new vn,Ne=new vn,de=new vn;function $e(){return 2*Math.PI/60/60*n.autoRotateSpeed}function Gt(){return Math.pow(.95,n.zoomSpeed)}function dt(Oe){F.theta-=Oe}function an(Oe){F.phi-=Oe}var _t=function(){var Oe=new De;return function(Kn,hn){Oe.setFromMatrixColumn(hn,0),Oe.multiplyScalar(-Kn),k.add(Oe)}}(),et=function(){var Oe=new De;return function(Kn,hn){n.screenSpacePanning===!0?Oe.setFromMatrixColumn(hn,1):(Oe.setFromMatrixColumn(hn,0),Oe.crossVectors(n.object.up,Oe)),Oe.multiplyScalar(Kn),k.add(Oe)}}(),rt=function(){var Oe=new De;return function(Kn,hn){var jn=n.domElement;if(n.object.isPerspectiveCamera){var er=n.object.position;Oe.copy(er).sub(n.target);var ts=Oe.length();ts*=Math.tan(n.object.fov/2*Math.PI/180),_t(2*Kn*ts/jn.clientHeight,n.object.matrix),et(2*hn*ts/jn.clientHeight,n.object.matrix)}else n.object.isOrthographicCamera?(_t(Kn*(n.object.right-n.object.left)/n.object.zoom/jn.clientWidth,n.object.matrix),et(hn*(n.object.top-n.object.bottom)/n.object.zoom/jn.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}}();function je(Oe){n.object.isPerspectiveCamera?O/=Oe:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom*Oe)),n.object.updateProjectionMatrix(),N=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function Ve(Oe){n.object.isPerspectiveCamera?O*=Oe:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/Oe)),n.object.updateProjectionMatrix(),N=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function ht(Oe){X.set(Oe.clientX,Oe.clientY)}function ft(Oe){Re.set(Oe.clientX,Oe.clientY)}function Wt(Oe){j.set(Oe.clientX,Oe.clientY)}function An(Oe){ne.set(Oe.clientX,Oe.clientY),te.subVectors(ne,X).multiplyScalar(n.rotateSpeed);var Ht=n.domElement;dt(2*Math.PI*te.x/Ht.clientHeight),an(2*Math.PI*te.y/Ht.clientHeight),X.copy(ne),n.update()}function Vt(Oe){Ne.set(Oe.clientX,Oe.clientY),de.subVectors(Ne,Re),de.y>0?je(Gt()):de.y<0&&Ve(Gt()),Re.copy(Ne),n.update()}function Dn(Oe){W.set(Oe.clientX,Oe.clientY),Pe.subVectors(W,j).multiplyScalar(n.panSpeed),rt(Pe.x,Pe.y),j.copy(W),n.update()}function Ci(Oe){Oe.deltaY<0?Ve(Gt()):Oe.deltaY>0&&je(Gt()),n.update()}function vi(Oe){var Ht=!1;switch(Oe.keyCode){case n.keys.UP:rt(0,n.keyPanSpeed),Ht=!0;break;case n.keys.BOTTOM:rt(0,-n.keyPanSpeed),Ht=!0;break;case n.keys.LEFT:rt(n.keyPanSpeed,0),Ht=!0;break;case n.keys.RIGHT:rt(-n.keyPanSpeed,0),Ht=!0;break}Ht&&(Oe.preventDefault(),n.update())}function he(Oe){if(Oe.touches.length==1)X.set(Oe.touches[0].pageX,Oe.touches[0].pageY);else{var Ht=.5*(Oe.touches[0].pageX+Oe.touches[1].pageX),Kn=.5*(Oe.touches[0].pageY+Oe.touches[1].pageY);X.set(Ht,Kn)}}function K(Oe){if(Oe.touches.length==1)j.set(Oe.touches[0].pageX,Oe.touches[0].pageY);else{var Ht=.5*(Oe.touches[0].pageX+Oe.touches[1].pageX),Kn=.5*(Oe.touches[0].pageY+Oe.touches[1].pageY);j.set(Ht,Kn)}}function Fe(Oe){var Ht=Oe.touches[0].pageX-Oe.touches[1].pageX,Kn=Oe.touches[0].pageY-Oe.touches[1].pageY,hn=Math.sqrt(Ht*Ht+Kn*Kn);Re.set(0,hn)}function me(Oe){n.enableZoom&&Fe(Oe),n.enablePan&&K(Oe)}function Le(Oe){n.enableZoom&&Fe(Oe),n.enableRotate&&he(Oe)}function Be(Oe){if(Oe.touches.length==1)ne.set(Oe.touches[0].pageX,Oe.touches[0].pageY);else{var Ht=.5*(Oe.touches[0].pageX+Oe.touches[1].pageX),Kn=.5*(Oe.touches[0].pageY+Oe.touches[1].pageY);ne.set(Ht,Kn)}te.subVectors(ne,X).multiplyScalar(n.rotateSpeed);var hn=n.domElement;dt(2*Math.PI*te.x/hn.clientHeight),an(2*Math.PI*te.y/hn.clientHeight),X.copy(ne)}function Ye(Oe){if(Oe.touches.length==1)W.set(Oe.touches[0].pageX,Oe.touches[0].pageY);else{var Ht=.5*(Oe.touches[0].pageX+Oe.touches[1].pageX),Kn=.5*(Oe.touches[0].pageY+Oe.touches[1].pageY);W.set(Ht,Kn)}Pe.subVectors(W,j).multiplyScalar(n.panSpeed),rt(Pe.x,Pe.y),j.copy(W)}function ke(Oe){var Ht=Oe.touches[0].pageX-Oe.touches[1].pageX,Kn=Oe.touches[0].pageY-Oe.touches[1].pageY,hn=Math.sqrt(Ht*Ht+Kn*Kn);Ne.set(0,hn),de.set(0,Math.pow(Ne.y/Re.y,n.zoomSpeed)),je(de.y),Re.copy(Ne)}function He(Oe){n.enableZoom&&ke(Oe),n.enablePan&&Ye(Oe)}function Je(Oe){n.enableZoom&&ke(Oe),n.enableRotate&&Be(Oe)}function ot(Oe){if(n.enabled!==!1)switch(Oe.pointerType){case"mouse":case"pen":ue(Oe);break}}function bt(Oe){if(n.enabled!==!1)switch(Oe.pointerType){case"mouse":case"pen":oe(Oe);break}}function Mt(Oe){if(n.enabled!==!1)switch(Oe.pointerType){case"mouse":case"pen":lt();break}}function ue(Oe){Oe.preventDefault(),n.domElement.focus?n.domElement.focus():window.focus();var Ht;switch(Oe.button){case 0:Ht=n.mouseButtons.LEFT;break;case 1:Ht=n.mouseButtons.MIDDLE;break;case 2:Ht=n.mouseButtons.RIGHT;break;default:Ht=-1}switch(Ht){case Pn.DOLLY:if(n.enableZoom===!1)return;ft(Oe),M=b.DOLLY;break;case Pn.ROTATE:if(Oe.ctrlKey||Oe.metaKey||Oe.shiftKey){if(n.enablePan===!1)return;Wt(Oe),M=b.PAN}else{if(n.enableRotate===!1)return;ht(Oe),M=b.ROTATE}break;case Pn.PAN:if(Oe.ctrlKey||Oe.metaKey||Oe.shiftKey){if(n.enableRotate===!1)return;ht(Oe),M=b.ROTATE}else{if(n.enablePan===!1)return;Wt(Oe),M=b.PAN}break;default:M=b.NONE}M!==b.NONE&&(n.domElement.ownerDocument.addEventListener("pointermove",bt,!1),n.domElement.ownerDocument.addEventListener("pointerup",Mt,!1),n.dispatchEvent(p))}function oe(Oe){if(n.enabled!==!1)switch(Oe.preventDefault(),M){case b.ROTATE:if(n.enableRotate===!1)return;An(Oe);break;case b.DOLLY:if(n.enableZoom===!1)return;Vt(Oe);break;case b.PAN:if(n.enablePan===!1)return;Dn(Oe);break}}function lt(Oe){n.enabled!==!1&&(n.domElement.ownerDocument.removeEventListener("pointermove",bt,!1),n.domElement.ownerDocument.removeEventListener("pointerup",Mt,!1),n.dispatchEvent(g),M=b.NONE)}function yt(Oe){n.enabled===!1||n.enableZoom===!1||M!==b.NONE&&M!==b.ROTATE||(Oe.preventDefault(),Oe.stopPropagation(),n.dispatchEvent(p),Ci(Oe),n.dispatchEvent(g))}function Ce(Oe){n.enabled===!1||n.enableKeys===!1||n.enablePan===!1||vi(Oe)}function Pt(Oe){if(n.enabled!==!1){switch(Oe.preventDefault(),Oe.touches.length){case 1:switch(n.touches.ONE){case Nt.ROTATE:if(n.enableRotate===!1)return;he(Oe),M=b.TOUCH_ROTATE;break;case Nt.PAN:if(n.enablePan===!1)return;K(Oe),M=b.TOUCH_PAN;break;default:M=b.NONE}break;case 2:switch(n.touches.TWO){case Nt.DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;me(Oe),M=b.TOUCH_DOLLY_PAN;break;case Nt.DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;Le(Oe),M=b.TOUCH_DOLLY_ROTATE;break;default:M=b.NONE}break;default:M=b.NONE}M!==b.NONE&&n.dispatchEvent(p)}}function Kt(Oe){if(n.enabled!==!1)switch(Oe.preventDefault(),Oe.stopPropagation(),M){case b.TOUCH_ROTATE:if(n.enableRotate===!1)return;Be(Oe),n.update();break;case b.TOUCH_PAN:if(n.enablePan===!1)return;Ye(Oe),n.update();break;case b.TOUCH_DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;He(Oe),n.update();break;case b.TOUCH_DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;Je(Oe),n.update();break;default:M=b.NONE}}function qn(Oe){n.enabled!==!1&&(n.dispatchEvent(g),M=b.NONE)}function xn(Oe){n.enabled!==!1&&Oe.preventDefault()}n.domElement.addEventListener("contextmenu",xn,!1),n.domElement.addEventListener("pointerdown",ot,!1),n.domElement.addEventListener("wheel",yt,!1),n.domElement.addEventListener("touchstart",Pt,!1),n.domElement.addEventListener("touchend",qn,!1),n.domElement.addEventListener("touchmove",Kt,!1),n.domElement.addEventListener("keydown",Ce,!1),n.domElement.tabIndex===-1&&(n.domElement.tabIndex=0),this.update()};zg.prototype=Object.create(go.prototype),zg.prototype.constructor=zg;var kw=function(r,i){zg.call(this,r,i),this.screenSpacePanning=!1,this.mouseButtons.LEFT=Pn.PAN,this.mouseButtons.RIGHT=Pn.ROTATE,this.touches.ONE=Nt.PAN,this.touches.TWO=Nt.DOLLY_ROTATE};kw.prototype=Object.create(go.prototype),kw.prototype.constructor=kw;var aA=function(){function r(he){ys.call(this,he),this.dracoLoader=null,this.ddsLoader=null,this.ktx2Loader=null,this.pluginCallbacks=[],this.register(function(K){return new b(K)}),this.register(function(K){return new A(K)}),this.register(function(K){return new M(K)}),this.register(function(K){return new p(K)})}r.prototype=Object.assign(Object.create(ys.prototype),{constructor:r,load:function(he,K,Fe,me){var Le=this,Be;this.resourcePath!==""?Be=this.resourcePath:this.path!==""?Be=this.path:Be=zp.extractUrlBase(he),this.manager.itemStart(he);var Ye=function(He){me?me(He):console.error(He),Le.manager.itemError(he),Le.manager.itemEnd(he)},ke=new Kl(this.manager);ke.setPath(this.path),ke.setResponseType("arraybuffer"),ke.setRequestHeader(this.requestHeader),ke.setWithCredentials(this.withCredentials),ke.load(he,function(He){try{Le.parse(He,Be,function(Je){K(Je),Le.manager.itemEnd(he)},Ye)}catch(Je){Ye(Je)}},Fe,Ye)},setDRACOLoader:function(he){return this.dracoLoader=he,this},setDDSLoader:function(he){return this.ddsLoader=he,this},setKTX2Loader:function(he){return this.ktx2Loader=he,this},register:function(he){return this.pluginCallbacks.indexOf(he)===-1&&this.pluginCallbacks.push(he),this},unregister:function(he){return this.pluginCallbacks.indexOf(he)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(he),1),this},parse:function(he,K,Fe,me){var Le,Be={},Ye={};if(typeof he=="string")Le=he;else{var ke=zp.decodeText(new Uint8Array(he,0,4));if(ke===C){try{Be[n.KHR_BINARY_GLTF]=new k(he)}catch(oe){me&&me(oe);return}Le=Be[n.KHR_BINARY_GLTF].content}else Le=zp.decodeText(new Uint8Array(he))}var He=JSON.parse(Le);if(He.asset===void 0||He.asset.version[0]<2){me&&me(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}var Je=new Vt(He,{path:K||this.resourcePath||"",crossOrigin:this.crossOrigin,manager:this.manager,ktx2Loader:this.ktx2Loader});Je.fileLoader.setRequestHeader(this.requestHeader);for(var ot=0;ot<this.pluginCallbacks.length;ot++){var bt=this.pluginCallbacks[ot](Je);Ye[bt.name]=bt,Be[bt.name]=!0}if(He.extensionsUsed)for(var ot=0;ot<He.extensionsUsed.length;++ot){var Mt=He.extensionsUsed[ot],ue=He.extensionsRequired||[];switch(Mt){case n.KHR_MATERIALS_UNLIT:Be[Mt]=new g;break;case n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:Be[Mt]=new te;break;case n.KHR_DRACO_MESH_COMPRESSION:Be[Mt]=new N(He,this.dracoLoader);break;case n.MSFT_TEXTURE_DDS:Be[Mt]=new u(this.ddsLoader);break;case n.KHR_TEXTURE_TRANSFORM:Be[Mt]=new X;break;case n.KHR_MESH_QUANTIZATION:Be[Mt]=new j;break;default:ue.indexOf(Mt)>=0&&Ye[Mt]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+Mt+'".')}}Je.setExtensions(Be),Je.setPlugins(Ye),Je.parse(Fe,me)}});function i(){var he={};return{get:function(K){return he[K]},add:function(K,Fe){he[K]=Fe},remove:function(K){delete he[K]},removeAll:function(){he={}}}}var n={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",MSFT_TEXTURE_DDS:"MSFT_texture_dds"};function u(he){if(!he)throw new Error("THREE.GLTFLoader: Attempting to load .dds texture without importing DDSLoader");this.name=n.MSFT_TEXTURE_DDS,this.ddsLoader=he}function p(he){this.parser=he,this.name=n.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}p.prototype._markDefs=function(){for(var he=this.parser,K=this.parser.json.nodes||[],Fe=0,me=K.length;Fe<me;Fe++){var Le=K[Fe];Le.extensions&&Le.extensions[this.name]&&Le.extensions[this.name].light!==void 0&&he._addNodeRef(this.cache,Le.extensions[this.name].light)}},p.prototype._loadLight=function(he){var K=this.parser,Fe="light:"+he,me=K.cache.get(Fe);if(me)return me;var Le=K.json,Be=Le.extensions&&Le.extensions[this.name]||{},Ye=Be.lights||[],ke=Ye[he],He,Je=new Mi(16777215);ke.color!==void 0&&Je.fromArray(ke.color);var ot=ke.range!==void 0?ke.range:0;switch(ke.type){case"directional":He=new Cw(Je),He.target.position.set(0,0,-1),He.add(He.target);break;case"point":He=new Aw(Je),He.distance=ot;break;case"spot":He=new Ew(Je),He.distance=ot,ke.spot=ke.spot||{},ke.spot.innerConeAngle=ke.spot.innerConeAngle!==void 0?ke.spot.innerConeAngle:0,ke.spot.outerConeAngle=ke.spot.outerConeAngle!==void 0?ke.spot.outerConeAngle:Math.PI/4,He.angle=ke.spot.outerConeAngle,He.penumbra=1-ke.spot.innerConeAngle/ke.spot.outerConeAngle,He.target.position.set(0,0,-1),He.add(He.target);break;default:throw new Error('THREE.GLTFLoader: Unexpected light type, "'+ke.type+'".')}return He.position.set(0,0,0),He.decay=2,ke.intensity!==void 0&&(He.intensity=ke.intensity),He.name=K.createUniqueName(ke.name||"light_"+he),me=Promise.resolve(He),K.cache.add(Fe,me),me},p.prototype.createNodeAttachment=function(he){var K=this,Fe=this.parser,me=Fe.json,Le=me.nodes[he],Be=Le.extensions&&Le.extensions[this.name]||{},Ye=Be.light;return Ye===void 0?null:this._loadLight(Ye).then(function(ke){return Fe._getNodeRef(K.cache,Ye,ke)})};function g(){this.name=n.KHR_MATERIALS_UNLIT}g.prototype.getMaterialType=function(){return yo},g.prototype.extendParams=function(he,K,Fe){var me=[];he.color=new Mi(1,1,1),he.opacity=1;var Le=K.pbrMetallicRoughness;if(Le){if(Array.isArray(Le.baseColorFactor)){var Be=Le.baseColorFactor;he.color.fromArray(Be),he.opacity=Be[3]}Le.baseColorTexture!==void 0&&me.push(Fe.assignTexture(he,"map",Le.baseColorTexture))}return Promise.all(me)};function b(he){this.parser=he,this.name=n.KHR_MATERIALS_CLEARCOAT}b.prototype.getMaterialType=function(he){var K=this.parser,Fe=K.json.materials[he];return!Fe.extensions||!Fe.extensions[this.name]?null:Ou},b.prototype.extendMaterialParams=function(he,K){var Fe=this.parser,me=Fe.json.materials[he];if(!me.extensions||!me.extensions[this.name])return Promise.resolve();var Le=[],Be=me.extensions[this.name];if(Be.clearcoatFactor!==void 0&&(K.clearcoat=Be.clearcoatFactor),Be.clearcoatTexture!==void 0&&Le.push(Fe.assignTexture(K,"clearcoatMap",Be.clearcoatTexture)),Be.clearcoatRoughnessFactor!==void 0&&(K.clearcoatRoughness=Be.clearcoatRoughnessFactor),Be.clearcoatRoughnessTexture!==void 0&&Le.push(Fe.assignTexture(K,"clearcoatRoughnessMap",Be.clearcoatRoughnessTexture)),Be.clearcoatNormalTexture!==void 0&&(Le.push(Fe.assignTexture(K,"clearcoatNormalMap",Be.clearcoatNormalTexture)),Be.clearcoatNormalTexture.scale!==void 0)){var Ye=Be.clearcoatNormalTexture.scale;K.clearcoatNormalScale=new vn(Ye,Ye)}return Promise.all(Le)};function M(he){this.parser=he,this.name=n.KHR_MATERIALS_TRANSMISSION}M.prototype.getMaterialType=function(he){var K=this.parser,Fe=K.json.materials[he];return!Fe.extensions||!Fe.extensions[this.name]?null:Ou},M.prototype.extendMaterialParams=function(he,K){var Fe=this.parser,me=Fe.json.materials[he];if(!me.extensions||!me.extensions[this.name])return Promise.resolve();var Le=[],Be=me.extensions[this.name];return Be.transmissionFactor!==void 0&&(K.transmission=Be.transmissionFactor),Be.transmissionTexture!==void 0&&Le.push(Fe.assignTexture(K,"transmissionMap",Be.transmissionTexture)),Promise.all(Le)};function A(he){this.parser=he,this.name=n.KHR_TEXTURE_BASISU}A.prototype.loadTexture=function(he){var K=this.parser,Fe=K.json,me=Fe.textures[he];if(!me.extensions||!me.extensions[this.name])return null;var Le=me.extensions[this.name],Be=Fe.images[Le.source],Ye=K.options.ktx2Loader;if(!Ye)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return K.loadTextureImage(he,Be,Ye)};var C="glTF",F=12,O={JSON:1313821514,BIN:5130562};function k(he){this.name=n.KHR_BINARY_GLTF,this.content=null,this.body=null;var K=new DataView(he,0,F);if(this.header={magic:zp.decodeText(new Uint8Array(he.slice(0,4))),version:K.getUint32(4,!0),length:K.getUint32(8,!0)},this.header.magic!==C)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");for(var Fe=new DataView(he,F),me=0;me<Fe.byteLength;){var Le=Fe.getUint32(me,!0);me+=4;var Be=Fe.getUint32(me,!0);if(me+=4,Be===O.JSON){var Ye=new Uint8Array(he,F+me,Le);this.content=zp.decodeText(Ye)}else if(Be===O.BIN){var ke=F+me;this.body=he.slice(ke,ke+Le)}me+=Le}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}function N(he,K){if(!K)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=n.KHR_DRACO_MESH_COMPRESSION,this.json=he,this.dracoLoader=K,this.dracoLoader.preload()}N.prototype.decodePrimitive=function(he,K){var Fe=this.json,me=this.dracoLoader,Le=he.extensions[this.name].bufferView,Be=he.extensions[this.name].attributes,Ye={},ke={},He={};for(var Je in Be){var ot=Gt[Je]||Je.toLowerCase();Ye[ot]=Be[Je]}for(Je in he.attributes){var ot=Gt[Je]||Je.toLowerCase();if(Be[Je]!==void 0){var bt=Fe.accessors[he.attributes[Je]],Mt=Re[bt.componentType];He[ot]=Mt,ke[ot]=bt.normalized===!0}}return K.getDependency("bufferView",Le).then(function(ue){return new Promise(function(oe){me.decodeDracoFile(ue,function(lt){for(var yt in lt.attributes){var Ce=lt.attributes[yt],Pt=ke[yt];Pt!==void 0&&(Ce.normalized=Pt)}oe(lt)},Ye,He)})})};function X(){this.name=n.KHR_TEXTURE_TRANSFORM}X.prototype.extendTexture=function(he,K){return he=he.clone(),K.offset!==void 0&&he.offset.fromArray(K.offset),K.rotation!==void 0&&(he.rotation=K.rotation),K.scale!==void 0&&he.repeat.fromArray(K.scale),K.texCoord!==void 0&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),he.needsUpdate=!0,he};function ne(he){Fo.call(this),this.isGLTFSpecularGlossinessMaterial=!0;var K=["#ifdef USE_SPECULARMAP","	uniform sampler2D specularMap;","#endif"].join(`
`),Fe=["#ifdef USE_GLOSSINESSMAP","	uniform sampler2D glossinessMap;","#endif"].join(`
`),me=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","	vec4 texelSpecular = texture2D( specularMap, vUv );","	texelSpecular = sRGBToLinear( texelSpecular );","	// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","	specularFactor *= texelSpecular.rgb;","#endif"].join(`
`),Le=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","	vec4 texelGlossiness = texture2D( glossinessMap, vUv );","	// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","	glossinessFactor *= texelGlossiness.a;","#endif"].join(`
`),Be=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.specularRoughness += geometryRoughness;","material.specularRoughness = min( material.specularRoughness, 1.0 );","material.specularColor = specularFactor;"].join(`
`),Ye={specular:{value:new Mi().setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=Ye,this.onBeforeCompile=function(ke){for(var He in Ye)ke.uniforms[He]=Ye[He];ke.fragmentShader=ke.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",K).replace("#include <metalnessmap_pars_fragment>",Fe).replace("#include <roughnessmap_fragment>",me).replace("#include <metalnessmap_fragment>",Le).replace("#include <lights_physical_fragment>",Be)},Object.defineProperties(this,{specular:{get:function(){return Ye.specular.value},set:function(ke){Ye.specular.value=ke}},specularMap:{get:function(){return Ye.specularMap.value},set:function(ke){Ye.specularMap.value=ke,ke?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return Ye.glossiness.value},set:function(ke){Ye.glossiness.value=ke}},glossinessMap:{get:function(){return Ye.glossinessMap.value},set:function(ke){Ye.glossinessMap.value=ke,ke?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(he)}ne.prototype=Object.create(Fo.prototype),ne.prototype.constructor=ne,ne.prototype.copy=function(he){return Fo.prototype.copy.call(this,he),this.specularMap=he.specularMap,this.specular.copy(he.specular),this.glossinessMap=he.glossinessMap,this.glossiness=he.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this};function te(){return{name:n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return ne},extendParams:function(he,K,Fe){var me=K.extensions[this.name];he.color=new Mi(1,1,1),he.opacity=1;var Le=[];if(Array.isArray(me.diffuseFactor)){var Be=me.diffuseFactor;he.color.fromArray(Be),he.opacity=Be[3]}if(me.diffuseTexture!==void 0&&Le.push(Fe.assignTexture(he,"map",me.diffuseTexture)),he.emissive=new Mi(0,0,0),he.glossiness=me.glossinessFactor!==void 0?me.glossinessFactor:1,he.specular=new Mi(1,1,1),Array.isArray(me.specularFactor)&&he.specular.fromArray(me.specularFactor),me.specularGlossinessTexture!==void 0){var Ye=me.specularGlossinessTexture;Le.push(Fe.assignTexture(he,"glossinessMap",Ye)),Le.push(Fe.assignTexture(he,"specularMap",Ye))}return Promise.all(Le)},createMaterial:function(he){var K=new ne(he);return K.fog=!0,K.color=he.color,K.map=he.map===void 0?null:he.map,K.lightMap=null,K.lightMapIntensity=1,K.aoMap=he.aoMap===void 0?null:he.aoMap,K.aoMapIntensity=1,K.emissive=he.emissive,K.emissiveIntensity=1,K.emissiveMap=he.emissiveMap===void 0?null:he.emissiveMap,K.bumpMap=he.bumpMap===void 0?null:he.bumpMap,K.bumpScale=1,K.normalMap=he.normalMap===void 0?null:he.normalMap,K.normalMapType=mu,he.normalScale&&(K.normalScale=he.normalScale),K.displacementMap=null,K.displacementScale=1,K.displacementBias=0,K.specularMap=he.specularMap===void 0?null:he.specularMap,K.specular=he.specular,K.glossinessMap=he.glossinessMap===void 0?null:he.glossinessMap,K.glossiness=he.glossiness,K.alphaMap=null,K.envMap=he.envMap===void 0?null:he.envMap,K.envMapIntensity=1,K.refractionRatio=.98,K}}}function j(){this.name=n.KHR_MESH_QUANTIZATION}function W(he,K,Fe,me){Bo.call(this,he,K,Fe,me)}W.prototype=Object.create(Bo.prototype),W.prototype.constructor=W,W.prototype.copySampleValue_=function(he){for(var K=this.resultBuffer,Fe=this.sampleValues,me=this.valueSize,Le=he*me*3+me,Be=0;Be!==me;Be++)K[Be]=Fe[Le+Be];return K},W.prototype.beforeStart_=W.prototype.copySampleValue_,W.prototype.afterEnd_=W.prototype.copySampleValue_,W.prototype.interpolate_=function(he,K,Fe,me){for(var Le=this.resultBuffer,Be=this.sampleValues,Ye=this.valueSize,ke=Ye*2,He=Ye*3,Je=me-K,ot=(Fe-K)/Je,bt=ot*ot,Mt=bt*ot,ue=he*He,oe=ue-He,lt=-2*Mt+3*bt,yt=Mt-bt,Ce=1-lt,Pt=yt-bt+ot,Kt=0;Kt!==Ye;Kt++){var qn=Be[oe+Kt+Ye],xn=Be[oe+Kt+ke]*Je,Oe=Be[ue+Kt+Ye],Ht=Be[ue+Kt]*Je;Le[Kt]=Ce*qn+Pt*xn+lt*Oe+yt*Ht}return Le};var Pe={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Re={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Ne={9728:Kr,9729:ti,9984:Na,9985:$n,9986:tn,9987:es},de={33071:$r,33648:Lo,10497:cr},$e={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Gt={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},dt={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},an={CUBICSPLINE:void 0,LINEAR:mo,STEP:fh},_t={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function et(he,K){return typeof he!="string"||he===""?"":(/^https?:\/\//i.test(K)&&/^\//.test(he)&&(K=K.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(he)||/^data:.*,.*$/i.test(he)||/^blob:.*$/i.test(he)?he:K+he)}function rt(he){return he.DefaultMaterial===void 0&&(he.DefaultMaterial=new Fo({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:St})),he.DefaultMaterial}function je(he,K,Fe){for(var me in Fe.extensions)he[me]===void 0&&(K.userData.gltfExtensions=K.userData.gltfExtensions||{},K.userData.gltfExtensions[me]=Fe.extensions[me])}function Ve(he,K){K.extras!==void 0&&(typeof K.extras=="object"?Object.assign(he.userData,K.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+K.extras))}function ht(he,K,Fe){for(var me=!1,Le=!1,Be=0,Ye=K.length;Be<Ye;Be++){var ke=K[Be];if(ke.POSITION!==void 0&&(me=!0),ke.NORMAL!==void 0&&(Le=!0),me&&Le)break}if(!me&&!Le)return Promise.resolve(he);for(var He=[],Je=[],Be=0,Ye=K.length;Be<Ye;Be++){var ke=K[Be];if(me){var ot=ke.POSITION!==void 0?Fe.getDependency("accessor",ke.POSITION):he.attributes.position;He.push(ot)}if(Le){var ot=ke.NORMAL!==void 0?Fe.getDependency("accessor",ke.NORMAL):he.attributes.normal;Je.push(ot)}}return Promise.all([Promise.all(He),Promise.all(Je)]).then(function(bt){var Mt=bt[0],ue=bt[1];return me&&(he.morphAttributes.position=Mt),Le&&(he.morphAttributes.normal=ue),he.morphTargetsRelative=!0,he})}function ft(he,K){if(he.updateMorphTargets(),K.weights!==void 0)for(var Fe=0,me=K.weights.length;Fe<me;Fe++)he.morphTargetInfluences[Fe]=K.weights[Fe];if(K.extras&&Array.isArray(K.extras.targetNames)){var Le=K.extras.targetNames;if(he.morphTargetInfluences.length===Le.length){he.morphTargetDictionary={};for(var Fe=0,me=Le.length;Fe<me;Fe++)he.morphTargetDictionary[Le[Fe]]=Fe}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function Wt(he){var K=he.extensions&&he.extensions[n.KHR_DRACO_MESH_COMPRESSION],Fe;return K?Fe="draco:"+K.bufferView+":"+K.indices+":"+An(K.attributes):Fe=he.indices+":"+An(he.attributes)+":"+he.mode,Fe}function An(he){for(var K="",Fe=Object.keys(he).sort(),me=0,Le=Fe.length;me<Le;me++)K+=Fe[me]+":"+he[Fe[me]]+";";return K}function Vt(he,K){this.json=he||{},this.extensions={},this.plugins={},this.options=K||{},this.cache=new i,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.nodeNamesUsed={},typeof createImageBitmap<"u"&&/Firefox/.test(navigator.userAgent)===!1?this.textureLoader=new Rw(this.options.manager):this.textureLoader=new C0(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new Kl(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}Vt.prototype.setExtensions=function(he){this.extensions=he},Vt.prototype.setPlugins=function(he){this.plugins=he},Vt.prototype.parse=function(he,K){var Fe=this,me=this.json,Le=this.extensions;this.cache.removeAll(),this._invokeAll(function(Be){return Be._markDefs&&Be._markDefs()}),Promise.all([this.getDependencies("scene"),this.getDependencies("animation"),this.getDependencies("camera")]).then(function(Be){var Ye={scene:Be[0][me.scene||0],scenes:Be[0],animations:Be[1],cameras:Be[2],asset:me.asset,parser:Fe,userData:{}};je(Le,Ye,me),Ve(Ye,me),he(Ye)}).catch(K)},Vt.prototype._markDefs=function(){for(var he=this.json.nodes||[],K=this.json.skins||[],Fe=this.json.meshes||[],me=0,Le=K.length;me<Le;me++)for(var Be=K[me].joints,Ye=0,ke=Be.length;Ye<ke;Ye++)he[Be[Ye]].isBone=!0;for(var He=0,Je=he.length;He<Je;He++){var ot=he[He];ot.mesh!==void 0&&(this._addNodeRef(this.meshCache,ot.mesh),ot.skin!==void 0&&(Fe[ot.mesh].isSkinnedMesh=!0)),ot.camera!==void 0&&this._addNodeRef(this.cameraCache,ot.camera)}},Vt.prototype._addNodeRef=function(he,K){K!==void 0&&(he.refs[K]===void 0&&(he.refs[K]=he.uses[K]=0),he.refs[K]++)},Vt.prototype._getNodeRef=function(he,K,Fe){if(he.refs[K]<=1)return Fe;var me=Fe.clone();return me.name+="_instance_"+he.uses[K]++,me},Vt.prototype._invokeOne=function(he){var K=Object.values(this.plugins);K.push(this);for(var Fe=0;Fe<K.length;Fe++){var me=he(K[Fe]);if(me)return me}},Vt.prototype._invokeAll=function(he){var K=Object.values(this.plugins);K.unshift(this);for(var Fe=[],me=0;me<K.length;me++){var Le=he(K[me]);Le&&Fe.push(Le)}return Fe},Vt.prototype.getDependency=function(he,K){var Fe=he+":"+K,me=this.cache.get(Fe);if(!me){switch(he){case"scene":me=this.loadScene(K);break;case"node":me=this.loadNode(K);break;case"mesh":me=this._invokeOne(function(Le){return Le.loadMesh&&Le.loadMesh(K)});break;case"accessor":me=this.loadAccessor(K);break;case"bufferView":me=this._invokeOne(function(Le){return Le.loadBufferView&&Le.loadBufferView(K)});break;case"buffer":me=this.loadBuffer(K);break;case"material":me=this._invokeOne(function(Le){return Le.loadMaterial&&Le.loadMaterial(K)});break;case"texture":me=this._invokeOne(function(Le){return Le.loadTexture&&Le.loadTexture(K)});break;case"skin":me=this.loadSkin(K);break;case"animation":me=this.loadAnimation(K);break;case"camera":me=this.loadCamera(K);break;default:throw new Error("Unknown type: "+he)}this.cache.add(Fe,me)}return me},Vt.prototype.getDependencies=function(he){var K=this.cache.get(he);if(!K){var Fe=this,me=this.json[he+(he==="mesh"?"es":"s")]||[];K=Promise.all(me.map(function(Le,Be){return Fe.getDependency(he,Be)})),this.cache.add(he,K)}return K},Vt.prototype.loadBuffer=function(he){var K=this.json.buffers[he],Fe=this.fileLoader;if(K.type&&K.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+K.type+" buffer type is not supported.");if(K.uri===void 0&&he===0)return Promise.resolve(this.extensions[n.KHR_BINARY_GLTF].body);var me=this.options;return new Promise(function(Le,Be){Fe.load(et(K.uri,me.path),Le,void 0,function(){Be(new Error('THREE.GLTFLoader: Failed to load buffer "'+K.uri+'".'))})})},Vt.prototype.loadBufferView=function(he){var K=this.json.bufferViews[he];return this.getDependency("buffer",K.buffer).then(function(Fe){var me=K.byteLength||0,Le=K.byteOffset||0;return Fe.slice(Le,Le+me)})},Vt.prototype.loadAccessor=function(he){var K=this,Fe=this.json,me=this.json.accessors[he];if(me.bufferView===void 0&&me.sparse===void 0)return Promise.resolve(null);var Le=[];return me.bufferView!==void 0?Le.push(this.getDependency("bufferView",me.bufferView)):Le.push(null),me.sparse!==void 0&&(Le.push(this.getDependency("bufferView",me.sparse.indices.bufferView)),Le.push(this.getDependency("bufferView",me.sparse.values.bufferView))),Promise.all(Le).then(function(Be){var Ye=Be[0],ke=$e[me.type],He=Re[me.componentType],Je=He.BYTES_PER_ELEMENT,ot=Je*ke,bt=me.byteOffset||0,Mt=me.bufferView!==void 0?Fe.bufferViews[me.bufferView].byteStride:void 0,ue=me.normalized===!0,oe,lt;if(Mt&&Mt!==ot){var yt=Math.floor(bt/Mt),Ce="InterleavedBuffer:"+me.bufferView+":"+me.componentType+":"+yt+":"+me.count,Pt=K.cache.get(Ce);Pt||(oe=new He(Ye,yt*Mt,me.count*Mt/Je),Pt=new Ko(oe,Mt/Je),K.cache.add(Ce,Pt)),lt=new Ih(Pt,ke,bt%Mt/Je,ue)}else Ye===null?oe=new He(me.count*ke):oe=new He(Ye,bt,me.count*ke),lt=new sr(oe,ke,ue);if(me.sparse!==void 0){var Kt=$e.SCALAR,qn=Re[me.sparse.indices.componentType],xn=me.sparse.indices.byteOffset||0,Oe=me.sparse.values.byteOffset||0,Ht=new qn(Be[1],xn,me.sparse.count*Kt),Kn=new He(Be[2],Oe,me.sparse.count*ke);Ye!==null&&(lt=new sr(lt.array.slice(),lt.itemSize,lt.normalized));for(var hn=0,jn=Ht.length;hn<jn;hn++){var er=Ht[hn];if(lt.setX(er,Kn[hn*ke]),ke>=2&&lt.setY(er,Kn[hn*ke+1]),ke>=3&&lt.setZ(er,Kn[hn*ke+2]),ke>=4&&lt.setW(er,Kn[hn*ke+3]),ke>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return lt})},Vt.prototype.loadTexture=function(he){var K=this,Fe=this.json,me=this.options,Le=Fe.textures[he],Be=Le.extensions||{},Ye;Be[n.MSFT_TEXTURE_DDS]?Ye=Fe.images[Be[n.MSFT_TEXTURE_DDS].source]:Ye=Fe.images[Le.source];var ke;return Ye.uri&&(ke=me.manager.getHandler(Ye.uri)),ke||(ke=Be[n.MSFT_TEXTURE_DDS]?K.extensions[n.MSFT_TEXTURE_DDS].ddsLoader:this.textureLoader),this.loadTextureImage(he,Ye,ke)},Vt.prototype.loadTextureImage=function(he,K,Fe){var me=this,Le=this.json,Be=this.options,Ye=Le.textures[he],ke=self.URL||self.webkitURL,He=K.uri,Je=!1,ot=!0;return K.mimeType==="image/jpeg"&&(ot=!1),K.bufferView!==void 0&&(He=me.getDependency("bufferView",K.bufferView).then(function(bt){if(K.mimeType==="image/png"){var Mt=new DataView(bt,25,1).getUint8(0,!1);ot=Mt===6||Mt===4||Mt===3}Je=!0;var ue=new Blob([bt],{type:K.mimeType});return He=ke.createObjectURL(ue),He})),Promise.resolve(He).then(function(bt){return new Promise(function(Mt,ue){var oe=Mt;Fe.isImageBitmapLoader===!0&&(oe=function(lt){Mt(new Cg(lt))}),Fe.load(et(bt,Be.path),oe,void 0,ue)})}).then(function(bt){Je===!0&&ke.revokeObjectURL(He),bt.flipY=!1,Ye.name&&(bt.name=Ye.name),ot||(bt.format=Or);var Mt=Le.samplers||{},ue=Mt[Ye.sampler]||{};return bt.magFilter=Ne[ue.magFilter]||ti,bt.minFilter=Ne[ue.minFilter]||es,bt.wrapS=de[ue.wrapS]||cr,bt.wrapT=de[ue.wrapT]||cr,me.associations.set(bt,{type:"textures",index:he}),bt})},Vt.prototype.assignTexture=function(he,K,Fe){var me=this;return this.getDependency("texture",Fe.index).then(function(Le){if(Fe.texCoord!==void 0&&Fe.texCoord!=0&&!(K==="aoMap"&&Fe.texCoord==1)&&console.warn("THREE.GLTFLoader: Custom UV set "+Fe.texCoord+" for texture "+K+" not yet supported."),me.extensions[n.KHR_TEXTURE_TRANSFORM]){var Be=Fe.extensions!==void 0?Fe.extensions[n.KHR_TEXTURE_TRANSFORM]:void 0;if(Be){var Ye=me.associations.get(Le);Le=me.extensions[n.KHR_TEXTURE_TRANSFORM].extendTexture(Le,Be),me.associations.set(Le,Ye)}}he[K]=Le})},Vt.prototype.assignFinalMaterial=function(he){var K=he.geometry,Fe=he.material,me=K.attributes.tangent!==void 0,Le=K.attributes.color!==void 0,Be=K.attributes.normal===void 0,Ye=he.isSkinnedMesh===!0,ke=Object.keys(K.morphAttributes).length>0,He=ke&&K.morphAttributes.normal!==void 0;if(he.isPoints){var Je="PointsMaterial:"+Fe.uuid,ot=this.cache.get(Je);ot||(ot=new Nh,Yi.prototype.copy.call(ot,Fe),ot.color.copy(Fe.color),ot.map=Fe.map,ot.sizeAttenuation=!1,this.cache.add(Je,ot)),Fe=ot}else if(he.isLine){var Je="LineBasicMaterial:"+Fe.uuid,bt=this.cache.get(Je);bt||(bt=new Qo,Yi.prototype.copy.call(bt,Fe),bt.color.copy(Fe.color),this.cache.add(Je,bt)),Fe=bt}if(me||Le||Be||Ye||ke){var Je="ClonedMaterial:"+Fe.uuid+":";Fe.isGLTFSpecularGlossinessMaterial&&(Je+="specular-glossiness:"),Ye&&(Je+="skinning:"),me&&(Je+="vertex-tangents:"),Le&&(Je+="vertex-colors:"),Be&&(Je+="flat-shading:"),ke&&(Je+="morph-targets:"),He&&(Je+="morph-normals:");var Mt=this.cache.get(Je);Mt||(Mt=Fe.clone(),Ye&&(Mt.skinning=!0),me&&(Mt.vertexTangents=!0),Le&&(Mt.vertexColors=!0),Be&&(Mt.flatShading=!0),ke&&(Mt.morphTargets=!0),He&&(Mt.morphNormals=!0),this.cache.add(Je,Mt),this.associations.set(Mt,this.associations.get(Fe))),Fe=Mt}Fe.aoMap&&K.attributes.uv2===void 0&&K.attributes.uv!==void 0&&K.setAttribute("uv2",K.attributes.uv),Fe.normalScale&&!me&&(Fe.normalScale.y=-Fe.normalScale.y),Fe.clearcoatNormalScale&&!me&&(Fe.clearcoatNormalScale.y=-Fe.clearcoatNormalScale.y),he.material=Fe},Vt.prototype.getMaterialType=function(){return Fo},Vt.prototype.loadMaterial=function(he){var K=this,Fe=this.json,me=this.extensions,Le=Fe.materials[he],Be,Ye={},ke=Le.extensions||{},He=[];if(ke[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var Je=me[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];Be=Je.getMaterialType(),He.push(Je.extendParams(Ye,Le,K))}else if(ke[n.KHR_MATERIALS_UNLIT]){var ot=me[n.KHR_MATERIALS_UNLIT];Be=ot.getMaterialType(),He.push(ot.extendParams(Ye,Le,K))}else{var bt=Le.pbrMetallicRoughness||{};if(Ye.color=new Mi(1,1,1),Ye.opacity=1,Array.isArray(bt.baseColorFactor)){var Mt=bt.baseColorFactor;Ye.color.fromArray(Mt),Ye.opacity=Mt[3]}bt.baseColorTexture!==void 0&&He.push(K.assignTexture(Ye,"map",bt.baseColorTexture)),Ye.metalness=bt.metallicFactor!==void 0?bt.metallicFactor:1,Ye.roughness=bt.roughnessFactor!==void 0?bt.roughnessFactor:1,bt.metallicRoughnessTexture!==void 0&&(He.push(K.assignTexture(Ye,"metalnessMap",bt.metallicRoughnessTexture)),He.push(K.assignTexture(Ye,"roughnessMap",bt.metallicRoughnessTexture))),Be=this._invokeOne(function(oe){return oe.getMaterialType&&oe.getMaterialType(he)}),He.push(Promise.all(this._invokeAll(function(oe){return oe.extendMaterialParams&&oe.extendMaterialParams(he,Ye)})))}Le.doubleSided===!0&&(Ye.side=Tn);var ue=Le.alphaMode||_t.OPAQUE;return ue===_t.BLEND?(Ye.transparent=!0,Ye.depthWrite=!1):(Ye.transparent=!1,ue===_t.MASK&&(Ye.alphaTest=Le.alphaCutoff!==void 0?Le.alphaCutoff:.5)),Le.normalTexture!==void 0&&Be!==yo&&(He.push(K.assignTexture(Ye,"normalMap",Le.normalTexture)),Ye.normalScale=new vn(1,1),Le.normalTexture.scale!==void 0&&Ye.normalScale.set(Le.normalTexture.scale,Le.normalTexture.scale)),Le.occlusionTexture!==void 0&&Be!==yo&&(He.push(K.assignTexture(Ye,"aoMap",Le.occlusionTexture)),Le.occlusionTexture.strength!==void 0&&(Ye.aoMapIntensity=Le.occlusionTexture.strength)),Le.emissiveFactor!==void 0&&Be!==yo&&(Ye.emissive=new Mi().fromArray(Le.emissiveFactor)),Le.emissiveTexture!==void 0&&Be!==yo&&He.push(K.assignTexture(Ye,"emissiveMap",Le.emissiveTexture)),Promise.all(He).then(function(){var oe;return Be===ne?oe=me[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(Ye):oe=new Be(Ye),Le.name&&(oe.name=Le.name),oe.map&&(oe.map.encoding=ph),oe.emissiveMap&&(oe.emissiveMap.encoding=ph),Ve(oe,Le),K.associations.set(oe,{type:"materials",index:he}),Le.extensions&&je(me,oe,Le),oe})},Vt.prototype.createUniqueName=function(he){for(var K=eo.sanitizeNodeName(he||""),Fe=1;this.nodeNamesUsed[K];++Fe)K=he+"_"+Fe;return this.nodeNamesUsed[K]=!0,K};function Dn(he,K,Fe){var me=K.attributes,Le=new Ps;if(me.POSITION!==void 0){var Be=Fe.json.accessors[me.POSITION],Ye=Be.min,ke=Be.max;if(Ye!==void 0&&ke!==void 0)Le.set(new De(Ye[0],Ye[1],Ye[2]),new De(ke[0],ke[1],ke[2]));else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;var He=K.targets;if(He!==void 0){for(var Je=new De,ot=new De,bt=0,Mt=He.length;bt<Mt;bt++){var ue=He[bt];if(ue.POSITION!==void 0){var Be=Fe.json.accessors[ue.POSITION],Ye=Be.min,ke=Be.max;Ye!==void 0&&ke!==void 0?(ot.setX(Math.max(Math.abs(Ye[0]),Math.abs(ke[0]))),ot.setY(Math.max(Math.abs(Ye[1]),Math.abs(ke[1]))),ot.setZ(Math.max(Math.abs(Ye[2]),Math.abs(ke[2]))),Je.max(ot)):console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}Le.expandByVector(Je)}he.boundingBox=Le;var oe=new zl;Le.getCenter(oe.center),oe.radius=Le.min.distanceTo(Le.max)/2,he.boundingSphere=oe}function Ci(he,K,Fe){var me=K.attributes,Le=[];function Be(Je,ot){return Fe.getDependency("accessor",Je).then(function(bt){he.setAttribute(ot,bt)})}for(var Ye in me){var ke=Gt[Ye]||Ye.toLowerCase();ke in he.attributes||Le.push(Be(me[Ye],ke))}if(K.indices!==void 0&&!he.index){var He=Fe.getDependency("accessor",K.indices).then(function(Je){he.setIndex(Je)});Le.push(He)}return Ve(he,K),Dn(he,K,Fe),Promise.all(Le).then(function(){return K.targets!==void 0?ht(he,K.targets,Fe):he})}function vi(he,K){var Fe=he.getIndex();if(Fe===null){var me=[],Le=he.getAttribute("position");if(Le!==void 0){for(var Be=0;Be<Le.count;Be++)me.push(Be);he.setIndex(me),Fe=he.getIndex()}else return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),he}var Ye=Fe.count-2,ke=[];if(K===Fm)for(var Be=1;Be<=Ye;Be++)ke.push(Fe.getX(0)),ke.push(Fe.getX(Be)),ke.push(Fe.getX(Be+1));else for(var Be=0;Be<Ye;Be++)Be%2===0?(ke.push(Fe.getX(Be)),ke.push(Fe.getX(Be+1)),ke.push(Fe.getX(Be+2))):(ke.push(Fe.getX(Be+2)),ke.push(Fe.getX(Be+1)),ke.push(Fe.getX(Be)));ke.length/3!==Ye&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var He=he.clone();return He.setIndex(ke),He}return Vt.prototype.loadGeometries=function(he){var K=this,Fe=this.extensions,me=this.primitiveCache;function Le(Mt){return Fe[n.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(Mt,K).then(function(ue){return Ci(ue,Mt,K)})}for(var Be=[],Ye=0,ke=he.length;Ye<ke;Ye++){var He=he[Ye],Je=Wt(He),ot=me[Je];if(ot)Be.push(ot.promise);else{var bt;He.extensions&&He.extensions[n.KHR_DRACO_MESH_COMPRESSION]?bt=Le(He):bt=Ci(new hs,He,K),me[Je]={primitive:He,promise:bt},Be.push(bt)}}return Promise.all(Be)},Vt.prototype.loadMesh=function(he){for(var K=this,Fe=this.json,me=Fe.meshes[he],Le=me.primitives,Be=[],Ye=0,ke=Le.length;Ye<ke;Ye++){var He=Le[Ye].material===void 0?rt(this.cache):this.getDependency("material",Le[Ye].material);Be.push(He)}return Be.push(K.loadGeometries(Le)),Promise.all(Be).then(function(Je){for(var ot=Je.slice(0,Je.length-1),bt=Je[Je.length-1],Mt=[],ue=0,oe=bt.length;ue<oe;ue++){var lt=bt[ue],yt=Le[ue],Ce,Pt=ot[ue];if(yt.mode===Pe.TRIANGLES||yt.mode===Pe.TRIANGLE_STRIP||yt.mode===Pe.TRIANGLE_FAN||yt.mode===void 0)Ce=me.isSkinnedMesh===!0?new f0(lt,Pt):new Ca(lt,Pt),Ce.isSkinnedMesh===!0&&!Ce.geometry.attributes.skinWeight.normalized&&Ce.normalizeSkinWeights(),yt.mode===Pe.TRIANGLE_STRIP?Ce.geometry=vi(Ce.geometry,Kv):yt.mode===Pe.TRIANGLE_FAN&&(Ce.geometry=vi(Ce.geometry,Fm));else if(yt.mode===Pe.LINES)Ce=new Ag(lt,Pt);else if(yt.mode===Pe.LINE_STRIP)Ce=new Qf(lt,Pt);else if(yt.mode===Pe.LINE_LOOP)Ce=new sw(lt,Pt);else if(yt.mode===Pe.POINTS)Ce=new ow(lt,Pt);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+yt.mode);Object.keys(Ce.geometry.morphAttributes).length>0&&ft(Ce,me),Ce.name=K.createUniqueName(me.name||"mesh_"+he),bt.length>1&&(Ce.name+="_"+ue),Ve(Ce,me),K.assignFinalMaterial(Ce),Mt.push(Ce)}if(Mt.length===1)return Mt[0];for(var Kt=new $o,ue=0,oe=Mt.length;ue<oe;ue++)Kt.add(Mt[ue]);return Kt})},Vt.prototype.loadCamera=function(he){var K,Fe=this.json.cameras[he],me=Fe[Fe.type];if(!me){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return Fe.type==="perspective"?K=new ba(fr.radToDeg(me.yfov),me.aspectRatio||1,me.znear||1,me.zfar||2e6):Fe.type==="orthographic"&&(K=new R0(-me.xmag,me.xmag,me.ymag,-me.ymag,me.znear,me.zfar)),Fe.name&&(K.name=this.createUniqueName(Fe.name)),Ve(K,Fe),Promise.resolve(K)},Vt.prototype.loadSkin=function(he){var K=this.json.skins[he],Fe={joints:K.joints};return K.inverseBindMatrices===void 0?Promise.resolve(Fe):this.getDependency("accessor",K.inverseBindMatrices).then(function(me){return Fe.inverseBindMatrices=me,Fe})},Vt.prototype.loadAnimation=function(he){for(var K=this.json,Fe=K.animations[he],me=[],Le=[],Be=[],Ye=[],ke=[],He=0,Je=Fe.channels.length;He<Je;He++){var ot=Fe.channels[He],bt=Fe.samplers[ot.sampler],Mt=ot.target,ue=Mt.node!==void 0?Mt.node:Mt.id,oe=Fe.parameters!==void 0?Fe.parameters[bt.input]:bt.input,lt=Fe.parameters!==void 0?Fe.parameters[bt.output]:bt.output;me.push(this.getDependency("node",ue)),Le.push(this.getDependency("accessor",oe)),Be.push(this.getDependency("accessor",lt)),Ye.push(bt),ke.push(Mt)}return Promise.all([Promise.all(me),Promise.all(Le),Promise.all(Be),Promise.all(Ye),Promise.all(ke)]).then(function(yt){for(var Ce=yt[0],Pt=yt[1],Kt=yt[2],qn=yt[3],xn=yt[4],Oe=[],Ht=0,Kn=Ce.length;Ht<Kn;Ht++){var hn=Ce[Ht],jn=Pt[Ht],er=Kt[Ht],ts=qn[Ht],wa=xn[Ht];if(hn!==void 0){hn.updateMatrix(),hn.matrixAutoUpdate=!0;var zs;switch(dt[wa.path]){case dt.weights:zs=Np;break;case dt.rotation:zs=Ig;break;case dt.position:case dt.scale:default:zs=Fp;break}var Ra=hn.name?hn.name:hn.uuid,ec=ts.interpolation!==void 0?an[ts.interpolation]:mo,to=[];dt[wa.path]===dt.weights?hn.traverse(function(bo){bo.isMesh===!0&&bo.morphTargetInfluences&&to.push(bo.name?bo.name:bo.uuid)}):to.push(Ra);var Ds=er.array;if(er.normalized){var xs;if(Ds.constructor===Int8Array)xs=1/127;else if(Ds.constructor===Uint8Array)xs=1/255;else if(Ds.constructor==Int16Array)xs=1/32767;else if(Ds.constructor===Uint16Array)xs=1/65535;else throw new Error("THREE.GLTFLoader: Unsupported output accessor component type.");for(var tl=new Float32Array(Ds.length),no=0,El=Ds.length;no<El;no++)tl[no]=Ds[no]*xs;Ds=tl}for(var no=0,El=to.length;no<El;no++){var ta=new zs(to[no]+"."+dt[wa.path],jn.array,Ds,ec);ts.interpolation==="CUBICSPLINE"&&(ta.createInterpolant=function(Dt){return new W(this.times,this.values,this.getValueSize()/3,Dt)},ta.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),Oe.push(ta)}}}var io=Fe.name?Fe.name:"animation_"+he;return new Jl(io,void 0,Oe)})},Vt.prototype.loadNode=function(he){var K=this.json,Fe=this.extensions,me=this,Le=K.nodes[he],Be=Le.name?me.createUniqueName(Le.name):"";return function(){var Ye=[];return Le.mesh!==void 0&&Ye.push(me.getDependency("mesh",Le.mesh).then(function(ke){var He=me._getNodeRef(me.meshCache,Le.mesh,ke);return Le.weights!==void 0&&He.traverse(function(Je){if(!!Je.isMesh)for(var ot=0,bt=Le.weights.length;ot<bt;ot++)Je.morphTargetInfluences[ot]=Le.weights[ot]}),He})),Le.camera!==void 0&&Ye.push(me.getDependency("camera",Le.camera).then(function(ke){return me._getNodeRef(me.cameraCache,Le.camera,ke)})),me._invokeAll(function(ke){return ke.createNodeAttachment&&ke.createNodeAttachment(he)}).forEach(function(ke){Ye.push(ke)}),Promise.all(Ye)}().then(function(Ye){var ke;if(Le.isBone===!0?ke=new rw:Ye.length>1?ke=new $o:Ye.length===1?ke=Ye[0]:ke=new Ni,ke!==Ye[0])for(var He=0,Je=Ye.length;He<Je;He++)ke.add(Ye[He]);if(Le.name&&(ke.userData.name=Le.name,ke.name=Be),Ve(ke,Le),Le.extensions&&je(Fe,ke,Le),Le.matrix!==void 0){var ot=new yr;ot.fromArray(Le.matrix),ke.applyMatrix4(ot)}else Le.translation!==void 0&&ke.position.fromArray(Le.translation),Le.rotation!==void 0&&ke.quaternion.fromArray(Le.rotation),Le.scale!==void 0&&ke.scale.fromArray(Le.scale);return me.associations.set(ke,{type:"nodes",index:he}),ke})},Vt.prototype.loadScene=function(){function he(K,Fe,me,Le){var Be=me.nodes[K];return Le.getDependency("node",K).then(function(Ye){if(Be.skin===void 0)return Ye;var ke;return Le.getDependency("skin",Be.skin).then(function(He){ke=He;for(var Je=[],ot=0,bt=ke.joints.length;ot<bt;ot++)Je.push(Le.getDependency("node",ke.joints[ot]));return Promise.all(Je)}).then(function(He){return Ye.traverse(function(Je){if(!!Je.isMesh){for(var ot=[],bt=[],Mt=0,ue=He.length;Mt<ue;Mt++){var oe=He[Mt];if(oe){ot.push(oe);var lt=new yr;ke.inverseBindMatrices!==void 0&&lt.fromArray(ke.inverseBindMatrices.array,Mt*16),bt.push(lt)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',ke.joints[Mt])}Je.bind(new d0(ot,bt),Je.matrixWorld)}}),Ye})}).then(function(Ye){Fe.add(Ye);var ke=[];if(Be.children)for(var He=Be.children,Je=0,ot=He.length;Je<ot;Je++){var bt=He[Je];ke.push(he(bt,Ye,me,Le))}return Promise.all(ke)})}return function(Fe){var me=this.json,Le=this.extensions,Be=this.json.scenes[Fe],Ye=this,ke=new $o;Be.name&&(ke.name=Ye.createUniqueName(Be.name)),Ve(ke,Be),Be.extensions&&je(Le,ke,Be);for(var He=Be.nodes||[],Je=[],ot=0,bt=He.length;ot<bt;ot++)Je.push(he(He[ot],ke,me,Ye));return Promise.all(Je).then(function(){return ke})}}(),r}(),zw=function(r){Ng.call(this,r),this.type=os};zw.prototype=Object.assign(Object.create(Ng.prototype),{constructor:zw,parse:function(r){var i=-1,n=1,u=2,p=3,g=4,b=function(et,rt){switch(et){case n:console.error("RGBELoader Read Error: "+(rt||""));break;case u:console.error("RGBELoader Write Error: "+(rt||""));break;case p:console.error("RGBELoader Bad File Format: "+(rt||""));break;default:case g:console.error("RGBELoader: Error: "+(rt||""))}return i},M=1,A=2,C=4,F=`
`,O=function(et,rt,je){rt=rt||1024;for(var Ve=et.pos,ht=-1,ft=0,Wt="",An=128,Vt=String.fromCharCode.apply(null,new Uint16Array(et.subarray(Ve,Ve+An)));0>(ht=Vt.indexOf(F))&&ft<rt&&Ve<et.byteLength;)Wt+=Vt,ft+=Vt.length,Ve+=An,Vt+=String.fromCharCode.apply(null,new Uint16Array(et.subarray(Ve,Ve+An)));return-1<ht?(je!==!1&&(et.pos+=ft+ht+1),Wt+Vt.slice(0,ht)):!1},k=function(et){var rt,je,Ve=/^#\?(\S+)$/,ht=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,ft=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,Wt=/^\s*FORMAT=(\S+)\s*$/,An=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,Vt={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};if(et.pos>=et.byteLength||!(rt=O(et)))return b(n,"no header found");if(!(je=rt.match(Ve)))return b(p,"bad initial token");for(Vt.valid|=M,Vt.programtype=je[1],Vt.string+=rt+`
`;rt=O(et),rt!==!1;){if(Vt.string+=rt+`
`,rt.charAt(0)==="#"){Vt.comments+=rt+`
`;continue}if((je=rt.match(ht))&&(Vt.gamma=parseFloat(je[1],10)),(je=rt.match(ft))&&(Vt.exposure=parseFloat(je[1],10)),(je=rt.match(Wt))&&(Vt.valid|=A,Vt.format=je[1]),(je=rt.match(An))&&(Vt.valid|=C,Vt.height=parseInt(je[1],10),Vt.width=parseInt(je[2],10)),Vt.valid&A&&Vt.valid&C)break}return Vt.valid&A?Vt.valid&C?Vt:b(p,"missing image size specifier"):b(p,"missing format specifier")},N=function(et,rt,je){var Ve,ht,ft,Wt,An,Vt,Dn,Ci,vi,he,K,Fe,me=rt,Le=je,Be;if(me<8||me>32767||et[0]!==2||et[1]!==2||et[2]&128)return new Uint8Array(et);if(me!==(et[2]<<8|et[3]))return b(p,"wrong scanline width");if(Ve=new Uint8Array(4*rt*je),!Ve.length)return b(g,"unable to allocate buffer space");for(ht=0,ft=0,Ci=4*me,Be=new Uint8Array(4),Vt=new Uint8Array(Ci);Le>0&&ft<et.byteLength;){if(ft+4>et.byteLength)return b(n);if(Be[0]=et[ft++],Be[1]=et[ft++],Be[2]=et[ft++],Be[3]=et[ft++],Be[0]!=2||Be[1]!=2||(Be[2]<<8|Be[3])!=me)return b(p,"bad rgbe scanline format");for(Dn=0;Dn<Ci&&ft<et.byteLength;){if(Wt=et[ft++],Fe=Wt>128,Fe&&(Wt-=128),Wt===0||Dn+Wt>Ci)return b(p,"bad scanline data");if(Fe)for(An=et[ft++],vi=0;vi<Wt;vi++)Vt[Dn++]=An;else Vt.set(et.subarray(ft,ft+Wt),Dn),Dn+=Wt,ft+=Wt}for(he=me,vi=0;vi<he;vi++)K=0,Ve[ht]=Vt[vi+K],K+=me,Ve[ht+1]=Vt[vi+K],K+=me,Ve[ht+2]=Vt[vi+K],K+=me,Ve[ht+3]=Vt[vi+K],ht+=4;Le--}return Ve},X=function(et,rt,je,Ve){var ht=et[rt+3],ft=Math.pow(2,ht-128)/255;je[Ve+0]=et[rt+0]*ft,je[Ve+1]=et[rt+1]*ft,je[Ve+2]=et[rt+2]*ft},ne=function(){var et=new Float32Array(1),rt=new Int32Array(et.buffer);function je(Ve){et[0]=Ve;var ht=rt[0],ft=ht>>16&32768,Wt=ht>>12&2047,An=ht>>23&255;return An<103?ft:An>142?(ft|=31744,ft|=(An==255?0:1)&&ht&8388607,ft):An<113?(Wt|=2048,ft|=(Wt>>114-An)+(Wt>>113-An&1),ft):(ft|=An-112<<10|Wt>>1,ft+=Wt&1,ft)}return function(Ve,ht,ft,Wt){var An=Ve[ht+3],Vt=Math.pow(2,An-128)/255;ft[Wt+0]=je(Ve[ht+0]*Vt),ft[Wt+1]=je(Ve[ht+1]*Vt),ft[Wt+2]=je(Ve[ht+2]*Vt)}}(),te=new Uint8Array(r);te.pos=0;var j=k(te);if(i!==j){var W=j.width,Pe=j.height,Re=N(te.subarray(te.pos),W,Pe);if(i!==Re){switch(this.type){case os:var dt=Re,an=zv,_t=os;break;case Tr:for(var $e=Re.length/4*3,Ne=new Float32Array($e),de=0;de<$e;de++)X(Re,de*4,Ne,de*3);var dt=Ne,an=Or,_t=Tr;break;case ur:for(var $e=Re.length/4*3,Gt=new Uint16Array($e),de=0;de<$e;de++)ne(Re,de*4,Gt,de*3);var dt=Gt,an=Or,_t=ur;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type);break}return{width:W,height:Pe,data:dt,header:j.string,gamma:j.gamma,exposure:j.exposure,format:an,type:_t}}}return null},setDataType:function(r){return this.type=r,this},load:function(r,i,n,u){function p(g,b){switch(g.type){case os:g.encoding=Sf,g.minFilter=Kr,g.magFilter=Kr,g.generateMipmaps=!1,g.flipY=!0;break;case Tr:g.encoding=Bl,g.minFilter=ti,g.magFilter=ti,g.generateMipmaps=!1,g.flipY=!0;break;case ur:g.encoding=Bl,g.minFilter=ti,g.magFilter=ti,g.generateMipmaps=!1,g.flipY=!0;break}i&&i(g,b)}return Ng.prototype.load.call(this,r,p,n,u)}});class Uw extends en.Object3D{constructor(i){super(),this.element=i,this.element.style.position="absolute",this.addEventListener("removed",function(){this.element.parentNode!==null&&this.element.parentNode.removeChild(this.element)})}}class oA{constructor(){this.domElement=document.createElement("div"),this.viewMatrix=new en.Matrix4,this.viewProjectionMatrix=new en.Matrix4,this.vector=new en.Vector3,this.cache={objects:new WeakMap},this.getDistanceToSquaredA=new en.Vector3,this.getDistanceToSquaredB=new en.Vector3,this.domElement.style.overflow="hidden"}zOrder(i){const n=this.filterAndFlatten(i).sort((p,g)=>{const b=this.cache.objects.get(p).distanceToCameraSquared,M=this.cache.objects.get(g).distanceToCameraSquared;return b-M}),u=n.length;for(let p=0,g=n.length;p<g;p++)n[p].element.style.zIndex=String(u-p)}getDistanceToSquared(i,n){return this.getDistanceToSquaredA.setFromMatrixPosition(i.matrixWorld),this.getDistanceToSquaredB.setFromMatrixPosition(n.matrixWorld),this.getDistanceToSquaredA.distanceToSquared(this.getDistanceToSquaredB)}render(i,n){i.updateMatrixWorld(),n.parent===null&&n.updateMatrixWorld(!1),this.viewMatrix.copy(n.matrixWorldInverse),this.viewProjectionMatrix.multiplyMatrices(n.projectionMatrix,this.viewMatrix),this.renderObject(i,n),this.zOrder(i)}getSize(){return{width:this.width,height:this.height}}setSize(i,n){this.width=i,this.height=n,this.widthHalf=this.width/2,this.heightHalf=this.height/2,this.domElement.style.width=i+"px",this.domElement.style.height=n+"px"}filterAndFlatten(i){const n=[];return i.traverse(u=>{u instanceof Uw&&n.push(u)}),n}renderObject(i,n){if(i instanceof Uw){this.vector.setFromMatrixPosition(i.matrixWorld),this.vector.applyMatrix4(this.viewProjectionMatrix);const u=i.element,p="translate(-50%,-50%) translate("+(this.vector.x*this.widthHalf+this.widthHalf)+"px,"+(-this.vector.y*this.heightHalf+this.heightHalf)+"px)";u.style.transform=p,u.style.display=i.visible&&this.vector.z>=-1&&this.vector.z<=1?"":"none";const g={distanceToCameraSquared:this.getDistanceToSquared(n,i)};this.cache.objects.set(i,g),u.parentNode!==this.domElement&&this.domElement.appendChild(u)}for(let u=0,p=i.children.length;u<p;u++)this.renderObject(i.children[u],n)}}var B0=null;function QS(r){if(r==null){B0=null;return}else lA(),B0=r}function lA(){B0&&B0.toggleVisibility()}class cA{constructor(i,n,u,p){this.widgetRef=null,this.visible=!1,this.id=i,this.position=n,this.normal_vector=u,this.labelObject=p}setWidgetRef(i){this.widgetRef=i}toggleVisibility(){this.visible=!this.visible,this.visible?(QS(this),this.widgetRef&&(this.widgetRef.style.display="grid")):(QS(null),this.widgetRef&&(this.widgetRef.style.display="none"))}setOpacity(i){this.labelObject.element.style.opacity=i}}let Hw;const Gw=45,uA=2,hA=.1,fA=100,e1={url:"https://devcdn.vev.design/private/IZ8anjrpLbNsil9YD4NOn6pLTsc2/ZtaWckY6KR_Astronaut.glb.glb"},dA="https://cdn.vev.design/private/Tr1z5E7fRfebmaI3Le2T8vQsHud2/c_W6ves3U_abandoned_factory_canteen_01_1k.hdr.hdr";function pA({hostRef:r,hotspots:i,hotspotColor:n,modelURL:u,posterURL:p,loader:g,enableMouseControl:b,autoRotate:M=!1,enablePan:A=!1,enableZoom:C=!1}){const{disabled:F}=Zt(),{width:O,height:k}=ln(r),N=gt(null),[X,ne]=qt(null),[te,j]=qt(u||e1),[W,Pe]=qt(p),[Re,Ne]=qt(null),[de,$e]=qt(null),[Gt,dt]=qt(null),[an,_t]=qt(null),[et,rt]=qt(null),[je,Ve]=qt(0),[ht,ft]=qt(!1),[Wt,An]=qt(null),Vt=gt(null),[Dn,Ci]=qt([]),vi=ln(r);console.log("lol"),Ct(()=>{Ye(),bt()},[]),Ct(()=>{ht&&Wt.render(et,an)},[ht]),Ct(()=>{if(!X||!i)return;he();let ue=K();Ci(ue),bt(),Wt.render(et,an)},[i,X,n]);function he(){for(let ue=X.children.length-1;ue>=0;ue--)X.children[ue]&&X.children[ue].name=="hotspot"&&X.remove(X.children[ue]);bt()}function K(){let ue=[];for(let oe=0;oe<i.length;oe++){let lt=new cA(i[oe].id,i[oe].position,i[oe].normal_vector,Be(X,i[oe].position));if(i[oe].widget){let yt=document.getElementById(i[oe].widget.value);yt&&lt.setWidgetRef(yt)}Fe(lt,"click"),Fe(lt,"touchend"),ue.push(lt)}return ue}function Fe(ue,oe){ue.labelObject.element.addEventListener(oe,()=>{var lt=an.position.length();let yt=new en.Vector3(ue.position.x,ue.position.y,ue.position.z).normalize().multiplyScalar(lt);Hn.to(an.position,1,{x:yt.x,y:yt.y,z:yt.z,onUpdate:()=>{de.update()}}),ue.toggleVisibility()})}Ct(()=>{Wt&&(Wt.setSize(vi.width,vi.height),Wt.render(et,an))},[vi]),Ct(()=>{if(!(F||!Re||!de))return Gt&&Gt.setAnimationLoop(Je),()=>{Gt&&Gt.setAnimationLoop(null)}},[F,Gt,Re,de,Dn]),Ct(()=>{!de||(de.enabled=b,de.enablePan=A,de.enableZoom=C,de.removeEventListener("start",me),de.removeEventListener("end",Le),M&&(de.addEventListener("start",me),de.addEventListener("end",Le)),clearTimeout(Hw),de.autoRotate=M,de.update())},[de,M,b,A,C]);const me=Bn(()=>{clearTimeout(Hw),de.autoRotate=!1},[de]),Le=Bn(()=>{Hw=setTimeout(function(){de.autoRotate=!0},3e3)},[de]);Ct(()=>{if(u){if(u.url==te.url)return;j(u)}else{j(e1);return}},[u]),Ct(()=>{if(!et||!an||!Gt)return;Re&&(Mt(Re),he(),ft(!1),Ve(0));let ue=te.url;ke(ue,et,X,an,Gt,de)},[te]);function Be(ue,oe){var lt=document.createElement("div");lt.className="dot",lt.style.backgroundColor=n||"blue",lt.style.width="20px",lt.style.height="20px",lt.style.borderRadius="10px",lt.style.cursor="pointer";var yt=new Uw(lt);return yt.position.set(oe.x,oe.y,oe.z),yt.name="hotspot",yt.parent=Re,ue.add(yt),yt}function Ye(){const ue=N.current;let oe=new en.WebGLRenderer({canvas:ue,alpha:!0,antialias:!0});oe.setSize(O,k),oe.toneMapping=en.ACESFilmicToneMapping,oe.toneMappingExposure=1,oe.outputEncoding=en.sRGBEncoding,oe.shadowMap.type=en.PCFShadowMap;let lt=new en.Scene,yt=new en.PerspectiveCamera(Gw,uA,hA,fA);lt.add(yt);let Ce=new oA;Ce.setSize(vi.width,vi.height),Ce.domElement.style.position="absolute",Ce.domElement.style.top="0",Ce.domElement.style.outline="none",Vt.current.appendChild(Ce.domElement),An(Ce);let Pt=new zg(yt,Ce.domElement);Pt.autoRotate=M,Pt.enableDamping=!0,Pt.enableZoom=C,Pt.dampingFactor=.1,Pt.update();var Kt=new en.Mesh;ne(Kt),lt.add(Kt);let qn=te.url;try{ke(qn,lt,Kt,yt,oe,Pt)}catch(xn){console.error("There was a issue loading the glb"),console.error((xn==null?void 0:xn.message)||xn)}dt(oe),rt(lt),_t(yt),$e(Pt)}function ke(ue,oe,lt,yt,Ce,Pt){var Kt=new en.PMREMGenerator(Ce);Kt.compileEquirectangularShader(),new zw().setDataType(en.UnsignedByteType).load(dA,function(qn){const xn=Kt.fromEquirectangular(qn).texture;oe.environment=xn,qn.dispose(),Kt.dispose(),new aA().load(ue,function(Oe){let Ht=Oe.scene;Ht.castShadow=!0,Ht.receiveShadow=!0,lt.add(Ht),Ne(Ht);const Kn=new en.Box3().setFromObject(Ht),hn=Kn.getSize(new en.Vector3),jn=Kn.getCenter(new en.Vector3);Ht.position.x=Ht.position.x-jn.x,Ht.position.y=Ht.position.y-jn.y,Ht.position.z=Ht.position.z-jn.z,He(hn,jn,yt),Pt.maxDistance=hn.length()*5,Pt.update(),ft(!0)},function(Oe){let Ht=Oe.loaded/Oe.total*100;Ve(Ht)},function(Oe){console.log("GLTF loading error: ",Oe)})},void 0,function(qn){console.log("Error in RGBELoader"),console.error((qn==null?void 0:qn.message)||qn)})}function He(ue,oe,lt){const yt=ue.length()*.5,Ce=en.MathUtils.degToRad(Gw*.5),Pt=yt/Math.tan(Ce),Kt=new en.Vector3().subVectors(lt.position,oe).multiply(new en.Vector3(1,0,1)).normalize();lt.position.copy(Kt.multiplyScalar(Pt).add(oe)),lt.near=ue.length()/100,lt.far=ue.length()*100,lt.rotation.set(0,0,0);const qn=Math.max(ue.x,ue.y);lt.position.set(0,0,Math.abs(qn/Math.sin(Gw/2))),lt.updateProjectionMatrix(),lt.lookAt(oe.x,oe.y,oe.z),bt()}function Je(){for(let ue=0;ue<Dn.length;ue++)ot(Dn[ue],an);de&&de.update(),Wt.render(et,an),bt()}function ot(ue,oe){let lt=new en.Vector3(ue.position.x,ue.position.y,ue.position.z),yt=new en.Vector3(0,0,-1).applyQuaternion(oe.quaternion);lt.angleTo(yt)>Math.PI/2?ue.setOpacity("1"):ue.setOpacity("0.1")}Ct(()=>{Gt&&an&&(an.aspect=O/k,an.updateProjectionMatrix(),Gt.setSize(O,k-10),bt())},[O,k,Re]);function bt(){try{Gt&&et&&an&&Gt.render(et,an)}catch(ue){console.error("Error rendering scene"),console.error((ue==null?void 0:ue.message)||ue)}}function Mt(ue){for(var oe of X.children)oe===ue&&X.remove(oe);bt()}return st.createElement(En,null,!ht&&st.createElement("div",{className:"loadingWrapper"},g=="bar"||st.createElement("div",{className:"loadingBar"},st.createElement("div",{className:"progressFill",style:{width:`${je}%`}}))),!ht&&W&&st.createElement("div",{className:"posterImage",style:{backgroundImage:`url(${W.url})`}}),st.createElement("div",{ref:Vt,className:"modelContainer"},st.createElement("canvas",{ref:N,id:"scene"})))}}}}),Bs.register("p7bj3ogk",["react","vev","animejs"],function(Ki){"use strict";var gt,qt,Ct,Bn,En,Zt,ln,Fn;return{setters:[function(Rn){gt=Rn.useState,qt=Rn.useRef,Ct=Rn.useEffect},function(Rn){Bn=Rn.useSize,En=Rn.Gesture,Zt=Rn.Link,ln=Rn.Icon},function(Rn){Fn=Rn.default}],execute:function(){Ki({wArrjLRwxR0:en,wUOVqaQjd8:Yt,"w-ExSvTIwU":Un,wrGDDbI2TY:Pn});function Rn(Nt,Ee,Xe){Nt>0?ri(Ee,Xe):In(Ee,Xe)}function ri(Nt,Ee){Fn({targets:Nt,translateX:[0,"-100%"],easing:"easeOutExpo"}),Fn({targets:Ee,translateX:["100%",0],easing:"easeOutExpo"})}function In(Nt,Ee){Fn({targets:Nt,translateX:[0,"100%"],easing:"easeOutExpo"}),Fn({targets:Ee,translateX:["-100%",0],easing:"easeOutExpo"})}function Hn(Nt,Ee,Xe,pt){for(let wt of Ee)Fn(wt===Nt?{targets:wt,translateX:[-Xe*pt+"px"],scale:1,easing:"easeOutExpo"}:{targets:wt,translateX:[-Xe*pt+"px"],scale:.8,easing:"easeOutExpo"})}function Un({hostRef:Nt,list:Ee,iconAlignment:Xe,hideArrows:pt}){const[wt,kt]=gt(0),mt=qt(null),{width:St}=Bn(Nt);function It(cn){var nn=cn-wt;if(!(wt==Ee.length-1&&nn>=0||wt==0&&nn<=0)){var di=Nt.current.querySelector(".card-slider"+cn),Ri=Nt.current.querySelectorAll(".card-slider");cn!=wt&&Hn(di,Ri,cn,St),kt(cn)}}Ct(()=>{var cn=Nt.current.querySelector(".card-slider0"),nn=Nt.current.querySelectorAll(".card-slider");Hn(cn,nn,0,St)},[]),Ct(()=>{if(wt>=Ee.length){var cn=Nt.current.querySelector(".card-slider"+(wt-1)),nn=Nt.current.querySelectorAll(".card-slider");if(cn)Hn(cn,nn,wt-1,St),kt(wt-1);else return}},[Ee]);function Tn(){wt<Ee.length-1&&It(wt+1)}function Ft(){wt>0&&It(wt-1)}return st.createElement(En,{onSwipeLeft:Tn,onSwipeRight:Ft},st.createElement("div",{className:"holder fill"},Ee&&Ee.length>0?Ee.map((cn,nn)=>st.createElement("div",{className:"card-slider card-slider"+nn.toString()+` ${nn==wt?"active":"inactive"}`,key:nn},cn.icon&&st.createElement("div",{className:"top"},st.createElement("div",{className:"image",style:cn.icon&&{backgroundImage:`url( ${cn.icon.url} )`,backgroundSize:cn.iconSize?`auto ${cn.iconSize}px`:"auto 60px",backgroundPosition:Xe}})),st.createElement("div",{className:"bottom",ref:mt},st.createElement("div",{className:"title"},cn.title),st.createElement("div",{className:"subtitle"},cn.subtitle),st.createElement("div",{className:"body"},cn.body),cn.link&&cn.linkText&&st.createElement(Zt,{className:"link",to:cn.link},cn.linkText)))):st.createElement("div",{className:"fill widget-instructions"},"No content. Double click to add something."),!pt&&Ee&&Ee.length>1&&st.createElement("div",{className:"nav-arrows"},st.createElement("div",{className:`arrow left ${wt<1&&"hidden"}`,onClick:Ft},st.createElement(ln,{d:"left"})),st.createElement("div",{className:`arrow right ${wt>=Ee.length-1&&"hidden"}`},st.createElement(ln,{d:"right",onClick:Tn}))),Ee&&Ee.length>1&&st.createElement("div",{className:"nav"},Ee.map((cn,nn)=>st.createElement("span",{key:nn,className:`nav-option ${nn==wt?"active":""}`,onClick:()=>It(nn)})))))}function en({hostRef:Nt,list:Ee}){const[Xe,pt]=gt(0),wt=qt([0,0]);function kt(Ft){var cn=Ft-Xe;if(!(Xe==Ee.length-1&&cn>=0||Xe==0&&cn<=0)){var nn=Nt.current.querySelector(".card"+Ft),di=Nt.current.querySelector(".card"+Xe);Rn(cn,di,nn),pt(Ft)}}Ct(()=>{if(Xe>=Ee.length){var Ft=Nt.current.querySelector(".card"+(Xe-1));if(Ft)Rn(-1,null,Ft),pt(Xe-1);else return}},[Ee]);function mt(){Xe<Ee.length-1&&kt(Xe+1)}function St(){Xe>0&&kt(Xe-1)}function It(Ft){wt.current=[Ft.pageX,Ft.pageY]}function Tn(Ft){Math.abs(Ft.pageX-wt.current[0])<10&&Math.abs(Ft.pageX-wt.current[0])<10&&kt((Xe+1)%((Ee==null?void 0:Ee.length)||0))}return st.createElement(En,{onSwipeLeft:mt,onSwipeRight:St,onTouchStart:It,onTouchEnd:Tn},st.createElement("div",{className:"holder fill"},Ee&&Ee.length>0&&Ee.map((Ft,cn)=>st.createElement("div",{className:"card card"+cn.toString()+` ${cn==Xe?"active":"inactive"}`,key:cn,style:{backgroundColor:`rgba(${Ft.color.r}, ${Ft.color.g}, ${Ft.color.b}, ${Ft.color.a})`}},st.createElement("div",{className:"icon-image",style:Ft.icon&&{backgroundImage:`url( ${Ft.icon.url} )`}}),st.createElement("div",{className:"text"},st.createElement("div",{className:"title"},Ft.title),st.createElement("div",{className:"body"},Ft.body)),Ft.footer.length>0&&st.createElement("div",{className:"footer"},st.createElement(Zt,{className:"link",to:Ft.link,onTouchEnd:nn=>nn.stopPropagation()},Ft.footer)))),Ee&&Ee.length>1&&st.createElement("div",{className:"nav"},Ee.map((Ft,cn)=>st.createElement("span",{key:cn,className:`nav-option ${cn==Xe?"active":""}`,onClick:()=>kt(cn)})))))}function Yt({hostRef:Nt,list:Ee}){const[Xe,pt]=gt(0);function wt(St){var It=St-Xe;if(!(Xe==Ee.length-1&&It>=0||Xe==0&&It<=0)){var Tn=Nt.current.querySelector(".card"+St),Ft=Nt.current.querySelector(".card"+Xe);Rn(It,Ft,Tn),pt(St)}}Ct(()=>{if(Xe>=Ee.length){var St=Nt.current.querySelector(".card"+(Xe-1));if(St)Rn(-1,null,St),pt(Xe-1);else return}},[Ee]);function kt(){Xe<Ee.length-1&&wt(Xe+1)}function mt(){Xe>0&&wt(Xe-1)}return st.createElement(En,{onSwipeLeft:kt,onSwipeRight:mt},st.createElement("div",{className:"fill"},st.createElement("div",{className:"card-wrapper fill"},Ee&&Ee.length>0&&Ee.map((St,It)=>st.createElement("div",{className:"card card"+It.toString()+` ${It==Xe?"active":"inactive"}`,key:It},st.createElement("div",{className:"content"},st.createElement("div",{className:"description"},st.createElement("div",{className:"title"},St.title),st.createElement("div",{className:"caption"},St.caption)),st.createElement("div",{className:"stats-wrapper"},St.stats&&St.stats.map((Tn,Ft)=>st.createElement("div",{className:"stat",key:Ft},st.createElement("div",{className:"stat"},Tn.stat),st.createElement("div",{className:"label"},Tn.label))))),st.createElement("div",{className:"badge",style:St.image&&{backgroundImage:`url(${St.image.url})`}})))),Ee&&Ee.length>1&&st.createElement("div",{className:"nav"},Ee.map((St,It)=>st.createElement("span",{key:It,className:`nav-option ${It==Xe?"active":""}`,onClick:()=>wt(It)})))))}function Pn({hostRef:Nt,list:Ee}){const[Xe,pt]=gt(0);function wt(St){var It=St-Xe;if(!(Xe==Ee.length-1&&It>=0||Xe==0&&It<=0)){var Tn=Nt.current.querySelector(".card"+St),Ft=Nt.current.querySelector(".card"+Xe);Rn(It,Ft,Tn),pt(St)}}Ct(()=>{if(Xe>=Ee.length){var St=Nt.current.querySelector(".card"+(Xe-1));if(St)Rn(-1,null,St),pt(Xe-1);else return}},[Ee]);function kt(){Xe<Ee.length-1&&wt(Xe+1)}function mt(){Xe>0&&wt(Xe-1)}return st.createElement(En,{onSwipeLeft:kt,onSwipeRight:mt},st.createElement("div",{className:"holder fill"},Ee&&Ee.length>0&&Ee.map((St,It)=>{var Tn;return st.createElement("div",{className:"card card"+It.toString()+` ${It==Xe?"active":"inactive"}`,key:It},st.createElement("img",{className:"top",src:(Tn=St.image)==null?void 0:Tn.url}),St.icon&&st.createElement("div",{className:"middle"},st.createElement("div",{className:"icon-image",style:{backgroundImage:`url( ${St.icon.url} )`}})),st.createElement("div",{className:"bottom"},st.createElement("div",{className:"title"},St.title),st.createElement("div",{className:"body"},St.body)))}),Ee&&Ee.length>1&&st.createElement("div",{className:"nav"},Ee.map((St,It)=>st.createElement("span",{key:It,className:`nav-option ${It==Xe?"active":""}`,onClick:()=>wt(It)})))))}}}})});})();
